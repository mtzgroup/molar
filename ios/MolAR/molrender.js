"use strict";(()=>{var I0=Object.defineProperty;var Ao=(e,t)=>{for(var r in t)I0(e,r,{get:t[r],enumerable:!0})};var Tl=Math.PI/180;function Io(e){return e*Tl}function Po(e){return e/Tl}function P0(e,t,r){return(e-t)/(r-t)}function Br(e,t,r){return Math.max(t,Math.min(r,e))}function T0(e){return Br(e,0,1)}function Qt(e,t,r){return e+(t-e)*r}function pa(e,t,r,n,o,a){let i=(r-e)*a,s=(n-t)*a,u=o*o,m=o*u;return(2*t-2*r+i+s)*m+(-3*t+3*r-2*i-s)*u+i*o+t}function fa(e,t,r){return r=T0(P0(r,e,t)),r*r*(3-2*r)}function yr(){return yr.zero()}(P=>{function e(){let A=[.1,0,0];return A[0]=0,A}P.zero=e;function t(A,b){let[_,v,R]=rt.toRgb(b),[E,B,L]=I(_,v,R),G=116*B-16;return A[0]=G<0?0:G,A[1]=500*(E-B),A[2]=200*(B-L),A}P.fromColor=t;function r(A,b){return fr.toLab(A,b)}P.fromHcl=r;function n(A){let b=(A[0]+16)/116,_=isNaN(A[1])?b:b+A[1]/500,v=isNaN(A[2])?b:b-A[2]/200;b=l*f(b),_=c*f(_),v=d*f(v);let R=h(3.2404542*_-1.5371385*b-.4985314*v),E=h(-.969266*_+1.8760108*b+.041556*v),B=h(.0556434*_-.2040259*b+1.0572252*v);return rt.fromRgb(Math.round(Br(R,0,255)),Math.round(Br(E,0,255)),Math.round(Br(B,0,255)))}P.toColor=n;function o(A,b){let[_,v,R]=b,E=Math.sqrt(v*v+R*R),B=(Po(Math.atan2(R,v))+360)%360;return Math.round(E*1e4)===0&&(B=Number.NaN),A[0]=B,A[1]=E,A[2]=_,A}P.toHcl=o;function a(A,b){return A[0]=b[0],A[1]=b[1],A[2]=b[2],A}P.copy=a;function i(A,b,_){return A[0]=b[0]-m*_,A[1]=b[1],A[2]=b[2],A}P.darken=i;let s=[0,0,0];function u(A,b,_){return o(s,b),fr.toLab(A,fr.saturate(s,s,_))}P.saturate=u;let m=18,c=.95047,l=1,d=1.08883,y=.137931034,S=.206896552,x=.12841855,g=.008856452;function h(A){return 255*(A<=.00304?12.92*A:1.055*Math.pow(A,1/2.4)-.055)}function f(A){return A>S?A*A*A:x*(A-y)}function C(A){return(A/=255)<=.04045?A/12.92:Math.pow((A+.055)/1.055,2.4)}function T(A){return A>g?Math.pow(A,1/3):A/x+y}function I(A,b,_){A=C(A),b=C(b),_=C(_);let v=T((.4124564*A+.3575761*b+.1804375*_)/c),R=T((.2126729*A+.7151522*b+.072175*_)/l),E=T((.0193339*A+.119192*b+.9503041*_)/d);return[v,R,E]}})(yr||(yr={}));function fr(){return fr.zero()}(m=>{function e(){let c=[.1,0,0];return c[0]=0,c}m.zero=e;let t=[0,0,0];function r(c,l){return yr.toHcl(c,yr.fromColor(t,l))}m.fromColor=r;let n=[0,0,0];function o(c){return yr.toColor(a(n,c))}m.toColor=o;function a(c,l){let[d,y,S]=l;return isNaN(d)&&(d=0),d=Io(d),c[0]=S,c[1]=Math.cos(d)*y,c[2]=Math.sin(d)*y,c}m.toLab=a;function i(c,l){return c[0]=l[0],c[1]=l[1],c[2]=l[2],c}m.copy=i;function s(c,l,d){return c[0]=l[0],c[1]=Math.max(0,l[1]+u*d),c[2]=l[2],c}m.saturate=s;let u=18})(fr||(fr={}));function rt(e){return e}(h=>{function e(f){return[f>>16&255,f>>8&255,f&255]}h.toRgb=e;function t(f){return[(f>>16&255)/255,(f>>8&255)/255,(f&255)/255]}h.toRgbNormalized=t;function r(f,C,T){return f<<16|C<<8|T}h.fromRgb=r;function n(f,C,T){return f*255<<16|C*255<<8|T*255}h.fromNormalizedRgb=n;function o(f,C){return r(f[C],f[C+1],f[C+2])}h.fromArray=o;function a(f,C){return n(f[C],f[C+1],f[C+2])}h.fromNormalizedArray=a;function i(f,C,T){return C[T]=f>>16&255,C[T+1]=f>>8&255,C[T+2]=f&255,C}h.toArray=i;function s(f,C,T){return C[T]=(f>>16&255)/255,C[T+1]=(f>>8&255)/255,C[T+2]=(f&255)/255,C}h.toArrayNormalized=s;function u(f,C){return f[0]=C>>16&255,f[1]=C>>8&255,f[2]=C&255,f}h.toVec3=u;function m(f,C){return f[0]=(C>>16&255)/255,f[1]=(C>>8&255)/255,f[2]=(C&255)/255,f}h.toVec3Normalized=m;function c(f,C,T){let I=f>>16&255,P=f>>8&255,A=f&255,b=C>>16&255,_=C>>8&255,v=C&255,R=I+(b-I)*T,E=P+(_-P)*T,B=A+(v-A)*T;return R<<16|E<<8|B}h.interpolate=c;let l=[0,0,0];function d(f,C){return fr.fromColor(l,f),fr.toColor(fr.saturate(l,l,C))}h.saturate=d;let y=[0,0,0];function S(f,C){return yr.fromColor(y,f),yr.toColor(yr.darken(y,y,C))}h.darken=S;function x(f){return f<.04045?f*.0773993808:Math.pow(f*.9478672986+.0521327014,2.4)}function g(f){return n(x((f>>16&255)/255),x((f>>8&255)/255),x((f&255)/255))}h.sRGBToLinear=g})(rt||(rt={}));function Fi(e,t){return{list:t,type:e}}function vl(e,t,r){let n={};for(let o in e){let a=e[o];a=rt.saturate(a,t),a=rt.darken(a,-r),n[o]=a}return n}var Ui={"red-yellow-blue":Fi("diverging",[10813478,14102567,16018755,16625249,16703632,16777151,14742520,11262441,7646673,4552116,3225237]),"dark-2":Fi("qualitative",[1810039,14245634,7696563,15149450,6727198,15117058,10909213,6710886]),"many-distinct":Fi("qualitative",[1810039,14245634,7696563,15149450,6727198,15117058,10909213,6710886,14948892,3636920,5091146,9981603,16744192,16777011,10901032,16220607,10066329,6734501,16551266,9281739,15174339,10934356,16767279,15058068,11776947]),turbo:Fi("sequential",[4866485,4872413,4354034,3770361,3120629,2667241,2475736,2611140,3073454,3928216,5109892,6487408,8126047,9829201,11531332,13167162,14605618,15780908,16693543,16753699,16748063,16741916,16146200,15026195,13644558,12198408,10818563,9833728])};function Rr(e){return Ui[e]}var xe;(m=>{function e(c){return c.creator&&c.chunkSize}m.is=e;function t(c){let l=c.growBy*c.elementSize;c.currentSize=l,c.currentIndex=0,c.currentChunk=new c.ctor(l),c.allocatedSize+=l,c.chunks[c.chunks.length]=c.currentChunk}function r(c,l,d,y){c.currentIndex>=c.currentSize&&t(c);let S=c.currentChunk,x=c.currentIndex;return S[x]=l,S[x+1]=d,S[x+2]=y,c.currentIndex+=3,c.elementCount++}m.add3=r;function n(c,l,d){c.currentIndex>=c.currentSize&&t(c);let y=c.currentChunk,S=c.currentIndex;return y[S]=l,y[S+1]=d,c.currentIndex+=2,c.elementCount++}m.add2=n;function o(c,l){return c.currentIndex>=c.currentSize&&t(c),c.currentChunk[c.currentIndex]=l,c.currentIndex+=1,c.elementCount++}m.add=o;function a(c,l,d){for(let y=0;y<l;y++)c.currentIndex>=c.currentSize&&t(c),c.currentChunk[c.currentIndex++]=d,c.elementCount++;return c.elementCount}m.addRepeat=a;function i(c,l=!1){return s(c,l)}m.compact=i;function s(c,l){let{ctor:d,chunks:y,currentIndex:S}=c;if(!y.length)return new d(0);if(y.length===1&&(l||S===c.allocatedSize))return y[0];let x=0;for(let C=0,T=y.length-1;C<T;C++)x+=y[C].length;x+=c.currentIndex;let g=new d(x),h=0;if(g.buffer)for(let C=0,T=y.length-1;C<T;C++)g.set(y[C],h),h+=y[C].length;else for(let C=0,T=y.length-1;C<T;C++){let I=y[C];for(let P=0,A=I.length;P<A;P++)g[h+P]=I[P];h+=I.length}let f=y[y.length-1];if(g.buffer&&S>=c.currentSize)g.set(f,h);else for(let C=0,T=f.length;C<T;C++)g[h+C]=f[C];return g}m._compact=s;function u(c,l,d,y){let S={ctor:c,elementSize:l,growBy:Math.max(1,Math.ceil(d)),allocatedSize:0,elementCount:0,currentSize:0,currentChunk:void 0,currentIndex:0,chunks:[]};if(typeof y>"u")return S;if(typeof y=="number")return S.currentChunk=new c(y*l),S.allocatedSize=y*l,S.currentSize=S.currentChunk.length,S.chunks[0]=S.currentChunk,S;let x=y;return S.currentChunk=x,S.allocatedSize=x.length,S.currentSize=x.length,S.chunks[0]=x,S}m.create=u})(xe||(xe={}));function ya(e,t,r){return e[t]-e[r]}function pn(e,t,r){let n=e[t];e[t]=e[r],e[r]=n}function Dl(e,t,r,n){let o=r+n>>1;return t(e,r,n)>0?t(e,r,o)>0?t(e,o,n)>0?o:n:r:t(e,n,o)>0?t(e,o,r)>0?o:r:n}function v0(e,t,r){let{cmp:n,swap:o,data:a,parts:i}=e,s=t+1,u=r;for(o(a,t,Dl(a,n,t,r));n(a,u,t)>0;)--u;for(let m=t+1;m<=u;m++){let c=n(a,m,t);if(c>0){for(o(a,m,u),--u;n(a,u,t)>0;)--u;m--}else c===0&&(o(a,m,s),s++)}for(let m=t;m<s;m++)o(a,m,t+u-m);i[0]=u-s+t+1,i[1]=u}function D0({data:e,cmp:t,swap:r},n,o){for(let a=n+1;a<=o;a++){let i=a-1;for(;i>=n&&t(e,i,i+1)>0;)r(e,i,i+1),i=i-1}}function ha(e,t,r){let{parts:n}=e;for(;t<r;){if(r-t<16){D0(e,t,r);return}v0(e,t,r);let o=n[0],a=n[1];o-t<r-a?(ha(e,t,o-1),t=a+1):(ha(e,a+1,r),r=o-1)}}function M0(e,t,r,n){let o=r+1,a=n;pn(e,r,Dl(e,ya,r,n));let i=e[r];for(;e[a]>i;)--a;for(let s=r+1;s<=a;s++){let u=e[s];if(u>i){for(pn(e,s,a),--a;e[a]>i;)--a;s--}else u===i&&(pn(e,s,o),++o)}for(let s=r;s<o;s++)pn(e,s,r+a-s);t[0]=a-o+r+1,t[1]=a}function E0(e,t,r){for(let n=t+1;n<=r;n++){let o=e[n],a=n-1;for(;a>=t&&e[a]>o;)e[a+1]=e[a],a=a-1;e[a+1]=o}}function Au(e,t,r,n){for(;r<n;){if(n-r<16){E0(e,r,n);return}M0(e,t,r,n);let o=t[0],a=t[1];o-r<n-a?(Au(e,t,r,o-1),r=a+1):(Au(e,t,a+1,n),n=o-1)}}function Fr(e,t=ya){return B0(e,0,e.length,t)}function B0(e,t,r,n=ya){return n===ya?Au(e,[0,0],t,r-1):ha({data:e,cmp:n,swap:pn,parts:[0,0]},t,r-1),e}function xa(e,t,r,n,o){return ha({data:e,cmp:n,swap:o,parts:[0,0]},t,r-1),e}function R0(e,t,r){return e[t].key<e[r].key?-1:1}function F0(e,t,r,n,o){let a=new Map,i=[],s=t(e[0]),u=!0;for(let y=n;y<o;y++){let S=t(e[y]);if(a.has(S))a.get(S).count++,s!==S&&(u=!1);else{let x={key:S,count:1,offset:y};a.set(S,x),i[i.length]=x}s=S}let m=new Int32Array(i.length+1);m[i.length]=o;let c=!0;if(r){for(let y=1,S=i.length;y<S;y++)if(i[y-1].key>i[y].key){c=!1;break}}if(u&&c){for(let y=0;y<i.length;y++)m[y]=i[y].offset;return m}r&&!c&&xa(i,0,i.length,R0,pn);let l=0;for(let y=0;y<i.length;y++){let S=i[y];S.offset=l,l+=S.count}let d=new Int32Array(o-n);for(let y=n;y<o;y++){let S=t(e[y]),x=a.get(S);d[x.offset++]=e[y]}for(let y=0,S=d.length;y<S;y++)e[y+n]=d[y];m[0]=n;for(let y=1;y<i.length;y++)m[y]=i[y-1].offset+n;return m}function ga(e,t,r){let n=r&&r.start||0,o=r&&r.end||e.length;return F0(e,t,!!(r&&r.sort),n,o)}var Iu=class{constructor(t,r){this.getHash=t;this.areEqual=r;this.id=0;this.byHash=new Map;this.groups=[]}createGroup(t,r){let n=this.id++,o=[t];return this.groups[n]=o,{id:n,keys:o,value:r}}add(t,r){let n=this.getHash(r);if(this.byHash.has(n)){let o=this.byHash.get(n);for(let i=0,s=o.length;i<s;i++){let u=o[i];if(this.areEqual(r,u.value))return u.keys[u.keys.length]=t,u.value}let a=this.createGroup(t,r);return o[o.length]=a,a.value}else{let o=this.createGroup(t,r);return this.byHash.set(n,[o]),o.value}}};function Ml(e,t){return new Iu(e,t)}function El(e){let t=e^e>>4;return t=(t^3735928559)+(t<<5),t=t^t>>11,t}function ba(e,t){let r=23;return r=31*r+e|0,r=31*r+t|0,r=r^r>>4,r=(r^3735928559)+(r<<5),r=r^r>>11,r}function Bl(e,t,r){let n=23;return n=31*n+e|0,n=31*n+t|0,n=31*n+r|0,n=n^n>>4,n=(n^3735928559)+(n<<5),n=n^n>>11,n}function Rl(e,t,r,n){let o=23;return o=31*o+e|0,o=31*o+t|0,o=31*o+r|0,o=31*o+n|0,o=o^o>>4,o=(o^3735928559)+(o<<5),o=o^o>>11,o}function Wt(e,t){return(e+t)*(e+t+1)/2+t}function Pu(e,t){return e<t?Wt(e,t):Wt(t,e)}function hr(e){let t=2166136261;for(let r=0,n=e.length;r<n;++r)t^=e[r],t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24);return t>>>0}var Vt={};Ao(Vt,{createAndFillArray:()=>L0,createArray:()=>To,getArrayBounds:()=>Kn,isTypedArray:()=>Sa,typedArrayWindow:()=>Ca});function Kn(e,t){let r=t&&typeof t.start<"u"?Math.max(Math.min(t.start,e-1),0):0,n=t&&typeof t.end<"u"?Math.min(t.end,e):e;return{start:r,end:n}}function To(e,t){let r=t&&typeof t.array<"u"?t.array:Array,{start:n,end:o}=Kn(e,t);return{array:new r(o-n),start:n,end:o}}function U0(e,t,r){for(let n=0,o=t.length;n<o;n++)t[n]=e(r+n);return t}function L0(e,t,r){let{array:n,start:o}=To(e,r);return U0(t,n,o)}function Sa(e){return!!e.buffer&&typeof e.byteLength=="number"&&typeof e.BYTES_PER_ELEMENT=="number"}function Ca(e,t){let{constructor:r,buffer:n,length:o,byteOffset:a,BYTES_PER_ELEMENT:i}=e,{start:s,end:u}=Kn(o,t);return s===0&&u===o?e:new r(n,a+i*s,Math.min(o,u-s))}function Bt(e,t,r){return Math.abs(e-t)<=r}function re(){return re.zero()}(ie=>{function e(){let D=[.1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];return D[0]=0,D}ie.zero=e;function t(){let D=e();return D[0]=1,D[1]=0,D[2]=0,D[3]=0,D[4]=0,D[5]=1,D[6]=0,D[7]=0,D[8]=0,D[9]=0,D[10]=1,D[11]=0,D[12]=0,D[13]=0,D[14]=0,D[15]=1,D}ie.identity=t;function r(D){return D[0]=1,D[1]=0,D[2]=0,D[3]=0,D[4]=0,D[5]=1,D[6]=0,D[7]=0,D[8]=0,D[9]=0,D[10]=1,D[11]=0,D[12]=0,D[13]=0,D[14]=0,D[15]=1,D}ie.setIdentity=r;function n(D){let F=e();for(let N=0;N<4;N++){let oe=D[N];for(let se=0;se<4;se++)F[4*se+N]=oe[se]}return F}ie.ofRows=n;let o=t();function a(D,F){return i(D,o,typeof F>"u"?1e-6:F)}ie.isIdentity=a;function i(D,F,N){for(let oe=0;oe<16;oe++)if(Math.abs(D[oe]-F[oe])>N)return!1;return!0}ie.areEqual=i;function s(D,F,N,oe){D[4*N+F]=oe}ie.setValue=s;function u(D,F,N){return D[4*N+F]}ie.getValue=u;function m(D,F,N){return F[N+0]=D[0],F[N+1]=D[1],F[N+2]=D[2],F[N+3]=D[3],F[N+4]=D[4],F[N+5]=D[5],F[N+6]=D[6],F[N+7]=D[7],F[N+8]=D[8],F[N+9]=D[9],F[N+10]=D[10],F[N+11]=D[11],F[N+12]=D[12],F[N+13]=D[13],F[N+14]=D[14],F[N+15]=D[15],F}ie.toArray=m;function c(D,F,N){return D[0]=F[N+0],D[1]=F[N+1],D[2]=F[N+2],D[3]=F[N+3],D[4]=F[N+4],D[5]=F[N+5],D[6]=F[N+6],D[7]=F[N+7],D[8]=F[N+8],D[9]=F[N+9],D[10]=F[N+10],D[11]=F[N+11],D[12]=F[N+12],D[13]=F[N+13],D[14]=F[N+14],D[15]=F[N+15],D}ie.fromArray=c;function l(D,F){return D[0]=F[0],D[1]=F[1],D[2]=F[2],D[3]=F[3],D[4]=F[4],D[5]=F[5],D[6]=F[6],D[7]=F[7],D[8]=F[8],D[9]=F[9],D[10]=F[10],D[11]=F[11],D[12]=F[12],D[13]=F[13],D[14]=F[14],D[15]=F[15],D}ie.copy=l;function d(D){return l(e(),D)}ie.clone=d;function y(D,F){let N=F[0],oe=F[1],se=F[2],ce=F[3],he=F[4],ve=F[5],Ie=F[6],Pe=F[7],me=F[8],fe=F[9],pe=F[10],Te=F[11],be=F[12],Re=F[13],Ne=F[14],Je=F[15],tt=N*ve-oe*he,Le=N*Ie-se*he,Ge=N*Pe-ce*he,Fe=oe*Ie-se*ve,U=oe*Pe-ce*ve,w=se*Pe-ce*Ie,q=me*Re-fe*be,ae=me*Ne-pe*be,Me=me*Je-Te*be,Ee=fe*Ne-pe*Re,ut=fe*Je-Te*Re,Ct=pe*Je-Te*Ne,it=tt*Ct-Le*ut+Ge*Ee+Fe*Me-U*ae+w*q;return it?(it=1/it,D[0]=(ve*Ct-Ie*ut+Pe*Ee)*it,D[1]=(se*ut-oe*Ct-ce*Ee)*it,D[2]=(Re*w-Ne*U+Je*Fe)*it,D[3]=(pe*U-fe*w-Te*Fe)*it,D[4]=(Ie*Me-he*Ct-Pe*ae)*it,D[5]=(N*Ct-se*Me+ce*ae)*it,D[6]=(Ne*Ge-be*w-Je*Le)*it,D[7]=(me*w-pe*Ge+Te*Le)*it,D[8]=(he*ut-ve*Me+Pe*q)*it,D[9]=(oe*Me-N*ut-ce*q)*it,D[10]=(be*U-Re*Ge+Je*tt)*it,D[11]=(fe*Ge-me*U-Te*tt)*it,D[12]=(ve*ae-he*Ee-Ie*q)*it,D[13]=(N*Ee-oe*ae+se*q)*it,D[14]=(Re*Le-be*Fe-Ne*tt)*it,D[15]=(me*Fe-fe*Le+pe*tt)*it,!0):!1}ie.tryInvert=y;function S(D,F){return y(D,F),D}ie.invert=S;function x(D,F,N){let oe=F[0],se=F[1],ce=F[2],he=F[3],ve=F[4],Ie=F[5],Pe=F[6],me=F[7],fe=F[8],pe=F[9],Te=F[10],be=F[11],Re=F[12],Ne=F[13],Je=F[14],tt=F[15],Le=N[0],Ge=N[1],Fe=N[2],U=N[3];return D[0]=Le*oe+Ge*ve+Fe*fe+U*Re,D[1]=Le*se+Ge*Ie+Fe*pe+U*Ne,D[2]=Le*ce+Ge*Pe+Fe*Te+U*Je,D[3]=Le*he+Ge*me+Fe*be+U*tt,Le=N[4],Ge=N[5],Fe=N[6],U=N[7],D[4]=Le*oe+Ge*ve+Fe*fe+U*Re,D[5]=Le*se+Ge*Ie+Fe*pe+U*Ne,D[6]=Le*ce+Ge*Pe+Fe*Te+U*Je,D[7]=Le*he+Ge*me+Fe*be+U*tt,Le=N[8],Ge=N[9],Fe=N[10],U=N[11],D[8]=Le*oe+Ge*ve+Fe*fe+U*Re,D[9]=Le*se+Ge*Ie+Fe*pe+U*Ne,D[10]=Le*ce+Ge*Pe+Fe*Te+U*Je,D[11]=Le*he+Ge*me+Fe*be+U*tt,Le=N[12],Ge=N[13],Fe=N[14],U=N[15],D[12]=Le*oe+Ge*ve+Fe*fe+U*Re,D[13]=Le*se+Ge*Ie+Fe*pe+U*Ne,D[14]=Le*ce+Ge*Pe+Fe*Te+U*Je,D[15]=Le*he+Ge*me+Fe*be+U*tt,D}ie.mul=x;function g(D,F,N,oe,se,ce){let he=F[0+se],ve=F[1+se],Ie=F[2+se],Pe=F[3+se],me=F[4+se],fe=F[5+se],pe=F[6+se],Te=F[7+se],be=F[8+se],Re=F[9+se],Ne=F[10+se],Je=F[11+se],tt=F[12+se],Le=F[13+se],Ge=F[14+se],Fe=F[15+se],U=N[0+ce],w=N[1+ce],q=N[2+ce],ae=N[3+ce];return D[0+oe]=U*he+w*me+q*be+ae*tt,D[1+oe]=U*ve+w*fe+q*Re+ae*Le,D[2+oe]=U*Ie+w*pe+q*Ne+ae*Ge,D[3+oe]=U*Pe+w*Te+q*Je+ae*Fe,U=N[4+ce],w=N[5+ce],q=N[6+ce],ae=N[7+ce],D[4+oe]=U*he+w*me+q*be+ae*tt,D[5+oe]=U*ve+w*fe+q*Re+ae*Le,D[6+oe]=U*Ie+w*pe+q*Ne+ae*Ge,D[7+oe]=U*Pe+w*Te+q*Je+ae*Fe,U=N[8+ce],w=N[9+ce],q=N[10+ce],ae=N[11+ce],D[8+oe]=U*he+w*me+q*be+ae*tt,D[9+oe]=U*ve+w*fe+q*Re+ae*Le,D[10+oe]=U*Ie+w*pe+q*Ne+ae*Ge,D[11+oe]=U*Pe+w*Te+q*Je+ae*Fe,U=N[12+ce],w=N[13+ce],q=N[14+ce],ae=N[15+ce],D[12+oe]=U*he+w*me+q*be+ae*tt,D[13+oe]=U*ve+w*fe+q*Re+ae*Le,D[14+oe]=U*Ie+w*pe+q*Ne+ae*Ge,D[15+oe]=U*Pe+w*Te+q*Je+ae*Fe,D}ie.mulOffset=g;function h(D,F,N,oe){return x(D,x(D,F,N),oe)}ie.mul3=h;function f(D,F){return D[0]=1,D[1]=0,D[2]=0,D[3]=0,D[4]=0,D[5]=1,D[6]=0,D[7]=0,D[8]=0,D[9]=0,D[10]=1,D[11]=0,D[12]=F[0],D[13]=F[1],D[14]=F[2],D[15]=1,D}ie.fromTranslation=f;function C(D,F){return D[12]=F[0],D[13]=F[1],D[14]=F[2],D}ie.setTranslation=C;function T(D,F,N){let oe=N[0],se=N[1],ce=N[2],he=Math.sqrt(oe*oe+se*se+ce*ce);if(Math.abs(he)<1e-6)return r(D);he=1/he,oe*=he,se*=he,ce*=he;let ve=Math.sin(F),Ie=Math.cos(F),Pe=1-Ie;return D[0]=oe*oe*Pe+Ie,D[1]=se*oe*Pe+ce*ve,D[2]=ce*oe*Pe-se*ve,D[3]=0,D[4]=oe*se*Pe-ce*ve,D[5]=se*se*Pe+Ie,D[6]=ce*se*Pe+oe*ve,D[7]=0,D[8]=oe*ce*Pe+se*ve,D[9]=se*ce*Pe-oe*ve,D[10]=ce*ce*Pe+Ie,D[11]=0,D[12]=0,D[13]=0,D[14]=0,D[15]=1,D}ie.fromRotation=T;function I(D,F,N){let oe=N[0],se=N[1],ce=N[2];return D[0]=F[0]*oe,D[1]=F[1]*oe,D[2]=F[2]*oe,D[3]=F[3]*oe,D[4]=F[4]*se,D[5]=F[5]*se,D[6]=F[6]*se,D[7]=F[7]*se,D[8]=F[8]*ce,D[9]=F[9]*ce,D[10]=F[10]*ce,D[11]=F[11]*ce,D[12]=F[12],D[13]=F[13],D[14]=F[14],D[15]=F[15],D}ie.scale=I;function P(D,F,N){return D[0]=F[0]*N,D[1]=F[1]*N,D[2]=F[2]*N,D[3]=F[3]*N,D[4]=F[4]*N,D[5]=F[5]*N,D[6]=F[6]*N,D[7]=F[7]*N,D[8]=F[8]*N,D[9]=F[9]*N,D[10]=F[10]*N,D[11]=F[11]*N,D[12]=F[12],D[13]=F[13],D[14]=F[14],D[15]=F[15],D}ie.scaleUniformly=P;function A(D,F){return D[0]=F[0],D[1]=0,D[2]=0,D[3]=0,D[4]=0,D[5]=F[1],D[6]=0,D[7]=0,D[8]=0,D[9]=0,D[10]=F[2],D[11]=0,D[12]=0,D[13]=0,D[14]=0,D[15]=1,D}ie.fromScaling=A;function b(D,F){return D[0]=F[0],D[1]=F[1],D[2]=F[2],D[4]=F[3],D[5]=F[4],D[6]=F[5],D[8]=F[6],D[9]=F[7],D[10]=F[8],D}ie.fromMat3=b;function _(D,F){return v(D,typeof F<"u"?F:1e-6)}ie.isTranslationAndUniformScaling=_;function v(D,F){let N=D[0];return Bt(D[1],0,F)&&Bt(D[2],0,F)&&Bt(D[3],0,F)&&Bt(D[4],0,F)&&Bt(D[5],N,F)&&Bt(D[6],0,F)&&Bt(D[7],0,F)&&Bt(D[8],0,F)&&Bt(D[9],0,F)&&Bt(D[10],N,F)&&Bt(D[11],0,F)&&Bt(D[15],1,F)}function R(D,F,N,oe){let se=F[0],ce=F[1],he=F[2],ve=oe[0],Ie=oe[1],Pe=oe[2],me=se-N[0],fe=ce-N[1],pe=he-N[2],Te=me*me+fe*fe+pe*pe;Te>0&&(Te=1/Math.sqrt(Te),me*=Te,fe*=Te,pe*=Te);let be=Ie*pe-Pe*fe,Re=Pe*me-ve*pe,Ne=ve*fe-Ie*me;return Te=be*be+Re*Re+Ne*Ne,Te>0&&(Te=1/Math.sqrt(Te),be*=Te,Re*=Te,Ne*=Te),D[0]=be,D[1]=Re,D[2]=Ne,D[3]=0,D[4]=fe*Ne-pe*Re,D[5]=pe*be-me*Ne,D[6]=me*Re-fe*be,D[7]=0,D[8]=me,D[9]=fe,D[10]=pe,D[11]=0,D[12]=se,D[13]=ce,D[14]=he,D[15]=1,D}ie.targetTo=R;function E(D){let F=D[0]*D[0]+D[1]*D[1]+D[2]*D[2],N=D[4]*D[4]+D[5]*D[5]+D[6]*D[6],oe=D[8]*D[8]+D[9]*D[9]+D[10]*D[10];return Math.sqrt(Math.max(F,N,oe))}ie.getMaxScaleOnAxis=E;let B=[1,0,0],L=[0,1,0],G=[0,0,1];ie.rotX90=T(e(),Io(90),B),ie.rotX180=T(e(),Io(180),B),ie.rotY90=T(e(),Io(90),L),ie.rotZ90=T(e(),Io(90),G),ie.rotZY90=x(e(),ie.rotZ90,ie.rotY90),ie.rotZYZ90=x(e(),ie.rotZY90,ie.rotZ90),ie.rotZ90X180=x(e(),ie.rotZ90,ie.rotX180),ie.id=t()})(re||(re={}));function gt(){return gt.zero()}(A=>{function e(){let b=[.1,0,0,0,0,0,0,0,0];return b[0]=0,b}A.zero=e;function t(){let b=e();return b[0]=1,b[1]=0,b[2]=0,b[3]=0,b[4]=1,b[5]=0,b[6]=0,b[7]=0,b[8]=1,b}A.identity=t;function r(b){return b[0]=1,b[1]=0,b[2]=0,b[3]=0,b[4]=1,b[5]=0,b[6]=0,b[7]=0,b[8]=1,b}A.setIdentity=r;function n(b,_,v){return _[v+0]=b[0],_[v+1]=b[1],_[v+2]=b[2],_[v+3]=b[3],_[v+4]=b[4],_[v+5]=b[5],_[v+6]=b[6],_[v+7]=b[7],_[v+8]=b[8],_}A.toArray=n;function o(b,_,v){return b[0]=_[v+0],b[1]=_[v+1],b[2]=_[v+2],b[3]=_[v+3],b[4]=_[v+4],b[5]=_[v+5],b[6]=_[v+6],b[7]=_[v+7],b[8]=_[v+8],b}A.fromArray=o;function a(b,_){return b[0]=_[0],b[1]=_[1],b[2]=_[2],b[3]=_[4],b[4]=_[5],b[5]=_[6],b[6]=_[8],b[7]=_[9],b[8]=_[10],b}A.fromMat4=a;function i(b,_,v,R,E,B,L,G,K){let X=e();return X[0]=b,X[1]=_,X[2]=v,X[3]=R,X[4]=E,X[5]=B,X[6]=L,X[7]=G,X[8]=K,X}A.create=i;let s=t();function u(b,_){return c(b,s,typeof _>"u"?1e-6:_)}A.isIdentity=u;function m(b){return y(e(),b)}A.clone=m;function c(b,_,v){for(let R=0;R<9;R++)if(Math.abs(b[R]-_[R])>v)return!1;return!0}A.areEqual=c;function l(b,_,v,R){b[3*v+_]=R}A.setValue=l;function d(b,_,v){return b[3*v+_]}A.getValue=d;function y(b,_){return b[0]=_[0],b[1]=_[1],b[2]=_[2],b[3]=_[3],b[4]=_[4],b[5]=_[5],b[6]=_[6],b[7]=_[7],b[8]=_[8],b}A.copy=y;function S(b,_){if(b===_){let v=_[1],R=_[2],E=_[5];b[1]=_[3],b[2]=_[6],b[3]=v,b[5]=_[7],b[6]=R,b[7]=E}else b[0]=_[0],b[1]=_[3],b[2]=_[6],b[3]=_[1],b[4]=_[4],b[5]=_[7],b[6]=_[2],b[7]=_[5],b[8]=_[8];return b}A.transpose=S;function x(b,_){let v=_[0],R=_[1],E=_[2],B=_[3],L=_[4],G=_[5],K=_[6],X=_[7],j=_[8],$=j*L-G*X,Z=-j*B+G*K,te=X*B-L*K,W=v*$+R*Z+E*te;return W&&(W=1/W,b[0]=$*W,b[1]=(-j*R+E*X)*W,b[2]=(G*R-E*L)*W,b[3]=Z*W,b[4]=(j*v-E*K)*W,b[5]=(-G*v+E*B)*W,b[6]=te*W,b[7]=(-X*v+R*K)*W,b[8]=(L*v-R*B)*W),b}A.invert=x;function g(b){let _=b[0],v=b[1],R=b[2],E=b[3],B=b[4],L=b[5],G=b[6],K=b[7],X=b[8],j=X*B-L*K,$=-X*E+L*G,Z=K*E-B*G;return _*j+v*$+R*Z}A.determinant=g;function h(b){return b[0]+b[4]+b[8]}A.trace=h;function f(b,_,v){return b[0]=_[0]-v[0],b[1]=_[1]-v[1],b[2]=_[2]-v[2],b[3]=_[3]-v[3],b[4]=_[4]-v[4],b[5]=_[5]-v[5],b[6]=_[6]-v[6],b[7]=_[7]-v[7],b[8]=_[8]-v[8],b}A.sub=f;function C(b,_,v){return b[0]=_[0]+v[0],b[1]=_[1]+v[1],b[2]=_[2]+v[2],b[3]=_[3]+v[3],b[4]=_[4]+v[4],b[5]=_[5]+v[5],b[6]=_[6]+v[6],b[7]=_[7]+v[7],b[8]=_[8]+v[8],b}A.add=C;function T(b,_,v){let R=_[0],E=_[1],B=_[2],L=_[3],G=_[4],K=_[5],X=_[6],j=_[7],$=_[8],Z=v[0],te=v[1],W=v[2],Y=v[3],ie=v[4],D=v[5],F=v[6],N=v[7],oe=v[8];return b[0]=Z*R+te*L+W*X,b[1]=Z*E+te*G+W*j,b[2]=Z*B+te*K+W*$,b[3]=Y*R+ie*L+D*X,b[4]=Y*E+ie*G+D*j,b[5]=Y*B+ie*K+D*$,b[6]=F*R+N*L+oe*X,b[7]=F*E+N*G+oe*j,b[8]=F*B+N*K+oe*$,b}A.mul=T;function I(b,_){return a(b,_),x(b,b),S(b,b),b}A.directionTransform=I,A.Identity=t()})(gt||(gt={}));function wt(){return wt.zero()}(n=>{function e(){let o=[.1,0];return o[0]=0,o}n.zero=e;function t(o,a){let i=e();return i[0]=o,i[1]=a,i}n.create=t;function r(o,a,i){return o[0]=a,o[1]=i,o}n.set=r})(wt||(wt={}));function p(){return p.zero()}(Fe=>{function e(){let U=[.1,0,0];return U[0]=0,U}Fe.zero=e;function t(U){let w=e();return w[0]=U[0],w[1]=U[1],w[2]=U[2],w}Fe.clone=t;function r(U){return U[0]=NaN,U[1]=NaN,U[2]=NaN,U}Fe.setNaN=r;function n(U,w,q){return U[0]=w[q+0],U[1]=w[q+1],U[2]=w[q+2],U}Fe.fromArray=n;function o(U,w,q){return w[q+0]=U[0],w[q+1]=U[1],w[q+2]=U[2],w}Fe.toArray=o;function a(U,w,q){let ae=e();return ae[0]=U,ae[1]=w,ae[2]=q,ae}Fe.create=a;function i(U){let w=e();return w[0]=U[0],w[1]=U[1],w[2]=U[2],w}Fe.ofArray=i;function s(U,w,q,ae){return U[0]=w,U[1]=q,U[2]=ae,U}Fe.set=s;function u(U,w){return U[0]=w[0],U[1]=w[1],U[2]=w[2],U}Fe.copy=u;function m(U,w,q){return U[0]=w[0]+q[0],U[1]=w[1]+q[1],U[2]=w[2]+q[2],U}Fe.add=m;function c(U,w,q){return U[0]=w[0]-q[0],U[1]=w[1]-q[1],U[2]=w[2]-q[2],U}Fe.sub=c;function l(U,w,q){return U[0]=w[0]*q[0],U[1]=w[1]*q[1],U[2]=w[2]*q[2],U}Fe.mul=l;function d(U,w,q){return U[0]=w[0]/q[0],U[1]=w[1]/q[1],U[2]=w[2]/q[2],U}Fe.div=d;function y(U,w,q){return U[0]=w[0]*q,U[1]=w[1]*q,U[2]=w[2]*q,U}Fe.scale=y;function S(U,w,q,ae){return U[0]=w[0]+q[0]*ae,U[1]=w[1]+q[1]*ae,U[2]=w[2]+q[2]*ae,U}Fe.scaleAndAdd=S;function x(U,w,q,ae){return U[0]=w[0]-q[0]*ae,U[1]=w[1]-q[1]*ae,U[2]=w[2]-q[2]*ae,U}Fe.scaleAndSub=x;function g(U,w){return U[0]=Math.round(w[0]),U[1]=Math.round(w[1]),U[2]=Math.round(w[2]),U}Fe.round=g;function h(U,w){return U[0]=Math.ceil(w[0]),U[1]=Math.ceil(w[1]),U[2]=Math.ceil(w[2]),U}Fe.ceil=h;function f(U,w){return U[0]=Math.floor(w[0]),U[1]=Math.floor(w[1]),U[2]=Math.floor(w[2]),U}Fe.floor=f;function C(U,w){return U[0]=Math.abs(w[0]),U[1]=Math.abs(w[1]),U[2]=Math.abs(w[2]),U}Fe.abs=C;function T(U,w,q){return U[0]=Math.min(w[0],q[0]),U[1]=Math.min(w[1],q[1]),U[2]=Math.min(w[2],q[2]),U}Fe.min=T;function I(U,w,q){return U[0]=Math.max(w[0],q[0]),U[1]=Math.max(w[1],q[1]),U[2]=Math.max(w[2],q[2]),U}Fe.max=I;function P(U,w){let q=w[0]-U[0],ae=w[1]-U[1],Me=w[2]-U[2];return Math.sqrt(q*q+ae*ae+Me*Me)}Fe.distance=P;function A(U,w){let q=w[0]-U[0],ae=w[1]-U[1],Me=w[2]-U[2];return q*q+ae*ae+Me*Me}Fe.squaredDistance=A;function b(U){let w=U[0],q=U[1],ae=U[2];return Math.sqrt(w*w+q*q+ae*ae)}Fe.magnitude=b;function _(U){let w=U[0],q=U[1],ae=U[2];return w*w+q*q+ae*ae}Fe.squaredMagnitude=_;function v(U,w,q){return y(U,B(U,w),q)}Fe.setMagnitude=v;function R(U,w){return U[0]=-w[0],U[1]=-w[1],U[2]=-w[2],U}Fe.negate=R;function E(U,w){return U[0]=1/w[0],U[1]=1/w[1],U[2]=1/w[2],U}Fe.inverse=E;function B(U,w){let q=w[0],ae=w[1],Me=w[2],Ee=q*q+ae*ae+Me*Me;return Ee>0&&(Ee=1/Math.sqrt(Ee),U[0]=w[0]*Ee,U[1]=w[1]*Ee,U[2]=w[2]*Ee),U}Fe.normalize=B;function L(U,w){return U[0]*w[0]+U[1]*w[1]+U[2]*w[2]}Fe.dot=L;function G(U,w,q){let ae=w[0],Me=w[1],Ee=w[2],ut=q[0],Ct=q[1],it=q[2];return U[0]=Me*it-Ee*Ct,U[1]=Ee*ut-ae*it,U[2]=ae*Ct-Me*ut,U}Fe.cross=G;function K(U,w,q,ae){let Me=w[0],Ee=w[1],ut=w[2];return U[0]=Me+ae*(q[0]-Me),U[1]=Ee+ae*(q[1]-Ee),U[2]=ut+ae*(q[2]-ut),U}Fe.lerp=K;let X=e();function j(U,w,q,ae){let Me=Br(L(w,q),-1,1),Ee=Math.acos(Me)*ae;return S(X,q,w,-Me),B(X,X),m(U,y(U,w,Math.cos(Ee)),y(X,X,Math.sin(Ee)))}Fe.slerp=j;function $(U,w,q,ae,Me,Ee,ut){return U[0]=pa(w[0],q[0],ae[0],Me[0],Ee,ut),U[1]=pa(w[1],q[1],ae[1],Me[1],Ee,ut),U[2]=pa(w[2],q[2],ae[2],Me[2],Ee,ut),U}Fe.spline=$;function Z(U,w,q){let ae=w[0],Me=w[1],Ee=w[2],ut=1/(q[3]*ae+q[7]*Me+q[11]*Ee+q[15]||1);return U[0]=(q[0]*ae+q[4]*Me+q[8]*Ee+q[12])*ut,U[1]=(q[1]*ae+q[5]*Me+q[9]*Ee+q[13])*ut,U[2]=(q[2]*ae+q[6]*Me+q[10]*Ee+q[14])*ut,U}Fe.transformMat4=Z;function te(U,w,q,ae,Me,Ee){let ut=w[0+Me],Ct=w[1+Me],it=w[2+Me],ii=1/(q[3+Ee]*ut+q[7+Ee]*Ct+q[11+Ee]*it+q[15+Ee]||1);return U[0+ae]=(q[0+Ee]*ut+q[4+Ee]*Ct+q[8+Ee]*it+q[12+Ee])*ii,U[1+ae]=(q[1+Ee]*ut+q[5+Ee]*Ct+q[9+Ee]*it+q[13+Ee])*ii,U[2+ae]=(q[2+Ee]*ut+q[6+Ee]*Ct+q[10+Ee]*it+q[14+Ee])*ii,U}Fe.transformMat4Offset=te;function W(U,w,q){let ae=w[0],Me=w[1],Ee=w[2];return U[0]=ae*q[0]+Me*q[3]+Ee*q[6],U[1]=ae*q[1]+Me*q[4]+Ee*q[7],U[2]=ae*q[2]+Me*q[5]+Ee*q[8],U}Fe.transformMat3=W;function Y(U,w){let q=Math.sqrt(_(U)*_(w));if(q===0)return Math.PI/2;let ae=L(U,w)/q;return Math.acos(Br(ae,-1,1))}Fe.angle=Y;let ie=e(),D=e(),F=e(),N=e(),oe=e(),se=e(),ce=e();function he(U,w,q,ae){c(ie,U,w),c(D,q,w),c(F,w,q),c(N,ae,q),G(oe,ie,D),G(se,F,N);let Me=Y(oe,se);return G(ce,oe,se),L(D,ce)>0?Me:-Me}Fe.dihedralAngle=he;function ve(U,w){let q=U[0],ae=U[1],Me=U[2],Ee=w[0],ut=w[1],Ct=w[2];return Math.abs(q-Ee)<=1e-6*Math.max(1,Math.abs(q),Math.abs(Ee))&&Math.abs(ae-ut)<=1e-6*Math.max(1,Math.abs(ae),Math.abs(ut))&&Math.abs(Me-Ct)<=1e-6*Math.max(1,Math.abs(Me),Math.abs(Ct))}Fe.equals=ve;let Ie=e();function Pe(U,w,q){let ae=Y(w,q);if(Math.abs(ae)<1e-4)return re.setIdentity(U);if(Math.abs(ae-Math.PI)<1e-6)return re.fromScaling(U,Fe.negUnit);let Me=G(Ie,w,q);return re.fromRotation(U,ae,Me)}Fe.makeRotation=Pe;function me(U){return U[0]===0&&U[1]===0&&U[2]===0}Fe.isZero=me;function fe(U,w,q,ae){c(U,w,ae);let Me=L(q,U)/_(q);return m(U,y(U,q,Me),ae)}Fe.projectPointOnVector=fe;function pe(U,w,q){return B(U,G(U,G(U,w,q),w))}Fe.orthogonalize=pe;function Te(U,w,q){return L(w,q)>0?u(U,w):R(U,u(U,w)),U}Fe.matchDirection=Te;let be=e(),Re=e();function Ne(U,w,q,ae){return c(be,q,w),c(Re,ae,w),B(U,G(U,be,Re))}Fe.triangleNormal=Ne,Fe.origin=a(0,0,0),Fe.unit=a(1,1,1),Fe.negUnit=a(-1,-1,-1),Fe.unitX=a(1,0,0)})(p||(p={}));function fn(){return fn.zero()}(o=>{function e(){let a=[.1,0,0,0];return a[0]=0,a}o.zero=e;function t(a,i,s,u){let m=e();return m[0]=a,m[1]=i,m[2]=s,m[3]=u,m}o.create=t;function r(a,i){return a[0]=i.center[0],a[1]=i.center[1],a[2]=i.center[2],a[3]=i.radius,a}function n(a){return r(e(),a)}o.ofSphere=n})(fn||(fn={}));function Li(){return Li.zero()}(m=>{function e(){let c=[.1,0,0,0];return c[0]=0,c}m.zero=e;function t(){let c=e();return c[3]=1,c}m.identity=t;function r(c,l,d,y){let S=t();return S[0]=c,S[1]=l,S[2]=d,S[3]=y,S}m.create=r;function n(c,l,d){d=d*.5;let y=Math.sin(d);return c[0]=y*l[0],c[1]=y*l[1],c[2]=y*l[2],c[3]=Math.cos(d),c}m.setAxisAngle=n;function o(c){let l=e();return l[0]=c[0],l[1]=c[1],l[2]=c[2],l[3]=c[3],l}m.clone=o;function a(c,l,d){return l[d+0]=c[0],l[d+1]=c[1],l[d+2]=c[2],l[d+3]=c[3],l}m.toArray=a;function i(c,l,d,y,S){return c[0]=l,c[1]=d,c[2]=y,c[3]=S,c}m.set=i;function s(c,l,d){return c[0]=l[0]+d[0],c[1]=l[1]+d[1],c[2]=l[2]+d[2],c[3]=l[3]+d[3],c}m.add=s,m.Identity=t()})(Li||(Li={}));var Nt;(S=>{function e(x,g,h){let f=[];for(let T=0;T<g.length;T++)f[T]=g[g.length-T-1];let C=[1];for(let T=1;T<x.length;T++)C[T]=x[f[T-1]];return{dimensions:x,axisOrderFastToSlow:f,axisOrderSlowToFast:g,accessDimensions:C,defaultCtor:h||Float64Array}}function t(x,g){return{space:x,data:g}}S.create=t;function r(x,g,h){let f=e(x,g,h),{get:C,set:T,add:I,dataOffset:P,getCoords:A}=c(f);return{rank:x.length,dimensions:x,axisOrderSlowToFast:g,create:l(f),get:C,set:T,add:I,dataOffset:P,getCoords:A}}S.Space=r;function n(x){return x}S.Data1=n;function o(x,g){return r([x],[0],g)}S.Vector=o;function a(x,g,h){return r([x,g],[1,0],h)}S.ColumnMajorMatrix=a;function i(x,g,h){let f=Math.min(4,g.dimensions[0]),C=Math.min(4,g.dimensions[1]);for(let T=0;T<f;T++)for(let I=0;I<C;I++)re.setValue(x,T,I,g.get(h,T,I));return x}S.toMat4=i;function s(x,g,h){let f=Math.min(3,g.dimensions[0]),C=Math.min(3,g.dimensions[1]);for(let T=0;T<f;T++)for(let I=0;I<C;I++)gt.setValue(x,T,I,g.get(h,T,I));return x}S.toMat3=s;function u(x,g,h){let f=Math.min(3,g.dimensions[0]);for(let C=0;C<f;C++)x[C]=h[C];return x}S.toVec3=u;function m(x,g){let h=x.length;if(h!==g.length)return!1;for(let f=0;f<h;f++)if(x[f]!==g[f])return!1;return!0}S.areEqualExact=m;function c(x){let{dimensions:g,axisOrderFastToSlow:h}=x;switch(g.length){case 1:return{get:(f,C)=>f[C],set:(f,C,T)=>f[C]=T,add:(f,C,T)=>f[C]+=T,dataOffset:f=>f,getCoords:(f,C)=>(C[0]=f,C)};case 2:{if(h[0]===0&&h[1]===1){let f=g[0];return{get:(C,T,I)=>C[I*f+T],set:(C,T,I,P)=>C[I*f+T]=P,add:(C,T,I,P)=>C[I*f+T]+=P,dataOffset:(C,T)=>T*f+C,getCoords:(C,T)=>(T[0]=C%f,T[1]=Math.floor(C/f),T)}}if(h[0]===1&&h[1]===0){let f=g[1];return{get:(C,T,I)=>C[T*f+I],set:(C,T,I,P)=>C[T*f+I]=P,add:(C,T,I,P)=>C[T*f+I]+=P,dataOffset:(C,T)=>C*f+T,getCoords:(C,T)=>(T[0]=Math.floor(C/f),T[1]=C%f,T)}}throw new Error("bad axis order")}case 3:{if(h[0]===0&&h[1]===1&&h[2]===2){let f=g[0],C=g[1],T=f*C;return{get:(I,P,A,b)=>I[P+A*f+b*T],set:(I,P,A,b,_)=>I[P+A*f+b*T]=_,add:(I,P,A,b,_)=>I[P+A*f+b*T]+=_,dataOffset:(I,P,A)=>I+P*f+A*T,getCoords:(I,P)=>{let A=Math.floor(I/f);return P[0]=I%f,P[1]=A%C,P[2]=Math.floor(A/C),P}}}if(h[0]===0&&h[1]===2&&h[2]===1){let f=g[0],C=g[2],T=f*C;return{get:(I,P,A,b)=>I[P+b*f+A*T],set:(I,P,A,b,_)=>I[P+b*f+A*T]=_,add:(I,P,A,b,_)=>I[P+b*f+A*T]+=_,dataOffset:(I,P,A)=>I+A*f+P*T,getCoords:(I,P)=>{let A=Math.floor(I/f);return P[0]=I%f,P[1]=Math.floor(A/C),P[2]=A%C,P}}}if(h[0]===1&&h[1]===0&&h[2]===2){let f=g[1],C=g[0],T=f*C;return{get:(I,P,A,b)=>I[A+P*f+b*T],set:(I,P,A,b,_)=>I[A+P*f+b*T]=_,add:(I,P,A,b,_)=>I[A+P*f+b*T]+=_,dataOffset:(I,P,A)=>P+I*f+A*T,getCoords:(I,P)=>{let A=Math.floor(I/f);return P[0]=A%C,P[1]=I%f,P[2]=Math.floor(A/C),P}}}if(h[0]===1&&h[1]===2&&h[2]===0){let f=g[1],C=g[2],T=f*C;return{get:(I,P,A,b)=>I[A+b*f+P*T],set:(I,P,A,b,_)=>I[A+b*f+P*T]=_,add:(I,P,A,b,_)=>I[A+b*f+P*T]+=_,dataOffset:(I,P,A)=>P+A*f+I*T,getCoords:(I,P)=>{let A=Math.floor(I/f);return P[0]=Math.floor(A/C),P[1]=I%f,P[2]=A%C,P}}}if(h[0]===2&&h[1]===0&&h[2]===1){let f=g[2],C=g[0],T=f*C;return{get:(I,P,A,b)=>I[b+P*f+A*T],set:(I,P,A,b,_)=>I[b+P*f+A*T]=_,add:(I,P,A,b,_)=>I[b+P*f+A*T]+=_,dataOffset:(I,P,A)=>A+I*f+P*T,getCoords:(I,P)=>{let A=Math.floor(I/f);return P[0]=A%C,P[1]=Math.floor(A/C),P[2]=I%f,P}}}if(h[0]===2&&h[1]===1&&h[2]===0){let f=g[2],C=g[1],T=f*C;return{get:(I,P,A,b)=>I[b+A*f+P*T],set:(I,P,A,b,_)=>I[b+A*f+P*T]=_,add:(I,P,A,b,_)=>I[b+A*f+P*T]+=_,dataOffset:(I,P,A)=>A+P*f+I*T,getCoords:(I,P)=>{let A=Math.floor(I/f);return P[0]=Math.floor(A/C),P[1]=A%C,P[2]=I%f,P}}}throw new Error("bad axis order")}default:return{get:(f,...C)=>f[d(x,C)],set:(f,...C)=>f[d(x,C)]=C[C.length-1],add:(f,...C)=>f[d(x,C)]+=C[C.length-1],dataOffset:(...f)=>d(x,f),getCoords:(f,C)=>y(x,f,C)}}}function l(x){let{dimensions:g}=x,h=1;for(let f=0,C=g.length;f<C;f++)h*=g[f];return f=>new(f||x.defaultCtor)(h)}function d(x,g){let{accessDimensions:h,axisOrderFastToSlow:f}=x,C=h.length-1,T=h[C]*g[f[C]];for(let I=C-1;I>=0;I--)T=(T+g[f[I]])*h[I];return T}function y(x,g,h){let{dimensions:f,axisOrderFastToSlow:C}=x,T=f.length,I=g;for(let P=0;P<T;P++){let A=f[C[P]];h[C[P]]=I%A,I=Math.floor(I/A)}return h[C[T+1]]=I,h}})(Nt||(Nt={}));var ne;(T=>{let e;($=>{$.str={"@type":"str",T:"",valueType:"str"},$.ustr={"@type":"str",T:"",valueType:"str",transform:"uppercase"},$.lstr={"@type":"str",T:"",valueType:"str",transform:"lowercase"},$.int={"@type":"int",T:0,valueType:"int"},$.coord={"@type":"coord",T:0,valueType:"float"},$.float={"@type":"float",T:0,valueType:"float"};function R(Z){var te;return{"@type":"str",T:(te=Z==null?void 0:Z.defaultValue)!=null?te:"",transform:Z==null?void 0:Z.transform,valueType:"str"}}$.Str=R;function E(Z=0){return{"@type":"int",T:Z,valueType:"int"}}$.Int=E;function B(Z=0){return{"@type":"float",T:Z,valueType:"float"}}$.Float=B;function L(Z,te=$.float){return{"@type":"tensor",T:Z.create(),space:Z,valueType:"tensor",baseType:te}}$.Tensor=L;function G(Z,te=$.float){return L(Nt.Vector(Z,te["@type"]==="int"?Int32Array:Float64Array),te)}$.Vector=G;function K(Z,te,W=$.float){return L(Nt.ColumnMajorMatrix(Z,te,W["@type"]==="int"?Int32Array:Float64Array),W)}$.Matrix=K;function X(Z){return Z}$.Aliased=X;function j(Z,te,W=[]){return{"@type":"list",T:W,separator:Z,itemParse:te,valueType:"list"}}$.List=j})(e=T.Schema||(T.Schema={}));function t(I){return!!I&&!!I.schema&&!!I.value}T.is=t;let r;(b=>(b[b.Present=0]="Present",b[b.NotPresent=1]="NotPresent",b[b.Unknown=2]="Unknown"))(r=T.ValueKind||(T.ValueKind={}));function n(I,P){return Fl(P.T,I,P,1)}T.Undefined=n;function o(I,P,A){return Fl(I,P,A,0)}T.ofConst=o;function a(I){return G0(I)}T.ofLambda=a;function i(I,P){return a({value:A=>A+I,rowCount:Math.max(P-I+1,0),schema:e.int})}T.range=i;function s(I){return ai(I)}T.ofArray=s;function u(I){return ai({array:I,schema:e.int})}T.ofIntArray=u;function m(I){return ai({array:I,schema:e.str})}T.ofStringArray=m;function c(I,P,A){return w0(I,P,A)}T.window=c;function l(I,P,A=!0){return q0(I,P,A)}T.view=l;function d(I){return V0(I)}T.createFirstIndexMap=d;function y(I){return k0(I)}T.createIndexer=y;function S(I,P,A){return j0(I,P,A||Array)}T.mapToArray=S;function x(I,P){return Q0(I,P)}T.areEqual=x;function g(I,P){return Z0(I,P)}T.indicesOf=g;function h(I,P){return I.__array?I:I.isDefined?ai({array:I.toArray({array:P}),schema:I.schema,valueKind:I.valueKind}):n(I.rowCount,I.schema)}T.asArrayColumn=h;function f(I,P,A=0){if(!I.isDefined)return;let b=I.__array;if(b)for(let _=0,v=b.length;_<v;_++)P[A+_]=b[_];else for(let _=0,v=I.rowCount;_<v;_++)P[A+_]=I.value(_)}T.copyToArray=f;function C(I){for(let P=0,A=I.rowCount;P<A;P++)if(P!==I.value(P))return!1;return!0}T.isIdentity=C})(ne||(ne={}));function V0(e){let t=new Map;for(let r=0,n=e.rowCount;r<n;r++){let o=e.value(r);t.has(o)||t.set(e.value(r),r)}return t}function k0(e){let t=new Map;for(let r=0,n=e.rowCount;r<n;r++){let o=e.value(r);t.has(o)||t.set(e.value(r),r)}return r=>t.has(r)?t.get(r):-1}function Fl(e,t,r,n){return{schema:r,__array:void 0,isDefined:n===0,rowCount:t,value:a=>e,valueKind:a=>n,toArray:a=>{let{array:i}=To(t,a);for(let s=0,u=i.length;s<u;s++)i[s]=e;return i},areValuesEqual:(a,i)=>!0}}function G0({value:e,valueKind:t,areValuesEqual:r,rowCount:n,schema:o}){return{schema:o,__array:void 0,isDefined:!0,rowCount:n,value:e,valueKind:t||(a=>0),toArray:a=>{let{array:i,start:s}=To(n,a);for(let u=0,m=i.length;u<m;u++)i[u]=e(u+s);return i},areValuesEqual:r||((a,i)=>e(a)===e(i))}}function ai({array:e,schema:t,valueKind:r}){let n=e.length,o=t.T,a=t.valueType==="str"?t.transform==="lowercase"?s=>{let u=e[s];return typeof u=="string"?u.toLowerCase():`${u!=null?u:o}`.toLowerCase()}:t.transform==="uppercase"?s=>{let u=e[s];return typeof u=="string"?u.toUpperCase():`${u!=null?u:o}`.toUpperCase()}:s=>{let u=e[s];return typeof u=="string"?u:`${u!=null?u:o}`}:s=>e[s],i=Sa(e);return{schema:t,__array:e,isDefined:!0,rowCount:n,value:a,valueKind:r||(s=>0),toArray:t.valueType==="str"?t.transform==="lowercase"?s=>{let{start:u,end:m}=Kn(n,s),c=new(s&&typeof s.array<"u"?s.array:e.constructor)(m-u);for(let l=0,d=m-u;l<d;l++){let y=e[u+l];c[l]=typeof y=="string"?y.toLowerCase():`${y!=null?y:o}`.toLowerCase()}return c}:t.transform==="uppercase"?s=>{let{start:u,end:m}=Kn(n,s),c=new(s&&typeof s.array<"u"?s.array:e.constructor)(m-u);for(let l=0,d=m-u;l<d;l++){let y=e[u+l];c[l]=typeof y=="string"?y.toUpperCase():`${y!=null?y:o}`.toUpperCase()}return c}:s=>{let{start:u,end:m}=Kn(n,s),c=new(s&&typeof s.array<"u"?s.array:e.constructor)(m-u);for(let l=0,d=m-u;l<d;l++){let y=e[u+l];c[l]=typeof y=="string"?y:`${y!=null?y:o}`}return c}:i?s=>Ca(e,s):s=>{let{start:u,end:m}=Kn(n,s);if(u===0&&m===e.length)return e;let c=new(s&&typeof s.array<"u"?s.array:e.constructor)(m-u);for(let l=0,d=m-u;l<d;l++)c[l]=e[u+l];return c},areValuesEqual:(s,u)=>e[s]===e[u]}}function w0(e,t,r){return e.isDefined?t===0&&r===e.rowCount?e:e.__array&&Sa(e.__array)?N0(e,t,r):O0(e,t,r):ne.Undefined(r-t,e.schema)}function N0(e,t,r){let n=Ca(e.__array,{start:t,end:r}),o=e.valueKind;return ai({array:n,schema:e.schema,valueKind:a=>o(t+a)})}function O0(e,t,r){let n=e.value,o=e.valueKind,a=e.areValuesEqual,i=t===0?n:u=>n(u+t),s=r-t;return{schema:e.schema,__array:void 0,isDefined:e.isDefined,rowCount:s,value:i,valueKind:t===0?o:u=>o(u+t),toArray:u=>{let{array:m}=To(s,u);for(let c=0,l=m.length;c<l;c++)m[c]=n(c+t);return m},areValuesEqual:t===0?a:(u,m)=>a(u+t,m+t)}}function H0(e,t){if(e.length!==t)return!1;for(let r=0,n=e.length;r<n;r++)if(e[r]!==r)return!1;return!0}function q0(e,t,r){return e.rowCount===0||r&&H0(t,e.rowCount)?e:e.__array&&typeof e.value(0)==typeof e.__array[0]?z0(e,t):K0(e,t)}function z0(e,t){let r=e.__array,n=new r.constructor(t.length);for(let a=0,i=t.length;a<i;a++)n[a]=r[t[a]];let o=e.valueKind;return ai({array:n,schema:e.schema,valueKind:a=>o(t[a])})}function K0(e,t){let r=e.value,n=e.valueKind,o=e.areValuesEqual,a=s=>r(t[s]),i=t.length;return{schema:e.schema,__array:void 0,isDefined:e.isDefined,rowCount:i,value:a,valueKind:s=>n(t[s]),toArray:s=>{let{array:u}=To(i,s);for(let m=0,c=u.length;m<c;m++)u[m]=r(t[m]);return u},areValuesEqual:(s,u)=>o(t[s],t[u])}}function j0(e,t,r){let n=new r(e.rowCount);for(let o=0,a=e.rowCount;o<a;o++)n[o]=t(e.value(o));return n}function Q0(e,t){return e===t?!0:e.rowCount!==t.rowCount||e.isDefined!==t.isDefined||e.schema.valueType!==t.schema.valueType?!1:e.__array&&t.__array?Y0(e,t):X0(e,t)}function Y0(e,t){let r=e.__array,n=t.__array;for(let o=0,a=e.rowCount;o<a;o++)if(r[o]!==n[o])return!1;return!0}function X0(e,t){let r=e.value,n=t.value;for(let o=0,a=e.rowCount;o<a;o++)if(r(o)!==n(o))return!1;return!0}function Z0(e,t){let r=[],n=e.value;for(let o=0,a=e.rowCount;o<a;o++)t(n(o))&&(r[r.length]=o);return r}var $e;(y=>{function e(S){return S&&typeof S._rowCount=="number"&&!!S._columns&&!!S._schema}y.is=e;function t(S,x){let g=Object.keys(x);return{_rowCount:x[g[0]].rowCount,_columns:g,_schema:S,...x}}y.ofColumns=t;function r(S,x,g){let h=Object.create(null),f=Object.keys(S);h._rowCount=g,h._columns=f,h._schema=S;for(let C of f)C in x?h[C]=x[C]:h[C]=ne.Undefined(g,S[C]);return h}y.ofPartialColumns=r;function n(S,x){let g=Object.create(null),h=Object.keys(S);g._rowCount=x,g._columns=h,g._schema=S;for(let f of h)g[f]=ne.Undefined(x,S[f]);return g}y.ofUndefinedColumns=n;function o(S,x){let g=Object.create(null),h=x.length,f=Object.keys(S);g._rowCount=h,g._columns=f,g._schema=S;for(let C of f)g[C]=ne.ofLambda({rowCount:h,schema:S[C],value:T=>x[T][C],valueKind:T=>typeof x[T][C]>"u"?ne.ValueKind.NotPresent:ne.ValueKind.Present});return g}y.ofRows=o;function a(S,x,g){let h=Object.create(null),f=Object.keys(x);h._rowCount=g.length,h._columns=f,h._schema=x;for(let C of f)h[C]=ne.view(S[C],g);return h}y.view=a;function i(S,x,g){let h=[];for(let f=0,C=S._rowCount;f<C;++f)g(f)&&h.push(f);return a(S,x,h)}y.pick=i;function s(S,x,g,h){if(g===0&&h===S._rowCount)return S;let f=Object.create(null),C=Object.keys(x);f._rowCount=h-g,f._columns=C,f._schema=x;for(let T of C)f[T]=ne.window(S[T],g,h);return f}y.window=s;function u(S,x,g){S[x]=ne.asArrayColumn(S[x],g)}y.columnToArray=u;function m(S,x){if(S._rowCount!==x._rowCount||S._columns.length!==x._columns.length)return!1;for(let g of S._columns)if(!x[g])return!1;for(let g of S._columns)if(!ne.areEqual(S[g],x[g]))return!1;return!0}y.areEqual=m;function c(S,x){let g=Object.create(null),{_columns:h}=S;for(let f=0;f<h.length;f++){let C=h[f];g[C]=S[C].value(x)}return g}y.getRow=c;function l(S,x){for(let g=0,h=S._rowCount;g<h;++g)if(x(g))return c(S,g)}y.pickRow=l;function d(S){let x=[],{_rowCount:g}=S;for(let h=0;h<g;h++)x[h]=c(S,h);return x}y.getRows=d})($e||($e={}));var Vi;(t=>{function e(r,n,o){let a=Object.keys(o),i=Object.create(null),s=[];i._name=r,i._tableNames=s,i._schema=n;for(let u of a)$e.is(o[u])&&(i[u]=o[u],s[s.length]=u);return i}t.ofTables=e})(Vi||(Vi={}));function Ul(e,t){for(let r=0,n=e.length;r<n;r++)if(t(e[r]))return e[r]}function Ll(e){if(Array.from)return Array.from(e);let t=[];for(;;){let{done:r,value:n}=e.next();if(r)break;t[t.length]=n}return t}function Vl(e,t,r){let n=t-e+1,o=r?new r(n):new Int32Array(n);for(let a=0;a<n;a++)o[a]=a+e;return o}var pt;(x=>{x.Zero=0;let{_int32:t,_float64:r,_int32_1:n,_float64_1:o}=function(){let g=new ArrayBuffer(8),h=new ArrayBuffer(8);return{_int32:new Int32Array(g),_float64:new Float64Array(g),_int32_1:new Int32Array(h),_float64_1:new Float64Array(h)}}();function a(g){return typeof g=="number"}x.is=a;function i(g,h){return t[0]=g,t[1]=h,r[0]}x.create=i;function s(g){return r[0]=g,t[1]-t[0]}x.diff=s;function u(g){return r[0]=g,t[0]}x.fst=u;function m(g){return r[0]=g,t[1]}x.snd=m;function c(g,h){return r[0]=g,o[0]=h,t[0]===n[0]&&t[1]===n[1]}x.areEqual=c;function l(g,h){r[0]=g,o[0]=h;let f=t[0]-n[0];return f!==0?f:t[1]-n[1]}x.compare=l;function d(g,h,f){r[0]=g[h],o[0]=g[f];let C=t[0]-n[0];return C!==0?C:t[1]-n[1]}x.compareInArray=d;function y(g){return r[0]=g,ba(t[0],t[1])}x.hashCode=y;function S(g){return r[0]=g,`(${t[0]}, ${t[1]})`}x.toString=S})(pt||(pt={}));var Tu=pt.Zero;function vu(e,t){return t<e?pt.create(e,e):pt.create(e,t+1)}function Aa(e,t){return t<=e?pt.create(e,e):pt.create(e,t)}function kl(e){return e<0?pt.create(0,0):pt.create(0,e)}var Gl=pt.is,Qr=pt.fst,yn=pt.snd,ki=pt.fst;function Gi(e){return pt.snd(e)-1}var jn=pt.diff,wl=pt.hashCode,aP=pt.toString;function Nl(e,t){return pt.fst(e)<=t&&t<pt.snd(e)}function Ol(e,t){let r=Qr(e);return t>=r&&t<yn(e)?t-r:-1}function Hl(e,t){return pt.fst(e)+t}var ql=pt.areEqual;function Du(e,t){let r=jn(e),n=jn(t);return r===0&&n===0?!0:r>0&&n>0&&Gi(e)>=ki(t)&&ki(e)<=Gi(t)}function zl(e,t){return jn(e)?jn(t)?Qr(e)<=Qr(t)&&yn(e)>=yn(t):!0:jn(t)===0}function _a(e,t){let r=Qr(e);if(t<=r)return 0;let n=yn(e);return t>=n?n-r:t-r}function Kl(e,t,r){let n=Qr(r),o=Qr(e);if(t<=n+o)return n;let a=yn(r);return t>=a+o?a:t-o}function Mu(e,t,r){return Aa(_a(e,t),_a(e,r+1))}function jl(e,t){return Du(e,t)?Aa(Math.max(Qr(e),Qr(t)),Math.min(yn(e),yn(t))):Tu}function Ql(e,t){return jn(Mu(e,ki(t),Gi(t)))}var z;(A=>(A.Empty=Tu,A.ofSingleton=b=>vu(b,b),A.ofRange=vu,A.ofBounds=Aa,A.ofLength=kl,A.is=Gl,A.has=Nl,A.indexOf=Ol,A.getAt=Hl,A.start=Qr,A.end=yn,A.min=ki,A.max=Gi,A.size=jn,A.hashCode=wl,A.areEqual=ql,A.areIntersecting=Du,A.isSubInterval=zl,A.findPredecessorIndex=_a,A.findPredecessorIndexInInterval=Kl,A.findRange=Mu,A.intersectionSize=Ql,A.intersect=jl))(z||(z={}));var Ia=[];function Yl(e){return[e]}function Xl(e){return e}function Zl(e){return Fr(e),e}function Eu(e,t){if(t<e)return[];let r=new Int32Array(t-e+1);for(let n=e;n<=t;n++)r[n-e]=n;return r}function Wl(e){return e&&(Array.isArray(e)||!!e.buffer)}function Bu(e){return e[e.length-1]-e[0]+1===e.length}function Pa(e){return e[0]}function Ta(e){return e[e.length-1]+1}function Jl(e){return e[0]}function $l(e){return e[e.length-1]}function Ru(e){return e.length}function ed(e){let t=e.length;return t?t>2?Rl(t,e[0],e[t-1],e[t>>1]):Bl(t,e[0],e[t-1]):0}function Fu(e,t){let r=e.length;return r===0?-1:e[0]<=t&&t<=e[r-1]?ad(e,t,0,r):-1}function td(e,t,r){return Uu(e,t,z.start(r),z.end(r))}function Uu(e,t,r,n){return e.length===0||n<=r?-1:e[r]<=t&&t<=e[n-1]?ad(e,t,r,n):-1}function rd(e,t){return Fu(e,t)>=0}function nd(e,t){if(e===t)return!0;let r=e.length;if(r!==t.length||e[0]!==t[0]||e[r-1]!==t[r-1])return!1;if(Bu(e))return!0;r--;for(let n=1;n<r;n++)if(e[n]!==t[n])return!1;return!0}function Qn(e,t){let r=e.length;return t<=e[0]?0:t>e[r-1]?r:sd(e,t,0,r)}function od(e,t,r){let n=z.start(r),o=z.end(r),a=e[n];return t<=a?n:o>n&&t>e[o-1]?o:t-a<=11?J0(e,t,n+1,o):sd(e,t,n,o)}function id(e,t,r){return z.ofBounds(Qn(e,t),Qn(e,r+1))}function ad(e,t,r,n){let o=r,a=n-1;for(;o<=a;){if(o+11>a){for(let u=o;u<=a;u++)if(t===e[u])return u;return-1}let i=o+a>>1,s=e[i];if(t<s)a=i-1;else if(t>s)o=i+1;else return i}return-1}function sd(e,t,r,n){let o=r,a=n-1;for(;o<a;){if(o+11>a){for(let u=o;u<=a;u++)if(t<=e[u])return u;return a+1}let i=o+a>>1,s=e[i];if(t<s)a=i-1;else if(t>s)o=i+1;else return i}return o>a?a+1:e[o]>=t?o:o+1}function J0(e,t,r,n){for(let o=r;o<n;o++)if(t<=e[o])return o;return n}function ud(e,t){if(e===t)return!0;let{startI:r,startJ:n,endI:o,endJ:a}=wi(e,t);for(;r<o&&n<a;){let i=e[r],s=t[n];if(i<s)r++;else if(i>s)n++;else return!0}return!1}function cd(e,t){if(e===t)return!0;let r=t.length,{startI:n,startJ:o,endI:a,endJ:i}=wi(e,t);if(i-o<r||a-n<r)return!1;let s=0;for(;n<a&&o<i;){let u=e[n],m=t[o];u<m?n++:u>m?o++:(n++,o++,s++)}return s===r}function Lu(e,t){if(e===t)return e;let r=e.length,n=t.length;if(r===0)return t;if(n===0)return e;if(e[0]>t[0])return Lu(t,e);let{startI:o,startJ:a,endI:i,endJ:s}=wi(e,t),u=ld(e,t,o,a,i,s);if(u===r&&u===n||u===n)return e;if(u===r)return t;let m=new Int32Array(r+n-u),c=0,l=0,d=0;for(c=0;c<o;c++)m[d++]=e[c];for(;l<s&&e[o]>t[l];)m[d++]=t[l++];for(;c<i&&l<s;){let y=e[c],S=t[l];y<S?(m[d++]=y,c++):y>S?(m[d++]=S,l++):(m[d++]=y,c++,l++)}for(;c<i;c++)m[d++]=e[c];for(;l<s;l++)m[d++]=t[l];for(;c<r;c++)m[d++]=e[c];for(;l<n;l++)m[d++]=t[l];return m}function md(e,t){if(e===t)return Ru(e);let{startI:r,startJ:n,endI:o,endJ:a}=wi(e,t);return ld(e,t,r,n,o,a)}function ld(e,t,r,n,o,a){let i=r,s=n,u=0;for(;i<o&&s<a;){let m=e[i],c=t[s];m<c?i++:m>c?s++:(i++,s++,u++)}return u}function dd(e,t){if(e===t)return Ia;let r=e.length,{startI:n,startJ:o,endI:a,endJ:i}=wi(e,t),s=n,u=o,m=0;for(;s<a&&u<i;){let d=e[s],y=t[u];d<y?s++:d>y?u++:(s++,u++,m++)}if(!m)return e;if(m>=r)return Ia;let c=new Int32Array(r-m),l=0;for(let d=0;d<n;d++)c[l++]=e[d];for(s=n,u=o;s<a&&u<i;){let d=e[s],y=t[u];d<y?(c[l++]=d,s++):(d>y||s++,u++)}for(;s<r;s++)c[l++]=e[s];return c}function pd(e){if(e.length<2)return e;let t=1;for(let o=0,a=e.length-1;o<a;o++)e[o]!==e[o+1]&&t++;if(t===e.length)return e;let r=new Int32Array(t),n=0;for(let o=0,a=e.length-1;o<a;o++)e[o]!==e[o+1]&&(r[n++]=e[o]);return r[n]=e[e.length-1],r}var hn={startI:0,startJ:0,endI:0,endJ:0};function wi(e,t){let r=e.length,n=t.length,o=r/n;return r>=128||n>=128||o<=.34||o>=2.99?(hn.startI=Qn(e,Pa(t)),hn.startJ=Qn(t,Pa(e)),hn.endI=Qn(e,Ta(t)),hn.endJ=Qn(t,Ta(e))):(hn.startI=0,hn.startJ=0,hn.endI=r,hn.endJ=n),hn}var ee;(E=>(E.Empty=Ia,E.ofUnsortedArray=Zl,E.ofSingleton=Yl,E.ofSortedArray=Xl,E.ofRange=Eu,E.ofBounds=(B,L)=>Eu(B,L-1),E.is=Wl,E.isRange=Bu,E.has=rd,E.indexOf=Fu,E.indexOfInInterval=td,E.indexOfInRange=Uu,E.start=Pa,E.end=Ta,E.min=Jl,E.max=$l,E.size=Ru,E.hashCode=ed,E.areEqual=nd,E.areIntersecting=ud,E.isSubset=cd,E.union=Lu,E.subtract=dd,E.findPredecessorIndex=Qn,E.findPredecessorIndexInInterval=od,E.findRange=id,E.intersectionSize=md,E.deduplicate=pd))(ee||(ee={}));var xn=z.Empty,gd=z.ofSingleton,bd=z.ofRange,Sd=z.ofBounds;function Xn(e){return e.length?ee.isRange(e)?z.ofRange(e[0],e[e.length-1]):e:xn}function Yn(e){return z.is(e)?z.size(e):ee.size(e)}function Cd(e,t){return z.is(e)?z.has(e,t):ee.has(e,t)}function _d(e,t){return z.is(e)?z.indexOf(e,t):ee.indexOf(e,t)}function va(e,t){return z.is(e)?z.getAt(e,t):e[t]}function vo(e){return z.is(e)?z.min(e):ee.min(e)}function Do(e){return z.is(e)?z.max(e):ee.max(e)}function Ad(e){return z.is(e)?z.hashCode(e):ee.hashCode(e)}function Id(e,t){return z.is(e)?z.is(t)?z.areEqual(e,t):fd(e,t):z.is(t)?fd(t,e):ee.areEqual(e,t)}function Pd(e,t){return z.is(e)?z.is(t)?z.areIntersecting(e,t):yd(t,e):z.is(t)?yd(e,t):ee.areIntersecting(e,t)}function Td(e,t){return z.is(e)?z.findPredecessorIndex(e,t):ee.findPredecessorIndex(e,t)}function vd(e,t,r){return z.is(e)?z.findPredecessorIndexInInterval(e,t,r):ee.findPredecessorIndexInInterval(e,t,r)}function Dd(e,t,r){return z.is(e)?z.findRange(e,t,r):ee.findRange(e,t,r)}function Md(e,t){return z.is(e)?z.is(t)?z.intersectionSize(e,t):xd(t,e):z.is(t)?xd(e,t):ee.intersectionSize(e,t)}function Ed(e,t){return z.is(e)?z.is(t)?rg(e,t):hd(t,e):z.is(t)?hd(e,t):Xn(ee.union(e,t))}function Bd(e,t){return z.is(e)?z.is(t)?ng(e,t):ig(e,t):z.is(t)?og(e,t):Xn(ee.subtract(e,t))}function fd(e,t){return z.size(e)===ee.size(t)&&z.start(e)===ee.start(t)&&z.end(e)===ee.end(t)}function yd(e,t){return e.length!==0&&z.size(ee.findRange(e,z.min(t),z.max(t)))!==0}function eg(e,t){let r=Yn(e),n=Yn(t);return r===0&&n===0?!0:r>0&&n>0&&Do(e)>=vo(t)&&vo(e)<=Do(t)}function tg(e,t){return Yn(e)?Yn(t)?vo(e)<=vo(t)&&Do(e)>=Do(t):!0:Yn(t)===0}function rg(e,t){if(z.areEqual(e,t))return e;let r=z.size(e),n=z.size(t);if(!n)return e;if(!r)return t;let o=z.min(e),a=z.min(t);if(eg(e,t))return z.ofRange(Math.min(o,a),Math.max(z.max(e),z.max(t)));let i,s,u,m;o<a?(i=r,s=o,u=n,m=a):(i=n,s=a,u=r,m=o);let c=new Int32Array(r+n);for(let l=0;l<i;l++)c[l]=l+s;for(let l=0;l<u;l++)c[l+i]=l+m;return Xn(c)}function hd(e,t){let r=z.size(t);if(!r)return e;if(tg(t,e))return t;let n=z.min(t),o=z.max(t),a=ee.findRange(e,n,o),i=z.start(a),s=z.end(a),u=new Int32Array(i+(e.length-s)+r),m=0;for(let c=0;c<i;c++)u[m++]=e[c];for(let c=n;c<=o;c++)u[m++]=c;for(let c=s,l=e.length;c<l;c++)u[m++]=e[c];return Xn(u)}function xd(e,t){if(!z.size(t))return 0;let r=ee.findRange(e,z.min(t),z.max(t));return z.end(r)-z.start(r)}function ng(e,t){if(z.areEqual(e,t))return xn;if(!z.areIntersecting(e,t))return e;let r=z.min(e),n=z.max(e),o=z.min(t),a=z.max(t);if(n<r||a<o)return e;if(z.isSubInterval(t,e))return xn;if(z.isSubInterval(e,t)){let i=o-r,s=n-a;if(i<=0)return z.ofRange(a+1,a+s);if(s<=0)return z.ofRange(r,r+i-1);let u=new Int32Array(i+s),m=0;for(let c=0;c<i;c++)u[m++]=r+c;for(let c=1;c<=s;c++)u[m++]=a+c;return Xn(u)}return r<o?z.ofRange(r,o-1):z.ofRange(a+1,n)}function og(e,t){let r=z.min(t),n=z.max(t);if(n<r)return e;let o=ee.findRange(e,r,n),a=z.start(o),i=z.end(o),s=e.length-(i-a);if(s<=0)return xn;if(s===e.length)return e;let u=new Int32Array(s),m=0;for(let c=0;c<a;c++)u[m++]=e[c];for(let c=i,l=e.length;c<l;c++)u[m++]=e[c];return Xn(u)}function ig(e,t){let r=z.min(e),n=z.max(e);if(n<r)return e;let o=n-r+1,a=ee.findRange(t,r,n),i=z.start(a),s=z.end(a),u=s-i;if(u===0)return e;let m=o-u;if(m<=0)return xn;let c=new Int32Array(m),l=t.length-1,d=t[Math.min(i,l)],y=t[Math.min(s,l)],S=0;for(let x=r;x<d;x++)c[S++]=x;for(let x=d;x<=y;x++)ee.indexOfInInterval(t,x,a)<0&&(c[S++]=x);for(let x=y+1;x<=n;x++)c[S++]=x;return Xn(c)}function Rd(e,t,r){if(z.is(e)){let n=z.min(e);for(let o=n,a=z.max(e);o<=a;o++)t(o,o-n,r)}else for(let n=0,o=e.length;n<o;n++)t(e[n],n,r);return r}function Fd(e,t,r){if(t===r)return e;let n=Yn(e),o=t.length,a=r.length;if(n===0||o===0||a===0)return xn;let i=ee.findPredecessorIndex(r,t[vo(e)]),s=ee.findPredecessorIndex(r,t[Do(e)]+1),u=0,m=0,c=0,l=i;for(;c<n&&l<s;){let y=t[va(e,c)],S=r[l];y<S?c++:(y>S||(u++,c++),l++)}if(u===0)return xn;if(u===o&&u===a)return e;let d=new Int32Array(u);for(m=0,c=0,l=i;c<n&&l<s;){let y=t[va(e,c)],S=r[l];y<S?c++:(y>S||(d[m++]=l,c++),l++)}return Xn(d)}var Ae;(P=>{P.Empty=xn,P.ofSingleton=gd,P.ofRange=bd,P.ofBounds=Sd,P.has=Cd,P.indexOf=_d,P.getAt=va,P.min=vo,P.max=Do,P.size=Yn,P.hashCode=Ad,P.areEqual=Id,P.areIntersecting=Pd,P.union=Ed,P.indexedIntersect=Fd,P.subtract=Bd,P.findPredecessorIndex=Td,P.findPredecessorIndexInInterval=vd,P.findRange=Dd,P.intersectionSize=Md;function T(A,b,_){return Rd(A,b,_)}P.forEach=T;function I(A){let b=[];return P.forEach(A,_=>b.push(_)),b}P.toArray=I})(Ae||(Ae={}));function ku(e){let t=ee.ofSortedArray(e),r=ee.max(t),n=new Int32Array(r);for(let o=0,a=e.length-1;o<a;o++)for(let i=e[o],s=e[o+1];i<s;i++)n[i]=o;return{offsets:t,index:n,count:e.length-1}}function Ud(e,t){let r=z.start(t),n=new Int32Array(e.length+1);for(let o=0,a=e.length;o<a;o++)n[o]=e[o]-r;return n[e.length]=z.end(t)-r,ku(n)}function Ld({count:e}){return e}function Vd({index:e},t){return e[t]}function kd({offsets:e},t,r){let n=Ae.max(e),o=r>=n?-1:Ae.findPredecessorIndex(e,r-1);return Ae.findRange(t,Ae.getAt(e,o),Ae.getAt(e,o+1)-1)}var Vu=class{constructor(t,r,n,o){this.segments=t;this.segmentMap=r;this.set=n;this.segmentMin=0;this.segmentMax=0;this.setRange=z.Empty;this.value={index:0,start:0,end:0};this.hasNext=!1;this.setRange=o,this.updateSegmentRange()}move(){for(;this.hasNext;)if(this.updateValue()){this.value.index=this.segmentMin++,this.hasNext=this.segmentMax>=this.segmentMin&&z.size(this.setRange)>0;break}else this.updateSegmentRange();return this.value}updateValue(){let t=this.segments[this.segmentMin+1],r=Ae.findPredecessorIndexInInterval(this.set,t,this.setRange);return this.value.start=z.start(this.setRange),this.value.end=r,this.setRange=z.ofBounds(r,z.end(this.setRange)),r>this.value.start}updateSegmentRange(){let t=z.min(this.setRange),r=z.max(this.setRange);if(r<t){this.hasNext=!1;return}this.segmentMin=this.segmentMap[Ae.getAt(this.set,t)],this.segmentMax=this.segmentMap[Ae.getAt(this.set,r)],this.hasNext=this.segmentMax>=this.segmentMin}setSegment(t){this.setRange=z.ofBounds(t.start,t.end),this.updateSegmentRange()}};function Gd(e,t,r){let n=typeof r<"u"?z.ofBounds(r.start,r.end):z.ofBounds(0,Ae.size(t));return new Vu(e.offsets,e.index,t,n)}var Ue;(i=>(i.create=ku,i.ofOffsets=Ud,i.count=Ld,i.getSegment=Vd,i.projectValue=kd,i.transientSegments=Gd))(Ue||(Ue={}));function wu(e){return new Gu(e)}var Gu=class{remove(t){let{prev:r,next:n}=this,o=r[t],a=n[t];o>=0&&(n[o]=a,r[t]=-1),a>=0&&(r[a]=o,n[t]=-1),t===this.head&&(o<0?this.head=a:this.head=o)}has(t){return this.prev[t]>=0||this.next[t]>=0||this.head===t}constructor(t){this.head=t>0?0:-1,this.prev=new Int32Array(t),this.next=new Int32Array(t);for(let r=0;r<t;r++)this.next[r]=r+1,this.prev[r]=r-1;this.prev[0]=-1,this.next[t-1]=-1}};var cr;(t=>{function e(){return new Map}t.Mutable=e})(cr||(cr={}));var Nu=class{constructor(t){this.xs=[];this.index=-1;this.length=0;this.hasNext=!1;this.length=t.length,this.hasNext=t.length>0,this.xs=t,this.index=-1,this.lastValue=t.length>0?t[0]:void 0}move(){return++this.index,this.lastValue=this.xs[this.index],this.hasNext=this.index<this.length-1,this.lastValue}},Da=class{constructor(t,r){this.max=r;this.value=0;this.hasNext=!1;this.value=t-1,this.hasNext=r>=t}move(){return++this.value,this.hasNext=this.value<this.max,this.value}},Ou=class{constructor(t){this.value=t;this.hasNext=!0}move(){return this.hasNext=!1,this.value}},Hu=class{constructor(t,r){this.base=t;this.f=r;this.hasNext=!1;this.hasNext=t.hasNext}move(){let t=this.f(this.base.move());return this.hasNext=this.base.hasNext,t}},qu=class{constructor(t,r){this.base=t;this.p=r;this.hasNext=this.findNext()}move(){let t=this.next;return this.hasNext=this.findNext(),t}findNext(){for(;this.base.hasNext;)if(this.next=this.base.move(),this.p(this.next))return!0;return!1}},zu;(s=>{s.Empty=new Da(0,-1);function t(u){return new Nu(u)}s.Array=t;function r(u){return new Ou(u)}s.Value=r;function n(u,m){return new Da(u,m)}s.Range=n;function o(u,m){return new Hu(u,m)}s.map=o;function a(u,m){return new qu(u,m)}s.filter=a;function i(u,m,c){for(;u.hasNext;)if(m(u.move(),c))return c;return c}s.forEach=i})(zu||(zu={}));var ug={domain:[0,1],reverse:!1,listOrName:"red-yellow-blue"},Mo;(t=>{function e(r){let{domain:n,reverse:o,listOrName:a}={...ug,...r},i=typeof a=="string"?Rr(a).list:a,s=o?i.slice().reverse():i,u=s.length-1,m=0,c=0,l=0;function d(x,g){c=x,l=g,m=l-c||1}d(n[0],n[1]);let y;if(s.every(x=>Array.isArray(x))){let x=[...s];x.sort((C,T)=>C[1]-T[1]);let g=x.map(C=>C[0]),h=ee.ofSortedArray(x.map(C=>C[1])),f=g.length-1;y=C=>{let T=Br((C-c)/m,0,1),I=ee.findPredecessorIndex(h,T);if(I===0)return g[c];if(I>f)return g[f];let P=h[I-1],A=h[I],b=Br((T-P)/(A-P),0,1);return rt.interpolate(g[I-1],g[I],b)}}else y=x=>{let g=Math.min(s.length-1,Math.max(0,(x-c)/m*u)),h=Math.floor(g),f=s[h],C=s[Math.ceil(g)];return rt.interpolate(f,C,g-h)};return{color:y,setDomain:d}}t.create=e})(Mo||(Mo={}));function Ni(e,t,r){let n=t,o=0,a=1;for(e.charCodeAt(n)===45?(a=-1,++n):e.charCodeAt(n)===43&&++n;n<r;n++){let i=e.charCodeAt(n)-48;if(i>9||i<0)return a*o|0;o=10*o+i|0}return a*o}function wd(e,t,r,n){return t.charCodeAt(r)===43&&r++,e*Math.pow(10,Ni(t,r,n))}function Ma(e,t,r){let n=t,o=1,a=0,i=0,s=1;for(e.charCodeAt(n)===45?(o=-1,++n):e.charCodeAt(n)===43&&++n;n<r;){let u=e.charCodeAt(n)-48;if(u>=0&&u<10)a=a*10+u,++n;else if(u===-2){for(++n;n<r;)if(u=e.charCodeAt(n)-48,u>=0&&u<10)i=10*i+u,s=10*s,++n;else return u===53||u===21?wd(o*(a+i/s),e,n+1,r):o*(a+i/s);return o*(a+i/s)}else{if(u===53||u===21)return wd(o*a,e,n+1,r);break}}return o*a}function Nd(e,t){return{name:t,blocks:e}}function Od(e,t){return{header:t,categories:e,getField(r){let[n,o]=r.split(".");return e[n].getField(o||"")}}}function Oi(e,t,r,n){return{rowCount:t,name:e,fieldNames:[...r],getField(o){return n[o]}}}(n=>{function e(o){return{rowCount:0,name:o,fieldNames:[],getField(a){}}}n.empty=e;function t(o,a){let i=Object.keys(a);return{rowCount:i.length>0?a[i[0]].rowCount:0,name:o,fieldNames:i,getField(s){return a[s]}}}function r(o,a){let i={};for(let s of a._columns)i[s]=ju.ofColumn(a[s]);return t(o,i)}n.ofTable=r})(Oi||(Oi={}));var ju;(r=>{function e(n){let{rowCount:o,valueKind:a,areValuesEqual:i,isDefined:s}=n,u,m,c;switch(n.schema.valueType){case"float":case"int":u=d=>""+n.value(d),m=n.value,c=n.value;break;case"str":u=n.value,m=d=>{let y=n.value(d);return Ni(y,0,y.length)||0},c=d=>{let y=n.value(d);return Ma(y,0,y.length)||0};break;case"list":let{separator:l}=n.schema;u=d=>n.value(d).join(l),m=d=>NaN,c=d=>NaN;break;default:throw new Error(`unsupported valueType '${n.schema.valueType}'`)}return{__array:void 0,binaryEncoding:void 0,isDefined:s,rowCount:o,str:u,int:m,float:c,valueKind:a,areValuesEqual:i,toStringArray:l=>Vt.createAndFillArray(o,u,l),toIntArray:l=>Vt.createAndFillArray(o,m,l),toFloatArray:l=>Vt.createAndFillArray(o,c,l)}}r.ofColumn=e;function t(n,o){return e(ne.Undefined(n,o))}r.ofUndefined=t})(ju||(ju={}));function Hd(e,t,r,n){let o=r?0:1;switch(t){case 1:return n==="brackets"?a=>`${e}[${a+o}]`:a=>`${e}_${a+o}`;case 2:return n==="brackets"?(a,i)=>`${e}[${a+o}][${i+o}]`:(a,i)=>`${e}_${a+o}${i+o}`;default:return n==="brackets"?(a,i,s)=>`${e}[${a+o}][${i+o}][${s+o}]`:(a,i,s)=>`${e}_${a+o}${i+o}${s+o}`}}function qd(e,t,r,n){let o=t.create();if(t.rank===1){let a=t.dimensions[0];for(let i=0;i<a;i++){let s=e.getField(n(i));t.set(o,i,s?s.float(r):0)}}else if(t.rank===2){let a=t.dimensions[0],i=t.dimensions[1];for(let s=0;s<a;s++)for(let u=0;u<i;u++){let m=e.getField(n(s,u));t.set(o,s,u,m?m.float(r):0)}}else{let a=t.dimensions[0],i=t.dimensions[1],s=t.dimensions[2];for(let u=0;u<a;u++)for(let m=0;m<i;m++)for(let c=0;c<s;c++){let l=e.getField(n(u,m,c));t.set(o,u,m,c,l?l.float(r):0)}}return o}var Rt;(r=>{let e;(m=>(m[m.Int8=1]="Int8",m[m.Int16=2]="Int16",m[m.Int32=3]="Int32",m[m.Uint8=4]="Uint8",m[m.Uint16=5]="Uint16",m[m.Uint32=6]="Uint32"))(e=r.IntDataType||(r.IntDataType={}));let t;(a=>(a[a.Float32=32]="Float32",a[a.Float64=33]="Float64"))(t=r.FloatDataType||(r.FloatDataType={}))})(Rt||(Rt={}));function Kd(e){return Object.keys(e)}function Zn(e){throw new Error("unreachable")}function si(e){let t=e.data;for(let r=e.encoding.length-1;r>=0;r--)t=cg(t,e.encoding[r]);return t}function cg(e,t){switch(t.kind){case"ByteArray":switch(t.type){case Rt.IntDataType.Uint8:return e;case Rt.IntDataType.Int8:return mg(e);case Rt.IntDataType.Int16:return lg(e);case Rt.IntDataType.Uint16:return dg(e);case Rt.IntDataType.Int32:return pg(e);case Rt.IntDataType.Uint32:return fg(e);case Rt.FloatDataType.Float32:return yg(e);case Rt.FloatDataType.Float64:return hg(e);default:Zn(t.type)}case"FixedPoint":return xg(e,t);case"IntervalQuantization":return gg(e,t);case"RunLength":return bg(e,t);case"Delta":return Sg(e,t);case"IntegerPacking":return Ag(e,t);case"StringArray":return Ig(e,t)}}function jd(e,t){switch(e){case Rt.IntDataType.Int8:return new Int8Array(t);case Rt.IntDataType.Int16:return new Int16Array(t);case Rt.IntDataType.Int32:return new Int32Array(t);case Rt.IntDataType.Uint8:return new Uint8Array(t);case Rt.IntDataType.Uint16:return new Uint16Array(t);case Rt.IntDataType.Uint32:return new Uint32Array(t);default:Zn(e)}}function Qd(e,t){switch(e){case Rt.FloatDataType.Float32:return new Float32Array(t);case Rt.FloatDataType.Float64:return new Float64Array(t);default:Zn(e)}}function mg(e){return new Int8Array(e.buffer,e.byteOffset)}function ui(e,t,r){return new r(e.buffer)}function lg(e){return ui(e,2,Int16Array)}function dg(e){return ui(e,2,Uint16Array)}function pg(e){return ui(e,4,Int32Array)}function fg(e){return ui(e,4,Uint32Array)}function yg(e){return ui(e,4,Float32Array)}function hg(e){return ui(e,8,Float64Array)}function xg(e,t){let r=e.length,n=Qd(t.srcType,r),o=1/t.factor;for(let a=0;a<r;a++)n[a]=o*e[a];return n}function gg(e,t){let r=e.length,n=Qd(t.srcType,r),o=(t.max-t.min)/(t.numSteps-1),a=t.min;for(let i=0;i<r;i++)n[i]=a+o*e[i];return n}function bg(e,t){let r=jd(t.srcType,t.srcSize),n=0;for(let o=0,a=e.length;o<a;o+=2){let i=e[o],s=e[o+1];for(let u=0;u<s;++u)r[n++]=i}return r}function Sg(e,t){let r=e.length,n=jd(t.srcType,r);if(!r)return e;n[0]=e[0]+(t.origin|0);for(let o=1;o<r;++o)n[o]=e[o]+n[o-1];return n}function Cg(e,t){let r=t.byteCount===1?127:32767,n=-r-1,o=e.length,a=new Int32Array(t.srcSize),i=0,s=0;for(;i<o;){let u=0,m=e[i];for(;m===r||m===n;)u+=m,i++,m=e[i];u+=m,a[s]=u,i++,s++}return a}function _g(e,t){let r=t.byteCount===1?255:65535,n=e.length,o=new Int32Array(t.srcSize),a=0,i=0;for(;a<n;){let s=0,u=e[a];for(;u===r;)s+=u,a++,u=e[a];s+=u,o[i]=s,a++,i++}return o}function Ag(e,t){return e.length===t.srcSize?e:t.isUnsigned?_g(e,t):Cg(e,t)}function Ig(e,t){let r=si({encoding:t.offsetEncoding,data:t.offsets}),n=si({encoding:t.dataEncoding,data:e}),o=t.stringData,a=new Array(r.length);a[0]="";for(let u=1,m=r.length;u<m;u++)a[u]=o.substring(r[u-1],r[u]);let i=0,s=new Array(n.length);for(let u=0,m=n.length;u<m;u++)s[i++]=a[n[u]+1];return s}function Yd(e){let t=e.mask?si(e.mask):void 0,r=si(e.data),n=Vt.isTypedArray(r),o=n?t?m=>t[m]===ne.ValueKind.Present?""+r[m]:"":m=>""+r[m]:t?m=>t[m]===ne.ValueKind.Present?r[m]:"":m=>r[m],a=n?m=>r[m]:m=>{let c=r[m];return Ni(c,0,c.length)},i=n?m=>r[m]:m=>{let c=r[m];return Ma(c,0,c.length)},s=t?m=>t[m]:m=>ne.ValueKind.Present,u=r.length;return{__array:r,binaryEncoding:e.data.encoding,isDefined:!0,rowCount:u,str:o,int:a,float:i,valueKind:s,areValuesEqual:(m,c)=>r[m]===r[c],toStringArray:m=>Vt.createAndFillArray(u,o,m),toIntArray:n?m=>Vt.typedArrayWindow(r,m):m=>Vt.createAndFillArray(u,a,m),toFloatArray:n?m=>Vt.typedArrayWindow(r,m):m=>Vt.createAndFillArray(u,i,m)}}var Pg=new TextDecoder;function Xd(e,t,r){let n=t||r!==e.length?e.subarray(t,t+r):e;return Pg.decode(n)}function Zd(e){return Ba({buffer:e,offset:0,dataView:new DataView(e.buffer)})}function Qu(e,t){let r={};for(let n=0;n<t;n++){let o=Ba(e);r[o]=Ba(e)}return r}function Yu(e,t){let r=new Uint8Array(t),n=e.offset;for(let o=0;o<t;o++)r[o]=e.buffer[o+n];return e.offset+=t,r}function Ea(e,t){let r=Xd(e.buffer,e.offset,t);return e.offset+=t,r}function Xu(e,t){let r=new Array(t);for(let n=0;n<t;n++)r[n]=Ba(e);return r}function Ba(e){let t=e.buffer[e.offset],r,n;if(!(t&128))return e.offset++,t;if((t&240)===128)return n=t&15,e.offset++,Qu(e,n);if((t&240)===144)return n=t&15,e.offset++,Xu(e,n);if((t&224)===160)return n=t&31,e.offset++,Ea(e,n);if((t&224)===224)return r=e.dataView.getInt8(e.offset),e.offset++,r;switch(t){case 192:return e.offset++,null;case 194:return e.offset++,!1;case 195:return e.offset++,!0;case 196:return n=e.dataView.getUint8(e.offset+1),e.offset+=2,Yu(e,n);case 197:return n=e.dataView.getUint16(e.offset+1),e.offset+=3,Yu(e,n);case 198:return n=e.dataView.getUint32(e.offset+1),e.offset+=5,Yu(e,n);case 202:return r=e.dataView.getFloat32(e.offset+1),e.offset+=5,r;case 203:return r=e.dataView.getFloat64(e.offset+1),e.offset+=9,r;case 204:return r=e.buffer[e.offset+1],e.offset+=2,r;case 205:return r=e.dataView.getUint16(e.offset+1),e.offset+=3,r;case 206:return r=e.dataView.getUint32(e.offset+1),e.offset+=5,r;case 208:return r=e.dataView.getInt8(e.offset+1),e.offset+=2,r;case 209:return r=e.dataView.getInt16(e.offset+1),e.offset+=3,r;case 210:return r=e.dataView.getInt32(e.offset+1),e.offset+=5,r;case 217:return n=e.dataView.getUint8(e.offset+1),e.offset+=2,Ea(e,n);case 218:return n=e.dataView.getUint16(e.offset+1),e.offset+=3,Ea(e,n);case 219:return n=e.dataView.getUint32(e.offset+1),e.offset+=5,Ea(e,n);case 220:return n=e.dataView.getUint16(e.offset+1),e.offset+=3,Xu(e,n);case 221:return n=e.dataView.getUint32(e.offset+1),e.offset+=5,Xu(e,n);case 222:return n=e.dataView.getUint16(e.offset+1),e.offset+=3,Qu(e,n);case 223:return n=e.dataView.getUint32(e.offset+1),e.offset+=5,Qu(e,n)}throw new Error("Unknown type 0x"+t.toString(16))}function Tg(e){let t=Object.create(null),r=Object.create(null);for(let n of e.columns)t[n.name]=n;return{rowCount:e.rowCount,name:e.name.substr(1),fieldNames:e.columns.map(n=>n.name),getField(n){let o=t[n];if(o)return r[n]||(r[n]=Yd(o)),r[n]}}}function Wd(e){let t=Zd(e);return Nd(t.dataBlocks.map(n=>{let o=Object.create(null);for(let a of n.categories)o[a.name.substr(1)]=Tg(a);return Od(o,n.header)}))}var Ot;(r=>{function e(n){return n}r.create=e;function t(n,o){return(n&o)!==0}r.has=t})(Ot||(Ot={}));var Ur;(r=>{let e=0;function t(){return e++,""+e}r.create22=t})(Ur||(Ur={}));function gn(e=0,t=Number.MAX_SAFE_INTEGER){let r=e;return()=>{let n=r;return r=(r+1)%t,n}}var Hi;(r=>{function e(n){return{ref:n}}r.create=e;function t(n,o){return n.ref=o,n}r.set=t})(Hi||(Hi={}));var vg=gn(0,2147483647),Yr;(r=>{function e(n,o){return{id:vg(),version:0,value:n,metadata:o}}r.create=e;function t(n,o){return{id:n.id,version:n.version+1,value:o,metadata:n.metadata}}r.withValue=t})(Yr||(Yr={}));var Q;(o=>{function e(a,i){return Hi.create(Yr.create(a,i))}o.create=e;function t(a,i){return Hi.set(a,Yr.withValue(a.ref,i))}o.update=t;function r(a,i){return Hi.set(a,i)}o.set=r;function n(a,i){return a.ref.value!==i?t(a,i):a}o.updateIfChanged=n})(Q||(Q={}));function Jn(e,t){let r=e.length;if(r!==t.length)return!1;for(let n=0;n<r;n++)if(e[n]!==t[n])return!1;return!0}var Jd=Object.prototype.hasOwnProperty;function Wn(e,t){if(e===t)return!0;let r=Array.isArray(e),n=Array.isArray(t);if(r&&n){if(e.length!==t.length)return!1;for(let o=0;o<e.length;o++)if(!Wn(e[o],t[o]))return!1;return!0}if(r!==n)return!1;if(e&&t&&typeof e=="object"&&typeof t=="object"){let o=Object.keys(e);if(o.length!==Object.keys(t).length)return!1;let a=e instanceof Date,i=t instanceof Date;if(a&&i)return e.getTime()===t.getTime();if(a!==i)return!1;let s=e instanceof RegExp,u=t instanceof RegExp;if(s&&u)return e.toString()===t.toString();if(s!==u)return!1;for(let m=0;m<o.length;m++)if(!Jd.call(t,o[m]))return!1;for(let m=0;m<o.length;m++)if(!Wn(e[o[m]],t[o[m]]))return!1;return!0}return!1}function $d(e,t){if(e===t)return!0;if(!e||!t)return!1;let r=Object.keys(e);if(Object.keys(t).length!==r.length)return!1;for(let n of r)if(!Jd.call(e,n)||e[n]!==t[n])return!1;return!0}function Jt(e,t){return e!==void 0?e:t}var ci;(r=>{function e(n){return n.replace(".","_").replace(/\[/,"_").replace(/(\[|\])/g,"")}r.canonical=e;function t(n,o,a=!1){let i=`${n}${o?`.${o}`:""}`;return a?e(i):i}r.create=t})(ci||(ci={}));function Fa(e,t,r){return Rg(e,t,r)}function tp(e,t){return new Ra(t,e,!0)}function Dg(e){switch(e.valueType){case"str":return(t,r,n)=>Mg(e,t,t.str,t.toStringArray);case"int":return(t,r,n)=>ep(e,t,t.int,t.toIntArray);case"float":return(t,r,n)=>ep(e,t,t.float,t.toFloatArray);case"list":throw new Error("Use createListColumn instead.");case"tensor":throw new Error("Use createTensorColumn instead.")}}function Mg(e,t,r,n){return{schema:e,__array:t.__array,isDefined:t.isDefined,rowCount:t.rowCount,value:e.transform==="lowercase"?o=>r(o).toLowerCase():e.transform==="uppercase"?o=>r(o).toUpperCase():r,valueKind:t.valueKind,areValuesEqual:t.areValuesEqual,toArray:e.transform==="lowercase"?o=>Array.from(n(o)).map(a=>a.toLowerCase()):e.transform==="uppercase"?o=>Array.from(n(o)).map(a=>a.toUpperCase()):n}}function ep(e,t,r,n){return{schema:e,__array:t.__array,isDefined:t.isDefined,rowCount:t.rowCount,value:r,valueKind:t.valueKind,areValuesEqual:t.areValuesEqual,toArray:n}}function Eg(e,t,r){let n=e.separator,o=e.itemParse,a=t.getField(r),i=a?u=>a.str(u).split(n).map(m=>o(m.trim())).filter(m=>!!m):u=>[],s=u=>Vt.createAndFillArray(t.rowCount,i,u);return{schema:e,__array:void 0,isDefined:!!a,rowCount:t.rowCount,value:i,valueKind:a?a.valueKind:()=>ne.ValueKind.NotPresent,areValuesEqual:(u,m)=>Jn(i(u),i(m)),toArray:s}}function Bg(e,t,r){let n=e.space,o=t.fieldNames.includes(`${r}[0]`)||t.fieldNames.includes(`${r}[0][0]`)||t.fieldNames.includes(`${r}[0][0][0]`),a=o?0:1,i=t.fieldNames.includes(`${r}_1`)||t.fieldNames.includes(`${r}_11`)||t.fieldNames.includes(`${r}_111`)?"underscore":"brackets",s=Hd(r,n.rank,o,i),u=t.getField(s(a,a,a))||ne.Undefined(t.rowCount,e),m=l=>qd(t,n,l,s),c=l=>Vt.createAndFillArray(t.rowCount,m,l);return{schema:e,__array:void 0,isDefined:u.isDefined,rowCount:t.rowCount,value:m,valueKind:u.valueKind,areValuesEqual:(l,d)=>Nt.areEqualExact(m(l),m(d)),toArray:c}}var Ra=class{constructor(t,r,n){this._isDefined=n;let o=Object.keys(r);this._rowCount=t.rowCount,this._columns=o,this._schema=r;let a=Object.create(null);for(let i of o)Object.defineProperty(this,i,{get:function(){if(a[i])return a[i];let s=r[i];if(s.valueType==="list")a[i]=Eg(s,t,i);else if(s.valueType==="tensor")a[i]=Bg(s,t,i);else{let u=Dg(s),m=t.getField(i);a[i]=m?u(m,t,i):ne.Undefined(t.rowCount,s)}return a[i]},enumerable:!0,configurable:!1})}};function Rg(e,t,r){let n=Object.create(null);for(let o of Object.keys(e))n[o]=Lg(o,e[o],t,r);return Vi.ofTables(t.header,e,n)}function Fg(e){let t=Object.create(null);for(let r of Object.keys(e.categories))for(let n of e.categories[r].fieldNames){let o=ci.create(r,n,!0);t[o]=e.categories[r].getField(n)}return t}function Ug(e,t,r,n){let o=ci.create(t,e),a=ci.canonical(o);if(a in r)return r[a];if(n&&o in n)for(let i of n[o]){let s=ci.canonical(i);if(s in r)return r[s]}}function Lg(e,t,r,n){let o=r.categories[e];if(n){let a=Fg(r),i=Object.create(null),s=[],u=0;for(let m of Object.keys(t)){let c=Ug(m,e,a,n);c&&(i[m]=c,s.push(m),u=c.rowCount)}o={rowCount:u,name:e,fieldNames:[...s],getField(m){return i[m]}}}return new Ra(o||Oi.empty(e),t,!!o)}var bn=ne.Schema,M=bn.str,V=bn.int,Be=bn.float,Zu=bn.coord,ue=bn.Aliased,$n=bn.Matrix,Ua=bn.Vector,Ke=bn.lstr,Eo=bn.List,ze={atom_site:{auth_asym_id:M,auth_atom_id:M,auth_comp_id:M,auth_seq_id:V,B_iso_or_equiv:Be,Cartn_x:Zu,Cartn_y:Zu,Cartn_z:Zu,group_PDB:ue(M),id:V,label_alt_id:M,label_asym_id:M,label_atom_id:M,label_comp_id:M,label_entity_id:M,label_seq_id:V,occupancy:Be,type_symbol:M,pdbx_PDB_ins_code:M,pdbx_PDB_model_num:V,pdbx_formal_charge:V,pdbx_label_index:V,pdbx_sifts_xref_db_name:M,pdbx_sifts_xref_db_acc:M,pdbx_sifts_xref_db_num:M,pdbx_sifts_xref_db_res:M,ihm_model_id:V},atom_site_anisotrop:{id:V,type_symbol:M,U:$n(3,3),U_esd:$n(3,3),pdbx_auth_seq_id:M,pdbx_auth_asym_id:M,pdbx_auth_atom_id:M,pdbx_auth_comp_id:M,pdbx_label_seq_id:V,pdbx_label_alt_id:M,pdbx_label_asym_id:M,pdbx_label_atom_id:M,pdbx_label_comp_id:M,pdbx_PDB_ins_code:M},atom_sites:{entry_id:M,fract_transf_matrix:$n(3,3),fract_transf_vector:Ua(3)},audit_author:{name:M,pdbx_ordinal:V,identifier_ORCID:M},audit_conform:{dict_location:M,dict_name:M,dict_version:M},cell:{angle_alpha:Be,angle_beta:Be,angle_gamma:Be,entry_id:M,length_a:Be,length_b:Be,length_c:Be,Z_PDB:V,pdbx_unique_axis:M},chem_comp:{formula:M,formula_weight:Be,id:M,mon_nstd_flag:ue(Ke),name:M,type:ue(Ke),pdbx_synonyms:Eo(";",e=>e)},chem_comp_bond:{atom_id_1:M,atom_id_2:M,comp_id:M,value_order:ue(Ke),pdbx_ordinal:V,pdbx_stereo_config:ue(Ke),pdbx_aromatic_flag:ue(Ke)},citation:{book_publisher:M,country:M,id:M,journal_abbrev:M,journal_id_ASTM:M,journal_id_CSD:M,journal_id_ISSN:M,journal_volume:M,page_first:M,page_last:M,title:M,year:V,pdbx_database_id_DOI:M,pdbx_database_id_PubMed:V},citation_author:{citation_id:M,name:M,ordinal:V},database_2:{database_id:ue(Ke),database_code:M},entity:{details:M,formula_weight:Be,id:M,src_method:ue(Ke),type:ue(Ke),pdbx_description:Eo(",",e=>e),pdbx_number_of_molecules:V,pdbx_mutation:M,pdbx_fragment:M,pdbx_ec:Eo(",",e=>e)},entity_poly:{entity_id:M,nstd_linkage:ue(Ke),nstd_monomer:ue(Ke),type:ue(M),pdbx_strand_id:Eo(",",e=>e),pdbx_seq_one_letter_code:M,pdbx_seq_one_letter_code_can:M,pdbx_target_identifier:M},entity_poly_seq:{entity_id:M,hetero:ue(Ke),mon_id:M,num:V},entry:{id:M},exptl:{entry_id:M,method:ue(M)},software:{classification:M,date:M,description:M,name:M,type:ue(Ke),version:M,pdbx_ordinal:V},struct:{entry_id:M,title:M,pdbx_descriptor:M},struct_asym:{details:M,entity_id:M,id:M,pdbx_modified:M,pdbx_blank_PDB_chainid_flag:ue(M)},struct_conf:{beg_label_asym_id:M,beg_label_comp_id:M,beg_label_seq_id:V,beg_auth_asym_id:M,beg_auth_comp_id:M,beg_auth_seq_id:V,conf_type_id:ue(Ke),details:M,end_label_asym_id:M,end_label_comp_id:M,end_label_seq_id:V,end_auth_asym_id:M,end_auth_comp_id:M,end_auth_seq_id:V,id:M,pdbx_beg_PDB_ins_code:M,pdbx_end_PDB_ins_code:M,pdbx_PDB_helix_class:M,pdbx_PDB_helix_length:V,pdbx_PDB_helix_id:M},struct_conn:{conn_type_id:ue(Ke),details:M,id:M,ptnr1_label_asym_id:M,ptnr1_label_atom_id:M,ptnr1_label_comp_id:M,ptnr1_label_seq_id:V,ptnr1_auth_asym_id:M,ptnr1_auth_comp_id:M,ptnr1_auth_seq_id:V,ptnr1_symmetry:M,ptnr2_label_asym_id:M,ptnr2_label_atom_id:M,ptnr2_label_comp_id:M,ptnr2_label_seq_id:V,ptnr2_auth_asym_id:M,ptnr2_auth_comp_id:M,ptnr2_auth_seq_id:V,ptnr2_symmetry:M,pdbx_ptnr1_PDB_ins_code:M,pdbx_ptnr1_label_alt_id:M,pdbx_ptnr1_standard_comp_id:M,pdbx_ptnr2_PDB_ins_code:M,pdbx_ptnr2_label_alt_id:M,pdbx_ptnr3_PDB_ins_code:M,pdbx_ptnr3_label_alt_id:M,pdbx_ptnr3_label_asym_id:M,pdbx_ptnr3_label_atom_id:M,pdbx_ptnr3_label_comp_id:M,pdbx_ptnr3_label_seq_id:V,pdbx_PDB_id:M,pdbx_dist_value:Be,pdbx_value_order:ue(Ke)},struct_conn_type:{criteria:M,id:ue(Ke),reference:M},struct_keywords:{entry_id:M,text:Eo(",",e=>e),pdbx_keywords:M},struct_ncs_oper:{code:ue(M),details:M,id:V,matrix:$n(3,3),vector:Ua(3)},struct_sheet_range:{beg_label_asym_id:M,beg_label_comp_id:M,beg_label_seq_id:V,end_label_asym_id:M,end_label_comp_id:M,end_label_seq_id:V,beg_auth_asym_id:M,beg_auth_comp_id:M,beg_auth_seq_id:V,end_auth_asym_id:M,end_auth_comp_id:M,end_auth_seq_id:V,id:M,sheet_id:M,pdbx_beg_PDB_ins_code:M,pdbx_end_PDB_ins_code:M},struct_site:{details:M,id:M,pdbx_num_residues:V,pdbx_evidence_code:M,pdbx_auth_asym_id:M,pdbx_auth_comp_id:M,pdbx_auth_seq_id:M,pdbx_auth_ins_code:M},struct_site_gen:{details:M,id:M,label_alt_id:M,label_asym_id:M,label_atom_id:M,label_comp_id:M,label_seq_id:V,auth_asym_id:M,auth_comp_id:M,auth_seq_id:M,site_id:M,symmetry:M,pdbx_auth_ins_code:M,pdbx_num_res:V},symmetry:{entry_id:M,cell_setting:ue(Ke),Int_Tables_number:V,space_group_name_Hall:M,"space_group_name_H-M":M},pdbx_database_status:{status_code:ue(M),status_code_sf:ue(M),status_code_mr:ue(M),entry_id:M,recvd_initial_deposition_date:M,SG_entry:ue(Ke),deposit_site:ue(M),process_site:ue(M),status_code_cs:ue(M),methods_development_category:ue(M),pdb_format_compatible:ue(Ke)},pdbx_nonpoly_scheme:{asym_id:M,entity_id:M,mon_id:M,pdb_strand_id:M,ndb_seq_num:M,pdb_seq_num:M,auth_seq_num:M,pdb_mon_id:M,auth_mon_id:M,pdb_ins_code:M},pdbx_database_related:{db_name:M,details:M,db_id:M,content_type:ue(M)},pdbx_entity_nonpoly:{entity_id:M,comp_id:M,name:M},pdbx_chem_comp_synonyms:{name:M,comp_id:M,provenance:ue(M)},pdbx_chem_comp_identifier:{comp_id:M,identifier:M,type:ue(M),program:M,program_version:M},pdbx_unobs_or_zero_occ_residues:{id:V,polymer_flag:ue(Ke),occupancy_flag:ue(V),PDB_model_num:V,auth_asym_id:M,auth_comp_id:M,auth_seq_id:M,PDB_ins_code:M,label_asym_id:M,label_comp_id:M,label_seq_id:V},pdbx_struct_mod_residue:{id:V,auth_asym_id:M,auth_comp_id:M,auth_seq_id:V,PDB_ins_code:M,label_asym_id:M,label_comp_id:M,label_seq_id:V,parent_comp_id:M,details:M},pdbx_struct_oper_list:{id:M,type:ue(M),name:M,symmetry_operation:M,matrix:$n(3,3),vector:Ua(3)},pdbx_struct_assembly:{method_details:M,oligomeric_details:M,oligomeric_count:V,details:M,id:M},pdbx_struct_assembly_gen:{asym_id_list:Eo(",",e=>e),assembly_id:M,oper_expression:M},pdbx_reference_entity_list:{prd_id:M,ref_entity_id:M,type:ue(Ke),details:M,component_id:V},pdbx_reference_entity_link:{link_id:V,prd_id:M,details:M,ref_entity_id_1:M,ref_entity_id_2:M,entity_seq_num_1:V,entity_seq_num_2:V,comp_id_1:M,comp_id_2:M,atom_id_1:M,atom_id_2:M,value_order:ue(Ke),component_1:V,component_2:V,link_class:ue(M)},pdbx_reference_entity_poly_link:{link_id:V,prd_id:M,ref_entity_id:M,component_id:V,entity_seq_num_1:V,entity_seq_num_2:V,comp_id_1:M,comp_id_2:M,atom_id_1:M,atom_id_2:M,value_order:ue(Ke)},pdbx_molecule:{prd_id:M,instance_id:V,asym_id:M},pdbx_molecule_features:{prd_id:M,class:ue(Ke),type:ue(Ke),name:M,details:M},entity_src_nat:{entity_id:M,pdbx_organism_scientific:M,pdbx_plasmid_name:M,pdbx_src_id:V,pdbx_beg_seq_num:V,pdbx_end_seq_num:V},entity_src_gen:{entity_id:M,pdbx_gene_src_gene:Eo(",",e=>e),pdbx_gene_src_scientific_name:M,plasmid_name:M,pdbx_src_id:V,pdbx_beg_seq_num:V,pdbx_end_seq_num:V},pdbx_entity_src_syn:{organism_scientific:M,entity_id:M,pdbx_src_id:V,pdbx_beg_seq_num:V,pdbx_end_seq_num:V},pdbx_entity_branch_descriptor:{entity_id:M,descriptor:M,type:ue(Ke),program:M,program_version:M,ordinal:V},pdbx_entity_instance_feature:{details:M,feature_type:ue(M),auth_asym_id:M,asym_id:M,auth_seq_num:M,seq_num:V,comp_id:M,auth_comp_id:M,ordinal:V},pdbx_entity_branch_list:{entity_id:M,hetero:ue(Ke),comp_id:M,num:V},pdbx_entity_branch_link:{link_id:V,details:M,entity_id:M,entity_branch_list_num_1:V,entity_branch_list_num_2:V,comp_id_1:M,comp_id_2:M,atom_id_1:M,leaving_atom_id_1:M,atom_stereo_config_1:ue(Ke),atom_id_2:M,leaving_atom_id_2:M,atom_stereo_config_2:ue(Ke),value_order:ue(Ke)},pdbx_entity_branch:{entity_id:M,type:ue(M)},pdbx_branch_scheme:{entity_id:M,hetero:ue(Ke),asym_id:M,mon_id:M,num:V,pdb_asym_id:M,pdb_seq_num:M,pdb_mon_id:M,auth_asym_id:M,auth_seq_num:M,auth_mon_id:M},pdbx_chem_comp_related:{comp_id:M,related_comp_id:M,relationship_type:ue(M),details:M},ihm_starting_model_details:{starting_model_id:M,entity_id:M,entity_description:M,asym_id:M,entity_poly_segment_id:V,starting_model_source:ue(M),starting_model_auth_asym_id:M,starting_model_sequence_offset:V,dataset_list_id:V},ihm_starting_comparative_models:{id:V,starting_model_id:M,starting_model_auth_asym_id:M,starting_model_seq_id_begin:V,starting_model_seq_id_end:V,template_auth_asym_id:M,template_seq_id_begin:V,template_seq_id_end:V,template_sequence_identity:Be,template_sequence_identity_denominator:ue(V),template_dataset_list_id:V,alignment_file_id:V},ihm_starting_model_seq_dif:{id:V,entity_id:M,asym_id:M,seq_id:V,comp_id:M,starting_model_id:M,db_asym_id:M,db_seq_id:V,db_comp_id:M,details:M},ihm_model_representation:{id:V,name:M,details:M},ihm_model_representation_details:{id:V,representation_id:V,entity_poly_segment_id:V,entity_id:M,entity_description:M,entity_asym_id:M,model_object_primitive:ue(M),starting_model_id:M,model_mode:ue(M),model_granularity:ue(M),model_object_count:V},ihm_struct_assembly_details:{id:V,assembly_id:V,parent_assembly_id:V,entity_description:M,entity_id:M,asym_id:M,entity_poly_segment_id:V},ihm_struct_assembly:{id:V,name:M,description:M},ihm_modeling_protocol:{id:V,num_steps:V,protocol_name:M},ihm_modeling_protocol_details:{id:V,protocol_id:V,step_id:V,struct_assembly_id:V,dataset_group_id:V,struct_assembly_description:M,step_name:M,step_method:M,num_models_begin:V,num_models_end:V,multi_scale_flag:ue(Ke),multi_state_flag:ue(Ke),ordered_flag:ue(Ke),script_file_id:V,software_id:V},ihm_multi_state_modeling:{state_id:V,state_group_id:V,population_fraction:Be,population_fraction_sd:Be,state_type:M,state_name:M,experiment_type:ue(M),details:M},ihm_modeling_post_process:{id:V,protocol_id:V,analysis_id:V,step_id:V,type:ue(M),feature:ue(M),num_models_begin:V,num_models_end:V},ihm_ensemble_info:{ensemble_id:V,ensemble_name:M,post_process_id:V,model_group_id:V,ensemble_clustering_method:ue(M),ensemble_clustering_feature:ue(M),num_ensemble_models:V,num_ensemble_models_deposited:V,ensemble_precision_value:Be,ensemble_file_id:V},ihm_model_list:{model_id:V,model_name:M,assembly_id:V,protocol_id:V,representation_id:V},ihm_model_group:{id:V,name:M,details:M},ihm_model_group_link:{model_id:V,group_id:V},ihm_model_representative:{id:V,model_group_id:V,model_id:V,selection_criteria:ue(M)},ihm_dataset_list:{id:V,data_type:ue(M),database_hosted:ue(Ke)},ihm_dataset_group:{id:V,name:M,application:ue(M),details:M},ihm_dataset_group_link:{dataset_list_id:V,group_id:V},ihm_related_datasets:{dataset_list_id_derived:V,dataset_list_id_primary:V},ihm_dataset_related_db_reference:{id:V,dataset_list_id:V,db_name:ue(M),accession_code:M,version:M,details:M},ihm_external_reference_info:{reference_id:V,reference_provider:M,reference_type:ue(M),reference:M,refers_to:ue(M),associated_url:M},ihm_external_files:{id:V,reference_id:V,file_path:M,content_type:ue(M),file_size_bytes:Be,details:M},ihm_dataset_external_reference:{id:V,dataset_list_id:V,file_id:V},ihm_localization_density_files:{id:V,file_id:V,ensemble_id:V,entity_id:M,entity_poly_segment_id:V,asym_id:M},ihm_predicted_contact_restraint:{id:V,group_id:V,entity_id_1:M,entity_id_2:M,asym_id_1:M,asym_id_2:M,comp_id_1:M,comp_id_2:M,seq_id_1:V,seq_id_2:V,rep_atom_1:ue(M),rep_atom_2:ue(M),distance_lower_limit:Be,distance_upper_limit:Be,probability:Be,restraint_type:ue(M),model_granularity:ue(M),dataset_list_id:V,software_id:V},ihm_cross_link_list:{id:V,group_id:V,entity_description_1:M,entity_description_2:M,entity_id_1:M,entity_id_2:M,comp_id_1:M,comp_id_2:M,seq_id_1:V,seq_id_2:V,linker_type:ue(M),dataset_list_id:V},ihm_cross_link_restraint:{id:V,group_id:V,entity_id_1:M,entity_id_2:M,asym_id_1:M,asym_id_2:M,comp_id_1:M,comp_id_2:M,seq_id_1:V,seq_id_2:V,atom_id_1:M,atom_id_2:M,restraint_type:ue(M),conditional_crosslink_flag:ue(M),model_granularity:ue(M),distance_threshold:Be,psi:Be,sigma_1:Be,sigma_2:Be},ihm_cross_link_result_parameters:{id:V,restraint_id:V,model_id:V,psi:Be,sigma_1:Be,sigma_2:Be},ihm_2dem_class_average_restraint:{id:V,dataset_list_id:V,number_raw_micrographs:V,pixel_size_width:Be,pixel_size_height:Be,image_resolution:Be,image_segment_flag:ue(Ke),number_of_projections:V,struct_assembly_id:V,details:M},ihm_2dem_class_average_fitting:{id:V,restraint_id:V,model_id:V,cross_correlation_coefficient:Be,rot_matrix:$n(3,3),tr_vector:Ua(3)},ihm_3dem_restraint:{id:V,dataset_list_id:V,model_id:V,struct_assembly_id:V,fitting_method:M,number_of_gaussians:V,cross_correlation_coefficient:Be},ihm_sas_restraint:{id:V,dataset_list_id:V,model_id:V,struct_assembly_id:V,profile_segment_flag:ue(Ke),fitting_atom_type:M,fitting_method:M,fitting_state:ue(M),radius_of_gyration:Be,chi_value:Be,details:M},ihm_starting_model_coord:{ordinal_id:V,starting_model_id:M,group_PDB:ue(M),id:V,type_symbol:M,entity_id:M,atom_id:M,comp_id:M,seq_id:V,asym_id:M,Cartn_x:Be,Cartn_y:Be,Cartn_z:Be,B_iso_or_equiv:Be},ihm_sphere_obj_site:{id:V,entity_id:M,seq_id_begin:V,seq_id_end:V,asym_id:M,Cartn_x:Be,Cartn_y:Be,Cartn_z:Be,object_radius:Be,rmsf:Be,model_id:V},ihm_gaussian_obj_site:{id:V,entity_id:M,seq_id_begin:V,seq_id_end:V,asym_id:M,mean_Cartn_x:Be,mean_Cartn_y:Be,mean_Cartn_z:Be,weight:Be,covariance_matrix:$n(3,3),model_id:V},ihm_gaussian_obj_ensemble:{id:V,entity_id:M,seq_id_begin:V,seq_id_end:V,asym_id:M,mean_Cartn_x:Be,mean_Cartn_y:Be,mean_Cartn_z:Be,weight:Be,covariance_matrix:$n(3,3),ensemble_id:V},ihm_feature_list:{feature_id:V,feature_type:ue(M),entity_type:ue(M)},ihm_poly_residue_feature:{ordinal_id:V,feature_id:V,entity_id:M,asym_id:M,comp_id_begin:M,comp_id_end:M,seq_id_begin:V,seq_id_end:V},ihm_derived_distance_restraint:{id:V,group_id:V,feature_id_1:V,feature_id_2:V,group_conditionality:ue(M),random_exclusion_fraction:Be,distance_upper_limit:Be,restraint_type:ue(M),dataset_list_id:V},ma_model_list:{ordinal_id:V,model_id:V,model_group_id:V,model_name:M,model_group_name:M,model_type:ue(M),data_id:V},ma_target_entity:{entity_id:M,data_id:V,origin:ue(M)},ma_target_entity_instance:{asym_id:M,entity_id:M,details:M},ma_target_ref_db_details:{target_entity_id:M,db_name:ue(M),db_code:M,db_accession:M,seq_db_isoform:M,seq_db_align_begin:M,seq_db_align_end:M,ncbi_taxonomy_id:M,organism_scientific:M},ma_data:{id:V,content_type:ue(M),content_type_other_details:M,name:M},ma_software_group:{ordinal_id:V,group_id:V,software_id:V},ma_qa_metric:{id:V,name:M,type:ue(M),mode:ue(M),software_group_id:V},ma_qa_metric_global:{ordinal_id:V,model_id:V,metric_id:V,metric_value:Be},ma_qa_metric_local:{ordinal_id:V,model_id:V,label_asym_id:M,label_seq_id:V,label_comp_id:M,metric_id:V,metric_value:Be}};var La={parseBinary:Wd,schema:{mmCIF:e=>Fa(ze,e)}};var Bo=class{constructor(){this._list=[];this._set=new Set;this._refs=new Map}get all(){return this._list}add(t){this._set.has(t)||(this._list.push(t),this._set.add(t))}reference(t,r){let n=this._refs.get(t)||0;n+=r?1:-1,this._refs.set(t,Math.max(n,0))}has(t){return this._set.has(t)}dispose(){}};function Va(e,t,r){let n=new Float32Array(e);for(let o=0;o<n.length;o++)n[o]=t+r*o;return n}var Tt;(m=>{m.DefaultName="1_555",m.Default=n(m.DefaultName,re.identity()),m.RotationTranslationEpsilon=.005;function n(c,l,d){let{assembly:y,ncsId:S,hkl:x,spgrOp:g}=d||{},h=x?p.clone(x):p();g=Jt(g,-1),S=S||-1;let f=re.isIdentity(l),C=a(d,f);return f?{name:c,assembly:y,matrix:l,inverse:re.identity(),isIdentity:!0,hkl:h,spgrOp:g,ncsId:S,suffix:C}:{name:c,assembly:y,matrix:l,inverse:re.invert(re(),l),isIdentity:!1,hkl:h,spgrOp:g,ncsId:S,suffix:C}}m.create=n;function o(c){return!!c&&!!c.matrix&&!!c.inverse&&typeof c.name=="string"}function a(c,l){if(!c)return"";if(c.assembly)return o(c)?c.suffix:l?"":`_${c.assembly.operId}`;if(typeof c.spgrOp<"u"&&typeof c.hkl<"u"&&c.spgrOp!==-1){let[d,y,S]=c.hkl;return`-${c.spgrOp+1}_${5+d}${5+y}${5+S}`}return c.ncsId!==-1?`_${c.ncsId}`:""}function i(c,l){let d=re.mul(re(),l.matrix,c.matrix);return n(l.name,d,l)}m.compose=i;function s(c,l,d){let y=m.createCoordinateMapper(m.Default,l),S=c.isIdentity?y:m.createCoordinateMapper(c,l),{x,y:g,z:h}=kg(c,l);return{operator:c,coordinates:l,invariantPosition:y,position:S,x,y:g,z:h,r:d||Vg}}m.createMapping=s;function u(c,l){return c.isIdentity?Og(l):Hg(c,l)}m.createCoordinateMapper=u})(Tt||(Tt={}));function Vg(e){return 0}function kg(e,t){return e.isIdentity?{x:Wu(t.x),y:Wu(t.y),z:Wu(t.z)}:{x:Gg(e,t),y:wg(e,t),z:Ng(e,t)}}function Wu(e){return function(r){return e[r]}}function ka(e){return e[3]===0&&e[7]===0&&e[11]===0&&e[15]===1}function Gg({matrix:e},{x:t,y:r,z:n}){let o=e[0],a=e[4],i=e[8],s=e[12];return ka(e)?function(m){return o*t[m]+a*r[m]+i*n[m]+s}:function(m){let c=t[m],l=r[m],d=n[m],y=e[3]*c+e[7]*l+e[11]*d+e[15]||1;return(o*c+a*l+i*d+s)/y}}function wg({matrix:e},{x:t,y:r,z:n}){let o=e[1],a=e[5],i=e[9],s=e[13];return ka(e)?function(m){return o*t[m]+a*r[m]+i*n[m]+s}:function(m){let c=t[m],l=r[m],d=n[m],y=e[3]*c+e[7]*l+e[11]*d+e[15]||1;return(o*c+a*l+i*d+s)/y}}function Ng({matrix:e},{x:t,y:r,z:n}){let o=e[2],a=e[6],i=e[10],s=e[14];return ka(e)?function(m){return o*t[m]+a*r[m]+i*n[m]+s}:function(m){let c=t[m],l=r[m],d=n[m],y=e[3]*c+e[7]*l+e[11]*d+e[15]||1;return(o*c+a*l+i*d+s)/y}}function Og({x:e,y:t,z:r}){return function(o,a){return a[0]=e[o],a[1]=t[o],a[2]=r[o],a}}function Hg({matrix:e},{x:t,y:r,z:n}){return ka(e)?function(a,i){let s=t[a],u=r[a],m=n[a];return i[0]=e[0]*s+e[4]*u+e[8]*m+e[12],i[1]=e[1]*s+e[5]*u+e[9]*m+e[13],i[2]=e[2]*s+e[6]*u+e[10]*m+e[14],i}:function(a,i){return i[0]=t[a],i[1]=r[a],i[2]=n[a],p.transformMat4(i,i,e),i}}var Ga=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[-1,0,0,0],[0,-1,0,0],[0,0,-1,0],[0,1,0,.5],[1,0,0,.5],[-1,0,0,.5],[0,0,1,.5],[0,-1,0,.5],[0,0,-1,.5],[1,0,0,.25],[0,-1,0,.25],[0,0,1,.25],[-1,0,0,.25],[0,1,0,.25],[0,-1,0,.75],[0,0,1,.75],[0,1,0,.75],[1,0,0,.75],[-1,0,0,.75],[0,0,-1,.25],[0,0,-1,.75],[1,-1,0,0],[-1,1,0,0],[0,0,1,.3333333333333333],[0,0,1,.6666666666666666],[1,0,0,.6666666666666666],[0,1,0,.3333333333333333],[0,-1,0,.6666666666666666],[1,-1,0,.3333333333333333],[-1,1,0,.6666666666666666],[-1,0,0,.3333333333333333],[1,0,0,.3333333333333333],[0,1,0,.6666666666666666],[0,-1,0,.3333333333333333],[1,-1,0,.6666666666666666],[-1,1,0,.3333333333333333],[-1,0,0,.6666666666666666],[0,0,-1,.3333333333333333],[0,0,-1,.6666666666666666],[0,0,1,.8333333333333334],[0,0,1,.16666666666666666],[0,0,-1,.8333333333333334],[0,0,-1,.16666666666666666]],rp=[[0,1,2],[3,4,5],[3,1,5],[3,6,5],[7,6,2],[8,6,5],[0,4,2],[0,4,9],[7,10,2],[7,10,9],[0,10,2],[8,10,5],[3,1,11],[3,6,11],[0,10,9],[8,6,11],[3,4,2],[0,4,5],[3,4,9],[7,10,5],[8,4,9],[8,10,9],[8,10,2],[0,6,9],[3,10,9],[0,10,11],[7,1,9],[8,1,11],[7,4,11],[7,6,9],[7,10,11],[3,10,2],[8,1,5],[0,4,11],[3,1,2],[3,1,9],[7,4,2],[8,1,2],[8,1,9],[3,6,9],[7,4,9],[8,6,2],[8,6,9],[3,6,2],[12,13,14],[15,16,14],[12,17,18],[15,19,18],[20,13,18],[21,16,18],[20,17,14],[21,19,14],[0,1,5],[8,10,11],[7,6,11],[7,6,5],[8,4,2],[7,4,5],[7,1,5],[7,1,11],[0,10,5],[0,1,11],[0,6,11],[0,6,5],[3,10,11],[8,4,11],[15,13,22],[12,16,22],[15,17,23],[12,19,23],[21,13,23],[20,16,23],[21,17,22],[20,19,22],[4,0,2],[1,3,2],[4,0,14],[1,3,18],[4,0,9],[1,3,9],[4,0,18],[1,3,14],[10,7,9],[6,8,9],[4,7,14],[6,3,18],[10,0,18],[1,8,14],[1,3,5],[4,0,5],[6,8,11],[10,7,11],[1,3,11],[4,0,11],[10,7,2],[6,8,2],[3,10,22],[7,1,23],[8,4,23],[0,6,22],[1,0,5],[4,3,5],[1,0,23],[4,3,22],[10,7,14],[6,8,18],[8,6,22],[7,10,23],[4,3,11],[1,0,11],[1,0,22],[4,3,23],[10,7,18],[6,8,14],[8,6,23],[7,10,22],[6,7,11],[10,8,11],[8,1,23],[0,10,22],[3,6,22],[7,4,23],[4,3,2],[1,0,2],[10,8,2],[6,7,2],[4,3,9],[1,0,9],[10,8,9],[6,7,9],[4,8,14],[6,0,18],[10,3,18],[1,7,14],[4,8,18],[6,0,14],[10,3,14],[1,7,18],[6,7,5],[10,8,5],[6,8,5],[10,7,5],[8,1,22],[0,10,23],[3,6,23],[7,4,22],[4,24,2],[25,3,2],[4,24,26],[25,3,27],[4,24,27],[25,3,26],[28,29,26],[30,31,26],[32,33,26],[34,35,27],[36,37,27],[38,39,27],[2,0,1],[1,2,0],[1,25,5],[24,0,5],[39,36,40],[35,38,40],[37,34,40],[33,30,41],[29,32,41],[31,28,41],[5,3,4],[4,5,3],[25,1,5],[0,24,5],[24,4,5],[3,25,5],[4,3,41],[25,1,40],[24,4,41],[3,25,40],[4,3,40],[25,1,41],[24,4,40],[3,25,41],[35,34,40],[37,36,40],[39,38,40],[29,28,41],[31,30,41],[33,32,41],[3,5,4],[5,4,3],[25,1,2],[0,24,2],[24,4,2],[3,25,2],[25,1,9],[0,24,9],[24,4,9],[3,25,9],[30,33,26],[32,29,26],[28,31,26],[36,39,27],[38,35,27],[34,37,27],[0,2,1],[2,1,0],[30,33,42],[32,29,42],[28,31,42],[36,39,43],[38,35,43],[34,37,43],[7,9,6],[9,6,7],[25,1,11],[0,24,11],[24,4,11],[3,25,11],[35,34,44],[37,36,44],[39,38,44],[29,28,45],[31,30,45],[33,32,45],[8,11,10],[11,10,8],[1,25,2],[24,0,2],[1,25,42],[24,0,43],[1,25,43],[24,0,42],[1,25,27],[24,0,26],[1,25,26],[24,0,27],[1,25,9],[24,0,9],[4,24,5],[25,3,5],[4,24,11],[25,3,11],[1,0,40],[4,3,44],[0,24,45],[1,0,41],[4,3,45],[0,24,44],[0,24,40],[0,24,41],[2,3,4],[5,3,1],[5,0,4],[4,2,3],[1,5,3],[4,5,0],[2,7,6],[2,8,10],[5,8,6],[5,7,10],[1,9,7],[4,9,8],[1,11,8],[4,11,7],[9,0,6],[9,3,10],[11,3,6],[11,0,10],[6,2,7],[10,2,8],[6,5,8],[10,5,7],[9,7,1],[9,8,4],[11,8,1],[11,7,4],[6,9,0],[10,9,3],[6,11,3],[10,11,0],[9,7,6],[9,8,10],[11,8,6],[11,7,10],[6,9,7],[10,9,8],[6,11,8],[10,11,7],[2,3,10],[5,8,1],[11,0,4],[10,2,3],[1,5,8],[4,11,0],[5,0,1],[2,0,4],[2,3,1],[1,5,0],[4,2,0],[1,2,3],[11,8,10],[11,7,6],[9,7,10],[9,8,6],[10,11,8],[6,11,7],[10,9,7],[6,9,8],[5,8,10],[5,7,6],[2,7,10],[2,8,6],[4,11,8],[1,11,7],[4,9,7],[1,9,8],[11,3,10],[11,0,6],[9,0,10],[9,3,6],[10,5,8],[6,5,7],[10,2,7],[6,2,8],[11,8,4],[11,7,1],[9,7,4],[9,8,1],[10,11,3],[6,11,0],[10,9,0],[6,9,3],[22,15,13],[22,12,16],[14,12,13],[14,15,16],[13,22,15],[16,22,12],[13,14,12],[16,14,15],[22,21,17],[22,20,19],[14,20,17],[14,21,19],[13,23,21],[16,23,20],[13,18,20],[16,18,21],[23,15,17],[23,12,19],[18,12,17],[18,15,19],[17,22,21],[19,22,20],[17,14,20],[19,14,21],[23,21,13],[23,20,16],[18,20,13],[18,21,16],[17,23,15],[19,23,12],[17,18,12],[19,18,15],[5,0,6],[2,7,4],[9,3,1],[6,5,0],[4,2,7],[1,9,3],[0,2,4],[3,2,1],[0,5,1],[2,1,3],[2,4,0],[5,1,0],[7,9,10],[8,9,6],[7,11,6],[9,6,8],[9,10,7],[11,6,7],[1,7,11],[4,8,11],[1,8,9],[4,7,9],[0,9,10],[3,9,6],[3,11,10],[0,11,6],[2,6,8],[2,10,7],[5,6,7],[5,10,8],[6,0,11],[10,3,11],[6,3,9],[10,0,9],[7,2,10],[8,2,6],[8,5,10],[7,5,6],[9,1,8],[9,4,7],[11,1,7],[11,4,8],[7,9,4],[8,9,1],[8,11,4],[7,11,1],[9,6,3],[9,10,0],[11,6,0],[11,10,3],[19,12,23],[13,15,22],[16,21,18],[17,20,14],[20,14,17],[21,18,16],[15,22,13],[12,23,19],[18,16,21],[14,17,20],[23,19,12],[22,13,15],[19,20,22],[13,21,23],[16,15,14],[17,12,18],[20,18,13],[21,14,19],[15,23,17],[12,22,16],[18,19,15],[14,13,12],[23,16,20],[22,17,21],[16,12,22],[17,15,23],[19,21,14],[13,20,18],[12,14,13],[15,18,19],[21,22,17],[20,23,16],[14,16,15],[18,17,12],[22,19,20],[23,13,21],[16,20,23],[17,21,22],[19,15,18],[13,12,14],[12,18,17],[15,14,16],[21,23,13],[20,22,19],[14,19,21],[18,13,20],[22,16,12],[23,17,15],[19,12,22],[17,21,23],[16,15,18],[13,20,14],[20,14,13],[15,18,16],[21,23,17],[12,22,19],[18,16,15],[14,13,20],[22,19,12],[23,17,21],[3,2,4],[3,5,1],[0,5,4],[2,4,3],[5,1,3],[5,4,0],[1,7,9],[4,8,9],[1,8,11],[4,7,11],[0,9,6],[3,9,10],[3,11,6],[0,11,10],[2,6,7],[2,10,8],[5,6,8],[5,10,7],[6,0,9],[10,3,9],[6,3,11],[10,0,11],[7,2,6],[8,2,10],[8,5,6],[7,5,10],[9,1,7],[9,4,8],[11,1,8],[11,4,7],[7,9,1],[8,9,4],[8,11,1],[7,11,4],[9,6,0],[9,10,3],[11,6,3],[11,10,0],[8,9,10],[8,11,6],[7,11,10],[9,10,8],[11,6,8],[11,10,7],[6,0,2],[10,3,2],[6,3,5],[10,0,5],[7,2,1],[8,2,4],[8,5,1],[7,5,4],[9,1,0],[9,4,3],[11,1,3],[11,4,0],[1,7,2],[4,8,2],[1,8,5],[4,7,5],[0,9,1],[3,9,4],[3,11,1],[0,11,4],[2,6,0],[2,10,3],[5,6,3],[5,10,0],[0,2,6],[3,2,10],[3,5,6],[0,5,10],[2,1,7],[2,4,8],[5,1,8],[5,4,7],[16,12,14],[13,21,18],[19,15,23],[17,20,22],[12,14,16],[21,18,13],[15,23,19],[20,22,17],[14,16,12],[18,13,21],[23,19,15],[22,17,20],[19,20,18],[17,15,14],[16,21,22],[13,12,23],[20,18,19],[15,14,17],[21,22,16],[12,23,13],[18,19,20],[14,17,15],[22,16,21],[23,13,12],[6,0,5],[10,3,5],[6,3,2],[10,0,2],[7,2,4],[8,2,1],[8,5,4],[7,5,1],[9,1,3],[9,4,0],[11,1,0],[11,4,3],[1,7,5],[4,8,5],[1,8,2],[4,7,2],[0,9,4],[3,9,1],[3,11,4],[0,11,1],[2,6,3],[2,10,0],[5,6,0],[5,10,3],[0,2,10],[3,2,6],[3,5,10],[0,5,6],[2,1,8],[2,4,7],[5,1,7],[5,4,8],[21,17,23],[20,16,22],[12,13,18],[15,19,14],[23,21,17],[22,20,16],[18,12,13],[14,15,19],[17,23,21],[16,22,20],[13,18,12],[19,14,15],[21,13,22],[20,19,23],[12,17,14],[15,16,18],[23,15,13],[22,12,19],[18,20,17],[14,21,16],[17,22,15],[16,23,12],[13,14,20],[19,18,21],[15,17,22],[12,16,23],[20,13,14],[21,19,18],[22,21,13],[23,20,19],[14,12,17],[18,15,16],[13,23,15],[19,22,12],[17,18,20],[16,14,21],[15,13,23],[12,19,22],[20,17,18],[21,16,14],[22,15,17],[23,12,16],[14,20,13],[18,21,19],[13,22,21],[19,23,20],[17,14,12],[16,18,15],[6,5,3],[4,9,3],[9,3,4],[5,7,4],[4,5,7],[5,3,6]],np=[[0],[0,1],[0,2],[0,3],[0,2,4,5],[0,6],[0,7],[0,6,4,8],[0,7,4,9],[0,6,2,1],[0,3,1,10],[0,6,2,1,4,8,5,11],[0,12,1,7],[0,1,13,14],[0,12,1,7,4,15,11,9],[0,16,2,17],[0,18,12,17],[0,16,5,19],[0,20,13,19],[0,18,12,17,4,21,15,19],[0,16,2,17,4,22,5,19],[0,16,2,17,23,24,13,25,26,20,27,28,4,22,5,19],[0,16,17,2,29,21,30,15],[0,20,13,19,29,31,32,33],[0,16,6,34],[0,18,7,34],[0,16,7,35],[0,16,36,37],[0,18,36,38],[0,16,14,39],[0,20,40,34],[0,16,8,41],[0,18,8,42],[0,16,9,42],[0,16,6,34,4,22,8,41],[0,18,7,34,4,21,9,41],[0,16,7,35,4,22,9,42],[0,16,6,34,23,24,14,39],[0,16,10,43,23,24,7,35],[0,16,36,37,23,24,9,42],[0,16,8,41,23,24,40,38],[0,16,6,34,23,24,14,39,26,20,40,38,4,22,8,41],[0,16,44,45,23,24,46,47,26,20,48,49,4,22,50,51],[0,16,6,34,29,21,9,42],[0,16,8,41,29,21,7,35],[0,16,36,37,29,21,14,39],[0,16,2,17,1,52,6,34],[0,16,2,17,53,54,9,42],[0,16,12,33,1,52,7,35],[0,16,2,17,11,55,8,41],[0,56,2,57,1,58,6,37],[0,56,15,25,1,58,9,39],[0,20,27,17,1,59,40,34],[0,56,12,28,1,58,7,38],[0,16,5,19,1,52,8,41],[0,22,13,28,1,55,14,38],[0,18,13,60,1,61,14,43],[0,16,15,30,1,52,9,42],[0,16,5,19,11,55,6,34],[0,21,12,19,1,54,7,41],[0,20,13,19,1,59,14,41],[0,20,3,30,1,59,10,42],[0,18,12,17,1,61,7,34,4,21,15,19,11,54,9,41],[0,24,13,17,1,62,14,34,4,20,27,19,11,59,40,41],[0,16,2,17,1,52,6,34,4,22,5,19,11,55,8,41],[0,16,12,33,1,52,7,35,4,22,15,30,11,55,9,42],[0,31,3,17,1,63,10,34,4,56,32,19,11,58,36,41],[0,22,2,19,64,59,14,38,4,16,5,17,65,62,40,39],[0,16,2,17,1,52,6,34,23,24,13,25,64,62,14,39,26,20,27,28,65,59,40,38,4,22,5,19,11,55,8,41],[0,16,2,17,66,67,44,45,23,24,13,25,68,69,46,47,26,20,27,28,70,71,48,49,4,22,5,19,72,73,50,51],[0,16,2,17,1,52,6,34,29,21,15,30,53,54,9,42],[0,16,5,19,1,52,8,41,29,21,12,33,53,54,7,35],[0,20,13,19,1,59,14,41,29,31,32,33,53,63,36,35],[0,31,3,17,1,63,10,34,29,20,27,30,53,59,40,42],[0,16,74,75],[0,18,76,77],[0,16,78,79],[0,18,80,81],[0,16,74,75,29,21,82,83],[0,21,84,85,29,16,86,87],[0,16,88,89],[0,16,88,89,29,21,90,91],[0,16,74,75,1,52,88,89],[0,16,78,79,1,52,92,93],[0,16,94,95,11,55,88,89],[0,16,82,83,53,54,88,89],[0,16,74,75,1,52,88,89,29,21,82,83,53,54,90,91],[0,21,84,85,96,97,88,91,29,16,86,87,98,99,90,89],[0,16,74,75,2,17,100,101],[0,16,94,95,5,19,100,101],[0,18,76,77,2,33,102,103],[0,18,104,105,106,107,100,108],[0,16,78,79,2,17,109,108],[0,16,82,83,15,30,100,101],[0,18,80,81,2,33,110,111],[0,18,112,113,114,115,100,108],[0,16,74,75,2,17,100,101,29,21,82,83,15,30,116,117],[0,21,84,85,118,119,116,101,29,16,86,87,120,121,100,117],[0,16,74,75,6,34,122,123],[0,16,74,75,8,41,124,125],[0,16,78,79,7,35,122,123],[0,16,82,83,9,42,122,123],[0,16,74,75,7,35,126,127],[0,16,74,75,9,42,128,129],[0,16,78,79,6,34,126,127],[0,16,78,79,8,41,128,129],[0,16,74,75,6,34,122,123,29,21,82,83,9,42,128,129],[0,16,74,75,7,35,126,127,29,21,82,83,8,41,124,125],[0,21,84,85,6,42,130,131,29,16,86,87,9,34,132,133],[0,21,84,85,7,41,134,135,29,16,86,87,8,35,136,137],[0,16,89,88,2,17,122,123],[0,16,89,88,12,33,126,127],[0,16,89,88,5,19,124,125],[0,16,89,88,15,30,128,129],[0,16,88,89,6,34,100,101],[0,16,89,88,7,35,109,108],[0,16,89,88,8,41,138,139],[0,16,89,88,9,42,116,117],[0,16,89,88,6,34,100,101,29,21,91,90,9,42,116,117],[0,16,89,88,7,35,109,108,29,21,91,90,8,41,138,139],[0,16,89,88,2,17,122,123,29,21,91,90,15,30,128,129],[0,16,89,88,118,121,132,131,29,21,91,90,120,119,130,133],[0,16,74,75,2,17,100,101,1,52,88,89,6,34,122,123],[0,16,74,75,12,33,109,108,1,52,88,89,7,35,126,127],[0,16,74,75,2,17,100,101,11,55,140,141,8,41,124,125],[0,16,74,75,2,17,100,101,53,54,90,91,9,42,128,129],[0,16,74,75,5,19,138,139,1,52,88,89,8,41,124,125],[0,16,74,75,15,30,116,117,1,52,88,89,9,42,128,129],[0,16,94,95,5,19,100,101,11,55,88,89,6,34,124,125],[0,16,94,95,15,30,109,108,11,55,88,89,7,35,128,129],[0,16,78,79,2,17,109,108,1,52,92,93,6,34,126,127],[0,16,78,79,12,33,100,101,1,52,92,93,7,35,122,123],[0,16,82,83,12,33,138,139,53,54,88,89,8,41,126,127],[0,16,82,83,2,17,116,117,53,54,88,89,9,42,122,123],[0,16,78,79,5,19,116,117,1,52,92,93,8,41,128,129],[0,16,82,83,15,30,100,101,1,52,90,91,9,42,122,123],[0,16,82,83,15,30,100,101,53,54,88,89,6,34,128,129],[0,16,82,83,5,19,109,108,53,54,88,89,7,35,124,125],[0,16,74,75,2,17,100,101,1,52,88,89,6,34,122,123,29,21,82,83,15,30,116,117,53,54,90,91,9,42,128,129],[0,16,74,75,12,33,109,108,1,52,88,89,7,35,126,127,29,21,82,83,5,19,138,139,53,54,90,91,8,41,124,125],[0,21,84,85,118,119,116,101,96,97,88,91,9,34,132,133,29,16,86,87,120,121,100,117,98,99,90,89,6,42,130,131],[0,21,84,85,142,143,138,108,96,97,88,91,8,35,136,137,29,16,86,87,144,145,109,139,98,99,90,89,7,41,134,135],[0,146,147],[0,148,149],[0,150,151],[0,146,147,152,153,154,155,156,157],[0,158,159],[0,146,147,1,160,161],[0,146,147,1,160,161,152,153,154,162,163,164,155,156,157,165,166,167],[0,158,159,1,168,169],[0,146,147,101,170,171],[0,146,147,100,172,173],[0,148,149,174,175,171],[0,148,149,100,176,177],[0,150,151,178,179,171],[0,150,151,100,180,181],[0,146,147,100,172,173,152,153,154,182,183,184,155,156,157,185,186,187],[0,158,159,101,188,189],[0,146,147,122,190,191],[0,146,147,123,192,193],[0,146,147,126,194,195],[0,146,147,127,196,197],[0,146,147,122,190,191,152,153,154,198,199,200,155,156,157,201,202,203],[0,158,159,123,204,205],[0,146,147,126,194,195,152,153,154,206,207,208,155,156,157,209,210,211],[0,158,159,129,212,213],[0,146,147,101,170,171,1,160,161,123,192,193],[0,146,147,108,214,215,1,160,161,127,196,197],[0,146,147,100,172,173,1,160,161,122,190,191],[0,146,147,109,216,217,1,160,161,126,194,195],[0,146,147,100,172,173,1,160,161,122,190,191,152,153,154,182,183,184,162,163,164,198,199,200,155,156,157,185,186,187,165,166,167,201,202,203],[0,158,159,101,188,189,1,168,169,123,204,205],[0,146,147,109,216,217,1,160,161,126,194,195,152,153,154,218,219,220,162,163,164,206,207,208,155,156,157,221,222,223,165,166,167,209,210,211],[0,158,159,117,224,225,1,168,169,129,212,213],[0,146,147,16,226,227],[0,148,149,18,228,229],[0,150,151,18,230,231],[0,150,151,16,232,233],[0,148,149,16,234,235],[0,146,147,18,236,237],[0,146,147,52,238,239],[0,146,147,16,226,227,1,160,161,52,238,239],[0,146,147,18,236,237,1,160,161,61,240,241],[0,146,147,16,226,227,100,172,173,101,170,171],[0,148,149,18,228,229,242,172,181,243,214,244],[0,150,151,18,230,231,245,172,177,246,214,247],[0,150,151,16,232,233,245,172,177,174,170,248],[0,148,149,16,234,235,242,172,181,178,170,249],[0,146,147,18,236,237,100,172,173,108,214,215],[0,146,147,16,226,227,122,190,191,123,192,193],[0,146,147,16,226,227,126,194,195,127,196,197],[0,146,147,18,236,237,126,194,195,123,192,193],[0,146,147,18,236,237,122,190,191,127,196,197],[0,146,147,52,238,239,122,190,191,101,170,171],[0,146,147,61,240,241,126,194,195,101,170,171],[0,146,147,52,238,239,100,172,173,123,192,193],[0,146,147,61,240,241,100,172,173,127,196,197],[0,146,147,16,226,227,100,172,173,101,170,171,1,160,161,52,239,238,122,190,191,123,192,193],[0,146,147,16,226,227,109,216,217,108,214,215,1,160,161,52,239,238,126,194,195,127,196,197],[0,146,147,18,236,237,109,216,217,101,170,171,1,160,161,61,241,240,126,194,195,123,192,193],[0,146,147,18,236,237,100,172,173,108,214,215,1,160,161,61,241,240,122,190,191,127,196,197],[0,16,2,17,158,250,251,252,159,253,254,255],[0,16,2,17,158,250,251,252,159,253,254,255,23,24,13,25,256,257,258,259,260,261,262,263,26,20,27,28,264,265,266,267,268,269,270,271,4,22,5,19,272,273,274,275,276,277,278,279],[0,16,2,17,158,250,251,252,159,253,254,255,29,21,15,30,280,281,282,283,284,285,286,287],[0,20,13,19,158,273,266,259,159,261,278,271],[0,20,13,19,158,273,266,259,159,261,278,271,29,31,32,33,280,288,289,290,284,291,292,293],[0,16,2,17,158,250,251,252,159,253,254,255,1,52,6,34,168,294,295,296,169,297,298,299],[0,16,2,17,158,250,251,252,159,253,254,255,53,54,9,42,300,301,302,303,304,305,306,307],[0,16,2,17,158,250,251,252,159,253,254,255,1,52,6,34,168,294,295,296,169,297,298,299,23,24,13,25,256,257,258,259,260,261,262,263,64,62,14,39,308,309,310,311,312,313,314,315,26,20,27,28,264,265,266,267,268,269,270,271,65,59,40,38,316,317,318,319,320,321,322,323,4,22,5,19,272,273,274,275,276,277,278,279,11,55,8,41,324,325,326,327,328,329,330,331],[0,16,2,17,158,250,251,252,159,253,254,255,66,67,44,45,332,333,334,335,336,337,338,339,23,24,13,25,256,257,258,259,260,261,262,263,68,69,46,47,340,341,342,343,344,345,346,347,26,20,27,28,264,265,266,267,268,269,270,271,70,71,48,49,348,349,350,351,352,353,354,355,4,22,5,19,272,273,274,275,276,277,278,279,72,73,50,51,356,357,358,359,360,361,362,363],[0,16,2,17,158,250,251,252,159,253,254,255,1,52,6,34,168,294,295,296,169,297,298,299,29,21,15,30,280,281,282,283,284,285,286,287,53,54,9,42,300,301,302,303,304,305,306,307],[0,20,13,19,158,273,266,259,159,261,278,271,1,59,14,41,168,325,318,311,169,313,330,323],[0,20,13,19,158,273,266,259,159,261,278,271,1,59,14,41,168,325,318,311,169,313,330,323,29,31,32,33,280,288,289,290,284,291,292,293,53,63,36,35,300,364,365,366,304,367,368,369],[0,16,2,17,158,250,251,252,159,253,254,255,100,101,75,74,370,371,188,372,373,374,375,189],[0,16,2,17,158,250,251,252,159,253,254,255,116,117,83,82,376,377,224,378,379,380,381,225],[0,16,2,17,158,250,251,252,159,253,254,255,100,101,75,74,370,371,188,372,373,374,375,189,23,24,13,25,256,257,258,259,260,261,262,263,382,383,384,385,386,387,388,389,390,391,392,393,26,20,27,28,264,265,266,267,268,269,270,271,394,395,396,397,398,399,400,401,402,403,404,405,4,22,5,19,272,273,274,275,276,277,278,279,138,139,95,94,406,407,408,409,410,411,412,413],[0,24,5,28,158,265,258,275,159,277,270,263,414,415,416,417,418,419,420,421,422,423,424,425,23,16,27,19,256,273,251,267,260,269,278,255,426,427,428,429,430,431,432,433,434,435,436,437,26,22,13,17,264,250,274,259,268,261,254,279,438,439,440,441,442,443,444,445,446,447,448,449,4,20,2,25,272,257,266,252,276,253,262,271,450,451,452,453,454,455,456,457,458,459,460,461],[0,16,2,17,158,250,251,252,159,253,254,255,100,101,75,74,370,371,188,372,373,374,375,189,29,21,15,30,280,281,282,283,284,285,286,287,116,117,83,82,376,377,224,378,379,380,381,225],[0,20,13,19,158,273,266,259,159,261,278,271,450,415,440,429,454,431,420,445,458,447,436,425],[0,20,13,19,158,273,266,259,159,261,278,271,462,463,464,465,466,467,468,469,470,471,472,473],[0,20,13,19,158,273,266,259,159,261,278,271,462,463,464,465,466,467,468,469,470,471,472,473,29,31,32,33,280,288,289,290,284,291,292,293,450,415,440,429,454,431,420,445,458,447,436,425],[0,16,2,17,158,250,251,252,159,253,254,255,123,122,88,89,204,474,475,476,205,477,478,479],[0,16,2,17,158,250,251,252,159,253,254,255,123,122,88,89,204,474,475,476,205,477,478,479,23,24,13,25,256,257,258,259,260,261,262,263,480,481,482,483,484,485,486,487,488,489,490,491,26,20,27,28,264,265,266,267,268,269,270,271,492,493,494,495,496,497,498,499,500,501,502,503,4,22,5,19,272,273,274,275,276,277,278,279,125,124,140,141,504,505,506,507,508,509,510,511],[0,16,2,17,158,250,251,252,159,253,254,255,123,122,88,89,204,474,475,476,205,477,478,479,29,21,15,30,280,281,282,283,284,285,286,287,129,128,90,91,212,512,513,514,213,515,516,517],[0,16,2,17,158,250,251,252,159,253,254,255,129,128,90,91,212,512,513,514,213,515,516,517],[0,16,2,17,158,250,251,252,159,253,254,255,129,128,90,91,212,512,513,514,213,515,516,517,23,24,13,25,256,257,258,259,260,261,262,263,518,519,520,521,522,523,524,525,526,527,528,529,26,20,27,28,264,265,266,267,268,269,270,271,530,531,532,533,534,535,536,537,538,539,540,541,4,22,5,19,272,273,274,275,276,277,278,279,127,126,92,93,542,543,544,545,546,547,548,549],[0,20,13,19,158,273,266,259,159,261,278,271,550,551,552,553,554,555,556,557,558,559,560,561,29,31,32,33,280,288,289,290,284,291,292,293,562,563,564,565,566,567,568,569,570,571,572,573],[0,16,2,17,158,250,251,252,159,253,254,255,100,101,75,74,370,371,188,372,373,374,375,189,1,52,6,34,168,294,295,296,169,297,298,299,122,123,89,88,475,476,204,474,479,478,477,205],[0,16,2,17,158,250,251,252,159,253,254,255,100,101,75,74,370,371,188,372,373,374,375,189,53,54,9,42,300,301,302,303,304,305,306,307,128,129,91,90,513,514,212,512,517,516,515,213],[0,16,2,17,158,250,251,252,159,253,254,255,116,117,83,82,376,377,224,378,379,380,381,225,1,52,6,34,168,294,295,296,169,297,298,299,128,129,91,90,513,514,212,512,517,516,515,213],[0,16,2,17,158,250,251,252,159,253,254,255,116,117,83,82,376,377,224,378,379,380,381,225,53,54,9,42,300,301,302,303,304,305,306,307,122,123,89,88,475,476,204,474,479,478,477,205],[0,16,2,17,158,250,251,252,159,253,254,255,100,101,75,74,370,371,188,372,373,374,375,189,1,52,6,34,168,294,295,296,169,297,298,299,122,123,89,88,475,476,204,474,479,478,477,205,23,24,13,25,256,257,258,259,260,261,262,263,382,383,384,385,386,387,388,389,390,391,392,393,64,62,14,39,308,309,310,311,312,313,314,315,481,480,483,482,486,487,484,485,491,490,489,488,26,20,27,28,264,265,266,267,268,269,270,271,394,395,396,397,398,399,400,401,402,403,404,405,65,59,40,38,316,317,318,319,320,321,322,323,493,492,495,494,498,499,496,497,503,502,501,500,4,22,5,19,272,273,274,275,276,277,278,279,138,139,95,94,406,407,408,409,410,411,412,413,11,55,8,41,324,325,326,327,328,329,330,331,124,125,141,140,506,507,504,505,511,510,509,508],[0,16,2,17,158,250,251,252,159,253,254,255,116,117,83,82,376,377,224,378,379,380,381,225,1,52,6,34,168,294,295,296,169,297,298,299,128,129,91,90,513,514,212,512,517,516,515,213,23,24,13,25,256,257,258,259,260,261,262,263,574,575,576,577,578,579,580,581,582,583,584,585,64,62,14,39,308,309,310,311,312,313,314,315,519,518,521,520,524,525,522,523,529,528,527,526,26,20,27,28,264,265,266,267,268,269,270,271,586,587,588,589,590,591,592,593,594,595,596,597,65,59,40,38,316,317,318,319,320,321,322,323,531,530,533,532,536,537,534,535,541,540,539,538,4,22,5,19,272,273,274,275,276,277,278,279,109,108,79,78,598,599,600,601,602,603,604,605,11,55,8,41,324,325,326,327,328,329,330,331,126,127,93,92,544,545,542,543,549,548,547,546],[0,24,5,28,158,265,258,275,159,277,270,263,414,415,416,417,418,419,420,421,422,423,424,425,66,69,50,49,332,349,342,359,336,361,354,347,493,123,483,140,498,507,204,485,503,490,509,205,23,16,27,19,256,273,251,267,260,269,278,255,426,427,428,429,430,431,432,433,434,435,436,437,68,67,48,51,340,357,334,351,344,353,362,339,124,480,89,494,506,499,484,474,511,478,501,488,26,22,13,17,264,250,274,259,268,261,254,279,438,439,440,441,442,443,444,445,446,447,448,449,70,73,46,45,348,333,358,343,352,345,338,363,122,492,141,482,475,487,496,505,479,510,489,500,4,20,2,25,272,257,266,252,276,253,262,271,450,451,452,453,454,455,456,457,458,459,460,461,72,71,44,47,356,341,350,335,360,337,346,355,481,125,495,88,486,476,504,497,491,502,477,508],[0,24,5,28,158,265,258,275,159,277,270,263,414,415,416,417,418,419,420,421,422,423,424,425,606,607,608,609,610,611,612,613,614,615,616,617,531,129,521,92,536,545,212,523,541,528,547,213,23,16,27,19,256,273,251,267,260,269,278,255,426,427,428,429,430,431,432,433,434,435,436,437,618,619,620,621,622,623,624,625,626,627,628,629,126,518,91,532,544,537,522,512,549,516,539,526,26,22,13,17,264,250,274,259,268,261,254,279,438,439,440,441,442,443,444,445,446,447,448,449,630,631,632,633,634,635,636,637,638,639,640,641,128,530,93,520,513,525,534,543,517,548,527,538,4,20,2,25,272,257,266,252,276,253,262,271,450,451,452,453,454,455,456,457,458,459,460,461,642,643,644,645,646,647,648,649,650,651,652,653,519,127,533,90,524,514,542,535,529,540,515,546],[0,16,2,17,158,250,251,252,159,253,254,255,100,101,75,74,370,371,188,372,373,374,375,189,1,52,6,34,168,294,295,296,169,297,298,299,122,123,89,88,475,476,204,474,479,478,477,205,29,21,15,30,280,281,282,283,284,285,286,287,116,117,83,82,376,377,224,378,379,380,381,225,53,54,9,42,300,301,302,303,304,305,306,307,128,129,91,90,513,514,212,512,517,516,515,213],[0,20,13,19,158,273,266,259,159,261,278,271,462,463,464,465,466,467,468,469,470,471,472,473,1,59,14,41,168,325,318,311,169,313,330,323,551,550,553,552,556,557,554,555,561,560,559,558,29,31,32,33,280,288,289,290,284,291,292,293,450,415,440,429,454,431,420,445,458,447,436,425,53,63,36,35,300,364,365,366,304,367,368,369,563,562,565,564,568,569,566,567,573,572,571,570],[0,16],[0,18],[0,16,26,20],[0,2,23,13],[0,3,4,32],[0,2,29,15],[0,3,29,27],[0,52],[0,63],[0,52,26,59],[0,63,26,54],[0,52,16,1],[0,18,1,61],[0,52,16,1,26,59,20,65],[0,31,1,63],[0,1,24,62],[0,15,1,9],[0,5,1,8],[0,31,1,63,26,21,65,54],[0,2,57,56],[0,60,3,16],[0,22,57,3],[0,2,28,20],[0,17,13,24],[0,20,19,13,4,24,17,27],[0,22,57,3,4,16,60,32],[0,22,57,3,23,20,30,12,26,24,33,15,4,16,60,32],[0,22,57,3,29,18,27,25],[0,22,3,57,1,55,10,37],[0,22,385,396,3,57,109,117],[0,22,57,3,159,279,654,655,158,274,656,657,29,18,25,27,284,658,262,269,280,659,257,267]],qi={"P 1":0,"P -1":1,"P 1 2 1":2,"P 1 21 1":3,"C 1 2 1":4,"P 1 m 1":5,"P 1 c 1":6,"C 1 m 1":7,"C 1 c 1":8,"P 1 2/m 1":9,"P 1 21/m 1":10,"C 1 2/m 1":11,"P 1 2/c 1":12,"P 1 21/c 1":13,"C 1 2/c 1":14,"P 2 2 2":15,"P 2 2 21":16,"P 21 21 2":17,"P 21 21 21":18,"C 2 2 21":19,"C 2 2 2":20,"F 2 2 2":21,"I 2 2 2":22,"I 21 21 21":23,"P m m 2":24,"P m c 21":25,"P c c 2":26,"P m a 2":27,"P c a 21":28,"P n c 2":29,"P m n 21":30,"P b a 2":31,"P n a 21":32,"P n n 2":33,"C m m 2":34,"C m c 21":35,"C c c 2":36,"A m m 2":37,"A b m 2":38,"A m a 2":39,"A b a 2":40,"F m m 2":41,"F d d 2":42,"I m m 2":43,"I b a 2":44,"I m a 2":45,"P 2/m 2/m 2/m":46,"P m m m":46,"P 2/n 2/n 2/n":47,"P n n n":47,"P 2/c 2/c 2/m":48,"P c c m":48,"P 2/b 2/a 2/n":49,"P b a n":49,"P 21/m 2/m 2/a":50,"P m m a":50,"P 2/n 21/n 2/a":51,"P n n a":51,"P 2/m 2/n 21/a":52,"P m n a":52,"P 21/c 2/c 2/a":53,"P c c a":53,"P 21/b 21/a 2/m":54,"P b a m":54,"P 21/c 21/c 2/n":55,"P c c n":55,"P 2/b 21/c 21/m":56,"P b c m":56,"P 21/n 21/n 2/m":57,"P n n m":57,"P 21/m 21/m 2/n":58,"P m m n":58,"P 21/b 2/c 21/n":59,"P b c n":59,"P 21/b 21/c 21/a":60,"P b c a":60,"P 21/n 21/m 21/a":61,"P n m a":61,"C 2/m 2/c 21/m":62,"C m c m":62,"C 2/m 2/c 21/a":63,"C m c a":63,"C 2/m 2/m 2/m":64,"C m m m":64,"C 2/c 2/c 2/m":65,"C c c m":65,"C 2/m 2/m 2/a":66,"C m m a":66,"C 2/c 2/c 2/a":67,"C c c a":67,"F 2/m 2/m 2/m":68,"F m m m":68,"F 2/d 2/d 2/d":69,"F d d d":69,"I 2/m 2/m 2/m":70,"I m m m":70,"I 2/b 2/a 2/m":71,"I b a m":71,"I 21/b 21/c 21/a":72,"I b c a":72,"I 21/m 21/m 21/a":73,"I m m a":73,"P 4":74,"P 41":75,"P 42":76,"P 43":77,"I 4":78,"I 41":79,"P -4":80,"I -4":81,"P 4/m":82,"P 42/m":83,"P 4/n":84,"P 42/n":85,"I 4/m":86,"I 41/a":87,"P 4 2 2":88,"P 4 21 2":89,"P 41 2 2":90,"P 41 21 2":91,"P 42 2 2":92,"P 42 21 2":93,"P 43 2 2":94,"P 43 21 2":95,"I 4 2 2":96,"I 41 2 2":97,"P 4 m m":98,"P 4 b m":99,"P 42 c m":100,"P 42 n m":101,"P 4 c c":102,"P 4 n c":103,"P 42 m c":104,"P 42 b c":105,"I 4 m m":106,"I 4 c m":107,"I 41 m d":108,"I 41 c d":109,"P -4 2 m":110,"P -4 2 c":111,"P -4 21 m":112,"P -4 21 c":113,"P -4 m 2":114,"P -4 c 2":115,"P -4 b 2":116,"P -4 n 2":117,"I -4 m 2":118,"I -4 c 2":119,"I -4 2 m":120,"I -4 2 d":121,"P 4/m 2/m 2/m":122,"P4/m m m":122,"P 4/m 2/c 2/c":123,"P4/m c c":123,"P 4/n 2/b 2/m":124,"P4/n b m":124,"P 4/n 2/n 2/c":125,"P4/n n c":125,"P 4/m 21/b 2/m":126,"P4/m b m":126,"P 4/m 21/n 2/c":127,"P4/m n c":127,"P 4/n 21/m 2/m":128,"P4/n m m":128,"P 4/n 2/c 2/c":129,"P4/n c c":129,"P 42/m 2/m 2/c":130,"P42/m m c":130,"P 42/m 2/c 2/m":131,"P42/m c m":131,"P 42/n 2/b 2/c":132,"P42/n b c":132,"P 42/n 2/n 2/m":133,"P42/n n m":133,"P 42/m 21/b 2/c":134,"P42/m b c":134,"P 42/m 21/n 2/m":135,"P42/m n m":135,"P 42/n 21/m 2/c":136,"P42/n m c":136,"P 42/n 21/c 2/m":137,"P42/n c m":137,"I 4/m 2/m 2/m":138,"I4/m m m":138,"I 4/m 2/c 2/m":139,"I4/m c m":139,"I 41/a 2/m 2/d":140,"I41/a m d":140,"I 41/a 2/c 2/d":141,"I41/a c d":141,"P 3":142,"P 31":143,"P 32":144,"H 3":145,"R 3":146,"P -3":147,"H -3":148,"R -3":149,"P 3 1 2":150,"P 3 2 1":151,"P 31 1 2":152,"P 31 2 1":153,"P 32 1 2":154,"P 32 2 1":155,"H 3 2":156,"R 3 2":157,"P 3 m 1":158,"P 3 1 m":159,"P 3 c 1":160,"P 3 1 c":161,"H 3 m":162,"R 3 m":163,"H 3 c":164,"R 3 c":165,"P -3 1 2/m":166,"P -3 1 m":166,"P -3 1 2/c":167,"P -3 1 c":167,"P -3 2/m 1":168,"P -3 m 1":168,"P -3 2/c 1":169,"P -3 c 1":169,"H -3 2/m":170,"H -3 m":170,"R -3 2/m":171,"R -3 m":171,"H -3 2/c":172,"H -3 c":172,"R -3 2/c":173,"R -3 c":173,"P 6":174,"P 61":175,"P 65":176,"P 62":177,"P 64":178,"P 63":179,"P -6":180,"P 6/m":181,"P 63/m":182,"P 6 2 2":183,"P 61 2 2":184,"P 65 2 2":185,"P 62 2 2":186,"P 64 2 2":187,"P 63 2 2":188,"P 6 m m":189,"P 6 c c":190,"P 63 c m":191,"P 63 m c":192,"P -6 m 2":193,"P -6 c 2":194,"P -6 2 m":195,"P -6 2 c":196,"P 6/m 2/m 2/m":197,"P 6/m m m":197,"P 6/m 2/c 2/c":198,"P 6/m c c":198,"P 63/m 2/c 2/m":199,"P 63/m c m":199,"P 63/m 2/m 2/c":200,"P 63/m m c":200,"P 2 3":201,"F 2 3":202,"I 2 3":203,"P 21 3":204,"I 21 3":205,"P 2/m -3":206,"P m -3":206,"P 2/n -3":207,"P n -3":207,"F 2/m -3":208,"F m -3":208,"F 2/d -3":209,"F d -3":209,"I 2/m -3":210,"I m -3":210,"P 21/a -3":211,"P a -3":211,"I 21/a -3":212,"I a -3":212,"P 4 3 2":213,"P 42 3 2":214,"F 4 3 2":215,"F 41 3 2":216,"I 4 3 2":217,"P 43 3 2":218,"P 41 3 2":219,"I 41 3 2":220,"P -4 3 m":221,"F -4 3 m":222,"I -4 3 m":223,"P -4 3 n":224,"F -4 3 c":225,"I -4 3 d":226,"P 4/m -3 2/m":227,"P m -3 m":227,"P 4/n -3 2/n":228,"P n -3 n":228,"P 42/m -3 2/n":229,"P m -3 n":229,"P 42/n -3 2/m":230,"P n -3 m":230,"F 4/m -3 2/m":231,"F m -3 m":231,"F 4/m -3 2/c":232,"F m -3 c":232,"F 41/d -3 2/m":233,"F d -3 m":233,"F 41/d -3 2/c":234,"F d -3 c":234,"I 4/m -3 2/m":235,"I m -3 m":235,"I 41/a -3 2/d":236,"I a -3 d":236,"P 1 1 2":237,"P 1 1 21":238,"B 1 1 2":239,"B 2":239,"A 1 2 1":240,"C 1 21 1":241,"I 1 2 1":242,"I 2":242,"I 1 21 1":243,"P 1 1 m":244,"P 1 1 b":245,"B 1 1 m":246,"B 1 1 b":247,"P 1 1 2/m":248,"P 1 1 21/m":249,"B 1 1 2/m":250,"P 1 1 2/b":251,"P 1 1 21/b":252,"P 1 21/n 1":253,"P 1 21/a 1":254,"B 1 1 2/b":255,"P 21 2 2":256,"P 2 21 2":257,"P 21 21 2 (a)":258,"P 21 2 21":259,"P 2 21 21":260,"C 2 2 21a)":261,"C 2 2 2a":262,"F 2 2 2a":263,"I 2 2 2a":264,"P 21/m 21/m 2/n a":265,"P 42 21 2a":266,"I 2 3a":267};function qg(e){switch(e){case 1146:return 146;case 1148:return 149;case 1155:return 157;case 1160:return 163;case 1161:return 165;case 1166:return 171;case 1167:return 173;case 1003:return 237;case 1004:return 238;case 1005:return 239;case 2005:return 240;case 3005:return 241;case 4005:return 242;case 5005:return 243;case 1006:return 244;case 1007:return 245;case 1008:return 246;case 1009:return 247;case 1010:return 248;case 1011:return 249;case 1012:return 250;case 1013:return 251;case 1014:return 252;case 2014:return 253;case 3014:return 254;case 1015:return 255;case 1017:return 256;case 2017:return 257;case 1018:return 258;case 2018:return 259;case 3018:return 260;case 1020:return 261;case 1021:return 262;case 1022:return 263;case 1023:return 264;case 1059:return 265;case 1094:return 266;case 1197:return 267}let t=0;return e>146&&++t,e>148&&++t,e>155&&++t,e>160&&++t,e>161&&++t,e>166&&++t,e>167&&++t,e-1+t}function zg(e){if(e<146)return e+1;if(e===146)return 1146;if(e<149)return e+1-1;if(e===149)return 1148;if(e<157)return e+1-2;if(e===157)return 1155;if(e<163)return e+1-3;if(e===163)return 1160;if(e<165)return e+1-4;if(e===165)return 1161;if(e<171)return e+1-5;if(e===171)return 1166;if(e<173)return e+1-6;if(e===173)return 1167;if(e<237)return e+1-7;if(e===237)return 1003;if(e===238)return 1004;if(e===239)return 1005;if(e===240)return 2005;if(e===241)return 3005;if(e===242)return 4005;if(e===243)return 5005;if(e===244)return 1006;if(e===245)return 1007;if(e===246)return 1008;if(e===247)return 1009;if(e===248)return 1010;if(e===249)return 1011;if(e===250)return 1012;if(e===251)return 1013;if(e===252)return 1014;if(e===253)return 2014;if(e===254)return 3014;if(e===255)return 1015;if(e===256)return 1017;if(e===257)return 2017;if(e===258)return 1018;if(e===259)return 2018;if(e===260)return 3018;if(e===261)return 1020;if(e===262)return 1021;if(e===263)return 1022;if(e===264)return 1023;if(e===265)return 1059;if(e===266)return 1094;if(e===267)return 1197;throw new Error(`unknown spacegroup index '${e}'`)}var Ju=function(){let e=Object.create(null);for(let t of Object.keys(qi))e[qi[t]]=t;return e}(),op=function(){let e=Object.create(null);for(let t of Object.keys(qi)){let r=qi[t];e[r]=zg(r)}return e}();function ip(e){let t=typeof e=="number"?qg(e):qi[e];return typeof t>"u"||typeof Ju[t]>"u"?-1:t}var Ro;(n=>{n.Zero=r("P 1",p.create(1,1,1),p.create(Math.PI/2,Math.PI/2,Math.PI/2));function t(o){return o?o.index===0&&o.size[0]===1&&o.size[1]===1&&o.size[1]===1:!0}n.isZero=t;function r(o,a,i){let s=ip(o);if(s<0)return n.Zero;let u=a[0]*a[1]*a[2],m=i[0],c=i[1],l=i[2],d=a[0],y=a[1],S=a[2],x=Math.cos(c),g=(Math.cos(m)-Math.cos(c)*Math.cos(l))/Math.sin(l),h=Math.sqrt(1-x*x-g*g),f=[d,0,0],C=[Math.cos(l)*y,Math.sin(l)*y,0],T=[x*S,g*S,h*S],I=re.ofRows([[f[0],C[0],T[0],0],[0,C[1],T[1],0],[0,0,T[2],0],[0,0,0,1]]);return{index:s,size:a,volume:u,anglesInRadians:i,fromFractional:I}}n.create=r})(Ro||(Ro={}));var Sn;(n=>{n.ZeroP1=t(Ro.Zero);function t(o){let a=np[o.index].map(u=>r(rp[u])),i=Ju[o.index],s=op[o.index];return{name:i,num:s,cell:o,operators:a}}n.create=t;function r(o){let a=Ga[o[0]],i=Ga[o[1]],s=Ga[o[2]];return re.ofRows([a,i,s,[0,0,0,1]])}})(Sn||(Sn={}));var Xr;(o=>{function e(a,i,s){a.squaredDistances[a.count]=s,a.indices[a.count++]=i}o.add=e;function t(a){a.count=0}o.reset=t;function r(){return{count:0,indices:[],squaredDistances:[]}}o.create=r;function n(a,i){for(let s=0;s<i.count;++s)a.indices[s]=i.indices[s],a.squaredDistances[s]=i.squaredDistances[s];return a.count=i.count,a}o.copy=n})(Xr||(Xr={}));function $t(){return $t.empty()}(i=>{function e(s,u,m,c){return{origin:s,dirA:u,dirB:m,dirC:c}}i.create=e;function t(){return{origin:p(),dirA:p(),dirB:p(),dirC:p()}}i.empty=t;function r(s,u){return p.copy(s.origin,u.origin),p.copy(s.dirA,u.dirA),p.copy(s.dirB,u.dirB),p.copy(s.dirC,u.dirC),s}i.copy=r;function n(s){return r(t(),s)}i.clone=n;function o(s,u){return p.copy(s.origin,u.origin),p.normalize(s.dirA,u.dirA),p.normalize(s.dirB,u.dirB),p.normalize(s.dirC,u.dirC),s}i.normalize=o;function a(s,u,m){return p.scale(s.dirA,u.dirA,m),p.scale(s.dirB,u.dirB,m),p.scale(s.dirC,u.dirC,m),s}i.scale=a})($t||($t={}));var bt;(c=>{function e(l,d,y=Float32Array){let S=l*d;return{data:new y(S),size:S,cols:l,rows:d}}c.create=e;function t(l,d,y){return l.data[l.rows*y+d]}c.get=t;function r(l,d,y,S){return l.data[l.rows*y+d]=S,l}c.set=r;function n(l,d,y,S){return l.data[l.rows*y+d]+=S,l}c.add=n;function o(l){return{data:l.data.slice(),size:l.size,cols:l.cols,rows:l.rows}}c.clone=o;function a(l,d,y){return{data:l,size:d*y,cols:d,rows:y}}c.fromArray=a;function i(l,d){let y=d.rows,S=d.cols,x=d.data,g=l.data;for(let h=0,f=0,C=0;h<y;C+=1,f+=S,++h){let T=C;for(let I=0;I<S;T+=y,I++)g[T]=x[f+I]}return l}c.transpose=i;function s(l,d,y){let S=d.cols,x=d.rows,g=y.rows,h=d.data,f=y.data,C=l.data;for(let T=0,I=0,P=0;T<x;I+=S,T++)for(let A=0,b=0;b<g;P++,b++){let _=0,v=I;for(let R=0;R<S;v++,A++,R++)_+=h[v]*f[A];C[P]=_}return l}c.multiplyABt=s;function u(l){let d=l.rows,y=l.cols,S=l.data,x=new Array(y);for(let g=0;g<y;++g)x[g]=0;for(let g=0,h=0;g<d;++g)for(let f=0;f<y;++f,++h)x[f]+=S[h];for(let g=0;g<y;++g)x[g]/=d;return x}c.meanRows=u;function m(l,d){let y=l.rows,S=l.cols,x=l.data;for(let g=0,h=0;g<y;++g)for(let f=0;f<S;++f,++h)x[h]-=d[f];return l}c.subRows=m})(bt||(bt={}));function $u(e,t,r,n){n=e[t],e[t]=e[r],e[r]=n}function Kg(e,t){return e=Math.abs(e),t=Math.abs(t),e>t?(t/=e,e*Math.sqrt(1+t*t)):t>0?(e/=t,t*Math.sqrt(1+e*e)):0}var jg=1192092896e-16,Qg=1e-37;function Yg(e,t,r,n,o,a,i,s){let u=jg*2,m=Qg,c=0,l=0,d=0,y=0,S=Math.max(a,30),x=0,g=0,h=0,f=0,C=0,T=0,I=0,P=0,A=0,b=0,_=0,v=0,R=0,E=0,B=0,L=0,G=0,K=4660,X=0,j=0,$=0,Z=new Float64Array(i<<3);for(;c<i;c++){for(d=0,_=0;d<a;d++)P=e[c*t+d],_+=P*P;if(Z[c]=_,n){for(d=0;d<i;d++)n[c*o+d]=0;n[c*o+c]=1}}for(;y<S;y++){for(C=0,c=0;c<i-1;c++)for(l=c+1;l<i;l++){for(x=c*t|0,g=l*t|0,B=Z[c],L=0,G=Z[l],d=2,L+=e[x]*e[g],L+=e[x+1]*e[g+1];d<a;d++)L+=e[x+d]*e[g+d];if(!(Math.abs(L)<=u*Math.sqrt(B*G))){for(L*=2,v=B-G,R=Kg(L,v),v<0?(E=(R-v)*.5,I=Math.sqrt(E/R),T=L/(R*I*2)):(T=Math.sqrt((R+v)/(R*2)),I=L/(R*T*2)),B=0,G=0,d=2,A=T*e[x]+I*e[g],b=-I*e[x]+T*e[g],e[x]=A,e[g]=b,B+=A*A,G+=b*b,A=T*e[x+1]+I*e[g+1],b=-I*e[x+1]+T*e[g+1],e[x+1]=A,e[g+1]=b,B+=A*A,G+=b*b;d<a;d++)A=T*e[x+d]+I*e[g+d],b=-I*e[x+d]+T*e[g+d],e[x+d]=A,e[g+d]=b,B+=A*A,G+=b*b;if(Z[c]=B,Z[l]=G,C=1,n)for(h=c*o|0,f=l*o|0,d=2,A=T*n[h]+I*n[f],b=-I*n[h]+T*n[f],n[h]=A,n[f]=b,A=T*n[h+1]+I*n[f+1],b=-I*n[h+1]+T*n[f+1],n[h+1]=A,n[f+1]=b;d<i;d++)A=T*n[h+d]+I*n[f+d],b=-I*n[h+d]+T*n[f+d],n[h+d]=A,n[f+d]=b}}if(C===0)break}for(c=0;c<i;c++){for(d=0,_=0;d<a;d++)P=e[c*t+d],_+=P*P;Z[c]=Math.sqrt(_)}for(c=0;c<i-1;c++){for(l=c,d=c+1;d<i;d++)Z[l]<Z[d]&&(l=d);if(c!==l&&($u(Z,c,l,_),n)){for(d=0;d<a;d++)$u(e,c*t+d,l*t+d,P);for(d=0;d<i;d++)$u(n,c*o+d,l*o+d,P)}}for(c=0;c<i;c++)r[c]=Z[c];if(n)for(c=0;c<s;c++){for(_=c<i?Z[c]:0;_<=m;){for(j=1/a,d=0;d<a;d++)K=K*214013+2531011,X=K>>16&32767&256?j:-j,e[c*t+d]=X;for(y=0;y<2;y++)for(l=0;l<c;l++){for(_=0,d=0;d<a;d++)_+=e[c*t+d]*e[l*t+d];for($=0,d=0;d<a;d++)P=e[c*t+d]-_*e[l*t+d],e[c*t+d]=P,$+=Math.abs(P);for($=$?1/$:0,d=0;d<a;d++)e[c*t+d]*=$}for(_=0,d=0;d<a;d++)P=e[c*t+d],_+=P*P;_=Math.sqrt(_)}for(I=1/_,d=0;d<a;d++)e[c*t+d]*=I}}function ap(e,t,r,n){let o=0,a=0,i=e.rows,s=e.cols,u=i,m=s;u<m&&(o=1,a=u,u=m,m=a);let c=bt.create(u,u),l=bt.create(1,m),d=bt.create(m,m);if(o===0)bt.transpose(c,e);else{for(a=0;a<s*i;a++)c.data[a]=e.data[a];for(;a<m*u;a++)c.data[a]=0}if(Yg(c.data,u,l.data,d.data,m,u,m,u),t){for(a=0;a<m;a++)t.data[a]=l.data[a];for(;a<s;a++)t.data[a]=0}o===0?(r&&bt.transpose(r,c),n&&bt.transpose(n,d)):(r&&bt.transpose(r,d),n&&bt.transpose(n,c))}var mr;(a=>{function e(i){let s=t(i),u=o(i,s);return{momentsAxes:s,boxAxes:u}}a.ofPositions=e;function t(i){if(i.length===3)return $t.create(p.fromArray(p(),i,0),p.create(1,0,0),p.create(0,1,0),p.create(0,1,0));let s=bt.fromArray(i,3,i.length/3),u=s.rows,m=u/3,c=bt.create(3,3),l=bt.create(1,3),d=bt.create(3,3),y=bt.create(3,3),S=bt.meanRows(s),x=bt.subRows(bt.clone(s),S),g=bt.transpose(bt.create(u,3),x);bt.multiplyABt(c,g,g),ap(c,l,d,y);let h=p.create(S[0],S[1],S[2]),f=p.create(d.data[0],d.data[3],d.data[6]),C=p.create(d.data[1],d.data[4],d.data[7]),T=p.create(d.data[2],d.data[5],d.data[8]);return p.scale(f,f,Math.sqrt(l.data[0]/m)),p.scale(C,C,Math.sqrt(l.data[1]/m)),p.scale(T,T,Math.sqrt(l.data[2]/m)),$t.create(h,f,C,T)}a.calculateMomentsAxes=t;function r(i){let s=$t.clone(i);return p.magnitude(s.dirC)<1e-6&&p.cross(s.dirC,s.dirA,s.dirB),$t.normalize(s,s)}a.calculateNormalizedAxes=r;let n=p();function o(i,s){if(i.length===3)return $t.clone(s);let u=-1/0,m=-1/0,c=-1/0,l=-1/0,d=-1/0,y=-1/0,S=p(),x=p(),g=s.origin,h=r(s);for(let A=0,b=i.length;A<b;A+=3){p.projectPointOnVector(S,p.fromArray(S,i,A),h.dirA,g);let _=p.dot(h.dirA,p.normalize(x,p.sub(x,S,g))),v=p.distance(S,g);_>0?v>u&&(u=v):v>m&&(m=v),p.projectPointOnVector(S,p.fromArray(S,i,A),h.dirB,g);let R=p.dot(h.dirB,p.normalize(x,p.sub(x,S,g))),E=p.distance(S,g);R>0?E>c&&(c=E):E>l&&(l=E),p.projectPointOnVector(S,p.fromArray(S,i,A),h.dirC,g);let B=p.dot(h.dirC,p.normalize(x,p.sub(x,S,g))),L=p.distance(S,g);B>0?L>d&&(d=L):L>y&&(y=L)}let f=p.setMagnitude(p(),h.dirA,(u+m)/2),C=p.setMagnitude(p(),h.dirB,(c+l)/2),T=p.setMagnitude(p(),h.dirC,(d+y)/2),I=p(),P=function(A,b,_){p.copy(n,g),p.scaleAndAdd(n,n,h.dirA,A),p.scaleAndAdd(n,n,h.dirB,b),p.scaleAndAdd(n,n,h.dirC,_),p.add(I,I,n)};return P(u,c,d),P(u,c,-y),P(u,-l,-y),P(u,-l,d),P(-m,-l,-y),P(-m,-l,d),P(-m,c,d),P(-m,c,-y),p.scale(I,I,1/8),$t.create(I,f,C,T)}})(mr||(mr={}));function Se(){return Se.zero()}(g=>{function e(h){return h.extrema!==void 0}g.hasExtrema=e;function t(h,f){return{center:h,radius:f}}g.create=t;function r(){return{center:p(),radius:0}}g.zero=r;function n(h){let f=t(p.clone(h.center),h.radius);return e(h)&&(f.extrema=h.extrema.map(C=>p.clone(C))),f}g.clone=n;function o(h,f,C){return p.copy(h.center,f),h.radius=C,h}g.set=o;function a(h,f){return p.copy(h.center,f.center),h.radius=f.radius,e(f)&&i(h,f.extrema.map(C=>p.clone(C))),h}g.copy=a;function i(h,f){return h.extrema!==void 0?(h.extrema.length=0,h.extrema.push(...f)):h.extrema=f,h}g.setExtrema=i;function s(h,f,C){return p.transformMat4(h.center,f.center,C),h.radius=f.radius*re.getMaxScaleOnAxis(C),e(f)&&i(h,f.extrema.map(T=>p.transformMat4(p(),T,C))),h}g.transform=s;function u(h,f,C){return p.add(h.center,f.center,C),e(f)&&i(h,f.extrema.map(T=>p.add(p(),T,C))),h}g.translate=u;function m(h,f,C){p.toArray(h.center,f,C),f[C+3]=h.radius}g.toArray=m;function c(h,f){return p.scale(h.center,p.add(h.center,f.max,f.min),.5),h.radius=p.distance(h.center,f.max),g.setExtrema(h,[p.create(f.min[0],f.min[1],f.min[2]),p.create(f.max[0],f.max[1],f.max[2]),p.create(f.max[0],f.min[1],f.min[2]),p.create(f.min[0],f.max[1],f.max[2]),p.create(f.min[0],f.min[1],f.max[2]),p.create(f.max[0],f.min[1],f.max[2]),p.create(f.max[0],f.max[1],f.min[2]),p.create(f.min[0],f.max[1],f.min[2])]),h}g.fromBox3D=c;function l(h,f,C){return p.copy(h.center,f.center),h.radius=Math.max(f.radius,p.distance(f.center,C.center)+C.radius),e(f)&&e(C)&&i(h,[...f.extrema.map(T=>p.clone(T)),...C.extrema.map(T=>p.clone(T))]),h}g.expandBySphere=l;let d=p();function y(h,f,C){var T,I;if(p.copy(h.center,f.center),h.radius=f.radius+C,f.radius<1e-12||((I=(T=f.extrema)==null?void 0:T.length)!=null?I:0)<=1)return h.extrema=void 0,h;if(e(f)){let P=new Float32Array(f.extrema.length*3);for(let b=0;b<f.extrema.length;b++)p.toArray(f.extrema[b],P,b*3);let A=mr.calculateMomentsAxes(P);$t.scale(A,$t.normalize(A,A),C),i(h,f.extrema.map(b=>{p.normalize(d,p.sub(d,b,f.center));let _=p.clone(b),v=p.dot(d,A.dirA)<0?-1:1;p.scaleAndAdd(_,_,A.dirA,v);let R=p.dot(d,A.dirB)<0?-1:1;p.scaleAndAdd(_,_,A.dirB,R);let E=p.dot(d,A.dirC)<0?-1:1;return p.scaleAndAdd(_,_,A.dirC,E),p.distance(h.center,_)>h.radius&&(f.extrema.length>=14&&p.normalize(d,p.sub(d,_,f.center)),p.scaleAndAdd(_,h.center,d,h.radius)),_}))}return h}g.expand=y;function S(h,f){return p.distance(h.center,f.center)<=h.radius+f.radius}g.overlaps=S;function x(h,f){return p.distance(h.center,f.center)-h.radius+f.radius}g.distance=x})(Se||(Se={}));function Xe(){return Xe.zero()}(S=>{function e(x,g){return{min:x,max:g}}S.create=e;function t(){return{min:p(),max:p()}}S.zero=t;function r(x,g){return p.copy(x.min,g.min),p.copy(x.max,g.max),x}S.copy=r;function n(x,g){if(Se.hasExtrema(g)&&g.extrema.length>=14)return o(x,g.extrema);let h=p.create(g.radius,g.radius,g.radius);return p.sub(x.min,g.center,h),p.add(x.max,g.center,h),x}S.fromSphere3D=n;function o(x,g){S.setEmpty(x);for(let h=0,f=g.length;h<f;h++)S.add(x,g[h]);return x}S.fromVec3Array=o;function a(x){let g=p.create(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),h=p.create(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),{x:f,y:C,z:T,indices:I}=x;for(let P=0,A=Ae.size(I);P<A;P++){let b=Ae.getAt(I,P);g[0]=Math.min(f[b],g[0]),g[1]=Math.min(C[b],g[1]),g[2]=Math.min(T[b],g[2]),h[0]=Math.max(f[b],h[0]),h[1]=Math.max(C[b],h[1]),h[2]=Math.max(T[b],h[2])}return{min:g,max:h}}S.computeBounding=a;function i(x,g){return p.sub(x,g.max,g.min)}S.size=i;let s=p();function u(x){return i(s,x),s[0]*s[1]*s[2]}S.volume=u;function m(x){return p.set(x.min,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),p.set(x.max,-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),x}S.setEmpty=m;function c(x,g){return p.min(x.min,x.min,g),p.max(x.max,x.max,g),x}S.add=c;function l(x,g,h){return p.sub(x.min,g.min,h),p.add(x.max,g.max,h),x}S.expand=l;function d(x,g,h){return p.scale(x.min,g.min,h),p.scale(x.max,g.max,h),x}S.scale=d;function y(x,g){return!(x.max[0]<g.min[0]||x.min[0]>g.max[0]||x.max[1]<g.min[1]||x.min[1]>g.max[1]||x.max[2]<g.min[2]||x.min[2]>g.max[2])}S.overlaps=y})(Xe||(Xe={}));function Fo(e,t,r){return new ec(e,t,r)}var ec=class{find(t,r,n,o,a){this.ctx.x=t,this.ctx.y=r,this.ctx.z=n,this.ctx.radius=o,this.ctx.isCheck=!1;let i=a!=null?a:this.result;return sp(this.ctx,i),i}check(t,r,n,o){return this.ctx.x=t,this.ctx.y=r,this.ctx.z=n,this.ctx.radius=o,this.ctx.isCheck=!0,sp(this.ctx,this.result)}constructor(t,r,n){let o=Zg(t,r,n);this.ctx=Wg(o),this.boundary={box:o.boundingBox,sphere:o.boundingSphere},this.buckets={offset:o.bucketOffset,count:o.bucketCounts,array:o.bucketArray},this.result=Xr.create()}};function Xg(e){let{expandedBox:t,size:[r,n,o],data:{x:a,y:i,z:s,radius:u,indices:m},elementCount:c,delta:l}=e,d=r*n*o,{min:[y,S,x]}=t,g=0,h=0,f=new Uint32Array(d),C=new Int32Array(c);for(let b=0;b<c;b++){let _=Ae.getAt(m,b),v=Math.floor((a[_]-y)/l[0]),R=Math.floor((i[_]-S)/l[1]),E=Math.floor((s[_]-x)/l[2]),B=(v*n+R)*o+E;(f[B]+=1)===1&&(h+=1),C[b]=B}if(u)for(let b=0;b<c;b++){let _=Ae.getAt(m,b);u[_]>g&&(g=u[_])}let T=new Int32Array(h);for(let b=0,_=0;b<d;b++){let v=f[b];v>0&&(f[b]=_+1,T[_]=v,_+=1)}let I=new Uint32Array(h);for(let b=1;b<h;++b)I[b]+=I[b-1]+T[b-1];let P=new Int32Array(h),A=new Int32Array(c);for(let b=0;b<c;b++){let _=f[C[b]];if(_>0){let v=_-1;A[I[v]+P[v]]=b,P[v]+=1}}return{size:e.size,bucketArray:A,bucketCounts:T,bucketOffset:I,grid:f,delta:l,min:e.expandedBox.min,data:e.data,maxRadius:g,expandedBox:e.expandedBox,boundingBox:e.boundingBox,boundingSphere:e.boundingSphere}}function Zg(e,t,r){let n=Xe.expand(Xe(),t.box,p.create(.5,.5,.5)),{indices:o}=e,a=Xe.size(p(),n),i,s,u=Ae.size(o),m=typeof r=="number"?r:32,c=Array.isArray(r)&&r;if(c&&!p.isZero(c))s=[Math.ceil(a[0]/c[0]),Math.ceil(a[1]/c[1]),Math.ceil(a[2]/c[2])],i=c;else if(u>0){let y=Math.ceil(u/m),S=Math.pow(y/(a[0]*a[1]*a[2]),1/3);s=[Math.ceil(a[0]*S),Math.ceil(a[1]*S),Math.ceil(a[2]*S)],i=[a[0]/s[0],a[1]/s[1],a[2]/s[2]]}else i=a,s=[1,1,1];let l={x:e.x,y:e.y,z:e.z,indices:o,radius:e.radius},d={size:s,data:l,expandedBox:n,boundingBox:t.box,boundingSphere:t.sphere,elementCount:u,delta:i};return Xg(d)}function Wg(e){return{grid:e,x:.1,y:.1,z:.1,radius:.1,isCheck:!1}}function sp(e,t){let{min:r,size:[n,o,a],bucketOffset:i,bucketCounts:s,bucketArray:u,grid:m,data:{x:c,y:l,z:d,indices:y,radius:S},delta:x,maxRadius:g}=e.grid,{radius:h,isCheck:f,x:C,y:T,z:I}=e,P=h+g,A=P*P;Xr.reset(t);let b=Math.max(0,Math.floor((C-P-r[0])/x[0])),_=Math.max(0,Math.floor((T-P-r[1])/x[1])),v=Math.max(0,Math.floor((I-P-r[2])/x[2])),R=Math.min(n-1,Math.floor((C+P-r[0])/x[0])),E=Math.min(o-1,Math.floor((T+P-r[1])/x[1])),B=Math.min(a-1,Math.floor((I+P-r[2])/x[2]));if(b>R||_>E||v>B)return!1;for(let L=b;L<=R;L++)for(let G=_;G<=E;G++)for(let K=v;K<=B;K++){let X=m[(L*o+G)*a+K];if(X===0)continue;let j=X-1,$=i[j],Z=s[j],te=$+Z;for(let W=$;W<te;W++){let Y=Ae.getAt(y,u[W]),ie=c[Y]-C,D=l[Y]-T,F=d[Y]-I,N=ie*ie+D*D+F*F;if(N<=A){if(g>0&&Math.sqrt(N)-S[Y]>h)continue;if(f)return!0;Xr.add(t,u[W],N)}}}return t.count>0}var up={molstar_atom_site_operator_mapping:{label_asym_id:ne.Schema.Str(),auth_asym_id:ne.Schema.Str(),operator_name:ne.Schema.Str(),suffix:ne.Schema.Str(),assembly_id:ne.Schema.Str(),assembly_operator_id:ne.Schema.Int(),symmetry_operator_index:ne.Schema.Int(),symmetry_hkl:ne.Schema.Vector(3),ncs_id:ne.Schema.Int()}};var cp={type_symbol:ne.Schema.Aliased(ze.atom_site.type_symbol),label_atom_id:ze.atom_site.label_atom_id,auth_atom_id:ze.atom_site.auth_atom_id,label_alt_id:ze.atom_site.label_alt_id,label_comp_id:ze.atom_site.label_comp_id,auth_comp_id:ze.atom_site.auth_comp_id,pdbx_formal_charge:ze.atom_site.pdbx_formal_charge},mp={group_PDB:ze.atom_site.group_PDB,label_seq_id:ze.atom_site.label_seq_id,auth_seq_id:ze.atom_site.auth_seq_id,pdbx_PDB_ins_code:ze.atom_site.pdbx_PDB_ins_code},lp={label_asym_id:ze.atom_site.label_asym_id,auth_asym_id:ze.atom_site.auth_asym_id,label_entity_id:ze.atom_site.label_entity_id},wa;(t=>{function e(){return{label_entity_id:"",label_asym_id:"",auth_seq_id:0,pdbx_PDB_ins_code:void 0}}t.EmptyResidueKey=e})(wa||(wa={}));var eo;(r=>{function e(n,o){return n.residueAtomSegments.index[n.chainAtomSegments.offsets[o]]}r.chainStartResidueIndex=e;function t(n,o){return n.residueAtomSegments.index[n.chainAtomSegments.offsets[o+1]-1]+1}r.chainEndResidueIndexExcl=t})(eo||(eo={}));var Na={H:1,D:1,T:1,HE:2,LI:3,BE:4,B:5,C:6,N:7,O:8,F:9,NE:10,NA:11,MG:12,AL:13,SI:14,P:15,S:16,CL:17,AR:18,K:19,CA:20,SC:21,TI:22,V:23,CR:24,MN:25,FE:26,CO:27,NI:28,CU:29,ZN:30,GA:31,GE:32,AS:33,SE:34,BR:35,KR:36,RB:37,SR:38,Y:39,ZR:40,NB:41,MO:42,TC:43,RU:44,RH:45,PD:46,AG:47,CD:48,IN:49,SN:50,SB:51,TE:52,I:53,XE:54,CS:55,BA:56,LA:57,CE:58,PR:59,ND:60,PM:61,SM:62,EU:63,GD:64,TB:65,DY:66,HO:67,ER:68,TM:69,YB:70,LU:71,HF:72,TA:73,W:74,RE:75,OS:76,IR:77,PT:78,AU:79,HG:80,TL:81,PB:82,BI:83,PO:84,AT:85,RN:86,FR:87,RA:88,AC:89,TH:90,PA:91,U:92,NP:93,PU:94,AM:95,CM:96,BK:97,CF:98,ES:99,FM:100,MD:101,NO:102,LR:103,RF:104,DB:105,SG:106,BH:107,HS:108,MT:109},Jg={1:1.1,2:1.4,3:1.81,4:1.53,5:1.92,6:1.7,7:1.55,8:1.52,9:1.47,10:1.54,11:2.27,12:1.73,13:1.84,14:2.1,15:1.8,16:1.8,17:1.75,18:1.88,19:2.75,20:2.31,21:2.3,22:2.15,23:2.05,24:2.05,25:2.05,26:2.05,27:2,28:2,29:2,30:2.1,31:1.87,32:2.11,33:1.85,34:1.9,35:1.83,36:2.02,37:3.03,38:2.49,39:2.4,40:2.3,41:2.15,42:2.1,43:2.05,44:2.05,45:2,46:2.05,47:2.1,48:2.2,49:2.2,50:1.93,51:2.17,52:2.06,53:1.98,54:2.16,55:3.43,56:2.68,57:2.5,58:2.48,59:2.47,60:2.45,61:2.43,62:2.42,63:2.4,64:2.38,65:2.37,66:2.35,67:2.33,68:2.32,69:2.3,70:2.28,71:2.27,72:2.25,73:2.2,74:2.1,75:2.05,76:2,77:2,78:2.05,79:2.1,80:2.05,81:1.96,82:2.02,83:2.07,84:1.97,85:2.02,86:2.2,87:3.48,88:2.83,89:2,90:2.4,91:2,92:2.3,93:2,94:2,95:2,96:2,97:2,98:2,99:2,100:2,101:2,102:2,103:2,104:2,105:2,106:2,107:2,108:2,109:2},$g=1.7,eb=0;function Oa(e){let t=Na[e];return t===void 0?$g:Jg[t]}function dp(e){let t=Na[e];return t===void 0?eb:t}var pp=new Set(["145","147","149","289","291","293","445","475","491","510","604","045","05L","07E","07Y","08U","09X","0AT","0BD","0H0","0HX","0LP","0MK","0NZ","0TS","0UB","0V4","0WK","0XY","0YT","10M","12E","14T","15L","16F","16G","16O","17T","18D","18O","18T","1AR","1BW","1CF","1FT","1GL","1GN","1JB","1LL","1NA","1S3","1S4","1SD","1X4","20S","20X","22O","22S","23V","24S","25E","26M","26O","26Q","26R","26V","26W","26Y","27C","2DG","2DR","2F8","2FG","2FL","2FP","2GL","2GS","2H5","2HA","2M4","2M5","2M8","2OS","2WP","2WS","32O","34V","38J","3BU","3CM","3DO","3DY","3FM","3GR","3HD","3J3","3J4","3LJ","3LR","3MF","3MG","3MK","3R3","3S6","3SA","3YW","40J","42D","44S","46D","46M","46Z","48Z","49A","49S","49T","49V","4AM","4CQ","4GC","4GL","4GP","4JA","4N2","4NN","4QY","4R1","4RS","4SG","4U0","4U1","4U2","4UZ","4V5","50A","51N","56N","57S","5DI","5GF","5GO","5II","5KQ","5KS","5KT","5KV","5L2","5L3","5LS","5LT","5MM","5N6","5QP","5RP","5SA","5SP","5TH","5TJ","5TK","5TM","61J","62I","64K","66O","6BG","6C2","6DM","6GB","6GP","6GR","6K3","6KH","6KL","6KS","6KU","6KW","6LA","6LS","6LW","6MJ","6MN","6PG","6PY","6PZ","6S2","6SA","6UD","6Y6","6YR","6ZC","73E","79J","7CV","7D1","7GP","7JZ","7K2","7K3","7NU","7SA","83Y","89Y","8B7","8B9","8EX","8GA","8GG","8GP","8LM","8LR","8OQ","8PK","8S0","8YV","95Z","96O","9AM","9C1","9CD","9GP","9KJ","9MR","9OK","9PG","9QG","9QZ","9S7","9SG","9SJ","9SM","9SP","9T1","9T7","9VP","9WJ","9WN","9WZ","9YW","A0K","A1Q","A2G","A5C","A6P","AAL","AAO","ABC","ABD","ABE","ABF","ABL","AC1","ACG","ACR","ACX","ADA","ADG","ADR","AF1","AFD","AFL","AFO","AFP","AFR","AGC","AGH","AGL","AGR","AH2","AH8","AHG","AHM","AHR","AIG","ALL","ALX","AMG","AMN","AMU","AMV","ANA","AOG","AOS","AQA","ARA","ARB","ARE","ARI","ARW","ASC","ASG","ASO","AXP","AXR","AY9","AZC","B0D","B16","B1H","B1N","B2G","B4G","B6D","B7G","B8D","B9D","BBK","BBV","BCD","BCW","BDF","BDG","BDP","BDR","BDZ","BEM","BFN","BFP","BG6","BG8","BGC","BGL","BGN","BGP","BGS","BHG","BM3","BM7","BMA","BMX","BND","BNG","BNX","BO1","BOG","BQY","BRI","BS7","BTG","BTU","BW3","BWG","BXF","BXP","BXX","BXY","BZD","C3B","C3G","C3X","C4B","C4W","C4X","C5X","CAP","CBF","CBI","CBK","CDR","CE5","CE6","CE8","CEG","CEX","CEY","CEZ","CGF","CJB","CKB","CKP","CNP","CR1","CR6","CRA","CT3","CTO","CTR","CTT","D0N","D1M","D5E","D6G","DAF","DAG","DAN","DDA","DDB","DDL","DEG","DEL","DFR","DFX","DG0","DGC","DGD","DGM","DGO","DGS","DGU","DIG","DJB","DJE","DK4","DKX","DKZ","DL6","DLD","DLF","DLG","DMU","DNO","DO8","DOM","DP5","DPC","DQQ","DQR","DR2","DR3","DR4","DR5","DRI","DSR","DT6","DVC","DYM","E3M","E4P","E5G","EAG","EBG","EBQ","EEN","EEQ","EGA","EJT","EMP","EMZ","EPG","EQP","EQV","ERE","ERI","ETT","EUS","F1P","F1X","F55","F58","F6P","F8X","FBP","FCA","FCB","FCT","FDP","FDQ","FFC","FFX","FIF","FIX","FK9","FKD","FMF","FMO","FNG","FNY","FRU","FSA","FSI","FSM","FSR","FSW","FU4","FUB","FUC","FUD","FUF","FUL","FUY","FVQ","FX1","FYJ","G0S","G16","G1P","G20","G28","G2F","G3F","G3I","G4D","G4S","G6D","G6P","G6S","G7P","G8Z","GAA","GAC","GAD","GAF","GAL","GAT","GBH","GC1","GC4","GC9","GCB","GCD","GCN","GCO","GCS","GCT","GCU","GCV","GCW","GDA","GDL","GE1","GE3","GFP","GIV","GL0","GL1","GL2","GL4","GL5","GL6","GL7","GL9","GLA","GLB","GLC","GLD","GLF","GLG","GLO","GLP","GLS","GLT","GLW","GM0","GMB","GMH","GMT","GMZ","GN1","GN4","GNS","GNX","GP0","GP1","GP4","GPH","GPK","GPM","GPO","GPQ","GPU","GPV","GPW","GQ1","GRF","GRX","GS1","GS4","GS9","GSA","GSD","GTE","GTH","GTK","GTM","GTR","GU0","GU1","GU2","GU3","GU4","GU5","GU6","GU8","GU9","GUF","GUL","GUP","GUZ","GXL","GXV","GYE","GYG","GYP","GYU","GYV","GZL","H1M","H1S","H2P","H3S","H53","H6Q","H6Z","HBZ","HD4","HDL","HMS","HNV","HNW","HSG","HSH","HSJ","HSQ","HSR","HSU","HSX","HSY","HSZ","HTG","HTM","I57","IAB","IDC","IDF","IDG","IDR","IDS","IDT","IDU","IDX","IDY","IEM","IN1","IPT","ISD","ISL","ISX","IXD","J5B","JFZ","JHM","JLT","JRV","JS2","JSV","JV4","JVA","JVS","JZR","K5B","K99","KBA","KBG","KD5","KDA","KDB","KDD","KDE","KDF","KDM","KDN","KDO","KDR","KFN","KG1","KGM","KHP","KME","KO1","KO2","KOT","KTU","L1L","L6S","L6T","LAG","LAH","LAI","LAK","LAO","LAT","LB2","LBS","LBT","LCN","LDY","LEC","LER","LFC","LFR","LGC","LGU","LKA","LKS","LM2","LMO","LMT","LMU","LNV","LOG","LOX","LPK","LRH","LSM","LTG","LTM","LVO","LVZ","LXB","LXC","LXZ","LZ0","M1F","M1P","M2F","M3M","M3N","M55","M6D","M6P","M7B","M7P","M8C","MA1","MA2","MA3","MA8","MAB","MAF","MAG","MAL","MAN","MAT","MAV","MAW","MBE","MBF","MBG","MCU","MDA","MDP","MFA","MFB","MFU","MG5","MGA","MGC","MGL","MGS","MJJ","MLB","MLR","MMA","MMN","MN0","MNA","MQG","MQT","MRH","MRP","MSX","MTT","MUB","MUG","MUR","MVP","MXY","MXZ","MYG","N1L","N9S","NA1","NAA","NAG","NBG","NBX","NBY","NDG","NED","NFG","NG1","NG6","NGA","NGB","NGC","NGE","NGF","NGK","NGL","NGR","NGS","NGY","NGZ","NHF","NLC","NM6","NM9","NNG","NPF","NSQ","NT1","NTF","NTO","NTP","NXD","NYT","O1G","OAK","OEL","OI7","OPM","ORP","OSU","OTG","OTN","OTU","OX2","P53","P6P","P8E","PA1","PA5","PAV","PDX","PH5","PKM","PNA","PNG","PNJ","PNW","PPC","PRP","PSG","PSJ","PSV","PTQ","PUF","PZU","QDK","QIF","QKH","QPS","QV4","R1P","R1X","R2B","R2G","R5P","RAA","RAE","RAF","RAM","RAO","RAT","RB5","RBL","RCD","RDP","REL","RER","RF5","RG1","RGG","RHA","RHC","RI2","RIB","RIP","RM4","RNS","RNT","ROB","ROR","RP3","RP5","RP6","RPA","RR7","RRJ","RRY","RST","RTG","RTV","RUB","RUG","RUU","RV7","RVG","RVM","RWI","RY7","RZM","S6P","S7P","S81","SA0","SCG","SCR","SDD","SDY","SEJ","SF6","SF9","SFJ","SFU","SG4","SG5","SG6","SG7","SGA","SGC","SGD","SGN","SGS","SHB","SHD","SHG","SI3","SIA","SID","SIO","SIZ","SLB","SLM","SLT","SMD","SN5","SNG","SOE","SOG","SOL","SOR","SR1","SSG","SSH","STW","STZ","SUC","SUP","SUS","SWE","SZZ","T68","T6D","T6P","T6T","TA6","TAG","TCB","TCG","TDG","TEU","TF0","TFU","TGA","TGK","TGR","TGY","TH1","TM5","TM6","TM9","TMR","TMX","TNX","TOA","TOC","TQY","TRE","TRV","TS8","TT7","TTV","TTZ","TU4","TUG","TUJ","TUP","TUR","TVD","TVG","TVM","TVS","TVV","TVY","TW7","TWA","TWD","TWG","TWJ","TWY","TXB","TYV","U1Y","U2A","U2D","U63","U8V","U97","U9A","U9D","U9G","U9J","U9M","UAP","UCD","UDC","UEA","V3M","V3P","V71","VG1","VJ1","VJ4","VKN","VTB","W9T","WIA","WOO","WUN","WZ1","WZ2","WZ4","X0X","X1P","X1X","X2F","X2Y","X34","X4S","X5S","X6X","X6Y","XBP","XDP","XDX","XGP","XIL","XKJ","XLF","XLS","XMM","XS2","XUL","XXM","XXR","XXX","XYB","XYF","XYL","XYP","XYS","XYT","XYZ","YDR","YIO","YJM","YKR","YO5","YX0","YX1","YYB","YYH","YYJ","YYK","YYM","YYQ","YYR","YZ0","YZT","Z0F","Z15","Z16","Z2D","Z2T","Z3K","Z3L","Z3Q","Z3U","Z4K","Z4R","Z4S","Z4U","Z4V","Z4W","Z4Y","Z57","Z5J","Z5L","Z61","Z6H","Z6J","Z6W","Z8H","Z8T","Z9D","Z9E","Z9H","Z9K","Z9L","Z9M","Z9N","Z9W","ZB0","ZB1","ZB2","ZB3","ZCD","ZCZ","ZD0","ZDC","ZDM","ZDO","ZEE","ZEL","ZGE","ZMR","UMQ","SQD"]);var ye={Blue:37052,Green:42577,Yellow:16765952,Orange:16021792,Pink:16162465,Purple:10830745,LightBlue:9424105,Brown:10582605,Red:15539236,Secondary:15854817};var tb={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,11:11};function fp(e,t){return e===10?t===4?12:t===5?13:t===6?14:t===7?15:10:tb[e]}var tc={abbr:"Unk",name:"Unknown",color:ye.Secondary,type:10},Ha=[{abbr:"Glc",name:"Glucose",color:ye.Blue,type:0},{abbr:"Man",name:"Mannose",color:ye.Green,type:0},{abbr:"Gal",name:"Galactose",color:ye.Yellow,type:0},{abbr:"Gul",name:"Gulose",color:ye.Orange,type:0},{abbr:"Alt",name:"Altrose",color:ye.Pink,type:0},{abbr:"All",name:"Allose",color:ye.Purple,type:0},{abbr:"Tal",name:"Talose",color:ye.LightBlue,type:0},{abbr:"Ido",name:"Idose",color:ye.Brown,type:0},{abbr:"GlcNAc",name:"N-Acetyl Glucosamine",color:ye.Blue,type:1},{abbr:"ManNAc",name:"N-Acetyl Mannosamine",color:ye.Green,type:1},{abbr:"GalNAc",name:"N-Acetyl Galactosamine",color:ye.Yellow,type:1},{abbr:"GulNAc",name:"N-Acetyl Gulosamine",color:ye.Orange,type:1},{abbr:"AltNAc",name:"N-Acetyl Altrosamine",color:ye.Pink,type:1},{abbr:"AllNAc",name:"N-Acetyl Allosamine",color:ye.Purple,type:1},{abbr:"TalNAc",name:"N-Acetyl Talosamine",color:ye.LightBlue,type:1},{abbr:"IdoNAc",name:"N-Acetyl Idosamine",color:ye.Brown,type:1},{abbr:"GlcN",name:"Glucosamine",color:ye.Blue,type:2},{abbr:"ManN",name:"Mannosamine",color:ye.Green,type:2},{abbr:"GalN",name:"Galactosamine",color:ye.Yellow,type:2},{abbr:"GulN",name:"Gulosamine",color:ye.Orange,type:2},{abbr:"AltN",name:"Altrosamine",color:ye.Pink,type:2},{abbr:"AllN",name:"Allosamine",color:ye.Purple,type:2},{abbr:"TalN",name:"Talosamine",color:ye.LightBlue,type:2},{abbr:"IdoN",name:"Idosamine",color:ye.Brown,type:2},{abbr:"GlcA",name:"Glucuronic Acid",color:ye.Blue,type:3},{abbr:"ManA",name:"Mannuronic Acid",color:ye.Green,type:3},{abbr:"GalA",name:"Galacturonic Acid",color:ye.Yellow,type:3},{abbr:"GulA",name:"Guluronic Acid",color:ye.Orange,type:3},{abbr:"AltA",name:"Altruronic Acid",color:ye.Pink,type:3},{abbr:"AllA",name:"Alluronic Acid",color:ye.Purple,type:3},{abbr:"TalA",name:"Taluronic Acid",color:ye.LightBlue,type:3},{abbr:"IdoA",name:"Iduronic Acid",color:ye.Brown,type:3},{abbr:"Qui",name:"Quinovose",color:ye.Blue,type:4},{abbr:"Rha",name:"Rhamnose",color:ye.Green,type:4},{abbr:"6dGul",name:"6-Deoxy Gulose",color:ye.Orange,type:4},{abbr:"6dAlt",name:"6-Deoxy Altrose",color:ye.Pink,type:4},{abbr:"6dTal",name:"6-Deoxy Talose",color:ye.LightBlue,type:4},{abbr:"Fuc",name:"Fucose",color:ye.Red,type:4},{abbr:"QuiNAc",name:"N-Acetyl Quinovosamine",color:ye.Blue,type:5},{abbr:"RhaNAc",name:"N-Acetyl Rhamnosamine",color:ye.Green,type:5},{abbr:"6dAltNAc",name:"N-Acetyl 6-Deoxy Altrosamine",color:ye.Pink,type:5},{abbr:"6dTalNAc",name:"N-Acetyl 6-Deoxy Talosamine",color:ye.LightBlue,type:5},{abbr:"FucNAc",name:"N-Acetyl Fucosamine",color:ye.Red,type:5},{abbr:"Oli",name:"Olivose",color:ye.Blue,type:6},{abbr:"Tyv",name:"Tyvelose",color:ye.Green,type:6},{abbr:"Abe",name:"Abequose",color:ye.Orange,type:6},{abbr:"Par",name:"Paratose",color:ye.Pink,type:6},{abbr:"Dig",name:"Digitoxose",color:ye.Purple,type:6},{abbr:"Col",name:"Colitose",color:ye.LightBlue,type:6},{abbr:"Ara",name:"Arabinose",color:ye.Green,type:7},{abbr:"Lyx",name:"Lyxose",color:ye.Yellow,type:7},{abbr:"Xyl",name:"Xylose",color:ye.Orange,type:7},{abbr:"Rib",name:"Ribose",color:ye.Pink,type:7},{abbr:"Kdn",name:"Keto-Deoxy Nonulonic Acid",color:ye.Green,type:8},{abbr:"Neu5Ac",name:"N-Acetyl Neuraminic Acid",color:ye.Purple,type:8},{abbr:"Neu5Gc",name:"N-Glycolyl Neuraminic Acid",color:ye.LightBlue,type:8},{abbr:"Neu",name:"Neuraminic Acid",color:ye.Brown,type:8},{abbr:"Sia",name:"Sialic acid",color:ye.Red,type:8},{abbr:"Pse",name:"Pseudaminic Acid",color:ye.Green,type:9},{abbr:"Leg",name:"Legionaminic Acid",color:ye.Yellow,type:9},{abbr:"Aci",name:"Acinetaminic Acid",color:ye.Pink,type:9},{abbr:"4eLeg",name:"4-Epilegionaminic Acid",color:ye.LightBlue,type:9},{abbr:"Bac",name:"Bacillosamine",color:ye.Blue,type:10},{abbr:"LDmanHep",name:"L-Glycero-D-Manno Heptose",color:ye.Green,type:10},{abbr:"Kdo",name:"Keto-Deoxy Octulonic Acid",color:ye.Yellow,type:10},{abbr:"Dha",name:"3-Deoxy Lyxo-Heptulosaric Acid",color:ye.Orange,type:10},{abbr:"DDmanHep",name:"D-Glycero-D-Manno-Heptose",color:ye.Pink,type:10},{abbr:"MurNAc",name:"N-Acetyl Muramic Acid",color:ye.Purple,type:10},{abbr:"MurNGc",name:"N-Glycolyl Muramic Acid",color:ye.LightBlue,type:10},{abbr:"Mur",name:"Muramic Acid",color:ye.Brown,type:10},{abbr:"Api",name:"Apicose",color:ye.Green,type:11},{abbr:"Fru",name:"Fructose",color:ye.Green,type:11},{abbr:"Tag",name:"Tagatose",color:ye.Yellow,type:11},{abbr:"Sor",name:"Sorbose",color:ye.Orange,type:11},{abbr:"Psi",name:"Psicose",color:ye.Pink,type:11}],yp=function(){let e=new Map;for(let t=0,r=Ha.length;t<r;++t){let n=Ha[t];e.set(n.abbr,n)}return e}(),rb={Glc:["GLC","BGC","Z8T","TRE","MLR"],Man:["MAN","BMA"],Gal:["GLA","GAL","GZL","GXL","GIV"],Gul:["4GL","GL0","GUP","Z8H"],Alt:["Z6H","3MK","SHD"],All:["AFD","ALL","WOO","Z2D"],Tal:["ZEE","A5C","SDY"],Ido:["ZCD","Z0F","4N2"],GlcNAc:["NDG","NAG","NGZ"],ManNAc:["BM3","BM7"],GalNAc:["A2G","NGA","YYQ"],GulNAc:["LXB"],AltNAc:[],AllNAc:["NAA"],TalNAc:[],IdoNAc:["LXZ","HSQ"],GlcN:["PA1","GCS"],ManN:["95Z"],GalN:["X6X","1GN"],GulN:[],AltN:[],AllN:[],TalN:[],IdoN:[],GlcA:["GCU","BDP"],ManA:["MAV","BEM"],GalA:["ADA","GTR","GTK"],GulA:["LGU"],AltA:[],AllA:[],TalA:["X1X","X0X"],IdoA:["IDR"],Qui:["G6D","YYK"],Rha:["RAM","RM4","XXR"],"6dGul":["66O"],"6dAlt":[],"6dTal":[],Fuc:["FUC","FUL","FCA","FCB","GYE"],QuiNAc:["Z9W"],RhaNAc:[],"6dAltNAc":[],"6dTalNAc":[],FucNAc:["49T"],Oli:["DDA","RAE","Z5J"],Tyv:["TYV"],Abe:["ABE"],Par:["PZU"],Dig:["Z3U"],Col:[],Ara:["64K","ARA","ARB","AHR","FUB","BXY","BXX","SEJ"],Lyx:["LDY","Z4W"],Xyl:["XYS","XYP","XYZ","HSY","LXC"],Rib:["YYM","RIP","RIB","BDR","0MK","Z6J","32O"],Kdn:["KDM","KDN"],Neu5Ac:["SIA","SLB"],Neu5Gc:["NGC","NGE"],Neu:[],Sia:[],Pse:[],Leg:[],Aci:[],"4eLeg":[],Bac:[],LDmanHep:["GMH"],Kdo:["KDO"],Dha:[],DDmanHep:["289"],MurNAc:["MUB","AMU"],MurNGc:[],Mur:["1S4","MUR"],Api:["XXM"],Fru:["BDF","Z9N","FRU","LFR"],Tag:["T6T"],Sor:["SOE","UEA"],Psi:["PSV","SF6","SF9","TTV"]},nb={Glc:["AGLC","BGLC"],GlcNAc:["AGLCNA","BGLCNA","BGLCN0"],GlcA:["AGLCA","BGLCA","BGLCA0"],Man:["AMAN","BMAN"],Rha:["ARHM","BRHM"],Ara:["AARB","BARB"],Gal:["AGAL","BGAL"],GalNAc:["AGALNA","BGALNA"],Gul:["AGUL","BGUL"],Alt:["AALT","BALT"],All:["AALL","BALL"],Tal:["ATAL","BTAL"],Ido:["AIDO","BIDO"],IdoA:["AIDOA","BIDOA"],Fuc:["AFUC","BFUC"],Lyx:["ALYF","BLYF"],Xyl:["AXYL","BXYL","AXYF","BXYF"],Rib:["ARIB","BRIB"],Fru:["AFRU","BFRU"],Neu5Ac:["ANE5AC","BNE5AC"]},ob=function(){let e=new Map;for(let t=0,r=Ha.length;t<r;++t){let n=Ha[t],o=rb[n.abbr];if(o)for(let i=0,s=o.length;i<s;++i)e.set(o[i],n);let a=nb[n.abbr];if(a)for(let i=0,s=a.length;i<s;++i)e.set(a[i],n)}return pp.forEach(t=>{e.has(t)||e.set(t,tc)}),e}(),Cn=ob;var xr;(o=>{function e(a){return Ll(a.values())}o.toArray=e;function t(...a){if(a.length===0)return new Set;a.length===1&&new Set(a[0]);let i=new Set(a[0]);for(let s=1,u=a.length;s<u;s++)a[s].forEach(m=>i.add(m));return i}o.unionMany=t;function r(a,i){let s=0;return i.forEach(u=>{a.has(u)&&(s+=1)}),s}o.intersectionSize=r;function n(a,i){if(a.size!==i.size)return!1;let s=!0;return i.forEach(u=>{a.has(u)||(s=!1)}),s}o.areEqual=n})(xr||(xr={}));var rc=new Set(["DAPC","DBPC","DFPC","DGPC","DIPC","DLPC","DNPC","DOPC","DPPC","DRPC","DTPC","DVPC","DXPC","DYPC","LPPC","PAPC","PEPC","PGPC","PIPC","POPC","PRPC","PUPC","DAPE","DBPE","DFPE","DGPE","DIPE","DLPE","DNPE","DOPE","DPPE","DRPE","DTPE","DUPE","DVPE","DXPE","DYPE","LPPE","PAPE","PGPE","PIPE","POPE","PQPE","PRPE","PUPE","DAPS","DBPS","DFPS","DGPS","DIPS","DLPS","DNPS","DOPS","DPPS","DRPS","DTPS","DUPS","DVPS","DXPS","DYPS","LPPS","PAPS","PGPS","PIPS","POPS","PQPS","PRPS","PUPS","DAPG","DBPG","DFPG","DGPG","DIPG","DLPG","DNPG","DOPG","DPPG","DRPG","DTPG","DVPG","DXPG","DYPG","LPPG","PAPG","PGPG","PIPG","POPG","PRPG","DAPA","DBPA","DFPA","DGPA","DIPA","DLPA","DNPA","DOPA","DPPA","DRPA","DTPA","DVPA","DXPA","DYPA","LPPA","PAPA","PGPA","PIPA","POPA","PRPA","PUPA","DPP","DPPI","PAPI","PIPI","POP","POPI","PUPI","PVP","PVPI","PADG","PIDG","PODG","PUDG","PVDG","APC","CPC","IPC","LPC","OPC","PPC","TPC","UPC","VPC","BNSM","DBSM","DPSM","DXSM","PGSM","PNSM","POSM","PVSM","XNSM","DPCE","DXCE","PNCE","XNCE","DMPC"]);var nc=new Set(["118","119","543","1AL","1CU","2FK","2HP","2OF","3CO","3MT","3NI","3OF","3P8","4MO","4PU","4TI","6MO","ACT","AG","AL","ALF","AM","ATH","AU","AU3","AUC","AZI","BA","BCT","BEF","BF4","BO4","BR","BS3","BSY","CA","CAC","CD","CD1","CD3","CD5","CE","CF","CHT","CL","CO","CO3","CO5","CON","CR","CS","CSB","CU","CU1","CU3","CUA","CUZ","CYN","DME","DMI","DSC","DTI","DY","E4N","EDR","EMC","ER3","EU","EU3","F","FE","FE2","FPO","GA","GD3","GEP","HAI","HG","HGC","IN","IOD","IR","IR3","IRI","IUM","K","KO4","LA","LCO","LCP","LI","LU","MAC","MG","MH2","MH3","MLI","MMC","MN","MN3","MN5","MN6","MO1","MO2","MO3","MO4","MO5","MO6","MOO","MOS","MOW","MW1","MW2","MW3","NA","NA2","NA5","NA6","NAO","NAW","ND","NET","NH4","NI","NI1","NI2","NI3","NO2","NO3","NRU","O4M","OAA","OC1","OC2","OC3","OC4","OC5","OC6","OC7","OC8","OCL","OCM","OCN","OCO","OF1","OF2","OF3","OH","OS","OS4","OXL","PB","PBM","PD","PDV","PER","PI","PO3","PO4","PR","PT","PT4","PTN","RB","RH3","RHD","RU","SB","SCN","SE4","SEK","SM","SMO","SO3","SO4","SR","T1A","TB","TBA","TCN","TEA","TH","THE","TL","TMA","TRA","UNX","V","VN3","VO4","W","WO5","Y1","YB","YB2","YH","YT3","ZCM","ZN","ZN2","ZN3","ZNO","ZO3","ZR","NCO","OHX"]);var ib=function(){let e=Object.create(null),t=[];for(let r="A".charCodeAt(0);r<="Z".charCodeAt(0);r++)t[t.length]=String.fromCharCode(r);for(let r="a".charCodeAt(0);r<="z".charCodeAt(0);r++)t[t.length]=String.fromCharCode(r);for(let r="0".charCodeAt(0);r<="9".charCodeAt(0);r++)t[t.length]=String.fromCharCode(r);for(let r of t){e[r]=r.toUpperCase();for(let n of t){e[r+n]=(r+n).toUpperCase();for(let o of t)e[r+n+o]=(r+n+o).toUpperCase()}}return e}();function Uo(e){return ib[e]||e.toUpperCase()}var hp={0:{trace:new Set,directionFrom:new Set,directionTo:new Set,backboneStart:new Set,backboneEnd:new Set,coarseBackbone:new Set},1:{trace:new Set(["CA"]),directionFrom:new Set(["C"]),directionTo:new Set(["O","OC1","O1","OX1","OXT","OT1"]),backboneStart:new Set(["N"]),backboneEnd:new Set(["C"]),coarseBackbone:new Set(["CA","BB","CA1"])},2:{trace:new Set(["CA"]),directionFrom:new Set(["C"]),directionTo:new Set(["O"]),backboneStart:new Set(["N"]),backboneEnd:new Set(["CD"]),coarseBackbone:new Set(["CA"])},3:{trace:new Set(["CA"]),directionFrom:new Set(["C"]),directionTo:new Set(["O"]),backboneStart:new Set(["N"]),backboneEnd:new Set(["CG"]),coarseBackbone:new Set(["CA"])},4:{trace:new Set(["O3'","O3*"]),directionFrom:new Set(["C4'","C4*"]),directionTo:new Set(["C3'","C3*"]),backboneStart:new Set(["P"]),backboneEnd:new Set(["O3'","O3*"]),coarseBackbone:new Set(["P"])},5:{trace:new Set(["O3'","O3*"]),directionFrom:new Set(["C3'","C3*"]),directionTo:new Set(["C1'","C1*"]),backboneStart:new Set(["P"]),backboneEnd:new Set(["O3'","O3*"]),coarseBackbone:new Set(["P"])},6:{trace:new Set(["N4'","N4*"]),directionFrom:new Set(["N4'","N4*"]),directionTo:new Set(["C7'","C7*"]),backboneStart:new Set(["N1'","N1*"]),backboneEnd:new Set(["C'","C*"]),coarseBackbone:new Set(["P"])}},xp=new Set(["d-peptide linking","d-peptide nh3 amino terminus","d-peptide cooh carboxy terminus","d-gamma-peptide, c-delta linking","d-beta-peptide, c-gamma linking"]),gp=new Set(["l-peptide linking","l-peptide nh3 amino terminus","l-peptide cooh carboxy terminus","l-gamma-peptide, c-delta linking","l-beta-peptide, c-gamma linking"]),ab=new Set(["d-gamma-peptide, c-delta linking","l-gamma-peptide, c-delta linking"]),sb=new Set(["d-beta-peptide, c-gamma linking","l-beta-peptide, c-gamma linking"]),ub=new Set(["d-peptide nh3 amino terminus","d-peptide cooh carboxy terminus","l-peptide nh3 amino terminus","l-peptide cooh carboxy terminus"]),bp=new Set(["peptide linking","peptide-like"]),cb=xr.unionMany(xp,gp,bp),Sp=new Set(["dna linking","l-dna linking","dna oh 5 prime terminus","dna oh 3 prime terminus"]),Cp=new Set(["rna linking","l-rna linking","rna oh 5 prime terminus","rna oh 3 prime terminus"]),_p=xr.unionMany(new Set(["d-saccharide, beta linking","l-saccharide, beta linking","d-saccharide, alpha linking","l-saccharide, alpha linking","l-saccharide","d-saccharide","saccharide"]),new Set(["d-saccharide 1,4 and 1,4 linking","l-saccharide 1,4 and 1,4 linking","d-saccharide 1,4 and 1,6 linking","l-saccharide 1,4 and 1,6 linking"])),mb=new Set(["non-polymer","other"]),lb=new Set(["ion"]),db=new Set(["lipid"]),Ap=new Set(["SOL","WAT","HOH","H2O","W","DOD","D3O","TIP","TIP3","TIP4","SPC"]),Ip=new Set(["HIS","ARG","LYS","ILE","PHE","LEU","TRP","ALA","MET","PRO","CYS","ASN","VAL","GLY","SER","GLN","TYR","ASP","GLU","THR","SEC","PYL","UNK","MSE","SEP","TPO","PTR","PCA","HSD","HSE","HSP","LSN","ASPP","GLUP","HID","HIE","HIP","LYN","ASH","GLH"]),Pp=new Set(["DAL","DAR","DSG","DAS","DCY","DGL","DGN","DHI","DIL","DLE","DLY","MED","DPN","DPR","DSN","DTH","DTR","DTY","DVA","DNE"]),zi=xr.unionMany(Ip,Pp),qa=new Set(["A","C","T","G","I","U","N"]),za=new Set(["DA","DC","DT","DG","DI","DU","DN"]),oc=new Set(["APN","CPN","TPN","GPN"]),pb=new Set(["A","G","I","DA","DG","DI","APN","GPN"]),fb=new Set(["C","T","U","DC","DT","DU","CPN","TPN"]),ic=xr.unionMany(qa,za,oc),Tp=e=>pb.has(e.toUpperCase()),vp=e=>fb.has(e.toUpperCase()),Ka=xr.unionMany(zi,ic);function ja(e,t){return t=t.toUpperCase(),oc.has(t)?8:cb.has(e)?5:Cp.has(e)?6:Sp.has(e)?7:_p.has(e)?9:Ap.has(t)?2:nc.has(t)?3:rc.has(t)?4:mb.has(e)?Cn.has(t)?9:zi.has(t)?5:qa.has(t)?6:za.has(t)?7:1:0}function Dp(e,t){return t===5?ab.has(e)?2:sb.has(e)?3:ub.has(e)?0:1:t===6?4:t===7?5:t===8?6:0}function ac(e){return e=e.toUpperCase(),zi.has(e)?"peptide linking":qa.has(e)?"rna linking":za.has(e)?"dna linking":Cn.has(e)?"saccharide":"other"}function Mp(e){return{formula:"",formula_weight:0,id:e,name:e,mon_nstd_flag:Ka.has(e)?"y":"n",pdbx_synonyms:[],type:ac(e)}}function Ep(e){return e=e.toUpperCase(),Ap.has(e)?"water":Ka.has(e)?"polymer":Cn.has(e)?"branched":"non-polymer"}function Bp(e,t){return e=e.toUpperCase(),gp.has(t)?"polypeptide(L)":xp.has(t)?"polypeptide(D)":Cp.has(t)?"polyribonucleotide":Sp.has(t)?"polydeoxyribonucleotide":_p.has(t)||Cn.has(e)?"oligosaccharide":oc.has(e)?"peptide nucleic acid":Ip.has(e)?"polypeptide(L)":Pp.has(e)?"polypeptide(D)":qa.has(e)?"polyribonucleotide":za.has(e)?"polydeoxyribonucleotide":lb.has(t)||nc.has(e)?"ion":db.has(t)||rc.has(e)?"lipid":bp.has(t)?"peptide-like":"other"}function Qa(e){return Lo(e)||sc(e)}function Lo(e){return e===7||e===6||e===8}function sc(e){return e===5}var ke;(s=>{s.is=Ot.has,s.create=Ot.create;let r;(Y=>(Y[Y.None=0]="None",Y[Y.DoubleHelix=1]="DoubleHelix",Y[Y.Helix=2]="Helix",Y[Y.Beta=4]="Beta",Y[Y.Bend=8]="Bend",Y[Y.Turn=16]="Turn",Y[Y.LeftHanded=32]="LeftHanded",Y[Y.RightHanded=64]="RightHanded",Y[Y.ClassicTurn=128]="ClassicTurn",Y[Y.InverseTurn=256]="InverseTurn",Y[Y.HelixOther=512]="HelixOther",Y[Y.Helix27=1024]="Helix27",Y[Y.Helix3Ten=2048]="Helix3Ten",Y[Y.HelixAlpha=4096]="HelixAlpha",Y[Y.HelixGamma=8192]="HelixGamma",Y[Y.HelixOmega=16384]="HelixOmega",Y[Y.HelixPi=32768]="HelixPi",Y[Y.HelixPolyproline=65536]="HelixPolyproline",Y[Y.DoubleHelixOther=131072]="DoubleHelixOther",Y[Y.DoubleHelixZ=262144]="DoubleHelixZ",Y[Y.DoubleHelixA=524288]="DoubleHelixA",Y[Y.DoubleHelixB=1048576]="DoubleHelixB",Y[Y.BetaOther=2097152]="BetaOther",Y[Y.BetaStrand=4194304]="BetaStrand",Y[Y.BetaSheet=8388608]="BetaSheet",Y[Y.BetaBarell=16777216]="BetaBarell",Y[Y.TurnOther=33554432]="TurnOther",Y[Y.Turn1=67108864]="Turn1",Y[Y.Turn2=134217728]="Turn2",Y[Y.Turn3=268435456]="Turn3",Y[Y.NA=536870912]="NA"))(r=s.Flag||(s.Flag={})),s.SecondaryStructureMmcif={helx_lh_27_p:1058,helx_lh_3t_p:2082,helx_lh_al_p:4130,helx_lh_a_n:524321,helx_lh_b_n:1048609,helx_lh_ga_p:8226,helx_lh_n:33,helx_lh_om_p:16418,helx_lh_ot_n:131105,helx_lh_ot_p:546,helx_lh_p:34,helx_lh_pi_p:32802,helx_lh_pp_p:65570,helx_lh_z_n:262177,helx_n:1,helx_ot_n:1,helx_ot_p:2,helx_p:2,helx_rh_27_p:1090,helx_rh_3t_p:2114,helx_rh_al_p:4162,helx_rh_a_n:524353,helx_rh_b_n:1048641,helx_rh_ga_p:8258,helx_rh_n:65,helx_rh_om_p:16450,helx_rh_ot_n:131137,helx_rh_ot_p:578,helx_rh_p:66,helx_rh_pi_p:32834,helx_rh_pp_p:65602,helx_rh_z_n:262209,strn:4194308,turn_ot_p:33554448,turn_p:16,turn_ty1p_p:67109136,turn_ty1_p:67109008,turn_ty2p_p:134218e3,turn_ty2_p:134217872,turn_ty3p_p:268435728,turn_ty3_p:268435600,bend:8,other:0},s.SecondaryStructurePdb={1:4162,2:16450,3:32834,4:8258,5:2114,6:4130,7:16418,8:8226,9:1026,10:65538},s.SecondaryStructureStride={H:4098,G:2050,I:32770,E:8388612,B:4194308,T:16,C:536870912},s.SecondaryStructureDssp={H:4098,B:4194308,E:8388612,G:2050,I:32770,T:16,S:8}})(ke||(ke={}));var _e;(m=>{m.is=Ot.has;let t;(h=>(h[h.None=0]="None",h[h.Covalent=1]="Covalent",h[h.MetallicCoordination=2]="MetallicCoordination",h[h.HydrogenBond=4]="HydrogenBond",h[h.Disulfide=8]="Disulfide",h[h.Aromatic=16]="Aromatic",h[h.Computed=32]="Computed"))(t=m.Flag||(m.Flag={}));function r(c){return Ot.create(c)}m.create=r;function n(c){return(c&1)!==0}m.isCovalent=n;function o(c){return c===Math.pow(2,6)-1}m.isAll=o,m.Names={covalent:1,"metal-coordination":2,"hydrogen-bond":4,disulfide:8,aromatic:16,computed:32};function i(c){return c in m.Names}m.isName=i;function s(c){switch(c){case"covalent":return 1;case"metal-coordination":return 2;case"hydrogen-bond":return 4;case"disulfide":return 8;case"aromatic":return 16;case"computed":return 32}}m.fromName=s;function u(c){let l=0;for(let d=0,y=c.length;d<y;++d)l|=s(c[d]);return l}m.fromNames=u})(_e||(_e={}));var hb=new Set;function Zr(e,t){let r=hp[e];if(r!==void 0){let n=r[t];if(n!==void 0)return n}return hb}var Rp=p.zero();function Ya(e,t){let r=e.conformation.position,n=new Float32Array(t.length*3),{elements:o}=e;for(let a=0,i=t.length;a<i;++a)r(o[t[a]],Rp),p.toArray(Rp,n,a*3);return n}function Fp(e,t,r,n){let{label_comp_id:o,type_symbol:a,_rowCount:i}=e.atoms,{_rowCount:s}=e.residues,{offsets:u}=t.residueAtomSegments,m=new Uint8Array(i);for(let h=0;h<i;++h)m[h]=dp(a.value(h));let c=new Int32Array(s),l=new Int32Array(s),d=new Int32Array(s),y=new Uint8Array(s),S=new Uint8Array(s),x=new Map,g=new Map;for(let h=0;h<s;++h){let f=o.value(u[h]),C=n,T,I;if(x.has(f))T=x.get(f),I=g.get(f);else{let v;C.has(f)?v=C.get(f).type:v=ac(f),T=ja(v,f),I=Dp(v,T),x.set(f,T),g.set(f,I)}y[h]=T,S[h]=I;let P=Zr(I,"trace"),A=r.findAtomsOnResidue(h,P);if(A===-1){let v=Zr(I,"coarseBackbone");A=r.findAtomsOnResidue(h,v),A===-1&&Qa(T)&&(A=r.findElementOnResidue(h,Uo("C")))}c[h]=A;let b=Zr(I,"directionFrom");l[h]=r.findAtomsOnResidue(h,b);let _=Zr(I,"directionTo");d[h]=r.findAtomsOnResidue(h,_)}return{atom:{atomicNumber:m},residue:{traceElementIndex:c,directionFromElementIndex:l,directionToElementIndex:d,moleculeType:y,polymerType:S}}}function ji(e,t){return t?t.length===1?Wt(t.charCodeAt(0),e):t.length===2?Wt(t.charCodeAt(0),Wt(t.charCodeAt(1),e)):`${e} ${t}`:e}function xb(e,t,r,n){if(e.has(t)){let o=e.get(t);o.has(r)||o.set(r,n)}else{let o=new Map;e.set(t,o),o.set(r,n)}}function gb(e,t,r){return{entities:e,segments:r,label_seq_id:ee.ofSortedArray(t.residues.label_seq_id.toArray({array:Int32Array})),label_atom_id:t.atoms.label_atom_id,auth_atom_id:t.atoms.auth_atom_id,label_alt_id:t.atoms.label_alt_id,type_symbol:t.atoms.type_symbol,chain_index_entity_index:new Int32Array(t.chains._rowCount),entity_index_label_asym_id:new Map,chain_index_label_seq_id:new Map,auth_asym_id_auth_seq_id:new Map,chain_index_auth_seq_id:new Map,label_asym_id:new Map}}var Ki=wa.EmptyResidueKey(),mc=class{constructor(t){this.map=t;this.entityIndex=t.entities.getEntityIndex,this.residueOffsets=this.map.segments.residueAtomSegments.offsets}getEntityFromChain(t){return this.map.chain_index_entity_index[t]}findEntity(t){let r=this.map.label_asym_id.get(t);return r!==void 0?r:-1}findChainLabel(t){let r=this.entityIndex(t.label_entity_id);if(r<0||!this.map.entity_index_label_asym_id.has(r))return-1;let n=this.map.entity_index_label_asym_id.get(r);return n&&n.has(t.label_asym_id)?n.get(t.label_asym_id):-1}findChainAuth(t){if(!this.map.auth_asym_id_auth_seq_id.has(t.auth_asym_id))return-1;let r=this.map.auth_asym_id_auth_seq_id.get(t.auth_asym_id);return r.has(t.auth_seq_id)?r.get(t.auth_seq_id):-1}findResidue(t,r,n,o){let a;arguments.length===1?a=t:(Ki.label_entity_id=t,Ki.label_asym_id=r,Ki.auth_seq_id=n,Ki.pdbx_PDB_ins_code=o,a=Ki);let i=this.findChainLabel(a);if(i<0)return-1;let s=this.map.chain_index_auth_seq_id.get(i),u=ji(a.auth_seq_id,a.pdbx_PDB_ins_code||"");return s.has(u)?s.get(u):-1}findResidueAuth(t){let r=this.findChainAuth(t);if(r<0)return-1;let n=this.map.chain_index_auth_seq_id.get(r),o=ji(t.auth_seq_id,t.pdbx_PDB_ins_code||"");return n.has(o)?n.get(o):-1}findResidueInsertion(t){let r=this.findChainLabel(t);if(r<0)return-1;let n=this.map.chain_index_label_seq_id.get(r),o=ji(t.label_seq_id,t.pdbx_PDB_ins_code||"");if(n.has(o))return n.get(o);let a=ee.findPredecessorIndex(this.map.label_seq_id,t.label_seq_id),i=eo.chainStartResidueIndex(this.map.segments,r);if(a<i)return i;let s=eo.chainEndResidueIndexExcl(this.map.segments,r)-1;return a>=s?s:a}findAtom(t){let r=this.findResidue(t);return r<0?-1:typeof t.label_alt_id>"u"?uc(this.residueOffsets[r],this.residueOffsets[r+1],this.map.label_atom_id,t.label_atom_id):cc(this.residueOffsets[r],this.residueOffsets[r+1],this.map.label_atom_id,this.map.label_alt_id,t.label_atom_id,t.label_alt_id)}findAtomAuth(t){let r=this.findResidueAuth(t);return r<0?-1:typeof t.label_alt_id>"u"?uc(this.residueOffsets[r],this.residueOffsets[r+1],this.map.auth_atom_id,t.auth_atom_id):cc(this.residueOffsets[r],this.residueOffsets[r+1],this.map.auth_atom_id,this.map.label_alt_id,t.auth_atom_id,t.label_alt_id)}findAtomOnResidue(t,r,n){return typeof n>"u"?uc(this.residueOffsets[t],this.residueOffsets[t+1],this.map.label_atom_id,r):cc(this.residueOffsets[t],this.residueOffsets[t+1],this.map.label_atom_id,this.map.label_alt_id,r,n)}findAtomsOnResidue(t,r){return bb(this.residueOffsets[t],this.residueOffsets[t+1],this.map.label_atom_id,r)}findElementOnResidue(t,r){return Sb(this.residueOffsets[t],this.residueOffsets[t+1],this.map.type_symbol,r)}};function uc(e,t,r,n){for(let o=e;o<t;o++)if(r.value(o)===n)return o;return-1}function bb(e,t,r,n){for(let o=e;o<t;o++)if(n.has(r.value(o)))return o;return-1}function cc(e,t,r,n,o,a){for(let i=e;i<t;i++)if(r.value(i)===o&&n.value(i)===a)return i;return-1}function Sb(e,t,r,n){for(let o=e;o<t;o++)if(r.value(o)===n)return o;return-1}function Up(e,t,r){let n=gb(t,e,r),{label_seq_id:o,auth_seq_id:a,pdbx_PDB_ins_code:i}=e.residues,{label_entity_id:s,label_asym_id:u,auth_asym_id:m}=e.chains,c=z.ofBounds(0,e.atoms._rowCount),l=Ue.transientSegments(r.chainAtomSegments,c);for(;l.hasNext;){let d=l.move(),y=d.index,S=t.getEntityIndex(s.value(y));n.chain_index_entity_index[y]=S;let x=m.value(y),g=n.auth_asym_id_auth_seq_id.get(x);g||(g=new Map,n.auth_asym_id_auth_seq_id.set(x,g));let h=u.value(y);n.label_asym_id.has(h)||n.label_asym_id.set(h,S),xb(n.entity_index_label_asym_id,S,h,y);let f=new Map,C=new Map;n.chain_index_label_seq_id.set(y,f),n.chain_index_auth_seq_id.set(y,C);let T=Ue.transientSegments(r.residueAtomSegments,c,d);for(;T.hasNext;){let P=T.move().index,A=a.value(P),b=i.value(P);f.set(ji(o.value(P),b),P),C.set(ji(A,b),P),g.set(A,y)}}return new mc(n)}function Cb(e){if(e._rowCount===0)return{residues:[],chains:[]};let t=0,r=e._rowCount,n=[t],o=[t],{label_entity_id:a,label_asym_id:i,label_seq_id:s,auth_seq_id:u,pdbx_PDB_ins_code:m}=e;for(let c=t+1;c<r;c++){let l=!a.areValuesEqual(c-1,c)||!i.areValuesEqual(c-1,c);(l||!s.areValuesEqual(c-1,c)||!u.areValuesEqual(c-1,c)||!m.areValuesEqual(c-1,c))&&(n[n.length]=c),l&&(o[o.length]=c)}return{residues:n,chains:o}}function _b(e,t,r){let n=$e.ofColumns(cp,{type_symbol:ne.ofArray({array:ne.mapToArray(e.type_symbol,Uo),schema:ne.Schema.Aliased(ne.Schema.str)}),label_atom_id:e.label_atom_id,auth_atom_id:e.auth_atom_id,label_alt_id:e.label_alt_id,label_comp_id:e.label_comp_id,auth_comp_id:e.auth_comp_id,pdbx_formal_charge:e.pdbx_formal_charge}),o=$e.view(e,mp,r.residues),a=$e.view(e,lp,r.chains);if(!o.label_seq_id.isDefined){let i=new Int32Array(o.label_seq_id.rowCount),{residues:s,chains:u}=r,m=0,c=0;for(let l=0,d=i.length;l<d;++l)s[l]>=u[m+1]&&(m+=1,c=0),i[l]=++c;o.label_seq_id=ne.ofIntArray(i)}return $e.columnToArray(o,"label_seq_id",Int32Array),$e.columnToArray(o,"auth_seq_id",Int32Array),{atoms:n,residues:o,chains:a,atomSourceIndex:t}}function Ab(e){return{id:Ur.create22(),atomId:e.id,occupancy:e.occupancy.isDefined?e.occupancy:ne.ofConst(1,e._rowCount,ne.Schema.float),B_iso_or_equiv:e.B_iso_or_equiv,xyzDefined:e.Cartn_x.isDefined&&e.Cartn_y.isDefined&&e.Cartn_z.isDefined,x:e.Cartn_x.toArray({array:Float32Array}),y:e.Cartn_y.toArray({array:Float32Array}),z:e.Cartn_z.toArray({array:Float32Array})}}function Ib(e,t){return $e.areEqual(e.chains,t.chains)&&$e.areEqual(e.residues,t.residues)&&$e.areEqual(e.atoms,t.atoms)}function Pb(e,t){let r=new Map;if(!kt.is(t))return r;let{molstar_atom_site_operator_mapping:n}=Fa(up,t.data.frame);if(n._rowCount===0)return r;let o=new Map,a=new Map;for(let c=0;c<n._rowCount;c++){let l=n.assembly_operator_id.valueKind(c)===ne.ValueKind.Present?{id:n.assembly_id.value(c),operList:[],operId:n.assembly_operator_id.value(c)}:void 0,d=Tt.create(n.operator_name.value(c),re.identity(),{assembly:l,spgrOp:n.symmetry_operator_index.valueKind(c)===ne.ValueKind.Present?n.symmetry_operator_index.value(c):void 0,hkl:p.ofArray(n.symmetry_hkl.value(c)),ncsId:n.ncs_id.value(c)}),y=n.suffix.value(c),S=n.label_asym_id.value(c);o.set(`${S}${y}`,{name:S,operator:d});let x=n.auth_asym_id.value(c);a.set(`${x}${y}`,x)}let{label_asym_id:i,auth_asym_id:s}=e.chains,u=new Array(i.rowCount),m=new Array(i.rowCount);for(let c=0;c<i.rowCount;c++){let l=i.value(c),d=s.value(c);if(!o.has(l)){u[c]=l,m[c]=d;continue}let{name:y,operator:S}=o.get(l);r.set(c,S),u[c]=y,m[c]=a.get(d)||d}return e.chains.label_asym_id=ne.ofArray({array:u,valueKind:e.chains.label_asym_id.valueKind,schema:e.chains.label_asym_id.schema}),e.chains.auth_asym_id=ne.ofArray({array:m,valueKind:e.chains.auth_asym_id.valueKind,schema:e.chains.auth_asym_id.schema}),r}function Tb(e,t,r,n,o,a){let i=Cb(e),s=_b(e,t,i),u=Pb(s,o);if(a&&Ib(a.atomicHierarchy,s))return{sameAsPrevious:!0,hierarchy:a.atomicHierarchy,chainOperatorMapping:u};let m={residueAtomSegments:Ue.ofOffsets(i.residues,z.ofBounds(0,e._rowCount)),chainAtomSegments:Ue.ofOffsets(i.chains,z.ofBounds(0,e._rowCount))},c=Up(s,r,m),l=Fp(s,m,c,n);return{sameAsPrevious:!1,hierarchy:{...s,...m,index:c,derived:l},chainOperatorMapping:u}}function lc(e,t,r,n,o,a){let{sameAsPrevious:i,hierarchy:s,chainOperatorMapping:u}=Tb(e,t,r,n,o,a),m=Ab(e);return{sameAsPrevious:i,hierarchy:s,conformation:m,chainOperatorMapping:u}}var ct;(g=>{function e(h){return ee.ofSortedArray(h)}g.ofSortedRanges=e;function t(h){return h[0]}g.start=t;function r(h){return h[h.length-1]+1}g.end=r;function n(h){return h[0]}g.min=n;function o(h){return h[h.length-1]}g.max=o;function a(h){let f=0;for(let C=0,T=h.length;C<T;C+=2)f+=h[C+1]-h[C]+1;return f}g.size=a;function i(h){return h.length/2}g.count=i;function s(h,f){return h[f*2]}g.startAt=s;function u(h,f){return h[f*2+1]+1}g.endAt=u;function m(h,f){return h[f*2]}function c(h,f){return h[f*2+1]}function l(h,f){return d(h,f)!==-1}g.has=l;function d(h,f){return y(h,f,0)}g.firstIntersectionIndex=d;function y(h,f,C){if(m(h,C)>Ae.max(f)||o(h)<Ae.min(f))return-1;for(let T=C,I=i(h);T<I;++T){let P=z.ofRange(m(h,T),c(h,T));if(Ae.areIntersecting(P,f))return T}return-1}function S(h,f){return new x(h,f)}g.transientSegments=S;class x{constructor(f,C){this.ranges=f;this.set=C;this.value={index:0,start:0,end:0};this.curIndex=0;this.hasNext=!1;this.curIndex=d(f,C),this.hasNext=this.curIndex!==-1}updateValue(){this.value.index=this.curIndex,this.value.start=Ae.findPredecessorIndex(this.set,s(this.ranges,this.curIndex)),this.value.end=Ae.findPredecessorIndex(this.set,u(this.ranges,this.curIndex))}move(){return this.hasNext&&(this.updateValue(),this.curIndex=y(this.ranges,this.set,this.curIndex+1),this.hasNext=this.curIndex!==-1),this.value}}g.Iterator=x})(ct||(ct={}));var Lp={chainKey:[],entityKey:[],findSequenceKey:()=>-1,findChainKey:()=>-1,getEntityFromChain:()=>-1,count:0,entity_id:ne.Undefined(0,ne.Schema.str),asym_id:ne.Undefined(0,ne.Schema.str),seq_id_begin:ne.Undefined(0,ne.Schema.int),seq_id_end:ne.Undefined(0,ne.Schema.int),chainElementSegments:Ue.create([]),polymerRanges:ct.ofSortedRanges([]),gapRanges:ct.ofSortedRanges([])},Xa;(t=>t.Empty={isDefined:!1,spheres:Lp,gaussians:Lp})(Xa||(Xa={}));function vb(e,t,r){if(e.has(t))return e.get(t);let n=r.index++;return e.set(t,n),n}function Db(e,t){if(e.has(t))return e.get(t);let r=new Map;return e.set(t,r),r}function Mb(e,t,r){let n=e.getEntityIndex;return{findChainKey:(i,s)=>{let u=n(i);if(u<0)return-1;let m=t.get(u);return m.has(s)?m.get(s):-1},findSequenceKey:(i,s,u)=>{let m=n(i);if(m<0)return-1;let c=t.get(m);if(c===void 0)return-1;let l=c.get(s);if(l===void 0)return-1;let d=r.get(l),{elementIndices:y,seqRanges:S}=d,x=ct.firstIntersectionIndex(S,Ae.ofSingleton(u));return x!==-1?y[x]:-1}}}function dc(e,t){let{entity_id:r,asym_id:n,seq_id_begin:o,seq_id_end:a,count:i,chainElementSegments:s}=e,u=new Map,m=new Map,c={index:0},l=new Int32Array(i),d=new Int32Array(i),y=new Int32Array(s.count);for(let h=0;h<i;h++)d[h]=t.getEntityIndex(r.value(h));for(let h=0;h<s.count;h++){let f=s.offsets[h],C=s.offsets[h+1],T=d[f];y[h]=T;let I=Db(m,T),P=vb(I,n.value(f),c);for(let v=f;v<C;v++)l[v]=P;let A=[],b=[];for(let v=f;v<C;v++){let R=o.value(v),E=a.value(v);A.push(v),b.push(R,E)}let _={elementIndices:A,seqRanges:ct.ofSortedRanges(b)};u.set(P,_)}let{findChainKey:S,findSequenceKey:x}=Mb(t,m,u);return{chainKey:l,entityKey:d,findSequenceKey:x,findChainKey:S,getEntityFromChain:h=>y[h]}}function pc(e,t){let r=[],n=[],o=Ue.transientSegments(e.chainElementSegments,z.ofBounds(0,e.count)),{seq_id_begin:a,seq_id_end:i}=e;for(;o.hasNext;){let{start:s,end:u}=o.move(),m=-1,c=-1;for(let l=s;l<u;++l){let d=i.value(l);l===s?(m=l,c=i.value(l)):a.value(l)-c>1&&(r.push(m,l-1),n.push(l-1,l),m=l),l===u-1&&r.push(m,l),c=d}}return{polymerRanges:ct.ofSortedRanges(r),gapRanges:ct.ofSortedRanges(n)}}var Vp={...ze.chem_comp,type:ne.Schema.Aliased(ne.Schema.str)};function Gp(e,t){let{ihm_model_group:r,ihm_model_group_link:n}=t,o=$e.pickRow(n,a=>n.model_id.value(a)===e);if(o){let a=$e.pickRow(r,i=>r.id.value(i)===o.group_id);if(a)return a.name}return""}function kp(e){for(let t=0,r=e.rowCount;t<r;t++)if(e.valueKind(t)===ne.ValueKind.Present)return!0;return!1}function Za(e,t,r){(!e[t].isDefined||!kp(e[t]))&&(e[t]=e[r]),(!e[r].isDefined||!kp(e[r]))&&(e[r]=e[t])}function wp(e){let t=$e.ofColumns(e._schema,e);return Za(t,"label_atom_id","auth_atom_id"),Za(t,"label_comp_id","auth_comp_id"),Za(t,"label_seq_id","auth_seq_id"),Za(t,"label_asym_id","auth_asym_id"),t}var to={entry:ze.entry,struct:ze.struct,struct_asym:ze.struct_asym,ihm_model_list:ze.ihm_model_list,ihm_model_group:ze.ihm_model_group,ihm_model_group_link:ze.ihm_model_group_link,entity:ze.entity,entity_poly:ze.entity_poly,entity_poly_seq:ze.entity_poly_seq,pdbx_entity_branch:ze.pdbx_entity_branch,chem_comp:Vp,pdbx_chem_comp_identifier:ze.pdbx_chem_comp_identifier,atom_site:ze.atom_site,ihm_sphere_obj_site:ze.ihm_sphere_obj_site,ihm_gaussian_obj_site:ze.ihm_gaussian_obj_site,pdbx_unobs_or_zero_occ_residues:ze.pdbx_unobs_or_zero_occ_residues,pdbx_molecule:ze.pdbx_molecule};function Np(e,t=!1){let r=Object.create(null);for(let n of Object.keys(to))n in e?r[n]=e[n]:r[n]=$e.ofUndefinedColumns(to[n],0);return t&&(r.atom_site=wp(r.atom_site)),r}var fc={hierarchy:Xa.Empty,conformation:void 0};function Hp(e,t){let{ihm_sphere_obj_site:r,ihm_gaussian_obj_site:n}=e;if(r._rowCount===0&&n._rowCount===0)return fc;let o=Op(r),a=Eb(r),i=dc(o,e.entities),s=pc(o,t),u=Op(n),m=Bb(n),c=dc(u,e.entities),l=pc(u,t);return{hierarchy:{isDefined:!0,spheres:{...o,...i,...s},gaussians:{...u,...c,...l}},conformation:{id:Ur.create22(),spheres:a,gaussians:m}}}function Eb(e){return{x:e.Cartn_x.toArray({array:Float32Array}),y:e.Cartn_y.toArray({array:Float32Array}),z:e.Cartn_z.toArray({array:Float32Array}),radius:e.object_radius.toArray({array:Float32Array}),rmsf:e.rmsf.toArray({array:Float32Array})}}function Bb(e){let t=to.ihm_gaussian_obj_site.covariance_matrix.space,r=[],{covariance_matrix:n}=e;for(let o=0,a=n.rowCount;o<a;o++)r[o]=Nt.toMat3(gt(),t,n.value(o));return{x:e.mean_Cartn_x.toArray({array:Float32Array}),y:e.mean_Cartn_y.toArray({array:Float32Array}),z:e.mean_Cartn_z.toArray({array:Float32Array}),weight:e.weight.toArray({array:Float32Array}),covariance_matrix:r}}function Rb(e,t,r){let n=[0];for(let o=1,a=e.rowCount;o<a;o++)!e.areValuesEqual(o-1,o)&&(n[n.length]=o);return{chainElementSegments:Ue.ofOffsets(n,z.ofBounds(0,e.rowCount))}}function Op(e){let{entity_id:t,seq_id_begin:r,seq_id_end:n,asym_id:o}=e;return{count:t.rowCount,entity_id:t,asym_id:o,seq_id_begin:r,seq_id_end:n,...Rb(o,r,n)}}var Fb={HIS:"H",ARG:"R",LYS:"K",ILE:"I",PHE:"F",LEU:"L",TRP:"W",ALA:"A",MET:"M",PRO:"P",CYS:"C",ASN:"N",VAL:"V",GLY:"G",SER:"S",GLN:"Q",TYR:"Y",ASP:"D",GLU:"E",THR:"T",SEC:"U",PYL:"O",HSD:"H",HSE:"H",HSP:"H",LSN:"K",ASPP:"D",GLUP:"E",HID:"H",HIE:"H",HIP:"H",LYN:"K",ASH:"D",GLH:"E"},Ub={DA:"A",DC:"C",DG:"G",DT:"T",DU:"U"},Lb={A:"A",C:"C",G:"G",T:"T",U:"U"};function yc(e){return Fb[e]||"X"}function hc(e){return Lb[e]||"X"}function xc(e){return Ub[e]||"X"}var Vo;(s=>{let e;(d=>(d.Protein="protein",d.RNA="RNA",d.DNA="DNA",d.Generic="generic"))(e=s.Kind||(s.Kind={}));function t(u){for(let m=0,c=Math.min(u.rowCount,10);m<c;m++){let l=u.value(m)||"";if(yc(l)!=="X")return"protein";if(hc(l)!=="X")return"RNA";if(xc(l)!=="X")return"DNA"}return"generic"}function r(u,m){let c;switch(u){case"protein":c=yc;break;case"DNA":c=xc;break;case"RNA":c=hc;break;case"generic":c=()=>"X";break;default:Zn(u)}return m&&m.size>0?l=>{let d=c(l);return d!=="X"||!m.has(l)?d:c(m.get(l))}:c}function n(u,m){let c=t(u);return new o(c,u,m)}s.ofResidueNames=n;class o{constructor(m,c,l){this.kind=m;this.microHet=new Map;let d=r(m),y=[],S=[],x=[],g=new Map,h=0,f=new Map;for(let T=0,I=l.rowCount;T<I;++T){let P=l.value(T);if(f.has(P))g.has(P)?g.get(P).push(c.value(T)):g.set(P,[S[f.get(P)],c.value(T)]);else{f.set(P,h);let A=c.value(T);S[h]=A,x[h]=P,y[h]=d(A),h+=1}}let C=[];for(let T=0,I=h;T<I;++T){let P=g.get(x[T]);if(P){let A=P.map(b=>{let _=d(b);return _==="X"?b:_});C[T]=`(${A.join("|")})`}else C[T]=y[T]==="X"?S[T]:y[T]}this.length=h,this.code=ne.ofStringArray(y),this.compId=ne.ofStringArray(S),this.seqId=ne.ofIntArray(x),this.label=ne.ofStringArray(C),this.microHet=g,this.indexMap=f}index(m){return this.indexMap.get(m)}}function a(u,m){let c="generic";return new i(c,u,m)}s.ofSequenceRanges=a;class i{constructor(m,c,l){this.kind=m;this.seqIdStart=c;this.seqIdEnd=l;this.microHet=new Map;let d=0,y=Number.MAX_SAFE_INTEGER;for(let x=0,g=this.seqIdStart.rowCount;x<g;x++){let h=this.seqIdStart.value(x),f=this.seqIdEnd.value(x);h<y&&(y=h),d<f&&(d=f)}let S=d-y+1;this.code=ne.ofConst("X",S,ne.Schema.str),this.label=ne.ofConst("",S,ne.Schema.str),this.seqId=ne.ofLambda({value:x=>x+y+1,rowCount:S,schema:ne.Schema.int}),this.compId=ne.ofConst("",S,ne.Schema.str),this.length=S,this.minSeqId=y}index(m){return m-this.minSeqId}}})(Vo||(Vo={}));var Qi;(i=>{let e={byEntityKey:{},sequences:[]};function t(...s){let u=[],m={};for(let c=0,l=s.length;c<l;++c)u.push(...s[c].sequences),Object.assign(m,s[c].byEntityKey);return{sequences:u,byEntityKey:m}}function r(s,u,m){let c=n(s,u),l=m.isDefined?o(s,m):e;return t(c,l)}i.fromHierarchy=r;function n(s,u){let{label_comp_id:m}=u.atoms,{label_seq_id:c}=u.residues,{chainAtomSegments:l,residueAtomSegments:d}=u,{count:y,offsets:S}=l,x={},g=[];if(y===1&&S[0]===0&&S[1]===0)return{byEntityKey:x,sequences:g};for(let h=0,f=u.chains._rowCount;h<f;h++){let C=u.index.getEntityFromChain(h);if(x[C]!==void 0||s.data.type.value(C)!=="polymer")continue;let T=h;for(h++;h<f&&C===u.index.getEntityFromChain(h)&&s.data.type.value(C)!=="polymer";)h++;h--;let I=d.index[S[T]],P=d.index[S[h+1]-1]+1,A=ne.window(c,I,P),b=[];for(let v=I;v<P;++v)b.push(m.value(d.offsets[v]));let _=ne.ofStringArray(b);x[C]={entityId:s.data.id.value(C),sequence:Vo.ofResidueNames(_,A)},g.push(x[C])}return{byEntityKey:x,sequences:g}}function o(s,u){let m=a(s,u.spheres),c=a(s,u.gaussians);return t(m,c)}function a(s,u){let{chainElementSegments:m,seq_id_begin:c,seq_id_end:l}=u,{count:d,offsets:y}=m,S={},x=[];if(d===1&&y[0]===0&&y[1]===0)return{byEntityKey:S,sequences:x};for(let g=0,h=d;g<h;g++){let f=u.getEntityFromChain(g);if(S[f]!==void 0)continue;let C=g;for(g++;g<h&&f===u.getEntityFromChain(g);)g++;g--;let T=y[C],I=y[g+1]-1,P=ne.window(c,T,I),A=ne.window(l,T,I);S[f]={entityId:s.data.id.value(f),sequence:Vo.ofSequenceRanges(P,A)},x.push(S[f])}return{byEntityKey:S,sequences:x}}})(Qi||(Qi={}));function gc(e,t,r,n){if(!e.entity_poly_seq||!e.entity_poly_seq._rowCount)return Qi.fromHierarchy(t,r,n);let{entity_id:o,num:a,mon_id:i}=e.entity_poly_seq,s={},u=[],m=o.rowCount,c=0;for(;c<m;){let l=c;for(;c<m-1&&o.areValuesEqual(c,c+1);)c++;c++;let d=o.value(l),y=ne.window(i,l,c),S=ne.window(a,l,c),x=t.getEntityIndex(d);s[x]={entityId:d,sequence:Vo.ofResidueNames(y,S)},u.push(s[x])}return{byEntityKey:s,sequences:u}}function qp(e){let t=-1/0;for(let r=0,n=e.length;r<n;++r)e[r]>t&&(t=e[r]);return t}function ro(e,t){for(let r=0,n=t?Math.min(t,e.length):e.length;r<n;++r)e[r]=r;return e}function Wa(e,t){return e.indexOf(t)>=0?!1:(e.push(t),!0)}function zp(e,t){let r=e.indexOf(t);if(r<0)return!1;for(let n=r,o=e.length-1;n<o;n++)e[n]=e[n+1];return e.pop(),!0}function bc(e,t){let r=0;for(let n=0,o=e.length;n<o;++n)t.includes(e[n])&&(r+=1);return r}function Kp(e){for(let t=0,r=e.length;t<r;t++)if(e[t]!==t)return!1;return!0}function Sc(e,t,r){let n=Vl(t,r-1),{label_entity_id:o,label_asym_id:a,label_seq_id:i}=e,s=ga(n,o.value);for(let u=0,m=s.length-1;u<m;u++){let c=ga(n,a.value,{start:s[u],end:s[u+1]});for(let l=0,d=c.length-1;l<d;l++){let y=c[l];i.valueKind(y)===ne.ValueKind.Present&&ga(n,i.value,{sort:!0,start:y,end:c[l+1]})}}return Kp(n)&&n.length===e._rowCount?{atom_site:e,sourceIndex:ne.ofIntArray(n)}:{atom_site:$e.view(e,e._schema,n),sourceIndex:ne.ofIntArray(n)}}function jp(e,t,r,n,o){let{polymerType:a,traceElementIndex:i,directionFromElementIndex:s,directionToElementIndex:u}=o.residue,m=a[e],c=a[t];if(m===0||c===0||i[e]===-1||i[t]===-1)return!1;let l=n.findAtomsOnResidue(e,Zr(m,"backboneStart")),d=n.findAtomsOnResidue(t,Zr(c,"backboneEnd"));(l===-1||d===-1)&&(l=n.findAtomsOnResidue(e,Zr(m,"coarseBackbone")),d=n.findAtomsOnResidue(t,Zr(c,"coarseBackbone")));let{x:y,y:S,z:x}=r,g=p.create(y[l],S[l],x[l]),h=p.create(y[d],S[d],x[d]),f=s[e]===-1||u[e]===-1||s[t]===-1||u[t]===-1;return p.distance(g,h)<(f?10:3)}function Cc(e,t,r,n){let o=[],a=[],i=new Map,s=Ue.transientSegments(e.chainAtomSegments,z.ofBounds(0,e.atoms._rowCount)),u=Ue.transientSegments(e.residueAtomSegments,z.ofBounds(0,e.atoms._rowCount)),{index:m,derived:c}=e,{label_seq_id:l}=e.residues,{label_entity_id:d}=e.chains,{moleculeType:y,traceElementIndex:S}=c.residue,x,g,h,f;for(;s.hasNext;){let C=s.move();u.setSegment(C),x=-1,g=-1,h=-1,f=-1;let T=t.getEntityIndex(d.value(C.index)),I=n.byEntityKey[T],P=I?I.sequence.seqId.value(I.sequence.seqId.rowCount-1):-1,A=e.residueAtomSegments.index[C.start],b=e.residueAtomSegments.index[C.end-1],_=l.value(A),v=l.value(b);for(_===1&&v===P&&r.xyzDefined&&jp(A,b,r,m,c)&&(i.set(A,b),i.set(b,A));u.hasNext;){let R=u.move(),E=R.index,B=l.value(E);if(Qa(y[E])&&S[E]!==-1)if(f!==-1)if(B!==x+1)o.push(f,h-1),a.push(g,R.end-1),f=R.start;else if(!u.hasNext)o.push(f,R.end-1);else{let L=e.residueAtomSegments.index[R.start],G=e.residueAtomSegments.index[h-1];r.xyzDefined&&!jp(L,G,r,e.index,c)&&(o.push(f,h-1),a.push(g,R.end-1),f=R.start)}else f=R.start;else f!==-1&&(o.push(f,h-1),f=-1);g=R.start,h=R.end,x=B}}return{polymerRanges:ct.ofSortedRanges(o),gapRanges:ct.ofSortedRanges(a),cyclicPolymerMap:i}}function Qp(e){let t=new Map;return r=>{if(t.has(r))return t.get(r);let n=e(r);return t.set(r,n),n}}function Xp(e){let t=new Map;if(e.chem_comp._rowCount>0){let{id:r}=e.chem_comp;for(let n=0,o=r.rowCount;n<o;++n)t.set(r.value(n),$e.getRow(e.chem_comp,n))}else Wp(e).forEach(n=>{t.set(n,Mp(n))});return t}function Zp(e){let t=new Map;if(e.pdbx_chem_comp_identifier._rowCount>0){let{comp_id:r,type:n,identifier:o}=e.pdbx_chem_comp_identifier;for(let a=0,i=r.rowCount;a<i;++a)if(n.value(a)==="SNFG CARBOHYDRATE SYMBOL"||n.value(a)==="SNFG CARB SYMBOL"){let s=o.value(a),u=yp.get(s);u&&t.set(r.value(a),u)}}if(e.chem_comp._rowCount>0){let{id:r,type:n}=e.chem_comp;for(let o=0,a=r.rowCount;o<a;++o){let i=r.value(o);if(t.has(i))continue;let s=n.value(o);Cn.has(i)?t.set(i,Cn.get(i)):ja(s,i)===9&&t.set(i,tc)}}else{let r=Wp(e);Cn.forEach((n,o)=>{!t.has(o)&&r.has(o)&&t.set(o,n)})}return t}var Wp=Qp(e=>{let t=new Set,{label_comp_id:r,auth_comp_id:n}=e.atom_site,o=r.isDefined?r:n;for(let a=0,i=o.rowCount;a<i;++a)t.add(o.value(a));return t});function _c(e,t){let r=new Map,{auth_asym_id:n,label_asym_id:o,label_entity_id:a}=e.chains;for(let i=0,s=e.chains._rowCount;i<s;i++){let u=o.value(i);r.set(u,{id:u,auth_id:n.value(i),entity_id:a.value(i)})}if(t!=null&&t.struct_asym._rowCount){let{id:i,entity_id:s}=t.struct_asym;for(let u=0,m=i.rowCount;u<m;++u){let c=i.value(u);r.has(c)||r.set(c,{id:c,auth_id:"",entity_id:s.value(u)})}}return r}var Jp=ne.Schema.Aliased(ne.Schema.Str());function Ac(e){let t;if(e.entity.id.isDefined)t=e.entity;else{let s=new Set,u=[],m=[],{label_entity_id:c,label_comp_id:l}=e.atom_site;for(let S=0,x=e.atom_site._rowCount;S<x;S++){let g=c.value(S);s.has(g)||(u.push(g),m.push(Ep(l.value(S))),s.add(g))}let{entity_id:d}=e.ihm_sphere_obj_site;for(let S=0,x=e.ihm_sphere_obj_site._rowCount;S<x;S++){let g=d.value(S);s.has(g)||(u.push(g),m.push("polymer"),s.add(g))}let{entity_id:y}=e.ihm_gaussian_obj_site;for(let S=0,x=e.ihm_gaussian_obj_site._rowCount;S<x;S++){let g=y.value(S);s.has(g)||(u.push(g),m.push("polymer"),s.add(g))}t=$e.ofPartialColumns(to.entity,{id:ne.ofArray({array:u,schema:to.entity.id}),type:ne.ofArray({array:m,schema:to.entity.type})},u.length)}let r=ne.createIndexer(t.id),n=new Array(t._rowCount);n.fill("other");let o=new Set,a=!1;if(e.entity_poly&&e.entity_poly.type.isDefined){let{entity_id:s,type:u,_rowCount:m}=e.entity_poly;for(let c=0;c<m;++c){let l=s.value(c);n[r(l)]=u.value(c),o.add(l)}}else a=!0;if(e.pdbx_entity_branch&&e.pdbx_entity_branch.entity_id.isDefined){let{entity_id:s,type:u,_rowCount:m}=e.pdbx_entity_branch;for(let c=0;c<m;++c){let l=s.value(c);n[r(l)]=u.value(c),o.add(l)}}else a=!0;if(o.size<n.length&&(a=!0),a){let s=new Map;if(e.chem_comp){let{id:u,type:m}=e.chem_comp;for(let c=0,l=e.chem_comp._rowCount;c<l;c++)s.set(u.value(c),m.value(c))}if(e.atom_site){let{label_entity_id:u,label_comp_id:m}=e.atom_site;for(let c=0,l=e.atom_site._rowCount;c<l;c++){let d=u.value(c);if(!o.has(d)){let y=m.value(c),S=s.get(y)||"other";n[r(d)]=Bp(y,S),o.add(d)}}}}let i=ne.ofArray({array:n,schema:Jp});return{data:t,subtype:i,getEntityIndex:r}}function Ic(e,t,r){var u;if(!e.pdbx_molecule||!e.pdbx_molecule.prd_id.isDefined)return t;let n=new Array(t.data._rowCount);n.fill("");let{asym_id:o,prd_id:a,_rowCount:i}=e.pdbx_molecule;for(let m=0;m<i;++m){let c=o.value(m),l=(u=r.get(c))==null?void 0:u.entity_id;l!==void 0&&(n[t.getEntityIndex(l)]=a.value(m))}let s=ne.ofArray({array:n,schema:ne.Schema.str});return{...t,prd_id:s}}var Ja=class{constructor(t){this.frames=t;this.frameCount=t.length,this.representative=t[0],this.duration=t.length}getFrameAtIndex(t){return this.frames[t]}};function $p(e,t){let r=kb(e,t),n=e.ihm_model_list._rowCount>0?Ob(e,r,t):Nb(e,r,t);for(let o=0;o<n.length;o++)lt.TrajectoryInfo.set(n[o],{index:o,size:n.length});return new Ja(n)}function kb(e,t){return{chemicalComponentMap:Xp(e),saccharideComponentMap:Zp(e)}}function Gb(e,t,r,n,o,a,i){let s=lc(t,r,n,o.chemicalComponentMap,a,i),u=t.pdbx_PDB_model_num.value(0);if(i&&s.sameAsPrevious)return{...i,id:Ur.create22(),modelNum:u,atomicConformation:s.conformation,_dynamicPropertyData:Object.create(null)};let m=fc,c=gc(e,n,s.hierarchy,m.hierarchy),l=Cc(s.hierarchy,n,s.conformation,c),d=_c(s.hierarchy),y=e.entry.id.valueKind(0)===ne.ValueKind.Present?e.entry.id.value(0):a.name;return{id:Ur.create22(),entryId:y,entry:y,sourceData:a,modelNum:u,parent:void 0,entities:Ic(e,n,d),sequence:c,atomicHierarchy:s.hierarchy,atomicConformation:s.conformation,atomicRanges:l,atomicChainOperatorMappinng:s.chainOperatorMapping,coarseHierarchy:m.hierarchy,coarseConformation:m.conformation,properties:{...o,structAsymMap:d},customProperties:new Bo,_staticPropertyData:Object.create(null),_dynamicPropertyData:Object.create(null)}}function wb(e,t,r,n){let o=lc(t.atom_site,t.atom_site_sourceIndex,t.entities,r.chemicalComponentMap,n),a=Hp(t,r.chemicalComponentMap),i=gc(e,t.entities,o.hierarchy,a.hierarchy),s=Cc(o.hierarchy,t.entities,o.conformation,i),u=e.entry.id.valueKind(0)===ne.ValueKind.Present?e.entry.id.value(0):n.name,m=_c(o.hierarchy,e);return{id:Ur.create22(),entryId:u,entry:u,sourceData:n,modelNum:t.model_id,parent:void 0,entities:Ic(e,t.entities,m),sequence:i,atomicHierarchy:o.hierarchy,atomicConformation:o.conformation,atomicRanges:s,atomicChainOperatorMappinng:o.chainOperatorMapping,coarseHierarchy:a.hierarchy,coarseConformation:a.conformation,properties:{...r,structAsymMap:m},customProperties:new Bo,_staticPropertyData:Object.create(null),_dynamicPropertyData:Object.create(null)}}function ef(e,t){let r=e.rowCount;if(!e.isDefined)return r;let n=t+1;for(;n<r&&e.areValuesEqual(t,n);)n++;return n}function Nb(e,t,r){let n=[];if(e.atom_site){let o=e.atom_site.id.rowCount,a=Ac(e),i=0;for(;i<o;){let s=ef(e.atom_site.pdbx_PDB_model_num,i),{atom_site:u,sourceIndex:m}=Sc(e.atom_site,i,s),c=Gb(e,u,m,a,t,r,n.length>0?n[n.length-1]:void 0);n.push(c),i=s}}return n}function Pc(e,t){let r=new Map,n=e._rowCount,o=0;for(;o<n;){let a=ef(t,o),i=t.value(o);r.set(i,{table:$e.window(e,e._schema,o,a),start:o,end:a}),o=a}return r}function Ob(e,t,r){let n=Ac(e),o=e.atom_site.ihm_model_id.isDefined?e.atom_site.ihm_model_id:e.atom_site.pdbx_PDB_model_num,a=Pc(e.atom_site,o),i=Pc(e.ihm_sphere_obj_site,e.ihm_sphere_obj_site.model_id),s=Pc(e.ihm_gaussian_obj_site,e.ihm_gaussian_obj_site.model_id),u=[];if(e.ihm_model_list){let{model_id:m,model_name:c}=e.ihm_model_list;for(let l=0;l<e.ihm_model_list._rowCount;l++){let d=m.value(l),y,S;if(a.has(d)){let h=a.get(d),{atom_site:f,sourceIndex:C}=Sc(e.atom_site,h.start,h.end);y=f,S=C}else y=$e.window(e.atom_site,e.atom_site._schema,0,0),S=ne.ofIntArray([]);let x={model_id:d,model_name:c.value(l),model_group_name:Gp(d,e),entities:n,atom_site:y,atom_site_sourceIndex:S,ihm_sphere_obj_site:i.has(d)?i.get(d).table:$e.window(e.ihm_sphere_obj_site,e.ihm_sphere_obj_site._schema,0,0),ihm_gaussian_obj_site:s.has(d)?s.get(d).table:$e.window(e.ihm_gaussian_obj_site,e.ihm_gaussian_obj_site._schema,0,0)},g=wb(e,x,t,r);u.push(g)}}return u}var ko=class{constructor(t,r,n){this.operatorsProvider=n;this.id=t,this.details=r}get operatorGroups(){return this._operators?this._operators:(this._operators=this.operatorsProvider(),this._operators)}};(t=>{function e(r,n,o){return new t(r,n,o)}t.create=e})(ko||(ko={}));var Yi;(r=>{r.Default={assemblies:[],spacegroup:Sn.ZeroP1};function t(n,o){let a=o.toLocaleLowerCase(),i=Lr.Provider.get(n);return i?Ul(i.assemblies,s=>s.id.toLowerCase()===a):void 0}r.findAssembly=t})(Yi||(Yi={}));function tf(e,t,r){if(!e._rowCount)return[];let n=zb(r),o=[];for(let a=0;a<e._rowCount;a++)o[o.length]=Hb(e,t,a,n);return o}function Hb(e,t,r,n){let o=e.id.value(r),a=e.details.value(r),i=[],{assembly_id:s,oper_expression:u,asym_id_list:m}=t;for(let c=0,l=t._rowCount;c<l;c++)s.value(c)===o&&(i[i.length]={assemblyId:o,expression:u.value(c),asymIds:m.value(c)});return ko.create(o,a,qb(i,n))}function qb(e,t){return()=>{let r=[],n=0;for(let o=0;o<e.length;o++){let a=e[o],i=Qb(a.expression),s=Kb(i),u=jb(t,s,n,a.assemblyId),m=Yt.generators.atoms({chainTest:Yt.pred.and(Yt.pred.eq(c=>mt.unit.operator_name(c.element),Tt.DefaultName),Yt.pred.inSet(c=>mt.chain.label_asym_id(c.element),a.asymIds))});r[r.length]={selector:m,operators:u},n+=u.length}return r}}function zb(e){let{id:t,matrix:r,vector:n,_schema:o}=e,a=new Map;for(let i=0,s=e._rowCount;i<s;i++){let u=Nt.toMat4(re(),o.matrix.space,r.value(i)),m=Nt.toVec3(p(),o.vector.space,n.value(i));re.setTranslation(u,m),re.setValue(u,3,3,1),a.set(t.value(i),u)}return a}function Kb(e){let t=[],r=[];for(let n=0;n<e.length;n++)r[n]="";return rf(e,t,e.length-1,r),t}function rf(e,t,r,n){if(r<0){t[t.length]=n.slice(0);return}let o=e[r],a=o.length;for(let i=0;i<a;i++)n[r]=o[i],rf(e,t,r-1,n)}function jb(e,t,r,n){let o=[],a=r;for(let i of t){let s=re.identity();for(let u=0;u<i.length;u++)re.mul(s,s,e.get(i[u]));a++,o[o.length]=Tt.create(`ASM_${a}`,s,{assembly:{id:n,operId:a,operList:i}})}return o}function Qb(e){let t=/\(?([^\(\)]+)\)?]*/g,r=[],n=[],o;for(;o=t.exec(e);)r[r.length]=o[1];return r.forEach(a=>{let i=[];a.split(",").forEach(s=>{let u=s.indexOf("-");if(u>0){let m=parseInt(s.substring(0,u)),c=parseInt(s.substr(u+1));for(let l=m;l<=c;l++)i[i.length]=l.toString()}else i[i.length]=s.trim()}),n[n.length]=i}),n}var Tc=class{constructor(){this.map=new Map;this.applicable=new Map}add(t,r,n){this.map.set(t,r),n&&this.applicable.set(t,n)}get(t){return this.map.get(t)}isApplicable(t){if(!this.map.has(t.sourceData.kind))return!1;let r=this.applicable.get(t.sourceData.kind);return r?r(t):!0}};var Ht;(t=>{function e(r,n){let{name:o}=r,a=new Tc;return{descriptor:r,formatRegistry:a,isApplicable(i){return a.isApplicable(i)},get(i){let s=n!=null&&n.asDynamic?i._dynamicPropertyData:i._staticPropertyData;if(s[o])return s[o];if(i.customProperties.has(r))return;let u=a.get(i.sourceData.kind);if(u)return s[o]=u(i),i.customProperties.add(r),s[o]},set(i,s){n!=null&&n.asDynamic?i._dynamicPropertyData[o]=s:i._staticPropertyData[o]=s},delete(i){n!=null&&n.asDynamic?delete i._dynamicPropertyData[o]:delete i._staticPropertyData[o]}}}t.create=e})(Ht||(Ht={}));var Lr;(n=>{n.Descriptor={name:"model_symmetry"},n.Provider=Ht.create(n.Descriptor);function r(o){let a=tf(o.pdbx_struct_assembly,o.pdbx_struct_assembly_gen,o.pdbx_struct_oper_list),i=Xb(o.symmetry,o.cell);return{assemblies:a,spacegroup:i}}n.fromData=r})(Lr||(Lr={}));function Yb(e){let t=e.Int_Tables_number.value(0),r=e["space_group_name_H-M"].value(0);return e.Int_Tables_number.isDefined?e["space_group_name_H-M"].isDefined?r:t:r}function Xb(e,t){if(e._rowCount===0||t._rowCount===0)return Sn.ZeroP1;let r=t.length_a.value(0),n=t.length_b.value(0),o=t.length_c.value(0);if(r===0||n===0||o===0)return Sn.ZeroP1;let a=t.angle_alpha.value(0),i=t.angle_beta.value(0),s=t.angle_gamma.value(0);if(a===0||i===0||s===0)return Sn.ZeroP1;let u=Yb(e),m=Ro.create(u,p.create(r,n,o),p.scale(p(),p.create(a,i,s),Math.PI/180));return Sn.create(m)}function $a(e,t,r,n){return{type:e,key:t,elements:r,getIndex:n}}var _n;(n=>{n.Descriptor={name:"model_secondary_structure"},n.Provider=Ht.create(n.Descriptor);function r(o,a,i){let s=new Map,u=[{kind:"none"}],m=Zb(o,a);Wb(o,m,s,u),Jb(a,m,s,o._rowCount,u);let c=i.residues._rowCount,l=y=>y,d={type:new Int32Array(c),key:new Int32Array(c),elements:u};return s.size>0&&e2(i,m,s,d),$a(d.type,d.key,d.elements,l)}n.fromStruct=r})(_n||(_n={}));function Zb(e,t){if(e._rowCount>0){if(e.beg_label_seq_id.valueKind(0)!==ne.ValueKind.Present||e.end_label_seq_id.valueKind(0)!==ne.ValueKind.Present)return"auth"}else if(t&&(t.beg_label_seq_id.valueKind(0)!==ne.ValueKind.Present||t.end_label_seq_id.valueKind(0)!==ne.ValueKind.Present))return"auth";return"label"}function Wb(e,t,r,n){if(!e._rowCount)return;let{beg_label_asym_id:o,beg_label_seq_id:a,beg_auth_seq_id:i,pdbx_beg_PDB_ins_code:s}=e,{end_label_seq_id:u,end_auth_seq_id:m,pdbx_end_PDB_ins_code:c}=e,{pdbx_PDB_helix_class:l,conf_type_id:d,details:y}=e,S=t==="label"?a:i,x=t==="label"?u:m;for(let g=0,h=e._rowCount;g<h;g++){let f=ke.create(l.valueKind(g)===ne.ValueKind.Present?ke.SecondaryStructurePdb[l.value(g)]:d.valueKind(g)===ne.ValueKind.Present?ke.SecondaryStructureMmcif[d.value(g)]:ke.Flag.NA),C={kind:"helix",flags:f,type_id:d.valueKind(g)===ne.ValueKind.Present?d.value(g):"helx_p",helix_class:l.value(g),details:y.valueKind(g)===ne.ValueKind.Present?y.value(g):void 0},T={startSeqId:S.value(g),startInsCode:s.value(g),endSeqId:x.value(g),endInsCode:c.value(g),type:f,key:n.length};n[n.length]=C;let I=o.value(g);if(r.has(I)){let P=r.get(I);P.has(T.startSeqId)?P.get(T.startSeqId).push(T):P.set(T.startSeqId,[T])}else r.set(I,new Map([[T.startSeqId,[T]]]))}}function Jb(e,t,r,n,o){if(!e._rowCount)return;let{beg_label_asym_id:a,beg_label_seq_id:i,beg_auth_seq_id:s,pdbx_beg_PDB_ins_code:u}=e,{end_label_seq_id:m,end_auth_seq_id:c,pdbx_end_PDB_ins_code:l}=e,{sheet_id:d}=e,y=t==="label"?i:s,S=t==="label"?m:c,x=new Map,g=n+1;for(let h=0,f=e._rowCount;h<f;h++){let C=d.value(h),T;x.has(C)?T=x.get(C):(T=g++,x.set(C,T));let I=ke.create(ke.Flag.Beta|ke.Flag.BetaSheet),P={kind:"sheet",flags:I,sheet_id:C,symmetry:void 0},A={startSeqId:y.value(h),startInsCode:u.value(h),endSeqId:S.value(h),endInsCode:l.value(h),type:I,key:o.length};o[o.length]=P;let b=a.value(h);if(r.has(b)){let _=r.get(b);_.has(A.startSeqId)?_.get(A.startSeqId).push(A):_.set(A.startSeqId,[A])}else r.set(b,new Map([[A.startSeqId,[A]]]))}}function $b(e,t,r,n,o,a){let{auth_seq_id:i,label_seq_id:s,pdbx_PDB_ins_code:u}=e.residues,{endSeqId:m,endInsCode:c,key:l,type:d}=r,y=t==="label"?s:i,S=n;for(;S<o;){let x=y.value(S);if(a.type[S]=d,a.key[S]=l,x>m||x===m&&u.value(S)===c)break;S++}}function e2(e,t,r,n){let{count:o}=e.chainAtomSegments,{label_asym_id:a}=e.chains,{auth_seq_id:i,label_seq_id:s,pdbx_PDB_ins_code:u}=e.residues,m=t==="label"?s:i;for(let c=0;c<o;c++){let l=eo.chainStartResidueIndex(e,c),d=eo.chainEndResidueIndexExcl(e,c),y=a.value(c);if(r.has(y)){let S=r.get(y);for(let x=l;x<d;x++){let g=m.value(x);if(S.has(g)){let h=S.get(g);for(let f of h){let C=u.value(x);f.startInsCode===C&&$b(e,t,f,x,d,n)}}}}}}var t2={U:ze.atom_site_anisotrop.U,U_esd:ze.atom_site_anisotrop.U_esd},mi;(o=>{o.Schema=t2,o.Descriptor={name:"atom_site_anisotrop"},o.Provider=Ht.create(o.Descriptor);function n(a,i){let s=new Int32Array(a.rowCount);s.fill(-1);for(let m=0,c=a.rowCount;m<c;m++)s[a.value(m)]=m;let u=new Int32Array(a.rowCount);u.fill(-1);for(let m=0,c=i.rowCount;m<c;++m){let l=s[i.value(m)];l!==-1&&(u[l]=m)}return u}o.getElementToAnsiotrop=n})(mi||(mi={}));var Go;(o=>{o.Descriptor={name:"chem_comp_bond"},o.Provider=Ht.create(o.Descriptor);function r(a){let i=new Map;function s(g){if(i.has(g))return i.get(g);let h=new n(g);return i.set(g,h),h}let{comp_id:u,atom_id_1:m,atom_id_2:c,value_order:l,pdbx_aromatic_flag:d,_rowCount:y,pdbx_ordinal:S}=a,x=s(u.value(0));for(let g=0;g<y;g++){let h=u.value(g),f=m.value(g),C=c.value(g),T=l.value(g),I=d.value(g)==="y",P=S.value(g);x.id!==h&&(x=s(h));let A=_e.Flag.Covalent,b=1;switch(I&&(A|=_e.Flag.Aromatic),T.toLowerCase()){case"delo":A|=_e.Flag.Aromatic;break;case"doub":b=2;break;case"trip":b=3;break;case"quad":b=4;break}x.add(f,C,b,A,P)}return i}o.getEntriesFromChemCompBond=r;class n{constructor(i){this.id=i;this.map=new Map}add(i,s,u,m,c,l=!0){let d=this.map.get(i);if(d!==void 0)d.get(s)===void 0&&d.set(s,{order:u,flags:m,key:c});else{let y=new Map;y.set(s,{order:u,flags:m,key:c}),this.map.set(i,y)}l&&this.add(s,i,u,m,c,!1)}}o.Entry=n})(Go||(Go={}));var r2=new Map([["HIS|CD2|CG",2],["HIS|CE1|ND1",2],["ARG|CZ|NH2",2],["PHE|CE1|CZ",2],["PHE|CD2|CE2",2],["PHE|CD1|CG",2],["TRP|CD1|CG",2],["TRP|CD2|CE2",2],["TRP|CE3|CZ3",2],["TRP|CH2|CZ2",2],["ASN|CG|OD1",2],["GLN|CD|OE1",2],["TYR|CD1|CG",2],["TYR|CD2|CE2",2],["TYR|CE1|CZ",2],["ASP|CG|OD1",2],["GLU|CD|OE1",2],["G|C8|N7",2],["G|C4|C5",2],["G|C2|N3",2],["G|C6|O6",2],["C|C4|N3",2],["C|C5|C6",2],["C|C2|O2",2],["A|C2|N3",2],["A|C6|N1",2],["A|C4|C5",2],["A|C8|N7",2],["U|C5|C6",2],["U|C2|O2",2],["U|C4|O4",2],["DG|C8|N7",2],["DG|C4|C5",2],["DG|C2|N3",2],["DG|C6|O6",2],["DC|C4|N3",2],["DC|C5|C6",2],["DC|C2|O2",2],["DA|C2|N3",2],["DA|C6|N1",2],["DA|C4|C5",2],["DA|C8|N7",2],["DT|C5|C6",2],["DT|C2|O2",2],["DT|C4|O4",2]]);function nf(e,t,r){return[t,r]=t<r?[t,r]:[r,t],zi.has(e)&&t==="C"&&r==="O"||ic.has(e)&&t==="OP1"&&r==="P"?2:r2.get(`${e}|${t}|${r}`)||1}var n2=new Map([["LYS|NZ|RET|C15",2]]);function es(e,t,r,n){return e>r&&([e,r]=[r,e],[t,n]=[n,t]),n2.get(`${e}|${t}|${r}|${n}`)||1}var er;(a=>{a.Descriptor={name:"struct_conn"},a.Provider=Ht.create(a.Descriptor);function r(i){let s=a.Provider.get(i);return!!s&&s.data.id.rowCount/i.atomicConformation.atomId.rowCount>.95}a.isExhaustive=r;function n(i){let s=new Map;for(let u of i){let{partnerA:{atomIndex:m},partnerB:{atomIndex:c}}=u;s.has(m)?s.get(m).push(u):s.set(m,[u]),s.has(c)?s.get(c).push(u):s.set(c,[u])}return s}a.getAtomIndexFromEntries=n;function o(i,s){let{conn_type_id:u,pdbx_dist_value:m,pdbx_value_order:c}=i,l={label_asym_id:i.ptnr1_label_asym_id,label_seq_id:i.ptnr1_label_seq_id,auth_seq_id:i.ptnr1_auth_seq_id,label_atom_id:i.ptnr1_label_atom_id,label_alt_id:i.pdbx_ptnr1_label_alt_id,ins_code:i.pdbx_ptnr1_PDB_ins_code,symmetry:i.ptnr1_symmetry},d={label_asym_id:i.ptnr2_label_asym_id,label_seq_id:i.ptnr2_label_seq_id,auth_seq_id:i.ptnr2_auth_seq_id,label_atom_id:i.ptnr2_label_atom_id,label_alt_id:i.pdbx_ptnr2_label_alt_id,ins_code:i.pdbx_ptnr2_PDB_ins_code,symmetry:i.ptnr2_symmetry},y=Array.from(s.entities.data.id.toArray()),S=(g,h)=>{if(h.label_asym_id.valueKind(g)!==ne.ValueKind.Present)return;let f=h.label_asym_id.value(g),C=h.label_atom_id.value(g);if(!C)return;let T=h.label_alt_id.value(g);for(let I of y){let P=s.atomicHierarchy.index.findResidue(I,f,h.auth_seq_id.value(g),h.ins_code.value(g));if(P<0)continue;let A=s.atomicHierarchy.index.findAtomOnResidue(P,C,T);if(!(A<0))return{residueIndex:P,atomIndex:A,symmetry:h.symmetry.value(g)}}},x=[];for(let g=0;g<i._rowCount;g++){let h=S(g,l),f=S(g,d);if(h===void 0||f===void 0)continue;let C=u.value(g),T=c.value(g)||"",I=_e.Flag.None,P=1;switch(T){case"sing":P=1;break;case"doub":P=2;break;case"trip":P=3;break;case"quad":P=4;break;default:P=es(i.ptnr1_label_comp_id.value(g),i.ptnr1_label_atom_id.value(g),i.ptnr2_label_comp_id.value(g),i.ptnr2_label_atom_id.value(g))}switch(C){case"covale":I=_e.Flag.Covalent;break;case"disulf":I=_e.Flag.Covalent|_e.Flag.Disulfide;break;case"hydrog":I=_e.Flag.HydrogenBond;break;case"metalc":I=_e.Flag.MetallicCoordination;break}x.push({rowIndex:g,flags:I,order:P,distance:m.value(g),partnerA:h,partnerB:f})}return x}a.getEntriesFromStructConn=o})(er||(er={}));var li;(i=>{let e="molstar_global_model_transform_info",t={[e]:{matrix:ne.Schema.Matrix(4,4,ne.Schema.float)}},r={name:e};i.Provider=Ht.create(r);function o(s){if(!kt.is(s.sourceData))return;let u=s.sourceData.data.frame.categories[e];if(!u)return;let m=tp(t[e],u);if(m._rowCount!==0)return m.matrix.value(0)}i.fromMmCif=o;function a(s){if(!kt.is(s.sourceData))return!1;let u=s.sourceData.data.frame.categories[e];return!!u&&u.rowCount>0}i.hasData=a})(li||(li={}));function o2(e){if(kt.is(e.sourceData))return Lr.fromData(e.sourceData.data.db)}Lr.Provider.formatRegistry.add("mmCIF",o2);function i2(e){if(!kt.is(e.sourceData))return;let{struct_conf:t,struct_sheet_range:r}=e.sourceData.data.db;return _n.fromStruct(t,r,e.atomicHierarchy)}_n.Provider.formatRegistry.add("mmCIF",i2);function a2(e){if(!kt.is(e.sourceData))return;let{atom_site_anisotrop:t}=e.sourceData.data.db,r=$e.ofColumns(mi.Schema,t),n=mi.getElementToAnsiotrop(e.atomicConformation.atomId,t.id);return{data:r,elementToAnsiotrop:n}}function s2(e){return kt.is(e.sourceData)?e.sourceData.data.db.atom_site_anisotrop.U.isDefined:!1}mi.Provider.formatRegistry.add("mmCIF",a2,s2);function u2(e){if(!kt.is(e.sourceData))return;let{chem_comp_bond:t}=e.sourceData.data.db;if(t._rowCount!==0)return{data:t,entries:Go.getEntriesFromChemCompBond(t)}}Go.Provider.formatRegistry.add("mmCIF",u2);function c2(e){if(!kt.is(e.sourceData))return;let{struct_conn:t}=e.sourceData.data.db;if(t._rowCount===0)return;let r=er.getEntriesFromStructConn(t,e);return{data:t,byAtomIndex:er.getAtomIndexFromEntries(r),entries:r}}er.Provider.formatRegistry.add("mmCIF",c2);li.Provider.formatRegistry.add("mmCIF",li.fromMmCif,li.hasData);var kt;(r=>{function e(n){return(n==null?void 0:n.kind)==="mmCIF"}r.is=e;function t(n,o,a){return o||(o=La.schema.mmCIF(n)),{kind:"mmCIF",name:o._name,data:{db:o,frame:n,source:a}}}r.fromFrame=t})(kt||(kt={}));function of(e){let t=kt.fromFrame(e),r=Np(t.data.db,!0);return $p(r,t)}var m2=Object.prototype.hasOwnProperty;function rs(e){if(e===null||typeof e!="object")return e;if(e instanceof Array){let r=[];for(let n=0,o=e.length;n<o;n++)r[n]=rs(e[n]);return r}let t={};for(let r in e)m2.call(e,r)&&(t[r]=rs(e[r]));return t}function ns(e,t){if(e)for(let r of Object.keys(e))t(e[r],r)}var k;(P=>{function e(A,b){return b&&(b.label&&(A.label=b.label),b.isHidden&&(A.isHidden=b.isHidden),b.category&&(A.category=b.category)),A}function t(A,b){return e({type:"value",defaultValue:A},b)}P.Value=t;function r(A,b,_){return e({type:"select",defaultValue:I(A,b),options:b,cycle:_==null?void 0:_.cycle},_)}P.Select=r;function n(A,b,_){let v=e({type:"multi-select",defaultValue:A,options:b},_);return _!=null&&_.emptyValue&&(v.emptyValue=_.emptyValue),v}P.MultiSelect=n;function o(A,b){return e({type:"boolean",defaultValue:A},b)}P.Boolean=o;function a(A,b){let _=e({type:"color",defaultValue:A},b);return b!=null&&b.isExpanded&&(_.isExpanded=b.isExpanded),_}P.Color=a;function i(A,b){let _;if(typeof A=="string"){let v=Rr(A);_={kind:v.type!=="qualitative"?"interpolate":"set",colors:v.list}}else _=A;return e({type:"color-list",presetKind:(b==null?void 0:b.presetKind)||"all",defaultValue:_,offsets:!!(b!=null&&b.offsets)},b)}P.ColorList=i;function s(A,b,_){let v=e({type:"number",defaultValue:A},_);return _!=null&&_.immediateUpdate&&(v.immediateUpdate=!0),v}P.Numeric=s;function u(A,b,_){return e({type:"interval",defaultValue:A},_)}P.Interval=u;function m(A,b){let _=e({type:"group",defaultValue:(b==null?void 0:b.customDefault)||d(A),params:A},b);return b!=null&&b.presets&&(_.presets=b.presets),b!=null&&b.isExpanded&&(_.isExpanded=b.isExpanded),b!=null&&b.isFlat&&(_.isFlat=b.isFlat),b!=null&&b.pivot&&(_.pivot=b.pivot),_}P.Group=m;function c(A){return m({},A)}P.EmptyGroup=c;function l(A,b,_){let v=_!=null&&_.options?_.options:Object.keys(b).map(E=>[E,b[E].label||E]),R=I(A,v);return e({type:"mapped",defaultValue:{name:R,params:b[R].defaultValue},select:r(R,v,_),map:E=>b[E]},_)}P.MappedStatic=l;function d(A){let b={};for(let _ of Object.keys(A))A[_].isOptional||(b[_]=A[_].defaultValue);return b}P.getDefaultValues=d;function y(A,b){for(let _ of Object.keys(A))A[_].isOptional||(A[_].defaultValue=b[_])}P.setDefaultValues=y;function S(A){return rs(A)}P.clone=S;function x(A,b,_){if(b===_)return!0;if(typeof b!="object"||typeof _!="object")return!1;for(let v of Object.keys(A))if(!g(A[v],b[v],_[v]))return!1;return!0}P.areEqual=x;function g(A,b,_){if(b===_)return!0;if(A.type==="group")return x(A.params,b,_);if(A.type==="mapped"){let v=b,R=_;if(v.name!==R.name)return!1;let E=A.map(v.name);return g(E,v.params,R.params)}else if(A.type==="multi-select"){let v=b,R=_;if(v.length!==R.length)return!1;if(v.length<10){for(let E=0,B=v.length;E<B;E++)if(v[E]!==R[E]&&R.indexOf(v[E])<0)return!1}else{let E=new Set(R);for(let B=0,L=v.length;B<L;B++)if(v[B]!==R[B]&&!E.has(v[B]))return!1}return!0}else{if(A.type==="interval")return b[0]===_[0]&&b[1]===_[1];if(typeof b=="object"&&typeof _=="object")return $d(b,_)}return!1}function h(A,b,_){if(b===void 0)return{..._};if(_===void 0)return{...b};let v=Object.create(null);for(let R of Object.keys(A))v[R]=f(A[R],b[R],_[R]);return v}P.merge=h;function f(A,b,_){if(b===void 0)return typeof _=="object"&&!Array.isArray(_)?{..._}:_;if(_===void 0)return typeof b=="object"&&!Array.isArray(b)?{...b}:b;if(A.type==="group")return h(A.params,b,_);if(A.type==="mapped"){let v=b,R=_;if(v.name!==R.name)return{...R};let E=A.map(R.name);return{name:R.name,params:f(E,v.params,R.params)}}else return A.type==="value"?_:typeof b=="object"&&typeof _=="object"?Array.isArray(_)?_:{...b,..._}:_}function C(A,b){let _=[];for(let v of Object.keys(A))if(!b)typeof A[v]=="string"?_.push([v,A[v]]):_.push([v,b===null?v:v]);else{let R=b(v,A[v]);_.push(typeof R=="string"?[v,R]:[v,R[0],R[1]])}return _}P.objectToOptions=C;function T(A){let b=[];for(let _ of A)b.push([_,_]);return b}P.arrayToOptions=T;function I(A,b){for(let _ of b)if(_[0]===A)return A;return b.length>0?b[0][0]:void 0}})(k||(k={}));var wo;(r=>{function e(n){let o=n.descriptor.name,a=n.type==="static"?"_staticPropertyData":"_dynamicPropertyData",i=u=>(o in u[a]||(u[a][o]={props:{...k.getDefaultValues(n.getParams(u))},data:Yr.create(void 0)}),u[a][o]),s=(u,m,c)=>{let l=i(u);u[a][o]={props:m,data:Yr.withValue(l.data,c)}};return{descriptor:n.descriptor,isHidden:n.isHidden,getParams:u=>{let m=k.clone(n.getParams(u));return k.setDefaultValues(m,i(u).props),m},defaultParams:n.defaultParams,isApplicable:n.isApplicable,attach:(u,m={},c)=>{c&&u.customProperties.reference(n.descriptor,!0);let l=i(u),d=k.merge(n.defaultParams,l.props,m);if(l.data.value&&k.areEqual(n.defaultParams,l.props,d))return;let{value:y}=n.obtain(u,d);u.customProperties.add(n.descriptor),s(u,d,y)},ref:(u,m)=>u.customProperties.reference(n.descriptor,m),get:u=>{var m;return(m=i(u))==null?void 0:m.data},set:(u,m={})=>{let c=i(u),l=k.merge(n.defaultParams,c.props,m);k.areEqual(n.defaultParams,c.props,l)||s(u,l,void 0)},props:u=>i(u).props}}r.createProvider=e;function t(n,o,a){let i={value:k.Value(a,{isHidden:!0})};return e({descriptor:{name:n},isHidden:!0,type:o,defaultParams:i,getParams:()=>({value:k.Value(a,{isHidden:!0})}),isApplicable:()=>!0,obtain:(s,u)=>{var m;return{value:(m=u.value)!=null?m:a}}})}r.createSimple=t})(wo||(wo={}));var lt;(h=>{function e(f){let C=new Int32Array(f.rowCount),T=!1;for(let I=0,P=f.rowCount;I<P;I++){let A=f.value(I);A!==I&&(T=!1),C[A]=I}return{isIdentity:T,invertedIndex:C}}let t="__InvertedAtomSrcIndex__";function r(f){if(f._staticPropertyData[t])return f._staticPropertyData[t];let C=e(f.atomicHierarchy.atomSourceIndex);return f._staticPropertyData[t]=C,C}h.getInvertedAtomSourceIndex=r;let n="__TrajectoryInfo__";h.TrajectoryInfo={get(f){return f._dynamicPropertyData[n]||{index:0,size:1}},set(f,C){return f._dynamicPropertyData[n]=C}},h.AsymIdOffset=wo.createSimple("asym_id_offset","static"),h.Index=wo.createSimple("index","static");function s(f){return f.parent||f}h.getRoot=s;function u(f,C){return f.atomicHierarchy===C.atomicHierarchy&&f.coarseHierarchy===C.coarseHierarchy}h.areHierarchiesEqual=u;let m="__CoordinatesHistory__";h.CoordinatesHistory={get(f){return f._staticPropertyData[m]},set(f,C){return f._staticPropertyData[m]=C}};let l="__CoarseGrained__";h.CoarseGrained={get(f){return f._staticPropertyData[l]},set(f,C){return f._staticPropertyData[l]=C}};function y(f){let C=h.CoarseGrained.get(f);if(C===void 0){let T=0,{polymerType:I}=f.atomicHierarchy.derived.residue;for(let v=0;v<I.length;++v)I[v]!==0&&(T+=1);let P=!1,A=!1,{label_atom_id:b,_rowCount:_}=f.atomicHierarchy.atoms;for(let v=0;v<_;++v){let R=b.value(v);if(!P&&R==="BB"&&(P=!0),!A&&R==="SC1"&&(A=!0),P&&A)break}C=P&&A||(T&&_?_/T<3:!1),h.CoarseGrained.set(f,C)}return C}h.isCoarseGrained=y;function S(f){return f.properties.saccharideComponentMap.size>0}h.hasCarbohydrate=S;function x(f){if(!kt.is(f.sourceData))return!1;let{db:C}=f.sourceData.data;for(let T=0,I=C.database_2.database_id.rowCount;T<I;++T)if(C.database_2.database_id.value(T)==="pdb")return!0;return!1}h.isFromPdbArchive=x;function g(f){if(kt.is(f.sourceData)){let{db:C}=f.sourceData.data;return C.struct_conf.id.isDefined||C.struct_sheet_range.id.isDefined}else return _n.Provider.isApplicable(f)}h.hasSecondaryStructure=g})(lt||(lt={}));var le={};Ao(le,{Location:()=>vc,Loci:()=>os,atomicProperty:()=>aC,chainIndex:()=>uC,entityIndex:()=>cC,property:()=>oC,residueIndex:()=>sC});var vc;(l=>{function e(d,y,S){return{kind:"element-location",structure:d,unit:y,element:S||0}}l.create=e;function t(d){return e(d.structure,d.unit,d.element)}l.clone=t;function r(d,y,S,x){return y&&(d.structure=y),S&&(d.unit=S),x!==void 0&&(d.element=x),d}l.set=r;function n(d,y){return d.unit=y.unit,d.element=y.element,d}l.copy=n;function o(d){return!!d&&d.kind==="element-location"}l.is=o;function a(d,y){return d.unit===y.unit&&d.element===y.element}l.areEqual=a;let i=p.zero(),s=p.zero();function u(d,y){return d.unit.conformation.position(d.element,i),y.unit.conformation.position(y.element,s),p.distance(i,s)}l.distance=u;function m(d){return d.unit.model.atomicHierarchy.residueAtomSegments.index[d.element]}l.residueIndex=m;function c(d){return d.unit.model.atomicHierarchy.chainAtomSegments.index[d.element]}l.chainIndex=c})(vc||(vc={}));var l2=pt.diff;function os(e,t){return{kind:"element-loci",structure:e,elements:t}}(a=>{function e(i){return!!i&&i.kind==="element-loci"}a.is=e;function t(i){for(let s of i.elements)if(Ae.size(s.indices)>0)return!1;return!0}a.isEmpty=t;function r(i){return n(i)===i.structure.elementCount}a.isWholeStructure=r;function n(i){let s=0;for(let{indices:u}of i.elements)typeof u=="number"?s+=l2(u):s+=u.length;return s}function o(i,s){if(s===i.structure)return i;let u=[];return i.elements.forEach(m=>{if(!s.unitMap.has(m.unit.id))return;let c=s.unitMap.get(m.unit.id),l=Ae.indexedIntersect(m.indices,m.unit.elements,c.elements);Ae.size(l)>0&&u.push({unit:c,indices:l})}),a(s,u)}a.remap=o})(os||(os={}));var An=class{constructor(){this.count=0;this.center=p();this.radiusSq=0}reset(){p.set(this.center,0,0,0),this.radiusSq=0,this.count=0}includeStep(t){p.add(this.center,this.center,t),this.count++}finishedIncludeStep(){this.count!==0&&p.scale(this.center,this.center,1/this.count)}radiusStep(t){let r=p.squaredDistance(t,this.center);r>this.radiusSq&&(this.radiusSq=r)}radiusSphereStep(t,r){let n=p.distance(t,this.center)+r,o=n*n;o>this.radiusSq&&(this.radiusSq=o)}getSphere(t){return t||(t=Se()),p.copy(t.center,this.center),t.radius=Math.sqrt(this.radiusSq),t}getCount(){return this.count}};(o=>{let e=new o,t=p(),r=p();function n(a,i,s){e.reset();for(let u=0;u<a;u++)i(u,t,r),e.includeStep(t),e.includeStep(r);e.finishedIncludeStep();for(let u=0;u<a;u++)i(u,t,r),e.radiusStep(t),e.radiusStep(r);return p.copy(s.center,e.center),s.radius=Math.sqrt(e.radiusSq),s}o.fromPairProvider=n})(An||(An={}));var qt;(m=>{function e(c,l){if(c===l)return!0;if(c.vertexCount!==l.vertexCount||c.edgeCount!==l.edgeCount)return!1;let{a:d,b:y,offset:S}=c,{a:x,b:g,offset:h}=l;for(let f=0,C=c.a.length;f<C;f++)if(d[f]!==x[f])return!1;for(let f=0,C=c.b.length;f<C;f++)if(y[f]!==g[f])return!1;for(let f=0,C=c.offset.length;f<C;f++)if(S[f]!==h[f])return!1;for(let f of Object.keys(c.edgeProps)){let C=c.edgeProps[f],T=l.edgeProps[f];if(!T)return!1;for(let I=0,P=C.length;I<P;I++)if(C[I]!==T[I])return!1}return!0}m.areEqual=e;class t{constructor(l,d,y,S,x,g){this.offset=l;this.a=d;this.b=y;this.edgeCount=S;this.props=g;this.vertexCount=l.length-1,this.edgeProps=x||{}}getEdgeIndex(l,d){let y,S;l<d?(y=l,S=d):(y=d,S=l);for(let x=this.offset[y],g=this.offset[y+1];x<g;x++)if(this.b[x]===S)return x;return-1}getDirectedEdgeIndex(l,d){for(let y=this.offset[l],S=this.offset[l+1];y<S;y++)if(this.b[y]===d)return y;return-1}getVertexEdgeCount(l){return this.offset[l+1]-this.offset[l]}}function r(c,l,d,y,S,x){return new t(c,l,d,y,S,x)}m.create=r;class n{constructor(l,d,y){this.vertexCount=l;this.xs=d;this.ys=y;this.current=0;this.curA=0;this.curB=0;this.edgeCount=d.length,this.offsets=new Int32Array(this.vertexCount+1),this.bucketFill=new Int32Array(this.vertexCount);let S=new Int32Array(this.vertexCount);for(let g=0,h=this.xs.length;g<h;g++)S[this.xs[g]]++;for(let g=0,h=this.ys.length;g<h;g++)S[this.ys[g]]++;let x=0;for(let g=0;g<this.vertexCount;g++)this.offsets[g]=x,x+=S[g];this.offsets[this.vertexCount]=x,this.slotCount=x,this.a=new Int32Array(x),this.b=new Int32Array(x)}createGraph(l,d){return r(this.offsets,this.a,this.b,this.edgeCount,l,d)}addNextEdge(){let l=this.xs[this.current],d=this.ys[this.current],y=this.offsets[l]+this.bucketFill[l],S=this.offsets[d]+this.bucketFill[d];this.a[y]=l,this.b[y]=d,this.bucketFill[l]++,this.a[S]=d,this.b[S]=l,this.bucketFill[d]++,this.current++,this.curA=y,this.curB=S}addAllEdges(){for(let l=0;l<this.edgeCount;l++)this.addNextEdge()}assignProperty(l,d){l[this.curA]=d,l[this.curB]=d}}m.EdgeBuilder=n;class o{constructor(l,d,y){this.vertexCount=l;this.xs=d;this.ys=y;this.current=0;this.curA=0;this.edgeCount=d.length,this.offsets=new Int32Array(this.vertexCount+1),this.bucketFill=new Int32Array(this.vertexCount);let S=new Int32Array(this.vertexCount);for(let g=0,h=this.xs.length;g<h;g++)S[this.xs[g]]++;let x=0;for(let g=0;g<this.vertexCount;g++)this.offsets[g]=x,x+=S[g];this.offsets[this.vertexCount]=x,this.slotCount=x,this.a=new Int32Array(x),this.b=new Int32Array(x)}createGraph(l){return r(this.offsets,this.a,this.b,this.edgeCount,l)}addNextEdge(){let l=this.xs[this.current],d=this.ys[this.current],y=this.offsets[l]+this.bucketFill[l];this.a[y]=l,this.b[y]=d,this.bucketFill[l]++,this.current++,this.curA=y}addAllEdges(){for(let l=0;l<this.edgeCount;l++)this.addNextEdge()}assignProperty(l,d){l[this.curA]=d}}m.DirectedEdgeBuilder=o;class a{constructor(l){this.vertexCount=l;this.xs=[];this.ys=[];this.included=new Set}addEdge(l,d){let y=l,S=d;l>d&&(y=d,S=l);let x=Wt(y,S);return this.included.has(x)?!1:(this.included.add(x),this.xs[this.xs.length]=y,this.ys[this.ys.length]=S,!0)}getGraph(){return i(this.vertexCount,this.xs,this.ys)}getEdgeBuiler(){return new n(this.vertexCount,this.xs,this.ys)}}m.UniqueEdgeBuilder=a;function i(c,l,d){let y=new m.EdgeBuilder(c,l,d);return y.addAllEdges(),y.createGraph({})}function s(c){let l=c.vertexCount;if(l===0)return{componentCount:0,componentIndex:new Int32Array(0)};if(c.edgeCount===0){let f=new Int32Array(l);for(let C=0,T=l;C<T;C++)f[C]=C;return{componentCount:l,componentIndex:f}}let d=new Int32Array(l);for(let f=0,C=l;f<C;f++)d[f]=-1;let y=0;d[0]=y;let{offset:S,b:x}=c,g=[0],h=wu(l);for(h.remove(0);g.length>0;){let f=g.pop(),C=d[f];for(let T=S[f],I=S[f+1];T<I;T++){let P=x[T];h.has(P)&&(h.remove(P),g.push(P),d[P]=C)}g.length===0&&h.head>=0&&(g.push(h.head),d[h.head]=++y,h.remove(h.head))}return{componentCount:l,componentIndex:d}}m.connectedComponents=s;function u(c,l,d,y){if(ee.areIntersecting(l,d))return!0;if(y<1)return!1;let S=new Set;for(let x=0,g=l.length;x<g;++x)S.add(l[x]);return af(c,l,d,y,S)}m.areVertexSetsConnected=u})(qt||(qt={}));function af(e,t,r,n,o){let{b:a,offset:i}=e,s=[];for(let u=0,m=t.length;u<m;++u){let c=t[u];for(let l=i[c],d=i[c+1];l<d;++l){let y=a[l];if(!o.has(y)){if(ee.has(r,y))return!0;o.add(y),s[s.length]=y}}}return n>1?af(e,s,r,n-1,o):!1}var Dc=class{constructor(t,r){this.getHash=t;this.areEqual=r;this.size=0;this.byHash=new Map}add(t){let r=this.getHash(t);if(this.byHash.has(r)){let n=this.byHash.get(r);for(let o=0,a=n.length;o<a;o++)if(this.areEqual(t,n[o]))return!1;return n[n.length]=t,this.size++,!0}else return this.byHash.set(r,[t]),this.size++,!0}has(t){let r=this.getHash(t);if(!this.byHash.has(r))return!1;let n=this.byHash.get(r);for(let o=0,a=n.length;o<a;o++)if(this.areEqual(t,n[o]))return!0;return!1}};function is(e,t){return new Dc(e,t)}var _t;(n=>{function e(){return{keys:new Set,array:[]}}n.create=e;function t({keys:o,array:a},i,s){return o.has(i)?!1:(o.add(i),a[a.length]=s,!0)}n.add=t;function r({keys:o},a){return o.has(a)}n.has=r})(_t||(_t={}));var Wr=class e{constructor(t){this.map=t;let r=0,n=[],o=new Map,a=new Map;this.map.forEach(i=>{i.forEach(s=>{r+=s.edgeCount,s.connectedIndices.forEach(u=>{s.getEdges(u).forEach(m=>{let{unitA:c,unitB:l}=s,d=e.getEdgeKey(u,c,m.indexB,l);o.set(d,n.length);let y=e.getVertexKey(u,c),S=a.get(y);S===void 0?a.set(y,[n.length]):S.push(n.length),n.push({...m,indexA:u,unitA:c,unitB:l})})})})}),this.edgeCount=r,this.edges=n,this.edgeKeyIndex=o,this.vertexKeyIndex=a}getConnectedUnits(t){return this.map.has(t)?this.map.get(t):sf}getEdgeIndex(t,r,n,o){let a=e.getEdgeKey(t,r,n,o),i=this.edgeKeyIndex.get(a);return i!==void 0?i:-1}getEdge(t,r,n,o){let a=this.getEdgeIndex(t,r,n,o);return a!==-1?this.edges[a]:void 0}getEdgeIndices(t,r){return this.vertexKeyIndex.get(e.getVertexKey(t,r))||[]}};(a=>{class e{constructor(s,u,m,c,l){this.unitA=s;this.unitB=u;this.edgeCount=m;this.connectedIndices=c;this.edgeMap=l}getEdges(s){return this.edgeMap.has(s)?this.edgeMap.get(s):sf}}a.UnitPairEdges=e;function t(i,s,u,m){return`${i}|${s}|${u}|${m}`}a.getEdgeKey=t;function r(i,s){return`${i}|${s}`}a.getVertexKey=r;function n(i,s,u){i.has(s)?i.get(s).push(u):i.set(s,[u])}class o{constructor(){this.map=new Map}startUnitPair(s,u){this.uA=s,this.uB=u,this.mapAB=new Map,this.mapBA=new Map,this.linkedA=_t.create(),this.linkedB=_t.create(),this.linkCount=0}finishUnitPair(){this.linkCount!==0&&(n(this.map,this.uA,new e(this.uA,this.uB,this.linkCount,this.linkedA.array,this.mapAB)),n(this.map,this.uB,new e(this.uB,this.uA,this.linkCount,this.linkedB.array,this.mapBA)))}add(s,u,m){n(this.mapAB,s,{indexB:u,props:m}),n(this.mapBA,u,{indexB:s,props:m}),_t.add(this.linkedA,s,s),_t.add(this.linkedB,u,u),this.linkCount+=1}getMap(){return this.map}}a.Builder=o})(Wr||(Wr={}));var sf=[];var as;(t=>t.Empty=qt.create([],[],[],0,{flags:[],order:[],key:[]}))(as||(as={}));var Jr=class extends Wr{getBondIndexFromLocation(t){return O.isAtomic(t.aUnit)&&O.isAtomic(t.bUnit)?this.getEdgeIndex(t.aIndex,t.aUnit.id,t.bIndex,t.bUnit.id):-1}};(t=>{class e extends Wr.UnitPairEdges{}t.UnitPairBonds=e})(Jr||(Jr={}));var d2=4,ss={forceCompute:!1,noCompute:!1,maxRadius:d2},Mc={H:0,h:0,D:0,d:0,T:0,t:0,He:2,HE:2,he:2,Li:3,LI:3,li:3,Be:4,BE:4,be:4,B:5,b:5,C:6,c:6,N:7,n:7,O:8,o:8,F:9,f:9,Ne:10,NE:10,ne:10,Na:11,NA:11,na:11,Mg:12,MG:12,mg:12,Al:13,AL:13,al:13,Si:14,SI:14,si:14,P:15,p:15,S:16,s:16,Cl:17,CL:17,cl:17,Ar:18,AR:18,ar:18,K:19,k:19,Ca:20,CA:20,ca:20,Sc:21,SC:21,sc:21,Ti:22,TI:22,ti:22,V:23,v:23,Cr:24,CR:24,cr:24,Mn:25,MN:25,mn:25,Fe:26,FE:26,fe:26,Co:27,CO:27,co:27,Ni:28,NI:28,ni:28,Cu:29,CU:29,cu:29,Zn:30,ZN:30,zn:30,Ga:31,GA:31,ga:31,Ge:32,GE:32,ge:32,As:33,AS:33,as:33,Se:34,SE:34,se:34,Br:35,BR:35,br:35,Kr:36,KR:36,kr:36,Rb:37,RB:37,rb:37,Sr:38,SR:38,sr:38,Y:39,y:39,Zr:40,ZR:40,zr:40,Nb:41,NB:41,nb:41,Mo:42,MO:42,mo:42,Tc:43,TC:43,tc:43,Ru:44,RU:44,ru:44,Rh:45,RH:45,rh:45,Pd:46,PD:46,pd:46,Ag:47,AG:47,ag:47,Cd:48,CD:48,cd:48,In:49,IN:49,in:49,Sn:50,SN:50,sn:50,Sb:51,SB:51,sb:51,Te:52,TE:52,te:52,I:53,i:53,Xe:54,XE:54,xe:54,Cs:55,CS:55,cs:55,Ba:56,BA:56,ba:56,La:57,LA:57,la:57,Ce:58,CE:58,ce:58,Pr:59,PR:59,pr:59,Nd:60,ND:60,nd:60,Pm:61,PM:61,pm:61,Sm:62,SM:62,sm:62,Eu:63,EU:63,eu:63,Gd:64,GD:64,gd:64,Tb:65,TB:65,tb:65,Dy:66,DY:66,dy:66,Ho:67,HO:67,ho:67,Er:68,ER:68,er:68,Tm:69,TM:69,tm:69,Yb:70,YB:70,yb:70,Lu:71,LU:71,lu:71,Hf:72,HF:72,hf:72,Ta:73,TA:73,ta:73,W:74,w:74,Re:75,RE:75,re:75,Os:76,OS:76,os:76,Ir:77,IR:77,ir:77,Pt:78,PT:78,pt:78,Au:79,AU:79,au:79,Hg:80,HG:80,hg:80,Tl:81,TL:81,tl:81,Pb:82,PB:82,pb:82,Bi:83,BI:83,bi:83,Po:84,PO:84,po:84,At:85,AT:85,at:85,Rn:86,RN:86,rn:86,Fr:87,FR:87,fr:87,Ra:88,RA:88,ra:88,Ac:89,AC:89,ac:89,Th:90,TH:90,th:90,Pa:91,PA:91,pa:91,U:92,u:92,Np:93,NP:93,np:93,Pu:94,PU:94,pu:94,Am:95,AM:95,am:95,Cm:96,CM:96,cm:96,Bk:97,BK:97,bk:97,Cf:98,CF:98,cf:98,Es:99,ES:99,es:99,Fm:100,FM:100,fm:100,Md:101,MD:101,md:101,No:102,NO:102,no:102,Lr:103,LR:103,lr:103,Rf:104,RF:104,rf:104,Db:105,DB:105,db:105,Sg:106,SG:106,sg:106,Bh:107,BH:107,bh:107,Hs:108,HS:108,hs:108,Mt:109,MT:109,mt:109},p2={0:1.42,1:1.42,3:2.7,4:2.7,6:1.75,7:1.6,8:1.52,11:2.7,12:2.7,13:2.7,14:1.9,15:2,16:1.9,17:1.8,19:2.7,20:2.7,21:2.7,22:2.7,23:2.7,24:2.7,25:2.7,26:2.7,27:2.7,28:2.7,29:2.7,30:2.7,31:2.7,33:2.68,37:2.7,38:2.7,39:2.7,40:2.7,41:2.7,42:2.7,43:2.7,44:2.7,45:2.7,46:2.7,47:2.7,48:2.7,49:2.7,50:2.7,55:2.7,56:2.7,57:2.7,58:2.7,59:2.7,60:2.7,61:2.7,62:2.7,63:2.7,64:2.7,65:2.7,66:2.7,67:2.7,68:2.7,69:2.7,70:2.7,71:2.7,72:2.7,73:2.7,74:2.7,75:2.7,76:2.7,77:2.7,78:2.7,79:2.7,80:2.7,81:2.7,82:2.7,83:2.7,87:2.7,88:2.7,89:2.7,90:2.7,91:2.7,92:2.7,93:2.7,94:2.7,95:2.7,96:2.7,97:2.7,98:2.7,99:2.7,100:2.7,101:2.7,102:2.7,103:2.7,104:2.7,105:2.7,106:2.7,107:2.7,108:2.7,109:2.88},f2={0:.8,20:1.31,27:1.2,35:1.15,44:1.1,54:1,60:1.84,72:1.88,84:1.75,85:1.56,86:1.76,98:1.6,99:1.68,100:1.63,112:1.6,113:1.59,114:1.36,129:1.45,135:1.47,144:1.6,152:1.45,170:1.4,180:1.55,202:2.4,222:2.24,224:1.91,225:1.98,243:2.02,269:2,293:1.9,316:1.8,420:2.37,480:2.3,512:2.3,544:2.3,612:2.1,629:1.54,665:1,813:2.6,854:2.27,894:1.93,896:2.1,937:2.05,938:2.06,981:1.62,1258:2.68,1309:2.33,1484:1,1763:2.14,1823:2.48,1882:2.1,1944:1.72,2380:2.34,3367:2.44,3733:2.11,3819:2.6,3821:2.36,4736:2.75,5724:2.73,5959:2.63,6519:2.84,6750:2.87,8991:2.81},uf=2.001,no=function(){let e=["LI","NA","K","RB","CS","FR","BE","MG","CA","SR","BA","RA","AL","GA","IN","SN","TL","PB","BI","SC","TI","V","CR","MN","FE","CO","NI","CU","ZN","Y","ZR","NB","MO","TC","RU","RH","PD","AG","CD","LA","HF","TA","W","RE","OS","IR","PT","AU","HG","AC","RF","DB","SG","BH","HS","MT","CE","PR","ND","PM","SM","EU","GD","TB","DY","HO","ER","TM","YB","LU","TH","PA","U","NP","PU","AM","CM","BK","CF","ES","FM","MD","NO","LR"],t=new Set;for(let r of e)t.add(Mc[r]);return t}();function y2(e,t){return e<t?(e+t)*(e+t+1)/2+t:(e+t)*(e+t+1)/2+e}function gr(e){let t=Mc[e];return t===void 0?-1:t}function h2(e,t){if(e<0||t<0)return-1;let r=f2[y2(e,t)];return r===void 0?-1:r}function $r(e){if(e<0)return uf;let t=p2[e];return t===void 0?uf:t}function di(e,t,r,n){let o=h2(e,t);return o>0?o:t<0?r:(r+n)/1.95}var x2=Mc.H;function en(e){return e===x2}var In;(n=>(n.Descriptor={name:"index_pair_bonds"},n.Provider=Ht.create(n.Descriptor,{asDynamic:!0}),n.DefaultProps={maxDistance:-1}))(In||(In={}));var g2=p.distance;function lf(e,t,r,n,o,a,i){let s=new qt.EdgeBuilder(a,e,t),u=new Uint16Array(s.slotCount),m=new Int8Array(s.slotCount),c=new Uint32Array(s.slotCount);for(let l=0,d=s.edgeCount;l<d;l++)s.addNextEdge(),s.assignProperty(u,n[l]),s.assignProperty(m,r[l]),s.assignProperty(c,o[l]);return s.createGraph({flags:u,order:m,key:c},{canRemap:i})}var cf=p(),mf=p();function b2(e,t,r){return e.conformation.position(t,cf),e.conformation.position(r,mf),g2(cf,mf)}var S2=new Set;function C2(e){let t=In.Provider.get(e.model),{elements:r}=e,{type_symbol:n}=e.model.atomicHierarchy.atoms,o=e.elements.length,{maxDistance:a}=t,{offset:i,b:s,edgeProps:{order:u,distance:m,flag:c,key:l}}=t.bonds,{atomSourceIndex:d}=e.model.atomicHierarchy,{invertedIndex:y}=lt.getInvertedAtomSourceIndex(e.model),S=[],x=[],g=[],h=[],f=[];for(let C=0;C<o;C++){let T=r[C],I=gr(n.value(T)),P=en(I),A=d.value(T);for(let b=i[A],_=i[A+1];b<_;++b){let v=y[s[b]];if(T>=v)continue;let R=ee.indexOf(e.elements,v);if(R<0)continue;let E=gr(n.value(v)),B=m[b],L=b2(e,T,v),G=!1;if(B>=0)G=Bt(L,B,.3);else if(a>=0)G=L<a;else{let K=di(I,E,$r(I),$r(E));G=L<K,P&&en(E)&&(G=!1)}G&&(S[S.length]=C,x[x.length]=R,h[h.length]=u[b],g[g.length]=c[b],f[f.length]=l[b])}}return lf(S,x,h,g,f,o,!1)}function _2(e,t){let{maxRadius:r}=t,{x:n,y:o,z:a}=e.model.atomicConformation,i=e.elements.length,{elements:s,residueIndex:u,chainIndex:m}=e,{type_symbol:c,label_atom_id:l,label_alt_id:d,label_comp_id:y}=e.model.atomicHierarchy.atoms,{label_seq_id:S}=e.model.atomicHierarchy.residues,{index:x}=e.model.atomicHierarchy,{byEntityKey:g}=e.model.sequence,h=e.lookup3d,f=er.Provider.get(e.model),C=Go.Provider.get(e.model),T=er.isExhaustive(e.model),I=[],P=[],A=[],b=[],_=[],v=-1,R,E=!0,B=!0,L=!0,G=S2;for(let X=0;X<i;X++){let j=s[X],$=c.value(j);E&&$!=="H"&&$!=="O"&&(E=!1);let Z=t.forceCompute?void 0:f&&f.byAtomIndex.get(j),te=!1;if(Z)for(let me of Z){let{partnerA:fe,partnerB:pe}=me;if(fe.symmetry!==pe.symmetry)continue;let Te=fe.atomIndex===j?pe:fe,be=ee.indexOf(e.elements,Te.atomIndex);be<0||s[be]<j||(I[I.length]=X,P[P.length]=be,A[A.length]=me.flags,b[b.length]=me.order,_[_.length]=me.rowIndex,te||G.clear(),te=!0,G.add(be))}if(T)continue;let W=u[j],Y=S.value(W),ie=y.value(j);if(!t.forceCompute&&W!==v)if(C&&C.entries.has(ie)){let me=g[x.getEntityFromChain(m[j])];me&&me.sequence.microHet.has(Y)?R=void 0:R=C.entries.get(ie).map}else R=void 0;v=W;let D=gr($),F=l.value(j),N=R?R.get(F):void 0,{indices:oe,count:se,squaredDistances:ce}=h.find(n[j],o[j],a[j],r),he=en(D),ve=$r(D),Ie=d.value(j),Pe=no.has(D);for(let me=0;me<se;me++){let fe=oe[me];if(te&&G.has(fe))continue;let pe=s[fe];if(pe<=j)continue;let Te=d.value(pe);if(Ie&&Te&&Ie!==Te)continue;let be=gr(c.value(pe)),Re=en(be);if(he&&Re)continue;let Ne=(Pe||no.has(be))&&!(he||Re),Je=u[pe];if(W===Je&&N){let Ge=N.get(l.value(pe));if(Ge){I[I.length]=X,P[P.length]=fe,b[b.length]=Ge.order;let Fe=Ge.flags;Ne&&(Fe|_e.Flag.Covalent&&(Fe^=_e.Flag.Covalent),Fe|=_e.Flag.MetallicCoordination),A[A.length]=Fe,_[_.length]=Ge.key}continue}let tt=Math.sqrt(ce[me]);if(tt===0)continue;let Le=di(D,be,ve,$r(be));if(tt<=Le){I[I.length]=X,P[P.length]=fe,b[b.length]=nf(ie,F,l.value(pe)),A[A.length]=(Ne?_e.Flag.MetallicCoordination:_e.Flag.Covalent)|_e.Flag.Computed,_[_.length]=-1;let Ge=S.value(Je);Y===Ge&&(B=!1),Math.abs(Y-Ge)>1&&(L=!1)}}}return lf(I,P,b,A,_,i,E||B&&L)}function df(e,t){let r={...ss,...t};return r.noCompute||lt.isCoarseGrained(e.model)&&!In.Provider.get(e.model)&&!er.isExhaustive(e.model)?as.Empty:!r.forceCompute&&In.Provider.get(e.model)?C2(e):_2(e,r)}var us;(n=>{function e(o,a,i,s){o.indices[o.count]=i,o.units[o.count]=a,o.squaredDistances[o.count]=s,o.count++}n.add=e;function t(){return{count:0,indices:[],units:[],squaredDistances:[]}}n.create=t;function r(o,a){for(let i=0;i<a.count;++i)o.indices[i]=a.indices[i],o.units[i]=a.units[i],o.squaredDistances[i]=a.squaredDistances[i];return o.count=a.count,o}n.copy=r})(us||(us={}));function A2(){return{result:us.create(),closeUnitsResult:Xr.create(),unitGroupResult:Xr.create()}}var cs=class{constructor(t){this.structure=t;this.pivot=p();this.findContext=A2();let{units:r,boundary:n}=t,o=r.length,a=new Float32Array(o),i=new Float32Array(o),s=new Float32Array(o),u=new Float32Array(o),m=p();for(let l=0;l<o;l++){let d=r[l],y=d.boundary.sphere;p.transformMat4(m,y.center,d.conformation.operator.matrix),a[l]=m[0],i[l]=m[1],s[l]=m[2],u[l]=y.radius}let c={x:a,y:i,z:s,radius:u,indices:Ae.ofBounds(0,o)};this.unitLookup=Fo(c,n)}findUnitIndices(t,r,n,o){return this.unitLookup.find(t,r,n,o)}find(t,r,n,o,a){return this._find(t,r,n,o,a!=null?a:this.findContext)}_find(t,r,n,o,a){Xr.reset(a.result);let{units:i}=this.structure,s=this.unitLookup.find(t,r,n,o,a.closeUnitsResult);if(s.count===0)return a.result;for(let u=0,m=s.count;u<m;u++){let c=i[s.indices[u]];p.set(this.pivot,t,r,n),c.conformation.operator.isIdentity||p.transformMat4(this.pivot,this.pivot,c.conformation.operator.inverse);let d=c.lookup3d.find(this.pivot[0],this.pivot[1],this.pivot[2],o,a.unitGroupResult);for(let y=0,S=d.count;y<S;y++)us.add(a.result,c,d.indices[y],d.squaredDistances[y])}return a.result}check(t,r,n,o){let{units:a}=this.structure,i=this.unitLookup.find(t,r,n,o);if(i.count===0)return!1;for(let s=0,u=i.count;s<u;s++){let m=a[i.indices[s]];if(p.set(this.pivot,t,r,n),m.conformation.operator.isIdentity||p.transformMat4(this.pivot,this.pivot,m.conformation.operator.inverse),m.lookup3d.check(this.pivot[0],this.pivot[1],this.pivot[2],o))return!0}return!1}get boundary(){return this.structure.boundary}};function Xi(e,t){if(t.length===0)return Ce.Empty;if(t.length===1)return t[0];let r=new Map,n=new Set;for(let{units:a}of t)for(let i=0,s=a.length;i<s;i++){let u=a[i];if(r.has(u.id)){if(n.has(u.id))continue;let m=ee.union(r.get(u.id),u.elements);r.set(u.id,m),m.length===e.unitMap.get(u.id).elements.length&&n.add(u.id)}else r.set(u.id,u.elements),u.elements.length===e.unitMap.get(u.id).elements.length&&n.add(u.id)}let o=e.subsetBuilder(!0);return r.forEach(I2,o),o.getStructure()}function I2(e,t){this.setUnit(t,e)}function P2(e,t){if(e===t)return!0;let r,n;e.units.length<t.units.length?(r=e,n=t):(r=t,n=e);let o=r.units,a=n.unitMap;for(let i=0,s=o.length;i<s;i++){let u=o[i];if(!a.has(u.id))continue;let m=a.get(u.id);if(ee.areIntersecting(u.elements,m.elements))return!0}return!1}function pf(e,t){if(e===t)return Ce.Empty;if(!P2(e,t))return e;let r=e.units,n=t.unitMap,o=[];for(let a=0,i=r.length;a<i;a++){let s=r[a];if(!n.has(s.id)){o[o.length]=s;continue}let u=n.get(s.id),m=ee.subtract(s.elements,u.elements);m.length>0&&(o[o.length]=s.getChild(m))}return Ce.create(o,{parent:e.parent||t.parent})}var we;(S=>{function e(x,g){return{kind:"singletons",source:x,structure:g}}S.Singletons=e;function t(x,g){return{kind:"sequence",source:x,structures:g}}S.Sequence=t;function r(x){return e(x,Ce.Empty)}S.Empty=r;function n(x){return x.kind==="singletons"}S.isSingleton=n;function o(x){return n(x)?x.structure.units.length===0:x.structures.length===0}S.isEmpty=o;function a(x){return n(x)?x.structure.elementCount:x.structures.length}S.structureCount=a;function i(x){return o(x)?Ce.Empty:n(x)?x.structure:Xi(x.source,x.structures)}S.unionStructure=i;function s(x,g,h){return g.length===0?r(x):h?e(x,Xi(x,g)):t(x,g)}class u{constructor(g){this.source=g;this.structures=[];this.allSingletons=!0}add(g){let h=g.elementCount;h!==0&&(this.structures[this.structures.length]=g,h!==1&&(this.allSingletons=!1))}getSelection(){return s(this.source,this.structures,this.allSingletons)}}class m{constructor(g){this.structure=g;this.structures=[];this.allSingletons=!0;this.uniqueSets=is(Ce.hashCode,Ce.areUnitIdsAndIndicesEqual)}add(g){let h=g.elementCount;h===0||!this.uniqueSets.add(g)||(this.structures[this.structures.length]=g,h!==1&&(this.allSingletons=!1))}getSelection(){return s(this.structure,this.structures,this.allSingletons)}}function c(x){return new u(x)}S.LinearBuilder=c;function l(x){return new m(x)}S.UniqueBuilder=l;function d(x,g){let h=0;if(S.isSingleton(x))for(let f of x.structure.units){let{elements:C}=f;for(let T=0,I=C.length;T<I;T++){let P=Ce.create([f.getChild(ee.ofSingleton(C[T]))],{parent:x.source});g(P,h++)}}else for(let f of x.structures)g(f,h++)}S.forEach=d;function y(x,g){return n(x)?e(g,x.structure):t(g,x.structures)}S.withInputStructure=y})(we||(we={}));var Ec={};Ao(Ec,{defaultBondTest:()=>ms,spheres:()=>v2,water:()=>T2});function ms(e){return _e.isCovalent(e.atomicBond.type)}function T2(){return function(t){let{inputStructure:r}=t,n=le.Location.create(r),o=[];for(let a of r.units){if(a.kind!==O.Kind.Atomic)continue;n.unit=a;let i=a.elements;n.element=i[0],mt.entity.type(n)==="water"&&o.push(a)}return we.Singletons(r,Ce.create(o,{parent:r}))}}function v2(){return function(t){let{inputStructure:r}=t,n=[];for(let o of r.units)o.kind===O.Kind.Spheres&&n.push(o);return we.Singletons(r,Ce.create(n,{parent:r}))}}var tn=class{constructor(t,r){this.currentElementStack=[];this.currentAtomicBondStack=[];this.currentStructureStack=[];this.inputStructureStack=[];this.element=le.Location.create(void 0);this.currentStructure=void 0;this.atomicBond=new ls;this.currentSelection=void 0;this.inputStructure=t,this.timeoutMs=r&&r.timeoutMs||0,this.currentSelection=r&&r.currentSelection}pushCurrentElement(){return this.currentElementStack[this.currentElementStack.length]=this.element,this.element=le.Location.create(void 0),this.element}popCurrentElement(){this.element=this.currentElementStack.pop()}pushCurrentBond(){return this.atomicBond&&this.currentAtomicBondStack.push(this.atomicBond),this.atomicBond=new ls,this.atomicBond}popCurrentBond(){this.currentAtomicBondStack.length>0?this.atomicBond=this.currentAtomicBondStack.pop():this.atomicBond=void 0}pushCurrentStructure(){this.currentStructure&&this.currentStructureStack.push(this.currentStructure)}popCurrentStructure(){this.currentStructureStack.length?this.currentStructure=this.currentStructureStack.pop():this.currentStructure=void 0}pushInputStructure(t){this.inputStructureStack.push(this.inputStructure),this.inputStructure=t}popInputStructure(){this.inputStructure=this.inputStructureStack.pop()}},ls=class{constructor(){this.a=le.Location.create(void 0);this.aIndex=0;this.b=le.Location.create(void 0);this.bIndex=0;this.type=_e.Flag.None;this.order=0;this.key=-1;this.testFn=ms}setStructure(t){this.a.structure=t,this.b.structure=t}setTestFn(t){this.testFn=t||ms}test(t,r){return this.testFn(t)?!0:r?(this.swap(),this.testFn(t)):!1}swap(){let t=this.aIndex;this.aIndex=this.bIndex,this.bIndex=t;let r=this.a.unit;this.a.unit=this.b.unit,this.b.unit=r;let n=this.a.element;this.a.element=this.b.element,this.b.element=n}get length(){return le.Location.distance(this.a,this.b)}};var Bc;(t=>{function e(r,n,o){return r(new tn(n,o))}t.run=e})(Bc||(Bc={}));var Lc={};Ao(Lc,{all:()=>ff,atoms:()=>Uc,bondedAtomicPairs:()=>L2,chains:()=>M2,none:()=>Fc,residues:()=>D2,rings:()=>U2});var ds=class{constructor(t){this.source=t;this.set=is(Ce.hashCode,Ce.areUnitIdsAndIndicesEqual);this.structures=[];this.allSingletons=!0}add(t){t.elementCount&&(t.elementCount!==1&&(this.allSingletons=!1),this.set.add(t)&&(this.structures[this.structures.length]=t))}getSelection(){return this.allSingletons?we.Singletons(this.source,Xi(this.source,this.structures)):we.Sequence(this.source,this.structures)}},ps=class{constructor(t){this.source=t;this.builders=[];this.builderMap=new Map}add(t,r,n){let o=this.builderMap.get(t);o||(o=this.source.subsetBuilder(!0),this.builders[this.builders.length]=o,this.builderMap.set(t,o)),o.addToUnit(r,n)}allSingletons(){for(let t=0,r=this.builders.length;t<r;t++)if(this.builders[t].elementCount>1)return!1;return!0}singletonSelection(){let t=this.source.subsetBuilder(!0),r=le.Location.create(this.source);for(let n=0,o=this.builders.length;n<o;n++)this.builders[n].setSingletonLocation(r),t.addToUnit(r.unit.id,r.element);return we.Singletons(this.source,t.getStructure())}fullSelection(){let t=new Array(this.builders.length);for(let r=0,n=this.builders.length;r<n;r++)t[r]=this.builders[r].getStructure();return we.Sequence(this.source,t)}getSelection(){return this.builders.length===0?we.Empty(this.source):this.allSingletons()?this.singletonSelection():this.fullSelection()}};var Fc=e=>we.Sequence(e.inputStructure,[]),ff=e=>we.Singletons(e.inputStructure,e.inputStructure);function D2(e){return Uc({...e,groupBy:t=>mt.residue.key(t.element)})}function M2(e){return Uc({...e,groupBy:t=>mt.chain.key(t.element)})}function oo(e){return!0}function E2(e){return 0}function Uc(e){if(!e||!e.atomTest&&!e.residueTest&&!e.chainTest&&!e.entityTest&&!e.unitTest&&!e.groupBy)return ff;if(e.atomTest&&!e.residueTest&&!e.chainTest&&!e.entityTest&&!e.unitTest&&!e.groupBy)return B2(e.atomTest);let t={unitTest:e.unitTest||oo,entityTest:e.entityTest||oo,chainTest:e.chainTest||oo,residueTest:e.residueTest||oo,atomTest:e.atomTest||oo,groupBy:e.groupBy||E2};return e.groupBy?F2(t):R2(t)}function B2(e){return function(r){let{inputStructure:n}=r,{units:o}=n,a=r.pushCurrentElement(),i=n.subsetBuilder(!0);a.structure=n;for(let s of o){a.unit=s;let u=s.elements;i.beginUnit(s.id);for(let m=0,c=u.length;m<c;m++)a.element=u[m],e(r)&&i.addElement(a.element);i.commitUnit()}return r.popCurrentElement(),we.Singletons(n,i.getStructure())}}function R2({unitTest:e,entityTest:t,chainTest:r,residueTest:n,atomTest:o}){return function(i){let{inputStructure:s}=i,{units:u}=s,m=i.pushCurrentElement(),c=s.subsetBuilder(!0),l=n===oo&&o===oo,d=o===oo;m.structure=s;for(let y of u){if(m.unit=y,!e(i))continue;let{elements:S,model:x}=y;if(c.beginUnit(y.id),y.kind===O.Kind.Atomic){let g=Ue.transientSegments(y.model.atomicHierarchy.chainAtomSegments,S),h=Ue.transientSegments(y.model.atomicHierarchy.residueAtomSegments,S);for(;g.hasNext;){let f=g.move();if(m.element=S[f.start],!(!t(i)||!r(i))){if(l){c.addElementRange(S,f.start,f.end);continue}for(h.setSegment(f);h.hasNext;){let C=h.move();if(m.element=S[C.start],!!n(i)){if(d){c.addElementRange(S,C.start,C.end);continue}for(let T=C.start,I=C.end;T<I;T++)m.element=S[T],o(i)&&c.addElement(m.element)}}}}}else{let{chainElementSegments:g}=O.Kind.Spheres?x.coarseHierarchy.spheres:x.coarseHierarchy.gaussians,h=Ue.transientSegments(g,S);for(;h.hasNext;){let f=h.move();if(m.element=S[f.start],!(!t(i)||!r(i))){if(l){c.addElementRange(S,f.start,f.end);continue}for(let C=f.start,T=f.end;C<T;C++)m.element=S[C],n(i)&&c.addElement(m.element)}}}c.commitUnit()}return i.popCurrentElement(),we.Singletons(s,c.getStructure())}}function F2({unitTest:e,entityTest:t,chainTest:r,residueTest:n,atomTest:o,groupBy:a}){return function(s){let{inputStructure:u}=s,{units:m}=u,c=s.pushCurrentElement(),l=new ps(u);c.structure=u;for(let d of m){if(c.unit=d,!e(s))continue;let{elements:y,model:S}=d;if(d.kind===O.Kind.Atomic){let x=Ue.transientSegments(S.atomicHierarchy.chainAtomSegments,y),g=Ue.transientSegments(S.atomicHierarchy.residueAtomSegments,y);for(;x.hasNext;){let h=x.move();if(c.element=y[h.start],!(!t(s)||!r(s)))for(g.setSegment(h);g.hasNext;){let f=g.move();if(c.element=y[f.start],!!n(s))for(let C=f.start,T=f.end;C<T;C++)c.element=y[C],o(s)&&l.add(a(s),d.id,c.element)}}}else{let{chainElementSegments:x}=O.Kind.Spheres?S.coarseHierarchy.spheres:S.coarseHierarchy.gaussians,g=Ue.transientSegments(x,y);for(;g.hasNext;){let h=g.move();if(c.element=y[h.start],!(!t(s)||!r(s)))for(let f=h.start,C=h.end;f<C;f++)c.element=y[f],n(s)&&l.add(a(s),d.id,c.element)}}}return s.popCurrentElement(),l.getSelection()}}function Rc(e,t,r){let n=new Int32Array(t.length);for(let o=0,a=t.length;o<a;o++)n[o]=e.elements[t[o]];return Ce.create([e.getChild(ee.ofSortedArray(n))],{parent:r})}function U2(e,t){return function(n){let{units:o}=n.inputStructure,a=we.LinearBuilder(n.inputStructure);if(!e||e.length===0){for(let i of o)if(O.isAtomic(i))if(t)for(let s of i.rings.aromaticRings)a.add(Rc(i,i.rings.all[s],n.inputStructure));else for(let s of i.rings.all)a.add(Rc(i,s,n.inputStructure))}else{let i=_t.create();for(let s=0;s<e.length;s++)_t.add(i,e[s],e[s]);for(let s of o){if(!O.isAtomic(s))continue;let u=s.rings;for(let m of i.array)if(u.byFingerprint.has(m))for(let c of u.byFingerprint.get(m))t&&!u.aromaticRings.includes(c)||a.add(Rc(s,u.all[c],n.inputStructure))}}return a.getSelection()}}function L2(e){return function(r){let n=r.inputStructure,o=n.interUnitBonds,a=we.UniqueBuilder(r.inputStructure);r.pushCurrentBond();let i=r.atomicBond;i.setTestFn(e),i.setStructure(n);for(let s of n.units){if(s.kind!==O.Kind.Atomic)continue;let{offset:u,b:m,edgeProps:{flags:c,order:l,key:d}}=s.bonds;i.a.unit=s,i.b.unit=s;for(let y=0,S=s.elements.length;y<S;y++){i.aIndex=y,i.a.element=s.elements[y];for(let x=u[y],g=u[y+1];x<g;x++)if(i.bIndex=m[x],i.b.element=s.elements[m[x]],i.type=c[x],i.order=l[x],i.key=d[x],i.test(r,!1)){let h=n.subsetBuilder(!1);h.beginUnit(s.id),h.addElement(i.a.element),h.addElement(i.b.element),h.commitUnit(),a.add(h.getStructure())}}}for(let s of o.edges)if(i.a.unit=n.unitMap.get(s.unitA),i.a.element=i.a.unit.elements[s.indexA],i.aIndex=s.indexA,i.b.unit=n.unitMap.get(s.unitB),i.b.element=i.b.unit.elements[s.indexB],i.bIndex=s.indexB,i.order=s.props.order,i.type=s.props.flag,i.key=s.props.key,i.test(r,!1)){let u=n.subsetBuilder(!1);u.addToUnit(i.a.unit.id,i.a.element),u.addToUnit(i.b.unit.id,i.b.element),a.add(u.getStructure())}return r.popCurrentBond(),a.getSelection()}}var kc={};Ao(kc,{exceptBy:()=>k2,includeConnected:()=>w2,union:()=>G2,wholeResidues:()=>V2});var fs=class{constructor(t){this.parent=t;this.ids=[];this.unitMap=cr.Mutable();this.parentId=-1;this.currentUnit=_t.create();this.elementCount=0}addToUnit(t,r){let n=this.unitMap.get(t);if(n)_t.add(n,r,r)&&this.elementCount++;else{let o=_t.create();_t.add(o,r,r),this.unitMap.set(t,o),this.ids[this.ids.length]=t,this.elementCount++}}has(t,r){let n=this.unitMap.get(t);return n?_t.has(n,r):!1}beginUnit(t){this.parentId=t,this.unitMap.has(t)?this.currentUnit=this.unitMap.get(t):this.currentUnit=this.currentUnit.array.length>0?_t.create():this.currentUnit}addElement(t){_t.add(this.currentUnit,t,t)&&this.elementCount++}commitUnit(){this.currentUnit.array.length===0||this.unitMap.has(this.parentId)||(this.ids[this.ids.length]=this.parentId,this.unitMap.set(this.parentId,this.currentUnit),this.parentId=-1)}getStructure(){if(this.isEmpty)return Ce.Empty;let t=[];Fr(this.ids);let r=br.UnitEquivalenceBuilder();for(let n=0,o=this.ids.length;n<o;n++){let a=this.ids[n],i=this.parent.unitMap.get(a),s=this.unitMap.get(a).array,u=s.length;if(s.length===i.elements.length){t[t.length]=i,r.add(i.id,i);continue}u>1&&Fr(s);let m=i.getChild(ee.ofSortedArray(s)),c=r.add(m.id,m);m!==c&&(m=c.applyOperator(m.id,m.conformation.operator,!0)),t[t.length]=m}return Ce.create(t,{parent:this.parent})}get isEmpty(){return this.elementCount===0}};function Vc(e,t,r){let n=t.subsetBuilder(!0);for(let o of r.units){if(o.kind!==O.Kind.Atomic){n.setUnit(o.id,o.elements);continue}let{residueAtomSegments:a}=o.model.atomicHierarchy,i=t.unitMap.get(o.id).elements,s=o.elements;n.beginUnit(o.id);let u=Ue.transientSegments(a,s);for(;u.hasNext;){let m=u.move().index;for(let c=a.offsets[m],l=a.offsets[m+1];c<l;c++)ee.has(i,c)&&n.addElement(c)}n.commitUnit()}return n.getStructure()}function V2(e){return function(r){let n=e(r);if(we.isSingleton(n))return we.Singletons(r.inputStructure,Vc(r,r.inputStructure,n.structure));{let o=new ds(r.inputStructure);for(let a of n.structures)o.add(Vc(r,r.inputStructure,a));return o.getSelection()}}}function k2(e,t){return function(n){let o=e(n);if(we.structureCount(o)===0)return o;let a=t(n);if(we.structureCount(a)===0)return o;let i=we.unionStructure(a),s=we.UniqueBuilder(n.inputStructure);return we.forEach(o,(u,m)=>{let c=pf(u,i);c.elementCount!==0&&s.add(c)}),s.getSelection()}}function G2(e){return function(r){let n=we.LinearBuilder(r.inputStructure);return n.add(we.unionStructure(e(r))),n.getSelection()}}function w2({query:e,layerCount:t,wholeResidues:r,bondTest:n,fixedPoint:o}){let a=Math.max(t,0);return function(s){let u=we.UniqueBuilder(s.inputStructure),m=e(s);return s.pushCurrentBond(),s.atomicBond.setTestFn(n),we.forEach(m,(c,l)=>{let d=c;if(o)for(;;){let y=d.elementCount;if(d=yf(s,r,d),d.elementCount===y)break}else for(let y=0;y<a;y++)d=yf(s,r,d);u.add(d)}),s.popCurrentBond(),u.getSelection()}}function yf(e,t,r){let n=N2(e,r);return t?Vc(e,e.inputStructure,n):n}function N2(e,t){let r=e.inputStructure,n=r.interUnitBonds,o=new fs(r),a=e.atomicBond;for(let i of t.units){if(i.kind!==O.Kind.Atomic){o.beginUnit(i.id);for(let y=0,S=i.elements.length;y<S;y++)o.addElement(i.elements[y]);o.commitUnit();continue}let s=r.unitMap.get(i.id),{offset:u,b:m,edgeProps:{flags:c,order:l,key:d}}=s.bonds;a.setStructure(r),a.a.unit=s,a.b.unit=s;for(let y=0,S=i.elements.length;y<S;y++){o.addToUnit(i.id,i.elements[y]);let x=ee.indexOf(s.elements,i.elements[y]);for(let g=u[x],h=u[x+1];g<h;g++){let f=m[g],C=s.elements[f];ee.has(i.elements,C)||o.has(i.id,C)||(a.aIndex=x,a.a.element=i.elements[y],a.bIndex=f,a.b.element=C,a.type=c[g],a.order=l[g],a.key=d[g],a.test(e,!0)&&o.addToUnit(i.id,C))}}for(let y of n.getConnectedUnits(s.id)){let S=t.unitMap.get(y.unitB),x=r.unitMap.get(y.unitB);for(let g of y.connectedIndices)if(ee.has(i.elements,s.elements[g]))for(let h of y.getEdges(g)){let f=x.elements[h.indexB];S&&ee.has(S.elements,f)||o.has(y.unitB,f)||(a.a.unit=s,a.aIndex=g,a.a.element=s.elements[g],a.b.unit=x,a.bIndex=h.indexB,a.b.element=f,a.type=h.props.flag,a.order=h.props.order,a.key=h.props.key,a.test(e,!0)&&o.addToUnit(y.unitB,f))}}}return o.getStructure()}var Gc={};Ao(Gc,{isConnectedTo:()=>H2});function O2(e,t){let{queryCtx:r,input:n,target:o,disjunct:a}=e,i=r.atomicBond,s=n.interUnitBonds;i.setStructure(n);for(let u of t.units){if(!O.isAtomic(u))continue;let m=n.unitMap.get(u.id),{offset:c,b:l,edgeProps:{flags:d,order:y,key:S}}=m.bonds,x=s.getConnectedUnits(u.id),g=x.length,h=u.elements,f=m.elements;for(let C=0,T=h.length;C<T;C++){let I=ee.indexOf(f,h[C]);i.a.unit=m,i.b.unit=m;for(let P=c[I],A=c[I+1];P<A;P++)if(i.b.element=m.elements[l[P]],!(a&&ee.has(u.elements,i.b.element))&&o.hasElement(i.b)&&(i.aIndex=I,i.a.element=h[C],i.bIndex=l[P],i.type=d[P],i.order=y[P],i.key=S[P],i.test(r,!0)))return!0;for(let P=0;P<g;P++){let A=x[P],b=n.unitMap.get(A.unitB),_=b.elements,v=A.getEdges(I);for(let R=0,E=v.length;R<E;R++){let B=v[R];if(i.b.unit=b,i.b.element=_[B.indexB],!!o.hasElement(i.b)&&!(a&&t.hasElement(i.b))&&(i.a.unit=m,i.aIndex=I,i.a.element=h[C],i.bIndex=B.indexB,i.type=B.props.flag,i.order=B.props.order,i.key=B.props.key,i.test(r,!0)))return!0}}}}return!1}function H2({query:e,target:t,disjunct:r,invert:n,bondTest:o}){return a=>{let i=t(a);if(we.isEmpty(i))return i;let s=e(a);if(we.isEmpty(s))return s;let u={queryCtx:a,input:a.inputStructure,disjunct:r,target:we.unionStructure(i)},m=we.LinearBuilder(a.inputStructure);return a.pushCurrentBond(),a.atomicBond.setTestFn(o),we.forEach(s,(c,l)=>{(O2(u,c)||n)&&m.add(c)}),a.popCurrentBond(),m.getSelection()}}var wc={};Ao(wc,{merge:()=>q2});function q2(e){return e.length===0?Fc:e.length===1?e[0]:t=>{let r=we.UniqueBuilder(t.inputStructure);for(let n=0;n<e.length;n++)we.forEach(e[n](t),(o,a)=>{r.add(o)});return r.getSelection()}}var ys;(l=>{function e(d){return!!d&&!!d.has}function t(d,y){return S=>d(S)===y}l.eq=t;function r(d,y){return S=>d(S)<y}l.lt=r;function n(d,y){return S=>d(S)<=y}l.lte=n;function o(d,y){return S=>d(S)>y}l.gt=o;function a(d,y){return S=>d(S)>=y}l.gte=a;function i(d){return!0}function s(d){return!1}function u(d,y){if(e(y))return S=>y.has(d(S));{if(y.length===0)return s;let S=new Set;for(let x=0;x<y.length;x++)S.add(y[x]);return x=>S.has(d(x))}}l.inSet=u;function m(...d){switch(d.length){case 0:return i;case 1:return d[0];case 2:{let y=d[0],S=d[1];return x=>y(x)&&S(x)}case 3:{let y=d[0],S=d[1],x=d[2];return g=>y(g)&&S(g)&&x(g)}case 4:{let y=d[0],S=d[1],x=d[2],g=d[3];return h=>y(h)&&S(h)&&x(h)&&g(h)}case 5:{let y=d[0],S=d[1],x=d[2],g=d[3],h=d[4];return f=>y(f)&&S(f)&&x(f)&&g(f)&&h(f)}case 6:{let y=d[0],S=d[1],x=d[2],g=d[3],h=d[4],f=d[5];return C=>y(C)&&S(C)&&x(C)&&g(C)&&h(C)&&f(C)}default:{let y=d.length;return S=>{for(let x=0;x<y;x++)if(!d[x])return!1;return!0}}}}l.and=m;function c(...d){switch(d.length){case 0:return s;case 1:return d[0];case 2:{let y=d[0],S=d[1];return x=>y(x)||S(x)}case 3:{let y=d[0],S=d[1],x=d[2];return g=>y(g)||S(g)||x(g)}case 4:{let y=d[0],S=d[1],x=d[2],g=d[3];return h=>y(h)||S(h)||x(h)||g(h)}case 5:{let y=d[0],S=d[1],x=d[2],g=d[3],h=d[4];return f=>y(f)||S(f)||x(f)||g(f)||h(f)}case 6:{let y=d[0],S=d[1],x=d[2],g=d[3],h=d[4],f=d[5];return C=>y(C)||S(C)||x(C)||g(C)||h(C)||f(C)}default:{let y=d.length;return S=>{for(let x=0;x<y;x++)if(d[x])return!0;return!1}}}}l.or=c})(ys||(ys={}));var Yt={generators:Lc,filters:Gc,modifiers:kc,combinators:wc,pred:ys,internal:Ec};var br;(a=>{function e(i,s){let u=i.models,m=Yi.findAssembly(u[0],s),c=Ce.Builder({dynamicBonds:i.dynamicBonds}),l=new tn(i);for(let d of m.operatorGroups){let y=d.selector(l);if(we.structureCount(y)===0)continue;let{units:S}=we.unionStructure(y);for(let x of d.operators)for(let g of S)c.addWithOperator(g,x)}return c.getStructure()}a.buildAssembly=e;function t(i,s){return i.invariantId===s.invariantId&&i.model.id===s.model.id&&ee.areEqual(i.elements,s.elements)}a.areUnitsEquivalent=t;function r(){return Ml(O.hashUnit,t)}a.UnitEquivalenceBuilder=r;function n(i){let s=r();for(let m of i.units)s.add(m.id,m);let u=[];for(let m of s.groups)u.push(O.SymmetryGroup(m.map(c=>i.unitMap.get(c))));return u}a.computeTransformGroups=n;function o(i,s){if(i.length!==s.length)return!1;for(let u=0,m=i.length;u<m;++u){let c=i[u].units,l=s[u].units;if(c.length!==l.length||i[u].hashCode!==s[u].hashCode)return!1;for(let d=0,y=c.length;d<y;d++)if(c[d].conformation!==l[d].conformation)return!1}return!0}a.areTransformGroupsEquivalent=o})(br||(br={}));var hs=class{constructor(t,r){this.parent=t;this.isSorted=r;this.ids=[];this.unitMap=cr.Mutable();this.parentId=-1;this.currentUnit=[];this.elementCount=0}addToUnit(t,r){let n=this.unitMap.get(t);n?n[n.length]=r:(this.unitMap.set(t,[r]),this.ids[this.ids.length]=t),this.elementCount++}beginUnit(t){this.parentId=t,this.currentUnit=this.currentUnit.length>0?[]:this.currentUnit}addElement(t){this.currentUnit[this.currentUnit.length]=t,this.elementCount++}addElementRange(t,r,n){for(let o=r;o<n;o++)this.currentUnit[this.currentUnit.length]=t[o],this.elementCount++}commitUnit(){this.currentUnit.length!==0&&(this.ids[this.ids.length]=this.parentId,this.unitMap.set(this.parentId,this.currentUnit),this.parentId=-1)}setUnit(t,r){this.ids[this.ids.length]=t,this.unitMap.set(t,r),this.elementCount+=r.length}_getStructure(t){if(this.isEmpty)return Ce.Empty;let r=[];Fr(this.ids);let n=br.UnitEquivalenceBuilder();for(let o=0,a=this.ids.length;o<a;o++){let i=this.ids[o],s=this.parent.unitMap.get(i),u=this.unitMap.get(i),m=!1;t&&(this.isSorted||Fr(u),u=ee.deduplicate(ee.ofSortedArray(this.currentUnit)),m=!0);let c=u.length;if(u.length===s.elements.length){r[r.length]=s,n.add(s.id,s);continue}!this.isSorted&&!m&&c>1&&Fr(u);let l=s.getChild(ee.ofSortedArray(u)),d=n.add(l.id,l);l!==d&&(l=d.applyOperator(l.id,l.conformation.operator,!0)),r[r.length]=l}return Ce.create(r,{parent:this.parent})}getStructure(){return this._getStructure(!1)}getStructureDeduplicate(){return this._getStructure(!0)}setSingletonLocation(t){let r=this.ids[0];t.unit=this.parent.unitMap.get(r),t.element=this.unitMap.get(r)[0]}get isEmpty(){return this.elementCount===0}};function hf(e,t){let r=1;for(;t--;)r*=e--;return r}function z2(e,t){return t>e?0:hf(e,t)/hf(t,t)}function K2(e){let t=e&-e,r=e+t,o=((r&-r)/t>>1)-1;return r|o}var Nc=class{constructor(t,r){this.array=t;this.hasNext=!1;this.index=(1<<r)-1,this.size=z2(t.length,r),this.maxIndex=1<<t.length,this.value=new Array(r),this.hasNext=r>0&&r<=t.length}move(){if(this.hasNext){let t=0,r=0,n=this.index;for(;n;n>>>=1,t++)n&1&&(this.value[r++]=this.array[t]);this.index=K2(this.index),this.hasNext=this.index<this.maxIndex}return this.value}};function Oc(e,t){let r=[],n=new Nc(e,t);for(;n.hasNext;)r.push(n.move().slice());return r}var No=[],xf={links:No,terminalLinks:No,elements:No,partialElements:No,getElementIndices:()=>No,getLinkIndices:()=>No,getTerminalLinkIndices:()=>No};function If(e){let t=Q2(e),r=j2(e,t),n=Ue.transientSegments(e.model.atomicHierarchy.residueAtomSegments,e.elements);for(;n.hasNext;){let o=n.move();Y2(r,o.start,o.end)}return r.rings}function j2(e,t){return{startVertex:0,endVertex:0,count:0,isRingAtom:new Int32Array(t),marked:new Int32Array(t),queue:new Int32Array(t),pred:new Int32Array(t),depth:new Int32Array(t),left:new Int32Array(5),right:new Int32Array(5),color:new Int32Array(t),currentColor:0,currentAltLoc:"",hasAltLoc:!1,rings:[],currentRings:[],unit:e,bonds:e.bonds,altLoc:e.model.atomicHierarchy.atoms.label_alt_id}}function gf(e){e.count=e.endVertex-e.startVertex;let{isRingAtom:t,pred:r,color:n,depth:o,marked:a}=e;for(let i=0;i<e.count;i++)t[i]=0,r[i]=-1,a[i]=-1,n[i]=0,o[i]=0;e.currentColor=0,e.currentAltLoc="",e.hasAltLoc=!1}function bf(e){let{depth:t}=e;for(let r=0;r<e.count;r++)t[r]=e.count+1}function Q2(e){let t=Ue.transientSegments(e.model.atomicHierarchy.residueAtomSegments,e.elements),r=0;for(;t.hasNext;){let n=t.move();r=Math.max(r,n.end-n.start)}return r}function Sf(e,t){let r=e.bonds.offset,n=e.startVertex+t,o=r[n],i=r[n+1]-o;return!(i<=1||e.isRingAtom[t]&&i===2)}function Y2(e,t,r){if(e.startVertex=t,e.endVertex=r,e.endVertex-e.startVertex<3)return;e.currentRings=[];let{elements:n}=e.unit,o=[];for(let i=e.startVertex;i<e.endVertex;i++){let s=e.altLoc.value(n[i]);Wa(o,s)}zp(o,"");let a=1;if(o.length===0){gf(e);for(let i=0;i<e.count;i++)Sf(e,i)&&(bf(e),a=Cf(e,i,a))}else for(let i=0;i<o.length;i++){gf(e),e.hasAltLoc=!0,e.currentAltLoc=o[i];for(let s=0;s<e.count;s++){if(!Sf(e,s))continue;let u=e.altLoc.value(n[e.startVertex+s]);u&&u!==e.currentAltLoc||(bf(e),a=Cf(e,s,a))}}for(let i=0,s=e.currentRings.length;i<s;i++)e.rings.push(e.currentRings[i])}function X2(e,t,r,n){if(r<t)return!1;let{pred:o,color:a,left:i,right:s}=e,u=++e.currentColor,m=t;for(let h=0;h<5&&(a[m]=u,m=o[m],!(m<0));h++);let c=0,l=0,d=!1,y=0;m=r;for(let h=0;h<5;h++){if(a[m]===u){y=m,d=!0;break}if(s[l++]=m,m=o[m],m<0)break}if(!d)return!1;m=t;for(let h=0;h<5&&(i[c++]=m,!(y===m||(m=o[m],m<0)));h++);let S=c+l;if(S<3)return!1;let x=new Int32Array(S),g=0;for(let h=0;h<c;h++)x[g++]=e.startVertex+i[h],n[i[h]]=1;for(let h=l-1;h>=0;h--)x[g++]=e.startVertex+s[h],n[s[h]]=1;Fr(x);for(let h=0,f=e.currentRings.length;h<f;h++){let C=e.currentRings[h];if(x.length===C.length){if(ee.areEqual(x,C))return!1}else if(x.length>C.length&&ee.isSubset(x,C))return!1}return e.currentRings.push(ee.ofSortedArray(x)),!0}function Cf(e,t,r){let{bonds:n,startVertex:o,endVertex:a,isRingAtom:i,marked:s,queue:u,pred:m,depth:c}=e,{elements:l}=e.unit,{b:d,edgeProps:{flags:y},offset:S}=n;s[t]=r,c[t]=0,u[0]=t;let x=0,g=1;for(;x<g;){let h=u[x++],f=c[h],C=o+h,T=S[C],I=S[C+1];for(let P=T;P<I;P++){let A=d[P];if(A<o||A>=a||!_e.isCovalent(y[P]))continue;if(e.hasAltLoc){let v=e.altLoc.value(l[A]);if(v&&e.currentAltLoc!==v)continue}let b=A-o;if(s[b]===r){if(m[b]!==h&&m[h]!==b&&X2(e,h,b,i))return r+1;continue}let _=Math.min(c[b],f+1);_>5||(c[b]=_,s[b]=r,u[g++]=b,m[b]=h)}}return r+1}function Pf(e){let t=e.length,r=new Array(t);for(let i=0;i<t;i++)r[i]=e[t-i-1];let n=_f(e),o=_f(r),a=!1;for(let i=0;i<t;i++){let s=e[(i+n)%t],u=r[(i+o)%t];if(s!==u){a=s<u;break}}return a?Af(e,n):Af(r,o)}function _f(e){let t=e.length,r=new Int32Array(t*2);for(let i=0;i<r.length;i++)r[i]=-1;let n="",o="",a=0;for(let i=1;i<r.length;i++){let s=r[i-a-1];for(;s!==-1&&(n=e[i%t],o=e[(a+s+1)%t],n!==o);)n<o&&(a=i-s-1),s=r[s];s===-1?(n=e[i%t],o=e[(a+s+1)%t],n!==o?(n<o&&(a=i),r[i-a]=-1):r[i-a]=s+1):r[i-a]=s+1}return a}function Af(e,t){let r=e.length,n=[],o;for(o=0;o<r-1;o++)n.push(e[(o+t)%r]),n.push("-");return n.push(e[(o+t)%r]),n.join("")}function Tf(e,t){let r=new Map,n=new Map;for(let u=0,m=e.length;u<m;u++){let c=e[u];for(let l=0,d=c.length;l<d;l++){let y=c[l];r.has(y)?r.get(y).push(u):r.set(y,[u])}}for(let u=0,m=t.length;u<m;u++){let c=t[u],l=e[c];for(let d=0,y=l.length;d<y;d++){let S=l[d];n.has(S)?n.get(S).push(c):n.set(S,[c])}}let o=new qt.UniqueEdgeBuilder(e.length);for(let u=0,m=e.length;u<m;u++){let c=e[u];for(let l=0,d=c.length;l<d;l++){let y=c[l],S=r.get(y);if(S.length!==1)for(let x=0,g=S.length;x<g;x++){let h=S[x];u>=h||o.addEdge(u,h)}}}let a=qt.connectedComponents(o.getGraph()),i=a.componentIndex,s=[];for(let u=0;u<a.componentCount;u++)s[u]=[];for(let u=0,m=e.length;u<m;u++)s[i[u]].push(u);return{elementRingIndices:r,elementAromaticRingIndices:n,ringComponentIndex:i,ringComponents:s}}var Pn=class{constructor(t,r){this.unit=r;this.all=t}get index(){return this._index?this._index:(this._index=Tf(this.all,this.aromaticRings),this._index)}get byFingerprint(){return this._byFingerprint?this._byFingerprint:(this._byFingerprint=Z2(this.unit,this.all),this._byFingerprint)}get elementRingIndices(){return this.index.elementRingIndices}get elementAromaticRingIndices(){return this.index.elementAromaticRingIndices}get ringComponentIndex(){return this.index.ringComponentIndex}get ringComponents(){return this.index.ringComponents}get aromaticRings(){return this._aromaticRings?this._aromaticRings:(this._aromaticRings=$2(this.unit,this.all),this._aromaticRings)}},Sr;(i=>{function e(s,u){let{elements:m}=s,{type_symbol:c}=s.model.atomicHierarchy.atoms,l=[];for(let d=0,y=u.length;d<y;d++)l[l.length]=c.value(m[u[d]]);return t(l)}i.fingerprint=e;function t(s){return Pf(s)}i.elementFingerprint=t;let r=new Set(["B","C","N","O","SI","P","S","GE","AS","SN","SB","BI"]),n=.05;function o(s,u){let{elements:m,bonds:{b:c,offset:l,edgeProps:{flags:d}}}=s,{type_symbol:y,label_comp_id:S}=s.model.atomicHierarchy.atoms;if(S.value(s.elements[u[0]])==="PRO")return!1;let x=0,g=!1;for(let f=0,C=u.length;f<C;++f){let T=u[f];!g&&r.has(y.value(m[T]))&&(g=!0);for(let I=l[T],P=l[T+1];I<P;++I)_e.is(_e.Flag.Aromatic,d[I])&&ee.has(u,c[I])&&(x+=1)}if(x===2*u.length)return!0;if(!g||u.length<5||x>0)return!1;let h=mr.calculateMomentsAxes(Ya(s,u));return p.magnitude(h.dirC)<n}i.isAromatic=o;function a(s,u){let{label_alt_id:m}=s.model.atomicHierarchy.atoms,{elements:c}=s;for(let l=0,d=u.length;l<d;++l){let y=c[u[l]],S=m.value(y);if(S)return S}return""}i.getAltId=a})(Sr||(Sr={}));(r=>{function e(n){let o=If(n);return new r(o,n)}r.create=e;function t(n,o){let a=new Map;for(let i=0,s=o.length;i<s;i++){let u=o[i];J2(n,u,a)}return a}r.byFingerprintAndResidue=t})(Pn||(Pn={}));function Z2(e,t){let r=new Map,n=0;for(let o=0,a=t.length;o<a;o++){let i=t[o],s=Sr.fingerprint(e,i);r.has(s)?r.get(s).push(n):r.set(s,[n]),n++}return r}function W2(e,t){let{elements:r}=e,n=e.model.atomicHierarchy.residueAtomSegments.index,o=n[r[t[0]]];for(let a=1,i=t.length;a<i;a++)if(o!==n[r[t[a]]])return-1;return o}function J2(e,t,r){let n=e.byFingerprint.get(t);if(n)for(let o=0,a=n.length;o<a;o++){let i=n[o],s=W2(e.unit,e.all[i]);s>=0&&(r.has(s)?r.get(s).push(i):r.set(s,[i]))}}function $2(e,t){let r=[];for(let n=0,o=t.length;n<o;++n)Sr.isAromatic(e,t[n])&&r.push(n);return r}var vt=Uo("C"),Zi=Uo("O"),eS=[Sr.elementFingerprint([vt,vt,vt,Zi]),Sr.elementFingerprint([vt,vt,vt,vt,Zi]),Sr.elementFingerprint([vt,vt,vt,vt,vt,Zi]),Sr.elementFingerprint([vt,vt,vt,vt,vt,vt,Zi])];function tS(e,t){let r=-1,n=-1,o=-1,a=-1,{elements:i}=e,{type_symbol:s,label_atom_id:u}=e.model.atomicHierarchy.atoms,{b:m,offset:c}=e.bonds;for(let l=0,d=t.length;l<d;++l){let y=i[t[l]];if(s.value(y)!==vt)continue;let S=0,x=0;for(let g=c[t[l]],h=c[t[l]+1];g<h;++g){let f=i[m[g]],C=s.value(f);C===Zi?++S:C===vt&&++x}if(S===2){r=y;break}else S===1&&x===1?n=y:u.value(y).startsWith("C1")?o=y:a=y}return r!==-1?r:n!==-1?n:o!==-1?o:a!==-1?a:i[t[0]]}function rS(e,t){let{elements:r}=e,{label_alt_id:n}=e.model.atomicHierarchy.atoms;return n.value(r[t])}function nS(e,t,r,n){let{position:o}=t.conformation;return p.normalize(e,p.sub(e,n,o(r,e))),e}function vf(e,t){let{elements:r}=e,{label_atom_id:n}=e.model.atomicHierarchy.atoms;return n.value(r[t])}function oS(e,t){if(!t||!t.length)return;let{unit:r,all:n}=e,o=new Set,a=Oc(ro(new Array(t.length)),2);for(let i=0,s=a.length;i<s;++i){let u=a[i],m=n[t[u[0]]],c=n[t[u[1]]];ee.areIntersecting(m,c)&&Sr.getAltId(r,m)===Sr.getAltId(r,c)&&(o.add(t[u[0]]),o.add(t[u[1]]))}if(o.size){let i=[];for(let s=0,u=t.length;s<u;++s)o.has(t[s])||i.push(t[s]);return i}else return t}function iS(e,t){return t.properties.saccharideComponentMap.get(e)}function Df(e){if(e.models.reduce((d,y)=>d+y.properties.saccharideComponentMap.size,0)===0)return xf;let t=[],r=[],n=[],o=[],a=new Map;function i(d,y,S){return`${d}|${y}|${S}`}function s(d,y){a.has(d)?a.get(d).push(y):a.set(d,[y])}function u(d,y){p.sub(n[d].geometry.direction,n[y].geometry.center,n[d].geometry.center),p.normalize(n[d].geometry.direction,n[d].geometry.direction)}let m=p();function c(d,y,S){let x=S.conformation.position,g=n[d].geometry;p.sub(g.direction,x(S.elements[y],m),g.center),p.normalize(g.direction,g.direction)}for(let d=0,y=e.units.length;d<y;++d){let S=e.units[d];if(!O.isAtomic(S))continue;let{model:x,rings:g}=S,{chainAtomSegments:h,residueAtomSegments:f,atoms:C}=x.atomicHierarchy,{label_comp_id:T}=C,I=Ue.transientSegments(h,S.elements),P=Ue.transientSegments(f,S.elements),A;for(;I.hasNext;)for(P.setSegment(I.move());P.hasNext;){let{index:b}=P.move(),_=iS(T.value(f.offsets[b]),x);if(!_)continue;A||(A=Pn.byFingerprintAndResidue(g,eS));let v=oS(g,A.get(b));if(!v||!v.length){o.push({unit:S,residueIndex:b,component:_});continue}let R=[];for(let B=0,L=v.length;B<L;++B){let G=g.all[v[B]],K=tS(S,G),X=mr.calculateMomentsAxes(Ya(S,G)),j=mr.calculateNormalizedAxes(X),$=p.copy(p(),j.origin),Z=p.copy(p(),j.dirC),te=nS(p(),S,K,$);p.orthogonalize(te,Z,te);let W=Sr.getAltId(S,G),Y=n.length;R.push(Y),s(i(b,S.id,W),Y),W&&s(i(b,S.id,""),Y),n.push({geometry:{center:$,normal:Z,direction:te},component:_,ringIndex:v[B],altId:W,unit:S,residueIndex:b})}let E=Oc(ro(new Array(v.length)),2);for(let B=0,L=E.length;B<L;++B){let G=E[B],K=g.all[v[G[0]]],X=g.all[v[G[1]]];if(qt.areVertexSetsConnected(S.bonds,K,X,3)){let j=R[G[0]],$=R[G[1]];n[j].altId===n[$].altId&&(u(j,$),u($,j),t.push({carbohydrateIndexA:j,carbohydrateIndexB:$}),t.push({carbohydrateIndexA:$,carbohydrateIndexB:j}))}}}}function l(d,y){return a.get(i(d.getResidueIndex(y),d.id,rS(d,y)))||[]}for(let d=0,y=n.length;d<y;++d){let S=n[d],{unit:x}=S;for(let g=d+1;g<y;++g){let h=n[g];if(x!==h.unit||S.residueIndex===h.residueIndex)continue;let f=x.rings.all[S.ringIndex],C=x.rings.all[h.ringIndex];qt.areVertexSetsConnected(x.bonds,f,C,3)&&(u(d,g),u(g,d),t.push({carbohydrateIndexA:d,carbohydrateIndexB:g}),t.push({carbohydrateIndexA:g,carbohydrateIndexB:d}))}}for(let d=0,y=e.units.length;d<y;++d){let S=e.units[d];O.isAtomic(S)&&e.interUnitBonds.getConnectedUnits(S.id).forEach(x=>{x.connectedIndices.forEach(g=>{x.getEdges(g).forEach(({props:h,indexB:f})=>{if(!_e.isCovalent(h.flag))return;let C=e.unitMap.get(x.unitA),T=e.unitMap.get(x.unitB),I=l(C,g),P=l(T,f);if(I.length>0&&P.length>0){let A=I.length,b=P.length;for(let _=0,v=Math.max(A,b);_<v;++_){let R=I[Math.min(_,A-1)],E=P[Math.min(_,b-1)],B=vf(C,g);(B.startsWith("O1")||B.startsWith("C1"))&&u(R,E),t.push({carbohydrateIndexA:R,carbohydrateIndexB:E})}}else if(P.length===0)for(let A of I){let b=vf(C,g);(b.startsWith("O1")||b.startsWith("C1"))&&c(A,f,T),r.push({carbohydrateIndex:A,elementIndex:f,elementUnit:T,fromCarbohydrate:!0})}else if(I.length===0)for(let A of P)r.push({carbohydrateIndex:A,elementIndex:g,elementUnit:C,fromCarbohydrate:!1})})})})}return{links:t,terminalLinks:r,elements:n,partialElements:o,...aS(n,t,r)}}function aS(e,t,r){function n(l,d){return Wt(l.id,d)}function o(l,d,y){let S=[],x=l.get(n(d,y));if(x!==void 0)for(let g of x)Wa(S,g);return S}let a=new Map;for(let l=0,d=e.length;l<d;++l){let{unit:y,ringIndex:S}=e[l],x=y.rings.all[S];for(let g=0,h=x.length;g<h;++g){let f=n(y,y.elements[x[g]]),C=a.get(f);C===void 0?a.set(f,[l]):C.push(l)}}function i(l,d){return o(a,l,d)}let s=new Map;for(let l=0,d=t.length;l<d;++l){let y=t[l],{unit:S,ringIndex:x}=e[y.carbohydrateIndexA],g=S.rings.all[x];for(let h=0,f=g.length;h<f;++h){let C=n(S,S.elements[g[h]]),T=s.get(C);T===void 0?s.set(C,[l]):T.push(l)}}function u(l,d){return o(s,l,d)}let m=new Map;for(let l=0,d=r.length;l<d;++l){let{fromCarbohydrate:y,carbohydrateIndex:S,elementUnit:x,elementIndex:g}=r[l];if(y){let{unit:h,ringIndex:f}=e[S],C=h.rings.all[f];for(let T=0,I=C.length;T<I;++T){let P=n(h,h.elements[C[T]]),A=m.get(P);A===void 0?m.set(P,[l]):A.push(l)}}else{let h=n(x,x.elements[g]),f=m.get(h);f===void 0?m.set(h,[l]):f.push(l)}}function c(l,d){return o(m,l,d)}return{getElementIndices:i,getLinkIndices:u,getTerminalLinkIndices:c}}var pi;(r=>{function e(n){let o=n.descriptor.name,a=n.type==="root"?"inheritedPropertyData":"currentPropertyData",i=u=>(o in u[a]||(u[a][o]={props:{...k.getDefaultValues(n.getParams(u))},data:Yr.create(void 0)}),u[a][o]),s=(u,m,c)=>{let l=i(u);u[a][o]={props:m,data:Yr.withValue(l.data,c)}};return{descriptor:n.descriptor,isHidden:n.isHidden,getParams:u=>{let m=k.clone(n.getParams(u));return k.setDefaultValues(m,i(u).props),m},defaultParams:n.defaultParams,isApplicable:n.isApplicable,attach:(u,m={},c)=>{c&&u.customPropertyDescriptors.reference(n.descriptor,!0),n.type==="root"&&(u=u.root);let l=i(u.root).props,d=i(u),y=k.merge(n.defaultParams,l,m);if(d.data.value&&k.areEqual(n.defaultParams,d.props,y))return;let{value:S}=n.obtain(u,y);u.customPropertyDescriptors.add(n.descriptor),s(u,y,S)},ref:(u,m)=>u.customPropertyDescriptors.reference(n.descriptor,m),get:u=>i(u).data,set:(u,m={},c)=>{n.type==="root"&&(u=u.root);let l=i(u),d=k.merge(n.defaultParams,l.props,m);k.areEqual(n.defaultParams,l.props,d)||s(u,d,c)},props:u=>i(u).props}}r.createProvider=e;function t(n,o,a){let i={value:k.Value(a,{isHidden:!0})};return e({descriptor:{name:n},isHidden:!0,type:o,defaultParams:i,getParams:()=>({value:k.Value(a,{isHidden:!0})}),isApplicable:()=>!0,obtain:(s,u)=>({...k.getDefaultValues(i),...u})})}r.createSimple=t})(pi||(pi={}));var Vr=class{constructor(t){this.minDist=[];this.maxDist=[];this.extrema=[];this.centroidHelper=new An;this.dir=sS(t),this.reset()}computeExtrema(t,r){let n=p.dot(this.dir[t],r);n<this.minDist[t]&&(this.minDist[t]=n,p.copy(this.extrema[t*2],r)),n>this.maxDist[t]&&(this.maxDist[t]=n,p.copy(this.extrema[t*2+1],r))}computeSphereExtrema(t,r,n){let o=p.dot(this.dir[t],r);o-n<this.minDist[t]&&(this.minDist[t]=o-n,p.scaleAndSub(this.extrema[t*2],r,this.dir[t],n)),o+n>this.maxDist[t]&&(this.maxDist[t]=o+n,p.scaleAndAdd(this.extrema[t*2+1],r,this.dir[t],n))}includeSphere(t){if(Se.hasExtrema(t)&&t.extrema.length>1)for(let r of t.extrema)this.includePosition(r);else this.includePositionRadius(t.center,t.radius)}includePosition(t){for(let r=0,n=this.dir.length;r<n;++r)this.computeExtrema(r,t)}includePositionRadius(t,r){for(let n=0,o=this.dir.length;n<o;++n)this.computeSphereExtrema(n,t,r)}finishedIncludeStep(){for(let t=0;t<this.extrema.length;t++)this.centroidHelper.includeStep(this.extrema[t]);this.centroidHelper.finishedIncludeStep()}radiusSphere(t){if(Se.hasExtrema(t)&&t.extrema.length>1)for(let r of t.extrema)this.radiusPosition(r);else this.radiusPositionRadius(t.center,t.radius)}radiusPosition(t){this.centroidHelper.radiusStep(t)}radiusPositionRadius(t,r){this.centroidHelper.radiusSphereStep(t,r)}getSphere(t){return Se.setExtrema(this.centroidHelper.getSphere(t),[...this.extrema])}getBox(t){return Xe.fromVec3Array(t||Xe(),this.extrema)}reset(){for(let t=0,r=this.dir.length;t<r;++t)this.minDist[t]=1/0,this.maxDist[t]=-1/0,this.extrema[t*2]=p(),this.extrema[t*2+1]=p();this.centroidHelper.reset()}};function sS(e){let t;switch(e){case"6":t=[...xs];break;case"14":t=[...xs,...Hc];break;case"26":t=[...xs,...Hc,...Mf];break;case"98":t=[...xs,...Hc,...Mf,...uS,...cS,...mS];break}return t.map(r=>{let n=p.create(r[0],r[1],r[2]);return p.normalize(n,n)})}var xs=[[1,0,0],[0,1,0],[0,0,1]],Hc=[[1,1,1],[-1,1,1],[-1,-1,1],[1,-1,1]],Mf=[[1,1,0],[1,-1,0],[1,0,1],[1,0,-1],[0,1,1],[0,1,-1]],uS=[[0,1,2],[0,2,1],[1,0,2],[2,0,1],[1,2,0],[2,1,0],[0,1,-2],[0,2,-1],[1,0,-2],[2,0,-1],[1,-2,0],[2,-1,0]],cS=[[1,1,2],[2,1,1],[1,2,1],[1,-1,2],[1,1,-2],[1,-1,-2],[2,-1,1],[2,1,-1],[2,-1,-1],[1,-2,1],[1,2,-1],[1,-2,-1]],mS=[[2,2,1],[1,2,2],[2,1,2],[2,-2,1],[2,2,-1],[2,-2,-1],[1,-2,2],[1,2,-2],[1,-2,-2],[2,-1,2],[2,1,-2],[2,-1,-2]];var gs=Se(),lS=new Vr("14"),dS=new Vr("98");function pS(e){return e>500?lS:dS}function Ef(e){let{units:t}=e,r=pS(t.length);r.reset();for(let n=0,o=t.length;n<o;n++){let a=t[n],i=a.boundary,s=a.conformation.operator;s.isIdentity?r.includeSphere(i.sphere):(Se.transform(gs,i.sphere,s.matrix),r.includeSphere(gs))}r.finishedIncludeStep();for(let n=0,o=t.length;n<o;n++){let a=t[n],i=a.boundary,s=a.conformation.operator;s.isIdentity?r.radiusSphere(i.sphere):(Se.transform(gs,i.sphere,s.matrix),r.radiusSphere(gs))}return{box:r.getBox(),sphere:r.getSphere()}}var Ce=class{constructor(t,r,n,o,a){this.units=t;this.unitMap=r;this.unitIndexMap=n;this.state=o;this._child=a==null?void 0:a.child,this._target=a==null?void 0:a.target}subsetBuilder(t){return new hs(this,t)}get elementCount(){return this.state.elementCount}get bondCount(){return this.state.bondCount===-1&&(this.state.bondCount=this.interUnitBonds.edgeCount+Qe.getIntraUnitBondCount(this)),this.state.bondCount}get hasCustomProperties(){return!!this.state.customProps&&this.state.customProps.all.length>0}get customPropertyDescriptors(){return this.state.customProps||(this.state.customProps=new Bo),this.state.customProps}get currentPropertyData(){return this.state.propertyData||(this.state.propertyData=Object.create(null)),this.state.propertyData}get inheritedPropertyData(){return this.parent?this.parent.currentPropertyData:this.currentPropertyData}get polymerResidueCount(){return this.state.polymerResidueCount===-1&&(this.state.polymerResidueCount=xS(this)),this.state.polymerResidueCount}get polymerGapCount(){return this.state.polymerGapCount===-1&&(this.state.polymerGapCount=gS(this)),this.state.polymerGapCount}get polymerUnitCount(){return this.state.polymerUnitCount===-1&&(this.state.polymerUnitCount=bS(this)),this.state.polymerUnitCount}get uniqueElementCount(){return this.state.uniqueElementCount===-1&&(this.state.uniqueElementCount=hS(this)),this.state.uniqueElementCount}get atomicResidueCount(){return this.state.atomicResidueCount===-1&&(this.state.atomicResidueCount=SS(this)),this.state.atomicResidueCount}get isCoarseGrained(){return this.models.some(t=>lt.isCoarseGrained(t))}get isEmpty(){return this.units.length===0}get hashCode(){return this.state.hashCode!==-1?this.state.hashCode:this.computeHash()}get transformHash(){return this.state.transformHash!==-1?this.state.transformHash:(this.state.transformHash=hr(this.units.map(t=>t.id)),this.state.transformHash)}computeHash(){let t=23;for(let r=0,n=this.units.length;r<n;r++){let o=this.units[r];t=31*t+o.id|0,t=31*t+ee.hashCode(o.elements)|0}return t=31*t+this.elementCount|0,t=El(t),t===-1&&(t=0),this.state.hashCode=t,t}get root(){var t;return(t=this.state.parent)!=null?t:this}get parent(){return this.state.parent}get boundary(){return this.state.boundary?this.state.boundary:(this.state.boundary=Ef(this),this.state.boundary)}get lookup3d(){return this.state.lookup3d?this.state.lookup3d:(this.state.lookup3d=new cs(this),this.state.lookup3d)}get interUnitBonds(){return this.state.interUnitBonds?this.state.interUnitBonds:(this.parent&&this.state.dynamicBonds===this.parent.state.dynamicBonds&&this.parent.state.interUnitBonds&&this.parent.state.interUnitBonds.edgeCount===0?this.state.interUnitBonds=new Jr(new Map):this.state.interUnitBonds=Bf(this,{ignoreWater:!this.dynamicBonds,ignoreIon:!this.dynamicBonds,validUnit:this.state.interBondsValidUnit,validUnitPair:this.state.interBondsValidUnitPair}),this.state.interUnitBonds)}get dynamicBonds(){return this.state.dynamicBonds}get interBondsValidUnit(){return this.state.interBondsValidUnit}get interBondsValidUnitPair(){return this.state.interBondsValidUnitPair}get unitSymmetryGroups(){return this.state.unitSymmetryGroups?this.state.unitSymmetryGroups:(this.state.unitSymmetryGroups=br.computeTransformGroups(this),this.state.unitSymmetryGroups)}get unitSymmetryGroupsIndexMap(){return this.state.unitSymmetryGroupsIndexMap?this.state.unitSymmetryGroupsIndexMap:(this.state.unitSymmetryGroupsIndexMap=O.SymmetryGroup.getUnitSymmetryGroupsIndexMap(this.unitSymmetryGroups),this.state.unitSymmetryGroupsIndexMap)}get carbohydrates(){return this.state.carbohydrates?this.state.carbohydrates:(this.state.carbohydrates=Df(this),this.state.carbohydrates)}get models(){return this.state.models?this.state.models:(this.state.models=yS(this),this.state.models)}get isAtomic(){for(let t of this.units)if(!O.isAtomic(t))return!1;return!0}get hasAtomic(){for(let t of this.units)if(O.isAtomic(t))return!0;return!1}get isCoarse(){for(let t of this.units)if(!O.isCoarse(t))return!1;return!0}get hasCoarse(){for(let t of this.units)if(O.isCoarse(t))return!0;return!1}get serialMapping(){return this.state.serialMapping||(this.state.serialMapping=CS(this))}get model(){if(this.state.model)return this.state.model;if(this.state.masterModel)return this.state.masterModel;let t=this.models;return this.state.model=t[0],this.state.model}get masterModel(){return this.state.masterModel}hasElement(t){return this.unitMap.has(t.unit.id)?ee.has(this.unitMap.get(t.unit.id).elements,t.element):!1}get child(){return this._child}get target(){var t;return(t=this._target)!=null?t:this}};function fS(e,t,r){return e[t].id-e[r].id}function yS(e){let{units:t}=e,r=_t.create();for(let n of t)_t.add(r,n.model.id,n.model);return r.array}function hS(e){let{unitSymmetryGroups:t}=e,r=0;for(let n=0,o=t.length;n<o;n++)r+=t[n].elements.length;return r}function xS(e){let{units:t}=e,r=0;for(let n=0,o=t.length;n<o;n++)r+=t[n].polymerElements.length;return r}function gS(e){let{units:t}=e,r=0;for(let n=0,o=t.length;n<o;n++)r+=t[n].gapElements.length/2;return r}function bS(e){let{units:t}=e,r=0;for(let n=0,o=t.length;n<o;n++)t[n].polymerElements.length>0&&(r+=1);return r}function SS(e){let{units:t}=e,r=0;for(let n=0,o=t.length;n<o;n++){let a=t[n];if(!O.isAtomic(a))continue;let{elements:i,residueIndex:s}=a,u=-1,m=-1;for(let c=0,l=i.length;c<l;++c)u=s[i[c]],u!==m&&(r+=1,m=u)}return r}function CS(e){let{units:t,elementCount:r,unitIndexMap:n}=e,o=new Uint32Array(t.length),a=new Uint32Array(r),i=new Uint32Array(r);for(let s=0,u=0,m=t.length;s<m;++s){o[s]=u;let{elements:c}=t[s];for(let l=0,d=c.length;l<d;++l){let y=u+l;a[y]=s,i[y]=c[l]}u+=c.length}return{cumulativeUnitElementCount:o,unitIndices:a,elementIndices:i,getSerialIndex:(s,u)=>o[n.get(s.id)]+Ae.indexOf(s.elements,u)}}(A=>{A.Empty=r([]);function t(b){return!!b&&b.kind==="structure-loci"}A.isLoci=t;function r(b,_={}){let v=cr.Mutable(),R=cr.Mutable(),E=0,B=!0,L=b.length>0?b[0].id:0;for(let K=0,X=b.length;K<X;K++){let j=b[K];v.set(j.id,j),E+=j.elements.length,j.id<L&&(B=!1),L=j.id}B||xa(b,0,b.length,fS,pn);for(let K=0,X=b.length;K<X;K++)R.set(b[K].id,K);let G={hashCode:-1,transformHash:-1,elementCount:E,bondCount:-1,uniqueElementCount:-1,atomicResidueCount:-1,polymerResidueCount:-1,polymerGapCount:-1,polymerUnitCount:-1,dynamicBonds:!1};return _.parent&&(G.parent=_.parent.parent||_.parent),_.interUnitBonds&&(G.interUnitBonds=_.interUnitBonds),_.interBondsValidUnit?G.interBondsValidUnit=_.interBondsValidUnit:_.parent&&(G.interBondsValidUnit=_.parent.interBondsValidUnit),_.interBondsValidUnitPair?G.interBondsValidUnitPair=_.interBondsValidUnitPair:_.parent&&(G.interBondsValidUnitPair=_.parent.interBondsValidUnitPair),_.dynamicBonds?G.dynamicBonds=_.dynamicBonds:_.parent&&(G.dynamicBonds=_.parent.dynamicBonds),_.masterModel?G.masterModel=_.masterModel:_.parent&&(G.masterModel=_.parent.masterModel),new A(b,v,R,G)}A.create=r;function n(b,_={}){let v=b.atomicHierarchy.chainAtomSegments,{index:R}=b.atomicHierarchy,{auth_asym_id:E}=b.atomicHierarchy.chains,{atomicChainOperatorMappinng:B}=b,L=new i({..._});for(let K=0;K<v.count;K++){let X=B.get(K)||Tt.Default,j=v.offsets[K],$=!1;if(o(b,K))for(;K+1<v.count&&o(b,K+1);){let te=B.get(K),W=B.get(K+1);if(te!==W)break;$=!0,K++}else for(;K+1<v.count&&v.offsets[K+1]-v.offsets[K]===1&&v.offsets[K+2]-v.offsets[K+1]===1;){let te=R.getEntityFromChain(K),W=R.getEntityFromChain(K+1);if(te!==W)break;let Y=E.value(K),ie=E.value(K+1);if(Y!==ie)break;let D=B.get(K),F=B.get(K+1);if(D!==F)break;$=!0,K++}let Z=ee.ofBounds(j,v.offsets[K+1]);L.addUnit(O.Kind.Atomic,b,X,Z,$?O.Trait.MultiChain:O.Trait.None)}let G=b.coarseHierarchy;return G.isDefined&&(G.spheres.count>0&&a(L,b,b.coarseHierarchy.spheres,O.Kind.Spheres),G.gaussians.count>0&&a(L,b,b.coarseHierarchy.gaussians,O.Kind.Gaussians)),L.getStructure()}A.ofModel=n;function o(b,_){let v=b.atomicHierarchy.index.getEntityFromChain(_);return b.entities.data.type.value(v)==="water"}function a(b,_,v,R){let{chainElementSegments:E}=v;for(let B=0;B<E.count;B++){let L=ee.ofBounds(E.offsets[B],E.offsets[B+1]);b.addUnit(R,_,Tt.Default,L,O.Trait.None)}}class i{constructor(_={}){this.props=_;this.units=[];this.invariantId=gn();this.chainGroupId=-1;this.inChainGroup=!1;this.p=p();this.singleElementUnits=new Map}beginChainGroup(){this.chainGroupId++,this.inChainGroup=!0}endChainGroup(){this.inChainGroup=!1}addUnit(_,v,R,E,B,L){L===void 0&&(L=this.invariantId());let G=this.inChainGroup?this.chainGroupId:++this.chainGroupId,K=O.create(this.units.length,L,G,B,_,v,R,E);return this.add(K)}add(_){if(_.elements.length===1){_.conformation.position(_.elements[0],this.p);let v=[_.invariantId,this.p[0],this.p[1],this.p[2]].join("|");if(this.singleElementUnits.has(v))return this.singleElementUnits.get(v);this.singleElementUnits.set(v,_)}return this.units.push(_),_}addWithOperator(_,v,R=!1){return this.add(_.applyOperator(this.units.length,v,R))}getStructure(){return r(this.units,this.props)}get isEmpty(){return this.units.length===0}}A.StructureBuilder=i;function s(b={}){return new i(b)}A.Builder=s;function u(b){return b.hashCode}A.hashCode=u;function m(b,_){if(b===_)return!0;if(b.elementCount!==_.elementCount)return!1;let v=b.units.length;if(v!==_.units.length)return!1;for(let R=0;R<v;R++)if(b.units[R].id!==_.units[R].id)return!1;return!0}function c(b,_){if(!m(b,_))return!1;for(let v=0,R=b.units.length;v<R;v++)if(!ee.areEqual(b.units[v].elements,_.units[v].elements))return!1;return!0}A.areUnitIdsAndIndicesEqual=c;function l(b,_){if(b.hashCode!==_.hashCode)return!1;let v=b.models.length;if(v!==_.models.length)return!1;for(let R=0;R<v;R++)if(!lt.areHierarchiesEqual(b.models[R],_.models[R]))return!1;return!0}A.areHierarchiesEqual=l;function d(b,_){return b===_||b.hashCode===_.hashCode&&br.areTransformGroupsEquivalent(b.unitSymmetryGroups,_.unitSymmetryGroups)}A.areEquivalent=d;function y(b,_){return d(b.root,_.root)}A.areRootsEquivalent=y;function S(b,_,v){return b.masterModel?_.model===v.model||_.model===b.masterModel||v.model===b.masterModel:_.model===v.model}A.validUnitPair=S;function x(b,_,v){let{maxRadius:R,validUnit:E,validUnitPair:B}=v;if(!b.units.some(j=>E(j)))return;let L=b.lookup3d,G=p(),K=Xe(),X=p.create(R,R,R);for(let j of b.units){if(!E(j))continue;let $=j.boundary.sphere;Xe.expand(K,j.boundary.box,X),p.transformMat4(G,$.center,j.conformation.operator.matrix);let Z=L.findUnitIndices(G[0],G[1],G[2],$.radius+R);for(let te=0;te<Z.count;te++){let W=b.units[Z.indices[te]];Xe.overlaps(K,W.boundary.box)&&(!E(W)||j.id>=W.id||!B(j,W)||(W.elements.length>=j.elements.length?_(j,W):_(W,j)))}}}A.eachUnitPair=x,A.DefaultSizeThresholds={smallResidueCount:10,mediumResidueCount:5e3,largeResidueCount:3e4,highSymmetryUnitCount:10,fiberResidueCount:15};function h(b){return b.unitSymmetryGroups.filter(_=>_.units[0].polymerElements.length>0)}function f(b,_){let v=h(b);return v.length===1&&v[0].units.length>2&&v[0].units[0].polymerElements.length<_.fiberResidueCount}function C(b,_){let v=h(b);return v.length>=1&&v[0].units.length>_.highSymmetryUnitCount}let T;(B=>(B[B.Small=0]="Small",B[B.Medium=1]="Medium",B[B.Large=2]="Large",B[B.Huge=3]="Huge",B[B.Gigantic=4]="Gigantic"))(T=A.Size||(A.Size={}));function I(b,_={},v=1){let R={...A.DefaultSizeThresholds,..._};return b.polymerResidueCount>=R.largeResidueCount*v?C(b,R)?3:4:f(b,R)||b.polymerResidueCount<R.smallResidueCount*v?0:b.polymerResidueCount<R.mediumResidueCount*v?1:2}A.getSize=I,A.Index=pi.createSimple("index","root")})(Ce||(Ce={}));var _S=p.distance,AS=p.set,IS=p.squaredDistance,PS=p.transformMat4,Rf=p(),Ff=p();function Uf(e,t,r,n){return e.conformation.position(t,Rf),r.conformation.position(n,Ff),_S(Rf,Ff)}var TS=re(),Oo=p();function vS(e,t,r,n){let{maxRadius:o}=r,{elements:a,residueIndex:i}=e,{x:s,y:u,z:m}=e.model.atomicConformation,{elements:c,residueIndex:l}=t,d=e.elements.length,{type_symbol:y,label_alt_id:S,label_atom_id:x,label_comp_id:g}=e.model.atomicHierarchy.atoms,{type_symbol:h,label_alt_id:f,label_atom_id:C,label_comp_id:T}=t.model.atomicHierarchy.atoms,{auth_seq_id:I}=e.model.atomicHierarchy.residues,{auth_seq_id:P}=t.model.atomicHierarchy.residues,{occupancy:A}=e.model.atomicConformation,{occupancy:b}=t.model.atomicConformation,_=A.isDefined&&b.isDefined,v=e.model===t.model&&er.Provider.get(e.model),R=!r.forceCompute&&e.model===t.model&&In.Provider.get(e.model),{atomSourceIndex:E}=e.model.atomicHierarchy,{invertedIndex:B}=R?lt.getInvertedAtomSourceIndex(t.model):{invertedIndex:void 0},L=e.model===t.model&&er.isExhaustive(e.model),G=re.mul(TS,t.conformation.operator.inverse,e.conformation.operator.matrix),K=!re.isIdentity(G),{center:X,radius:j}=t.boundary.sphere,$=(j+o)*(j+o);n.startUnitPair(e.id,t.id);for(let Z=0;Z<d;Z++){let te=a[Z];if(AS(Oo,s[te],u[te],m[te]),K&&PS(Oo,Oo,G),IS(Oo,X)>$)continue;if(!r.forceCompute&&R){let{maxDistance:me}=R,{offset:fe,b:pe,edgeProps:{order:Te,distance:be,flag:Re,key:Ne}}=R.bonds,Je=E.value(te),tt=gr(y.value(te));for(let Le=fe[Je],Ge=fe[Je+1];Le<Ge;++Le){let Fe=B[pe[Le]],U=ee.indexOf(t.elements,Fe);if(U<0)continue;let w=gr(y.value(Fe)),q=be[Le],ae=Uf(e,te,t,Fe),Me=!1;if(q>=0)Me=Bt(ae,q,.3);else if(me>=0)Me=ae<me;else{let Ee=di(tt,w,$r(tt),$r(w));Me=ae<Ee,en(tt)&&en(w)&&(Me=!1)}Me&&n.add(Z,U,{order:Te[Le],flag:Re[Le],key:Ne[Le]})}continue}let W=r.forceCompute?void 0:v&&v.byAtomIndex.get(te);if(W&&W.length){let me=!1;for(let fe of W){let{partnerA:pe,partnerB:Te}=fe,be=pe.atomIndex===te?Te:pe,Re=ee.indexOf(t.elements,be.atomIndex);Re<0||Uf(e,te,t,be.atomIndex)>o||(n.add(Z,Re,{order:fe.order,flag:fe.flags,key:fe.rowIndex}),me=!0)}if(me)continue}if(L)continue;let Y=A.value(te),{lookup3d:ie}=t,{indices:D,count:F,squaredDistances:N}=ie.find(Oo[0],Oo[1],Oo[2],o);if(F===0)continue;let oe=gr(y.value(te)),se=en(oe),ce=$r(oe),he=S.value(te),ve=no.has(oe),Ie=x.value(te),Pe=g.value(i[te]);for(let me=0;me<F;me++){let fe=D[me],pe=c[fe],Te=f.value(pe);if(he&&Te&&he!==Te||_&&b.value(pe)<1&&Y<1&&I.value(te)===P.value(pe))continue;let be=gr(h.value(pe)),Re=en(be);if(se&&Re)continue;let Ne=(ve||no.has(be))&&!(se||Re),Je=Math.sqrt(N[me]);if(Je===0)continue;let tt=di(oe,be,ce,$r(be));if(Je<=tt){let Le=C.value(pe),Ge=T.value(l[pe]);n.add(Z,fe,{order:es(Pe,Ge,Ie,Le),flag:(Ne?_e.Flag.MetallicCoordination:_e.Flag.Covalent)|_e.Flag.Computed,key:-1})}}}n.finishUnitPair()}var DS={...ss,ignoreWater:!0,ignoreIon:!0};function MS(e,t){let r=new Wr.Builder,n=e.models.some(a=>In.Provider.get(a)),o=e.models.some(a=>er.isExhaustive(a));return t.noCompute||e.isCoarseGrained&&!n&&!o?new Jr(r.getMap()):(Ce.eachUnitPair(e,(a,i)=>{vS(a,i,t,r)},{maxRadius:t.maxRadius,validUnit:a=>t.validUnit(a),validUnitPair:(a,i)=>t.validUnitPair(e,a,i)}),new Jr(r.getMap()))}function Bf(e,t){let r={...DS,...t};return MS(e,{...r,validUnit:t&&t.validUnit||(n=>O.isAtomic(n)),validUnitPair:t&&t.validUnitPair||((n,o,a)=>{let i=o.model.atomicHierarchy.derived.residue.moleculeType,s=a.model.atomicHierarchy.derived.residue.moleculeType,u=(!O.isAtomic(o)||i[o.residueIndex[o.elements[0]]]!==2)&&(!O.isAtomic(a)||s[a.residueIndex[a.elements[0]]]!==2),m=(!O.isAtomic(o)||i[o.residueIndex[o.elements[0]]]!==3)&&(!O.isAtomic(a)||s[a.residueIndex[a.elements[0]]]!==3);return Ce.validUnitPair(n,o,a)&&(u||!r.ignoreWater)&&(m||!r.ignoreIon)})})}var Qe;(u=>{function e(m,c,l,d,y,S){return{kind:"bond-location",aStructure:m,aUnit:c,aIndex:l,bStructure:d,bUnit:y,bIndex:S}}u.Location=e;function t(m){return!!m&&m.kind==="bond-location"}u.isLocation=t;function r(m,c){return{kind:"bond-loci",structure:m,bonds:c}}u.Loci=r;function n(m){return!!m&&m.kind==="bond-loci"}u.isLoci=n;function o(m,c){if(c===m.structure)return m;let l=[];return m.bonds.forEach(d=>{let y=c.unitMap.get(d.aUnit.id);if(!y)return;let S=c.unitMap.get(d.bUnit.id);if(!S)return;let x=d.aUnit.elements[d.aIndex],g=ee.indexOf(y.elements,x);if(g===-1)return;let h=d.bUnit.elements[d.bIndex],f=ee.indexOf(S.elements,h);f!==-1&&l.push(e(m.structure,y,g,m.structure,S,f))}),r(c,l)}u.remapLoci=o;function a(m){let c=0;for(let l=0,d=m.units.length;l<d;++l){let y=m.units[l];O.isAtomic(y)&&(c+=y.bonds.edgeCount)}return c}u.getIntraUnitBondCount=a;class i{constructor(){this.current={};this.hasNext=!1}move(){return this.advance(),this.current}setElement(c,l,d){this.structure=c,this.unit=l,this.index=d,this.interBondIndices=c.interUnitBonds.getEdgeIndices(d,l.id),this.interBondCount=this.interBondIndices.length,this.interBondIndex=0,this.intraBondEnd=l.bonds.offset[d+1],this.intraBondIndex=l.bonds.offset[d],this.hasNext=this.interBondIndex<this.interBondCount||this.intraBondIndex<this.intraBondEnd}advance(){if(this.intraBondIndex<this.intraBondEnd)this.current.otherUnit=this.unit,this.current.otherIndex=this.unit.bonds.b[this.intraBondIndex],this.current.type=this.unit.bonds.edgeProps.flags[this.intraBondIndex],this.current.order=this.unit.bonds.edgeProps.order[this.intraBondIndex],this.intraBondIndex+=1;else if(this.interBondIndex<this.interBondCount){let c=this.structure.interUnitBonds.edges[this.interBondIndex];this.current.otherUnit=this.structure.unitMap.get(c.unitA!==this.unit.id?c.unitA:c.unitB),this.current.otherIndex=c.indexA!==this.index?c.indexA:c.indexB,this.current.type=c.props.flag,this.current.order=c.props.order,this.interBondIndex+=1}else{this.hasNext=!1;return}this.hasNext=this.interBondIndex<this.interBondCount||this.intraBondIndex<this.intraBondEnd}}u.ElementBondIterator=i;function s(m,c){return An.fromPairProvider(m.bonds.length,(l,d,y)=>{let{aUnit:S,aIndex:x,bUnit:g,bIndex:h}=m.bonds[l];S.conformation.position(S.elements[x],d),g.conformation.position(g.elements[h],y)},c)}u.getBoundingSphere=s})(Qe||(Qe={}));function Lf(e){let t=[],{elements:r,model:n}=e,{residueAtomSegments:o}=e.model.atomicHierarchy,{traceElementIndex:a}=n.atomicHierarchy.derived.residue,i=ct.transientSegments(e.model.atomicRanges.polymerRanges,r),s=Ue.transientSegments(o,r);for(;i.hasNext;){let u=i.move();for(s.setSegment(u);s.hasNext;){let m=s.move(),{start:c,end:l,index:d}=m;if(Ae.areIntersecting(z.ofRange(r[c],r[l-1]),r)){let y=a[d];t.push(y===-1?o.offsets[d]:y)}}}return ee.ofSortedArray(t)}function Vf(e){let t=[],{elements:r,model:n}=e,{spheres:o,gaussians:a}=n.coarseHierarchy,i=O.isSpheres(e)?o.polymerRanges:a.polymerRanges,s=ct.transientSegments(i,r);for(;s.hasNext;){let{start:u,end:m}=s.move();for(let c=u;c<m;++c)t.push(r[c])}return ee.ofSortedArray(t)}function kf(e){let t=[],{elements:r,model:n,residueIndex:o}=e,{residueAtomSegments:a}=e.model.atomicHierarchy,{traceElementIndex:i}=n.atomicHierarchy.derived.residue,s=ct.transientSegments(e.model.atomicRanges.gapRanges,e.elements);for(;s.hasNext;){let u=s.move(),m=o[r[u.start]],c=o[r[u.end-1]],l=i[m],d=i[c];t.push(l===-1?a.offsets[m]:l),t.push(d===-1?a.offsets[c]:d)}return ee.ofSortedArray(t)}function Gf(e){let t=[],{elements:r,model:n}=e,{spheres:o,gaussians:a}=n.coarseHierarchy,i=O.isSpheres(e)?o.gapRanges:a.gapRanges,s=ct.transientSegments(i,r);for(;s.hasNext;){let{start:u,end:m}=s.move();t.push(r[u],r[m-1])}return ee.ofSortedArray(t)}function wf(e){let t=[],{elements:r,model:n}=e,{chainAtomSegments:o,residueAtomSegments:a}=n.atomicHierarchy,{moleculeType:i,traceElementIndex:s}=n.atomicHierarchy.derived.residue,u=Ue.transientSegments(o,r),m=Ue.transientSegments(a,r);for(;u.hasNext;)for(m.setSegment(u.move());m.hasNext;){let{index:c}=m.move();if(Lo(i[c])){let l=s[c];t.push(l===-1?a.offsets[c]:l)}}return ee.ofSortedArray(t)}function Nf(e){let t=[],{elements:r,model:n}=e,{chainAtomSegments:o,residueAtomSegments:a}=n.atomicHierarchy,{moleculeType:i,traceElementIndex:s}=n.atomicHierarchy.derived.residue,u=Ue.transientSegments(o,r),m=Ue.transientSegments(a,r);for(;u.hasNext;)for(m.setSegment(u.move());m.hasNext;){let{index:c}=m.move();if(sc(i[c])){let l=s[c];t.push(l===-1?a.offsets[c]:l)}}return ee.ofSortedArray(t)}var Of=p.zero();function ES(e){let t=e.conformation.invariantPosition,{elements:r}=e,n=new Float32Array(r.length*3);for(let o=0,a=r.length;o<a;o++)t(r[o],Of),p.toArray(Of,n,o*3);return n}function qc(e){let t=ES(e);return mr.ofPositions(t)}var Hf=p.set,BS=new Vr("14"),RS=new Vr("98");function FS(e){return e>1e4?BS:RS}var bs=p();function Ho(e){let{x:t,y:r,z:n,radius:o,indices:a}=e,i=Ae.size(a);if(i>25e4){let m=Xe.computeBounding(e);return{box:m,sphere:Se.fromBox3D(Se(),m)}}let s=FS(i);s.reset();for(let m=0;m<i;m++){let c=Ae.getAt(a,m);Hf(bs,t[c],r[c],n[c]),s.includePositionRadius(bs,o&&o[c]||0)}s.finishedIncludeStep();for(let m=0;m<i;m++){let c=Ae.getAt(a,m);Hf(bs,t[c],r[c],n[c]),s.radiusPositionRadius(bs,o&&o[c]||0)}let u=s.getSphere();if(!o&&Se.hasExtrema(u)&&i<=u.extrema.length){let m=[];for(let c=0;c<i;c++){let l=Ae.getAt(a,c);m.push(p.create(t[l],r[l],n[l]))}Se.setExtrema(u,m)}return{box:s.getBox(),sphere:u}}var Ss=class e{constructor(){this.data=new Map}get(t){let r=ee.hashCode(t);if(this.data.has(r)){for(let[n,o]of this.data.get(r))if(ee.areEqual(t,n))return o}}set(t,r){let n=ee.hashCode(t);if(this.data.has(n)){let o=this.data.get(n);for(let a of o)if(ee.areEqual(t,a[0])){a[1]=r;return}o.push([t,r])}else this.data.set(n,[[t,r]])}static get(t){return t._dynamicPropertyData.ElementSetIntraBondCache||(t._dynamicPropertyData.ElementSetIntraBondCache=new e),t._dynamicPropertyData.ElementSetIntraBondCache}};function qf(e){return{delocalizedTriplets:US(e)}}function US(e){let t=e.bonds,{b:r,edgeProps:n,offset:o}=t,{order:a,flags:i}=n,{elementAromaticRingIndices:s}=e.rings,u=[],m=new Map,c=new Map,l=(d,y,S)=>{let x=u.length;u.push(ee.ofUnsortedArray([d,y,S])),m.set(Pu(d,y),S),c.has(d)?c.get(d).push(x):c.set(d,[x])};for(let d=0;d<e.elements.length;d++){if(s.has(d)||o[d+1]-o[d]+1<2)continue;let S=[];for(let x=o[d],g=o[d+1];x<g;x++){let h=i[x];_e.is(h,_e.Flag.Aromatic)&&S.push(r[x])}if(S.length>=2){l(d,S[0],S[1]);for(let x=1,g=S.length;x<g;x++)l(d,S[x],S[0])}}return{getThirdElement:(d,y)=>m.get(Pu(d,y)),getTripletIndices:d=>c.get(d),triplets:u}}var O;(R=>{let e;(G=>(G[G.Atomic=0]="Atomic",G[G.Spheres=1]="Spheres",G[G.Gaussians=2]="Gaussians"))(e=R.Kind||(R.Kind={}));function t(E){return E.kind===0}R.isAtomic=t;function r(E){return E.kind===1||E.kind===2}R.isCoarse=r;function n(E){return E.kind===1}R.isSpheres=n;function o(E){return E.kind===2}R.isGaussians=o;function a(E,B,L,G,K,X,j,$,Z){switch(K){case 0:return new x(E,B,L,G,X,$,Tt.createMapping(j,X.atomicConformation,void 0),Z!=null?Z:g());case 1:return P(E,B,L,G,X,1,$,Tt.createMapping(j,X.coarseConformation.spheres,y(X)),Z!=null?Z:C());case 2:return P(E,B,L,G,X,2,$,Tt.createMapping(j,X.coarseConformation.gaussians,S(X)),Z!=null?Z:C())}}R.create=a;function i(E){let B=cr.Mutable();for(let L=0,G=E.length;L<G;L++)B.set(E[L].id,L);return B}function s(E){let B=[];for(let L=0,G=E.length;L<G;L++)B.push(E[L].id);return hr(B)}function u(E){let B={};return{elements:E[0].elements,units:E,get unitIndexMap(){return B.unitIndexMap||(B.unitIndexMap=i(E)),B.unitIndexMap},hashCode:m(E[0]),transformHash:s(E)}}R.SymmetryGroup=u,(B=>{function E(L){let G=cr.Mutable();for(let K=0,X=L.length;K<X;++K){let j=L[K];for(let $=0,Z=j.units.length;$<Z;++$)G.set(j.units[$].id,K)}return G}B.getUnitSymmetryGroupsIndexMap=E})(u=R.SymmetryGroup||(R.SymmetryGroup={}));function m(E){return ba(E.invariantId,ee.hashCode(E.elements))}R.hashUnit=m;let c;(G=>(G[G.None=0]="None",G[G.MultiChain=1]="MultiChain",G[G.Partitioned=2]="Partitioned"))(c=R.Trait||(R.Trait={}));let l;(L=>(L.is=Ot.has,L.create=Ot.create))(l=R.Traits||(R.Traits={}));function d(){return{}}function y(E){let B=E.coarseConformation.spheres.radius;return L=>B[L]}function S(E){return B=>0}class x{constructor(B,L,G,K,X,j,$,Z){this.kind=0;this.objectPrimitive="atomistic";this.id=B,this.invariantId=L,this.chainGroupId=G,this.traits=K,this.model=X,this.elements=j,this.conformation=$,this.residueIndex=X.atomicHierarchy.residueAtomSegments.index,this.chainIndex=X.atomicHierarchy.chainAtomSegments.index,this.props=Z}getChild(B){return B.length===this.elements.length?this:new x(this.id,this.invariantId,this.chainGroupId,this.traits,this.model,B,this.conformation,g())}applyOperator(B,L,G=!1){let K=G?L:Tt.compose(this.conformation.operator,L);return new x(B,this.invariantId,this.chainGroupId,this.traits,this.model,this.elements,Tt.createMapping(K,this.model.atomicConformation,this.conformation.r),this.props)}get boundary(){if(this.props.boundary)return this.props.boundary;let{x:B,y:L,z:G}=this.model.atomicConformation;return this.props.boundary=Ho({x:B,y:L,z:G,indices:this.elements}),this.props.boundary}get lookup3d(){if(this.props.lookup3d)return this.props.lookup3d;let{x:B,y:L,z:G}=this.model.atomicConformation;return this.props.lookup3d=Fo({x:B,y:L,z:G,indices:this.elements},this.boundary),this.props.lookup3d}get principalAxes(){return this.props.principalAxes?this.props.principalAxes:(this.props.principalAxes=qc(this),this.props.principalAxes)}get bonds(){if(this.props.bonds)return this.props.bonds;let B=Ss.get(this.model),L=B.get(this.elements);return L||(L=df(this),B.set(this.elements,L)),this.props.bonds=L,this.props.bonds}get rings(){return this.props.rings?this.props.rings:(this.props.rings=Pn.create(this),this.props.rings)}get resonance(){return this.props.resonance?this.props.resonance:(this.props.resonance=qf(this),this.props.resonance)}get polymerElements(){return this.props.polymerElements?this.props.polymerElements:(this.props.polymerElements=Lf(this),this.props.polymerElements)}get gapElements(){return this.props.gapElements?this.props.gapElements:(this.props.gapElements=kf(this),this.props.gapElements)}get nucleotideElements(){return this.props.nucleotideElements?this.props.nucleotideElements:(this.props.nucleotideElements=wf(this),this.props.nucleotideElements)}get proteinElements(){return this.props.proteinElements?this.props.proteinElements:(this.props.proteinElements=Nf(this),this.props.proteinElements)}get residueCount(){if(this.props.residueCount!==void 0)return this.props.residueCount;let B=0,L=Ue.transientSegments(this.model.atomicHierarchy.residueAtomSegments,this.elements);for(;L.hasNext;)L.move(),B+=1;return this.props.residueCount=B,this.props.residueCount}getResidueIndex(B){return this.residueIndex[this.elements[B]]}}R.Atomic=x;function g(){return d()}class h{getChild(B){return B.length===this.elements.length?this:P(this.id,this.invariantId,this.chainGroupId,this.traits,this.model,this.kind,B,this.conformation,C())}applyOperator(B,L,G=!1){let K=G?L:Tt.compose(this.conformation.operator,L);return P(B,this.invariantId,this.chainGroupId,this.traits,this.model,this.kind,this.elements,Tt.createMapping(K,this.getCoarseConformation(),this.conformation.r),this.props)}get boundary(){if(this.props.boundary)return this.props.boundary;let{x:B,y:L,z:G}=this.getCoarseConformation();return this.props.boundary=Ho({x:B,y:L,z:G,indices:this.elements}),this.props.boundary}get lookup3d(){if(this.props.lookup3d)return this.props.lookup3d;let{x:B,y:L,z:G}=this.getCoarseConformation();return this.props.lookup3d=Fo({x:B,y:L,z:G,indices:this.elements},this.boundary),this.props.lookup3d}get principalAxes(){return this.props.principalAxes?this.props.principalAxes:(this.props.principalAxes=qc(this),this.props.principalAxes)}get polymerElements(){return this.props.polymerElements?this.props.polymerElements:(this.props.polymerElements=Vf(this),this.props.polymerElements)}get gapElements(){return this.props.gapElements?this.props.gapElements:(this.props.gapElements=Gf(this),this.props.gapElements)}getCoarseConformation(){return f(this.kind,this.model)}constructor(B,L,G,K,X,j,$,Z,te){this.kind=j,this.objectPrimitive=j===1?"sphere":"gaussian",this.id=B,this.invariantId=L,this.chainGroupId=G,this.traits=K,this.model=X,this.elements=$,this.conformation=Z,this.coarseElements=j===1?X.coarseHierarchy.spheres:X.coarseHierarchy.gaussians,this.coarseConformation=j===1?X.coarseConformation.spheres:X.coarseConformation.gaussians,this.props=te}}function f(E,B){return E===1?B.coarseConformation.spheres:B.coarseConformation.gaussians}function C(){return d()}class T extends h{}R.Spheres=T;class I extends h{}R.Gaussians=I;function P(E,B,L,G,K,X,j,$,Z){return new h(E,B,L,G,K,X,j,$,Z)}function A(E,B){return re.areEqual(E.conformation.operator.matrix,B.conformation.operator.matrix,1e-6)}R.areOperatorsEqual=A;function b(E,B){return ee.areEqual(E.elements,B.elements)?_(E,B.model):!1}R.areConformationsEqual=b;function _(E,B){let L=lt.CoordinatesHistory.get(lt.getRoot(B));if(L)return L.areEqual(E.elements,E.kind,B);let G=E.elements,{x:K,y:X,z:j}=E.conformation.coordinates,{x:$,y:Z,z:te}=v(E.kind,B);for(let W=0,Y=G.length;W<Y;W++){let ie=G[W];if(K[ie]!==$[ie]||X[ie]!==Z[ie]||j[ie]!==te[ie])return!1}return!0}function v(E,B){return E===0?B.atomicConformation:E===1?B.coarseConformation.spheres:B.coarseConformation.gaussians}})(O||(O={}));var J;(n=>{n.is=Ot.has,n.create=Ot.create;let r;(f=>(f[f._=0]="_",f[f.H=1]="H",f[f.B=2]="B",f[f.E=4]="E",f[f.G=8]="G",f[f.I=16]="I",f[f.S=32]="S",f[f.T=64]="T",f[f.T3=128]="T3",f[f.T4=256]="T4",f[f.T5=512]="T5",f[f.T3S=1024]="T3S",f[f.T4S=2048]="T4S",f[f.T5S=4096]="T5S"))(r=n.Flag||(n.Flag={}))})(J||(J={}));var qo=class{constructor(t,r,n){this.partner1=Math.min(t,r),this.partner2=Math.max(t,r),this.type=n}};function zf(e){let{unit:t,flags:r,proteinInfo:n}=e,{position:o}=t.conformation,{traceElementIndex:a}=t.model.atomicHierarchy.derived.residue,{residueIndices:i,nIndices:s}=n,u=i.length,m=(h,f)=>h===-1?p.setNaN(f):o(h,f),c=p(),l=p(),d=p(),y=p(),S=p(),x=p(),g=p();e:for(let h=2;h<u-2;h++){for(let _=0;_<4;_++){let v=h+_-2;if(m(a[v],y),m(s[v+1],S),p.squaredDistance(y,S)>6.25)continue e}let f=i[h-2],C=i[h],T=i[h+2],I=a[f],P=a[C],A=a[T];m(I,c),m(P,l),m(A,d),p.sub(x,c,l),p.sub(g,l,d);let b=Po(p.angle(x,g));b&&b>70&&(r[h]|=J.Flag.S)}}var LS=9,Cs=-27.888,VS=-.5,Kf=-9.9;function kS(e,t,r,n){let o=p.distance(e,n),a=p.distance(t,n),i=p.distance(t,r),s=p.distance(e,r),u=Cs/o-Cs/a,m=Cs/i-Cs/s,c=u+m;return c<Kf?Kf:c}function jf(e,t,r){let{residueIndices:n,cIndices:o,hIndices:a,nIndices:i,oIndices:s}=t,{index:u}=e.model.atomicHierarchy,{invariantPosition:m}=e.conformation,{traceElementIndex:c}=e.model.atomicHierarchy.derived.residue,l=n.length,d=[],y=[],S=[],x=p(),g=p(),h=p(),f=p(),C=p(),T=p(),I=p();for(let P=0,A=n.length;P<A;++P){let b=P,_=n[P],v=s[b],R=o[b],E=c[_];if(v===-1||R===-1||u.findAtomOnResidue(_,"OXT")!==-1)continue;m(v,x),m(R,g),m(E,h);let{indices:B,count:L}=r.find(h[0],h[1],h[2],LS);for(let G=0;G<L;++G){let K=B[G];if(K===b||K-1===b||K+1===b)continue;let X=i[K];if(X===-1)continue;m(X,f);let j=a[K];if(j===-1){if(K===0)continue;let Z=K-1,te=s[Z],W=o[Z];if(te===-1||W===-1)continue;m(te,I),m(W,T),p.sub(C,T,I);let Y=p.distance(I,T);p.scaleAndAdd(C,f,C,1/Y)}else m(j,C);let $=kS(x,g,f,C);$>VS||(d[d.length]=b,y[y.length]=K,S[S.length]=$)}}return GS(l,d,y,S)}function GS(e,t,r,n){let o=new qt.DirectedEdgeBuilder(e,t,r),a=new Float32Array(o.slotCount);for(let i=0,s=o.edgeCount;i<s;i++)o.addNextEdge(),o.assignProperty(a,n[i]);return o.createGraph({energies:n})}function Qf(e){let{proteinInfo:t,hbonds:r,flags:n}=e,o=[J.Flag.T3S,J.Flag.T4S,J.Flag.T5S,J.Flag.T3,J.Flag.T4,J.Flag.T5];for(let a=0;a<3;a++)for(let i=0,s=t.residueIndices.length-1;i<s;++i)if(r.getDirectedEdgeIndex(i,i+a+3)!==-1)if(n[i]|=o[a+3]|o[a],e.params.oldDefinition)for(let u=1;u<a+3;++u)n[i+u]|=o[a+3]|J.Flag.T;else for(let u=0;u<=a+3;++u)n[i+u]|=o[a+3]|J.Flag.T}function Yf(e){let{proteinInfo:t,flags:r}=e,n=t.residueIndices.length,o=[J.Flag.T3S,J.Flag.T4S,J.Flag.T5S,J.Flag.T3,J.Flag.T4,J.Flag.T5],a=[0,0,0,J.Flag.G,J.Flag.H,J.Flag.I],i=e.params.oldOrdering?[4,3,5]:[3,4,5];for(let s=0;s<i.length;s++){let u=i[s];for(let m=1,c=n-u;m<c;m++){let l=J.create(r[m]),d=J.create(r[m-1]),y=J.create(r[m+1]);if(e.params.oldOrdering){if(u===3&&(J.is(l,J.Flag.H)||J.is(y,J.Flag.H))||u===5&&(J.is(l,J.Flag.H)||J.is(l,J.Flag.G)||J.is(y,J.Flag.H)||J.is(y,J.Flag.G)))continue}else if(u===4&&(J.is(l,J.Flag.G)||J.is(y,J.Flag.G))||u===5&&(J.is(l,J.Flag.H)||J.is(l,J.Flag.G)||J.is(y,J.Flag.H)||J.is(y,J.Flag.G)))continue;if(J.is(l,o[u])&&J.is(l,o[u-3])&&J.is(d,o[u])&&J.is(d,o[u-3]))if(e.params.oldDefinition)for(let S=0;S<u;S++)r[m+S]|=a[u];else for(let S=-1;S<=u;S++)r[m+S]|=a[u]}}}function wS(e,t){if(t.type!==e.type||t.partner1!==e.firstEnd+1)return!1;if(t.type===0){if(t.partner2===e.secondEnd+1)return!0}else if(t.partner2===e.secondStart-1)return!0;return!1}function NS(e,t){return e.type===t.type&&t.firstStart-e.firstEnd<6&&e.firstStart<t.firstStart&&t.nextLadder===0?e.type===0?Xf(e,t):Xf(t,e):!1}function Xf(e,t){return t.secondStart-e.secondEnd>0&&(t.secondStart-e.secondEnd<6&&t.firstStart-e.firstEnd<3||t.secondStart-e.secondEnd<3)}function Wf(e){let{bridges:t,ladders:r}=e;for(let n=0;n<t.length;n++){let o=t[n],a=!1;for(let i=0;i<r.length;i++){let s=r[i];wS(s,o)&&(a=!0,s.firstEnd++,o.type===0?s.secondEnd++:s.secondStart--)}a||(r[r.length]={previousLadder:0,nextLadder:0,firstStart:o.partner1,firstEnd:o.partner1,secondStart:o.partner2,secondEnd:o.partner2,type:o.type})}for(let n=0;n<r.length;n++){let o=r[n];for(let a=n;a<r.length;a++){let i=r[a];NS(o,i)&&(o.nextLadder=a,i.previousLadder=n)}}}function Jf(e){let{proteinInfo:t,hbonds:r,flags:n,bridges:o}=e,{offset:a,b:i}=r,s,u;for(let m=0,c=t.residueIndices.length;m<c;++m)for(let l=a[m],d=a[m+1];l<d;l++){let y=i[l];m>y||(s=m+1,u=y,s!==u&&r.getDirectedEdgeIndex(u,s+1)!==-1&&(n[s]|=J.Flag.B,n[u]|=J.Flag.B,o[o.length]=new qo(s,u,0)),s=m,u=y-1,s!==u&&r.getDirectedEdgeIndex(u-1,s)!==-1&&(n[s]|=J.Flag.B,n[u]|=J.Flag.B,o[o.length]=new qo(u,s,0)),s=m,u=y,s!==u&&r.getDirectedEdgeIndex(u,s)!==-1&&(n[s]|=J.Flag.B,n[u]|=J.Flag.B,o[o.length]=new qo(u,s,1)),s=m+1,u=y-1,s!==u&&r.getDirectedEdgeIndex(u-1,s+1)!==-1&&(n[s]|=J.Flag.B,n[u]|=J.Flag.B,o[o.length]=new qo(u,s,1)))}o.sort((m,c)=>m.partner1>c.partner1?1:m.partner1<c.partner1?-1:0)}function $f(e){return J.is(e,J.Flag.G)||J.is(e,J.Flag.H)||J.is(e,J.Flag.I)}function ey(e){let{ladders:t,flags:r}=e;for(let n=0;n<t.length;n++){let o=t[n];for(let i=o.firstStart;i<=o.firstEnd;i++){let s=o.firstStart-i,u=o.secondStart-s;o.firstStart!==o.firstEnd?(r[i]|=J.Flag.E,r[u]|=J.Flag.E):(!$f(r[i])&&J.is(r[i],J.Flag.E)&&(r[i]|=J.Flag.B),!$f(r[u])&&J.is(r[u],J.Flag.E)&&(r[u]|=J.Flag.B))}if(o.nextLadder===0)continue;let a=t[o.nextLadder];for(let i=o.firstStart;i<=a.firstEnd;i++)r[i]|=J.Flag.E;if(o.type===0)for(let i=o.secondStart;i<=a.secondEnd;i++)r[i]|=J.Flag.E;else for(let i=a.secondEnd;i<=o.secondStart;i++)r[i]|=J.Flag.E}}function ty(e,t){let{cIndices:r,nIndices:n,residueIndices:o}=t,{position:a}=e.conformation,{index:i}=e.model.atomicHierarchy,{traceElementIndex:s}=e.model.atomicHierarchy.derived.residue,u=o.length,m=(I,P)=>I===-1?p.setNaN(P):a(I,P),c=p(),l=p(),d=p(),y=p(),S=p(),x=p(),g=p(),h=p(),f=p();if(u===0)return{phi:new Float32Array(0),psi:new Float32Array(0)};let C=new Float32Array(u-1),T=new Float32Array(u-1);m(-1,c),m(-1,l),m(-1,d),m(r[0],y),m(s[o[0]],S),m(n[0],x),m(r[1],g),m(s[o[1]],h),m(n[1],f);for(let I=0;I<u-1;++I)i.findAtomOnResidue(o[I],"OXT")===-1&&(C[I]=Po(p.dihedralAngle(c,x,S,y)),T[I]=Po(p.dihedralAngle(x,S,y,f)),c=y,l=S,d=x,y=g,S=h,x=f,m(r[I+1],g),m(s[o[I+1]],h),m(n[I+1],f));return{phi:C,psi:T}}function ry(e,t){let{x:r,y:n,z:o}=e.model.atomicConformation,{traceElementIndex:a}=e.model.atomicHierarchy.derived.residue,i=new Uint32Array(t.length);for(let u=0,m=t.length;u<m;++u)i[u]=a[t[u]];let s={x:r,y:n,z:o,indices:ee.ofSortedArray(i)};return Fo(s,Ho(s))}function ny(e){let{index:t}=e.model.atomicHierarchy,{proteinElements:r,residueIndex:n}=e,o=r.length,a=new Uint32Array(o),i=new Int32Array(o),s=new Int32Array(o),u=new Int32Array(o),m=new Int32Array(o);for(let c=0;c<o;++c){let l=n[r[c]];a[c]=l,i[c]=t.findAtomOnResidue(l,"C"),s[c]=t.findAtomOnResidue(l,"H"),u[c]=t.findAtomOnResidue(l,"O"),m[c]=t.findAtomOnResidue(l,"N")}return{residueIndices:ee.ofSortedArray(a),cIndices:i,hIndices:s,oIndices:u,nIndices:m}}var oy={oldDefinition:k.Boolean(!0),oldOrdering:k.Boolean(!0)};function iy(e,t){let r=ny(e),{residueIndices:n}=r,o=ry(e,n),a=jf(e,r,o),i=n.length,s=new Uint32Array(i),u=ty(e,r),m=[],c=[],l=t.oldDefinition?qS:KS,d=t.oldOrdering?zS:jS,y={params:t,getResidueFlag:l,getFlagName:d,unit:e,proteinInfo:r,flags:s,hbonds:a,torsionAngles:u,ladders:m,bridges:c};Qf(y),Yf(y),zf(y),Jf(y),Wf(y),ey(y);let S=QS(s,l),x=new Uint32Array(i),g=[],h=[],f=C=>ee.indexOf(n,C);for(let C=0,T=n.length;C<T;++C){let I=S[C];x[C]=I;let P=l(s[C]);(h.length===0||P!==h[h.length-1].flags)&&(h[h.length]=OS(HS(I),s[C],l)),g[C]=h.length-1}return $a(x,g,h,f)}function OS(e,t,r){return e==="helix"?{kind:"helix",flags:r(t)}:e==="sheet"?{kind:"sheet",flags:r(t)}:e==="turn"||e==="bend"?{kind:"turn",flags:r(t)}:{kind:"none"}}function HS(e){return e===ke.SecondaryStructureDssp.H||e===ke.SecondaryStructureDssp.G||e===ke.SecondaryStructureDssp.I?"helix":e===ke.SecondaryStructureDssp.B||e===ke.SecondaryStructureDssp.E?"sheet":e===ke.SecondaryStructureDssp.T?"turn":e===ke.SecondaryStructureDssp.S?"bend":"none"}function qS(e){return J.is(e,J.Flag.H)?ke.SecondaryStructureDssp.H:J.is(e,J.Flag.E)?ke.SecondaryStructureDssp.E:J.is(e,J.Flag.B)?ke.SecondaryStructureDssp.B:J.is(e,J.Flag.G)?ke.SecondaryStructureDssp.G:J.is(e,J.Flag.I)?ke.SecondaryStructureDssp.I:J.is(e,J.Flag.T)?ke.SecondaryStructureDssp.T:J.is(e,J.Flag.S)?ke.SecondaryStructureDssp.S:ke.Flag.None}function zS(e){return J.is(e,J.Flag.H)?"H":J.is(e,J.Flag.E)?"E":J.is(e,J.Flag.B)?"B":J.is(e,J.Flag.G)?"G":J.is(e,J.Flag.I)?"I":J.is(e,J.Flag.T)?"T":J.is(e,J.Flag.S)?"S":"-"}function KS(e){return J.is(e,J.Flag.I)?ke.SecondaryStructureDssp.I:J.is(e,J.Flag.H)?ke.SecondaryStructureDssp.H:J.is(e,J.Flag.E)?ke.SecondaryStructureDssp.E:J.is(e,J.Flag.B)?ke.SecondaryStructureDssp.B:J.is(e,J.Flag.G)?ke.SecondaryStructureDssp.G:J.is(e,J.Flag.T)?ke.SecondaryStructureDssp.T:J.is(e,J.Flag.S)?ke.SecondaryStructureDssp.S:ke.Flag.None}function jS(e){return J.is(e,J.Flag.I)?"I":J.is(e,J.Flag.H)?"H":J.is(e,J.Flag.E)?"E":J.is(e,J.Flag.B)?"B":J.is(e,J.Flag.G)?"G":J.is(e,J.Flag.T)?"T":J.is(e,J.Flag.S)?"S":"-"}function QS(e,t){let r=new Uint32Array(e.length);for(let n=0,o=e.length;n<o;++n){let a=J.create(e[n]);r[n]=t(a)}return r}function sy(e){let t="model";if(e){t="dssp";for(let r=0,n=e.models.length;r<n;++r){let o=e.models[r];if(lt.isFromPdbArchive(o)||lt.hasSecondaryStructure(o)){t="model";break}}}return{type:k.MappedStatic(t,{model:k.EmptyGroup({label:"Model"}),dssp:k.Group(oy,{label:"DSSP",isFlat:!0})},{options:[["model","Model"],["dssp","DSSP"]]})}}var ay=sy(),rn=pi.createProvider({descriptor:{name:"molstar_computed_secondary_structure"},type:"root",defaultParams:ay,getParams:sy,isApplicable:e=>!0,obtain:(e,t)=>{let r={...k.getDefaultValues(ay),...t};switch(r.type.name){case"dssp":return{value:YS(e,r.type.params)};case"model":return{value:XS(e)}}}});function YS(e,t){let r=new Map;for(let n=0,o=e.unitSymmetryGroups.length;n<o;++n){let a=e.unitSymmetryGroups[n].units[0];if(O.isAtomic(a)&&!lt.isCoarseGrained(a.model)){let i=iy(a,t);r.set(a.invariantId,i)}}return r}function XS(e){let t=new Map;for(let r=0,n=e.unitSymmetryGroups.length;r<n;++r){let o=e.unitSymmetryGroups[r].units[0];if(O.isAtomic(o)){let a=_n.Provider.get(o.model);a&&t.set(o.invariantId,a)}}return t}var ZS={true:e=>!0,false:e=>!1,zero:e=>0};function dt(){throw new Error("Property only available for atomic models.")}function Tn(e){throw new Error("Property only available for coarse models.")}var Wi={key:e=>e.element,x:e=>e.unit.conformation.x(e.element),y:e=>e.unit.conformation.y(e.element),z:e=>e.unit.conformation.z(e.element),id:e=>O.isAtomic(e.unit)?e.unit.model.atomicConformation.atomId.value(e.element):dt(),occupancy:e=>O.isAtomic(e.unit)?e.unit.model.atomicConformation.occupancy.value(e.element):dt(),B_iso_or_equiv:e=>O.isAtomic(e.unit)?e.unit.model.atomicConformation.B_iso_or_equiv.value(e.element):dt(),sourceIndex:e=>O.isAtomic(e.unit)?e.unit.model.atomicHierarchy.atomSourceIndex.value(e.element):e.element,type_symbol:e=>O.isAtomic(e.unit)?e.unit.model.atomicHierarchy.atoms.type_symbol.value(e.element):dt(),label_atom_id:e=>O.isAtomic(e.unit)?e.unit.model.atomicHierarchy.atoms.label_atom_id.value(e.element):dt(),auth_atom_id:e=>O.isAtomic(e.unit)?e.unit.model.atomicHierarchy.atoms.auth_atom_id.value(e.element):dt(),label_alt_id:e=>O.isAtomic(e.unit)?e.unit.model.atomicHierarchy.atoms.label_alt_id.value(e.element):dt(),label_comp_id:_s,auth_comp_id:e=>O.isAtomic(e.unit)?e.unit.model.atomicHierarchy.atoms.auth_comp_id.value(e.element):dt(),pdbx_formal_charge:e=>O.isAtomic(e.unit)?e.unit.model.atomicHierarchy.atoms.pdbx_formal_charge.value(e.element):dt(),vdw_radius:e=>O.isAtomic(e.unit)?Oa(e.unit.model.atomicHierarchy.atoms.type_symbol.value(e.element)):dt()};function _s(e){return O.isAtomic(e.unit)||dt(),e.unit.model.atomicHierarchy.atoms.label_comp_id.value(e.element)}function zc(e){return O.isAtomic(e.unit)?e.unit.model.atomicHierarchy.residues.label_seq_id.value(e.unit.residueIndex[e.element]):dt()}function WS(e){O.isAtomic(e.unit)||dt();let t=e.unit.model.sequence.byEntityKey[Xt(e)];return t&&t.sequence.microHet.has(zc(e))}function uy(e){O.isAtomic(e.unit)||dt();let t=e.unit.model.sequence.byEntityKey[Xt(e)];return t?t.sequence.microHet.get(zc(e))||[_s(e)]:[_s(e)]}var JS={key:e=>O.isAtomic(e.unit)?e.unit.residueIndex[e.element]:dt(),group_PDB:e=>O.isAtomic(e.unit)?e.unit.model.atomicHierarchy.residues.group_PDB.value(e.unit.residueIndex[e.element]):dt(),label_seq_id:zc,auth_seq_id:e=>O.isAtomic(e.unit)?e.unit.model.atomicHierarchy.residues.auth_seq_id.value(e.unit.residueIndex[e.element]):dt(),pdbx_PDB_ins_code:e=>O.isAtomic(e.unit)?e.unit.model.atomicHierarchy.residues.pdbx_PDB_ins_code.value(e.unit.residueIndex[e.element]):dt(),isNonStandard:e=>O.isAtomic(e.unit)?uy(e).some(t=>e.unit.model.properties.chemicalComponentMap.get(t).mon_nstd_flag[0]==="n"):dt(),hasMicroheterogeneity:WS,microheterogeneityCompIds:uy,secondary_structure_type:e=>{var r;O.isAtomic(e.unit)||dt();let t=(r=rn.get(e.structure).value)==null?void 0:r.get(e.unit.invariantId);return t?t.type[t.getIndex(e.unit.residueIndex[e.element])]:ke.Flag.NA},secondary_structure_key:e=>{var r;O.isAtomic(e.unit)||dt();let t=(r=rn.get(e.structure).value)==null?void 0:r.get(e.unit.invariantId);return t?t.key[t.getIndex(e.unit.residueIndex[e.element])]:-1},chem_comp_type:e=>O.isAtomic(e.unit)?e.unit.model.properties.chemicalComponentMap.get(_s(e)).type:dt()},$S={key:e=>O.isAtomic(e.unit)?e.unit.chainIndex[e.element]:dt(),label_asym_id:e=>O.isAtomic(e.unit)?e.unit.model.atomicHierarchy.chains.label_asym_id.value(e.unit.chainIndex[e.element]):dt(),auth_asym_id:e=>O.isAtomic(e.unit)?e.unit.model.atomicHierarchy.chains.auth_asym_id.value(e.unit.chainIndex[e.element]):dt(),label_entity_id:e=>O.isAtomic(e.unit)?e.unit.model.atomicHierarchy.chains.label_entity_id.value(e.unit.chainIndex[e.element]):dt()},eC={key:Wi.key,entityKey:e=>O.isCoarse(e.unit)?e.unit.coarseElements.entityKey[e.element]:Tn(),x:Wi.x,y:Wi.y,z:Wi.z,asym_id:e=>O.isCoarse(e.unit)?e.unit.coarseElements.asym_id.value(e.element):Tn(),entity_id:e=>O.isCoarse(e.unit)?e.unit.coarseElements.entity_id.value(e.element):Tn(),seq_id_begin:e=>O.isCoarse(e.unit)?e.unit.coarseElements.seq_id_begin.value(e.element):Tn(),seq_id_end:e=>O.isCoarse(e.unit)?e.unit.coarseElements.seq_id_end.value(e.element):Tn(),sphere_radius:e=>O.isSpheres(e.unit)?e.unit.coarseConformation.radius[e.element]:Tn("spheres"),sphere_rmsf:e=>O.isSpheres(e.unit)?e.unit.coarseConformation.rmsf[e.element]:Tn("spheres"),gaussian_weight:e=>O.isGaussians(e.unit)?e.unit.coarseConformation.weight[e.element]:Tn("gaussians"),gaussian_covariance_matrix:e=>O.isGaussians(e.unit)?e.unit.coarseConformation.covariance_matrix[e.element]:Tn("gaussians")};function Xt(e){switch(e.unit.kind){case O.Kind.Atomic:return e.unit.model.atomicHierarchy.index.getEntityFromChain(e.unit.chainIndex[e.element]);case O.Kind.Spheres:return e.unit.model.coarseHierarchy.spheres.entityKey[e.element];case O.Kind.Gaussians:return e.unit.model.coarseHierarchy.gaussians.entityKey[e.element]}}var tC={key:Xt,id:e=>e.unit.model.entities.data.id.value(Xt(e)),type:e=>e.unit.model.entities.data.type.value(Xt(e)),src_method:e=>e.unit.model.entities.data.src_method.value(Xt(e)),pdbx_description:e=>e.unit.model.entities.data.pdbx_description.value(Xt(e)),formula_weight:e=>e.unit.model.entities.data.formula_weight.value(Xt(e)),pdbx_number_of_molecules:e=>e.unit.model.entities.data.pdbx_number_of_molecules.value(Xt(e)),details:e=>e.unit.model.entities.data.details.value(Xt(e)),pdbx_mutation:e=>e.unit.model.entities.data.pdbx_mutation.value(Xt(e)),pdbx_fragment:e=>e.unit.model.entities.data.pdbx_fragment.value(Xt(e)),pdbx_ec:e=>e.unit.model.entities.data.pdbx_ec.value(Xt(e)),subtype:e=>e.unit.model.entities.subtype.value(Xt(e)),prd_id:e=>{var t,r;return(r=(t=e.unit.model.entities.prd_id)==null?void 0:t.value(Xt(e)))!=null?r:""}},rC=[],nC={id:e=>e.unit.id,chainGroupId:e=>e.unit.chainGroupId,multiChain:e=>O.Traits.is(e.unit.traits,O.Trait.MultiChain),object_primitive:e=>e.unit.objectPrimitive,operator_name:e=>e.unit.conformation.operator.name,model_index:e=>e.unit.model.modelNum,model_entry_id:e=>e.unit.model.entryId,hkl:e=>e.unit.conformation.operator.hkl,spgrOp:e=>e.unit.conformation.operator.spgrOp,model_num:e=>e.unit.model.modelNum,pdbx_struct_assembly_id:e=>{var t;return((t=e.unit.conformation.operator.assembly)==null?void 0:t.id)||Tt.DefaultName},pdbx_struct_oper_list_ids:e=>{var t;return((t=e.unit.conformation.operator.assembly)==null?void 0:t.operList)||rC},struct_ncs_oper_id:e=>e.unit.conformation.operator.ncsId},mt={constant:ZS,atom:Wi,residue:JS,chain:$S,entity:tC,unit:nC,coarse:eC};function oC(e){return e}function iC(e){throw new Error(`Property only available for ${e} models.`)}function aC(e){return t=>O.isAtomic(t.unit)?e(t):iC("atomic")}function sC(e){return O.isAtomic(e.unit)?e.unit.residueIndex[e.element]:-1}function uC(e){return O.isAtomic(e.unit)?e.unit.chainIndex[e.element]:-1}function cC(e){return mt.entity.key(e)}var As=13421772,cy={};function mC(e){return cy}function my(e,t){let r;if(e.structure){let{elements:n,getElementIndices:o}=e.structure.carbohydrates,a=(i,s)=>{if(!O.isAtomic(i))return As;let u=o(i,s);return u.length>0?n[u[0]].component.color:As};r=(i,s)=>s?ye.Secondary:le.Location.is(i)?a(i.unit,i.element):Qe.isLocation(i)?a(i.aUnit,i.aUnit.elements[i.aIndex]):As}else r=()=>As;return{factory:my,granularity:"group",color:r,props:t}}var ly={name:"carbohydrate-symbol",factory:my,getParams:mC,defaultValues:k.getDefaultValues(cy),isApplicable:e=>!!e.structure&&e.structure.models.some(t=>lt.hasCarbohydrate(t))};var dy=13421772,py={value:k.Color(dy)};function lC(e){return py}function Is(e,t){let r=Jt(t.value,dy);return{factory:Is,granularity:"uniform",color:()=>r,props:t}}var fy={name:"uniform",factory:Is,getParams:lC,defaultValues:k.getDefaultValues(py),isApplicable:e=>!0};var yy={value:k.Numeric(1,{min:0,max:20,step:.1})};function dC(e){return yy}function Ps(e,t){let r=t.value;return{factory:Ps,granularity:"uniform",size:()=>r,props:t}}var hy={name:"uniform",factory:Ps,getParams:dC,defaultValues:k.getDefaultValues(yy),isApplicable:e=>!0};var pC=1,xy={scale:k.Numeric(1,{min:.1,max:5,step:.1})};function fC(e){return xy}function Kc(e,t){return O.isAtomic(e)?Oa(e.model.atomicHierarchy.atoms.type_symbol.value(t)):O.isSpheres(e)?e.model.coarseConformation.spheres.radius[t]:0}function gy(e,t){let r=t.scale===void 0?1:t.scale;function n(o){let a;return le.Location.is(o)?a=r*Kc(o.unit,o.element):Qe.isLocation(o)?a=r*Math.min(Kc(o.aUnit,o.aUnit.elements[o.aIndex]),Kc(o.bUnit,o.bUnit.elements[o.bIndex])):a=r*pC,a}return{factory:gy,granularity:"group",size:n,props:t}}var by={name:"physical",factory:gy,getParams:fC,defaultValues:k.getDefaultValues(xy),isApplicable:e=>!!e.structure};var nn;(i=>{i.EmptyFactory=()=>i.Empty,i.Empty={factory:i.EmptyFactory,granularity:"uniform",size:()=>1,props:{}};function r(s,u){return s.factory===u.factory&&Wn(s.props,u.props)}i.areEqual=r,i.EmptyProvider={name:"",factory:i.EmptyFactory,getParams:()=>({}),defaultValues:{},isApplicable:()=>!0};function o(){return new fi(i.BuiltIn,i.EmptyProvider)}i.createRegistry=o,i.BuiltIn={physical:by,uniform:hy}})(nn||(nn={}));var lr;(r=>{function e(n,o,a,i){i=i||t();let s=a.colorTheme,u=a.sizeTheme;return i.color=n.colorThemeRegistry.create(s.name,o,s.params),i.size=n.sizeThemeRegistry.create(u.name,o,u.params),i}r.create=e;function t(){return{color:io.Empty,size:nn.Empty}}r.createEmpty=t})(lr||(lr={}));var fi=class{constructor(t,r){this.emptyProvider=r;this._map=new Map;ns(t,(n,o)=>{this.add(n)})}add(t){let r=t.name;this._map.set(r,t)}get(t){return this._map.get(t)||this.emptyProvider}create(t,r,n={}){let o=this.get(t);return o.factory(r,{...k.getDefaultValues(o.getParams(r)),...n})}};function Sy(e){let t={};return ns(e,(r,n)=>{t[n]=k.Color(e[n])}),t}var Cy={type:"colors",colorList:"red-yellow-blue"};function zo(e={}){let t={...Cy,...e};return{palette:k.MappedStatic(t.type,{colors:k.Group({list:k.ColorList(t.colorList)},{isFlat:!0})},{options:[["colors","Color List"]]})}}var Z9=k.getDefaultValues(zo());function yi(e,t){let r;if(t.palette.name==="colors"&&t.palette.params.list.kind==="interpolate"){let{list:n}=t.palette.params,o=[0,e-1],a=n.colors;a.length===0&&(a=Rr(Cy.colorList).list),r=Mo.create({listOrName:a,domain:o}).color}else{let n;n=t.palette.params.list.colors.map(a=>Array.isArray(a)?a[0]:a),n.length===0&&(n=Rr("dark-2").list.map(a=>Array.isArray(a)?a[0]:a));let o=n.length;r=a=>n[a%o]}return{color:r}}var yC="many-distinct",_y=16448250,Iy={asymId:k.Select("auth",k.arrayToOptions(["auth","label"])),...zo({type:"colors",colorList:yC})};function hC(e,t){switch(e.kind){case O.Kind.Atomic:return t==="auth"?mt.chain.auth_asym_id:mt.chain.label_asym_id;case O.Kind.Spheres:case O.Kind.Gaussians:return mt.coarse.asym_id}}function Ay(e,t){let r=hC(e.unit,t)(e);return e.structure.root.models.length>1?Py(e.unit.model,r):r}function Py(e,t){return`${t}|${(lt.Index.get(e).value||0)+1}`}function xC(e,t){let r=new Map;for(let n of e.models){let o=lt.AsymIdOffset.get(n).value,a=(t==="auth"?o==null?void 0:o.auth:o==null?void 0:o.label)||0,i=0;n.properties.structAsymMap.forEach(({auth_id:s},u)=>{let m=t==="auth"?s:u,c=e.models.length>1?Py(n,m):m;r.has(c)||(r.set(c,i+a),++i)})}return r}function jc(e,t){let r;if(e.structure){let n=le.Location.create(e.structure.root),o=xC(e.structure.root,t.asymId),a=yi(o.size,t);r=i=>{let s;if(le.Location.is(i)){let u=Ay(i,t.asymId);s=o.get(u)}else if(Qe.isLocation(i)){n.unit=i.aUnit,n.element=i.aUnit.elements[i.aIndex];let u=Ay(n,t.asymId);s=o.get(u)}return s===void 0?_y:a.color(s)}}else r=()=>_y;return{factory:jc,granularity:"group",color:r,props:t}}var Ty={H:16777215,D:16777152,T:16777120,HE:14286847,LI:13402367,BE:12779264,B:16758197,C:9474192,N:3166456,O:16715021,F:9494608,NE:11789301,NA:11230450,MG:9109248,AL:12560038,SI:1578e4,P:16744448,S:16777008,CL:2093087,AR:8442339,K:9388244,CA:4062976,SC:15132390,TI:12567239,V:10921643,CR:9083335,MN:10255047,FE:14706227,CO:15765664,NI:5296208,CU:13140019,ZN:8224944,GA:12750735,GE:6721423,AS:12419299,SE:16752896,BR:10889513,KR:6076625,RB:7351984,SR:65280,Y:9764863,ZR:9756896,NB:7586505,MO:5551541,TC:3907230,RU:2396047,RH:687500,PD:27013,AG:12632256,CD:16767375,IN:10909043,SN:6717568,SB:10380213,TE:13924864,I:9699476,XE:9699476,CS:5707663,BA:51456,LA:7394559,CE:16777159,PR:14286791,ND:13107143,PM:10747847,SM:9437127,EU:6422471,GD:4587463,TB:3211207,DY:2097095,HO:65436,ER:58997,TM:54354,YB:48952,LU:43812,HF:5096191,TA:5089023,W:2200790,RE:2522539,OS:2516630,IR:1528967,PT:13684960,AU:16765219,HG:12105936,TL:10900557,PB:5724513,BI:10375093,PO:11230208,AT:7688005,RN:4358806,FR:4325478,RA:32e3,AC:7384058,TH:47871,PA:41471,U:36863,NP:33023,PU:27647,AM:5528818,CM:7888099,BK:9064419,CF:10565332,ES:11739092,FM:11739066,MD:11734438,NO:12389767,LR:13041766,RF:13369433,DB:13697103,SG:14221381,BH:14680120,HS:15073326,MT:15400998,DS:16777215,RG:16777215,CN:16777215,UUT:16777215,FL:16777215,UUP:16777215,LV:16777215,UUH:16777215},vy=16777215,Dy={carbonColor:k.MappedStatic("chain-id",{"chain-id":k.Group(Iy),"element-symbol":k.EmptyGroup()}),saturation:k.Numeric(0,{min:-6,max:6,step:.1}),lightness:k.Numeric(.2,{min:-6,max:6,step:.1}),colors:k.MappedStatic("default",{default:k.EmptyGroup(),custom:k.Group(Sy(Ty))})};function gC(e){return Dy}function bC(e,t){let r=e[t];return r===void 0?vy:r}function My(e,t){let r=vl(t.colors.name==="default"?Ty:t.colors.params,t.saturation,t.lightness),n=t.carbonColor,o=n.name==="chain-id"?jc(e,n.params).color:n.name==="element-symbol"?void 0:Zn(n);function a(u,m){return o&&u==="C"?o(m,!1):bC(r,u)}function i(u){if(le.Location.is(u)){if(O.isAtomic(u.unit)){let{type_symbol:m}=u.unit.model.atomicHierarchy.atoms;return a(m.value(u.element),u)}}else if(Qe.isLocation(u)&&O.isAtomic(u.aUnit)){let{type_symbol:m}=u.aUnit.model.atomicHierarchy.atoms,c=m.value(u.aUnit.elements[u.aIndex]);return a(c,u)}return vy}return{factory:My,granularity:"group",preferSmoothing:!0,color:i,props:t}}var Ey={name:"element-symbol",factory:My,getParams:gC,defaultValues:k.getDefaultValues(Dy),isApplicable:e=>!!e.structure};var Qc="dark-2",By=16448250,Fy={...zo({type:"colors",colorList:Qc})};function SC(e){let t=k.clone(Fy);return e.structure&&Uy(e.structure.root).size>Ui[Qc].list.length&&(t.palette.defaultValue.name="colors",t.palette.defaultValue.params={...t.palette.defaultValue.params,list:{kind:"interpolate",colors:Rr(Qc).list}}),t}function Ry(e){switch(e.kind){case O.Kind.Atomic:return mt.chain.label_asym_id;case O.Kind.Spheres:case O.Kind.Gaussians:return mt.coarse.asym_id}}function Uy(e){let t=new Map;for(let r=0,n=e.unitSymmetryGroups.length;r<n;++r){let o=e.unitSymmetryGroups[r].units[0],{model:a}=o;if(O.isAtomic(o)){let{chainAtomSegments:i,chains:s}=a.atomicHierarchy,u=Ue.transientSegments(i,o.elements);for(;u.hasNext;){let{index:m}=u.move(),c=s.label_entity_id.value(m),l=a.entities.getEntityIndex(c);if(a.entities.data.type.value(l)==="polymer"){let d=s.label_asym_id.value(m);t.has(d)||t.set(d,t.size)}}}else if(O.isCoarse(o)){let{chainElementSegments:i,asym_id:s,entity_id:u}=O.isSpheres(o)?a.coarseHierarchy.spheres:a.coarseHierarchy.gaussians,m=Ue.transientSegments(i,o.elements);for(;m.hasNext;){let{index:c}=m.move(),l=i.offsets[c],d=u.value(l),y=a.entities.getEntityIndex(d);if(a.entities.data.type.value(y)==="polymer"){let S=s.value(l);t.has(S)||t.set(S,t.size)}}}}return t}function Ly(e,t){let r;if(e.structure){let n=le.Location.create(e.structure),o=Uy(e.structure.root),a=yi(o.size,t);r=i=>{let s;if(le.Location.is(i)){let u=Ry(i.unit);s=o.get(u(i))}else if(Qe.isLocation(i)){let u=Ry(i.aUnit);n.unit=i.aUnit,n.element=i.aUnit.elements[i.aIndex],s=o.get(u(n))}return s===void 0?By:a.color(s)}}else r=()=>By;return{factory:Ly,granularity:"group",color:r,props:t}}var Vy={name:"polymer-id",factory:Ly,getParams:SC,defaultValues:k.getDefaultValues(Fy),isApplicable:e=>!!e.structure};var Yc="dark-2",ky=13421772,Gy={...zo({type:"colors",colorList:Yc})};function CC(e){let t=k.clone(Gy);return e.structure&&wy(e.structure.root)>Ui[Yc].list.length&&(t.palette.defaultValue.name="colors",t.palette.defaultValue.params={...t.palette.defaultValue.params,list:{kind:"interpolate",colors:Rr(Yc).list}}),t}function wy(e){let t=0,{units:r}=e;for(let n=0,o=r.length;n<o;++n)r[n].polymerElements.length>0&&++t;return t}function Ny(e,t){let r;if(e.structure){let n=yi(wy(e.structure.root),t),{units:o}=e.structure.root,a=new Map;for(let i=0,s=0,u=o.length;i<u;++i)o[i].polymerElements.length>0&&(a.set(o[i].id,n.color(s)),++s);r=i=>{let s;return le.Location.is(i)?s=a.get(i.unit.id):Qe.isLocation(i)&&(s=a.get(i.aUnit.id)),s!==void 0?s:ky}}else r=()=>ky;return{factory:Ny,granularity:"instance",color:r,props:t}}var Oy={name:"polymer-index",factory:Ny,getParams:CC,defaultValues:k.getDefaultValues(Gy),isApplicable:e=>!!e.structure};var _C=13421772,zy={list:k.ColorList("turbo",{presetKind:"scale"})};function AC(e){return zy}function Hy(e,t){let{model:r}=e;switch(e.kind){case O.Kind.Atomic:let n=r.atomicHierarchy.residueAtomSegments.index[t];return r.atomicHierarchy.residues.label_seq_id.value(n);case O.Kind.Spheres:return Math.round((r.coarseHierarchy.spheres.seq_id_begin.value(t)+r.coarseHierarchy.spheres.seq_id_end.value(t))/2);case O.Kind.Gaussians:return Math.round((r.coarseHierarchy.gaussians.seq_id_begin.value(t)+r.coarseHierarchy.gaussians.seq_id_end.value(t))/2)}}function qy(e,t){let{model:r}=e,n="";switch(e.kind){case O.Kind.Atomic:let i=r.atomicHierarchy.chainAtomSegments.index[t];n=r.atomicHierarchy.chains.label_entity_id.value(i);break;case O.Kind.Spheres:n=r.coarseHierarchy.spheres.entity_id.value(t);break;case O.Kind.Gaussians:n=r.coarseHierarchy.gaussians.entity_id.value(t);break}if(n==="")return 0;let o=r.entities.getEntityIndex(n);if(o===-1)return 0;let a=r.sequence.byEntityKey[o];return a===void 0?0:a.sequence.length}function Ky(e,t){let r=Mo.create({listOrName:t.list.colors});return{factory:Ky,granularity:"group",preferSmoothing:!0,color:o=>{if(le.Location.is(o)){let{unit:a,element:i}=o,s=Hy(a,i);if(s>0){let u=qy(a,i);if(u)return r.setDomain(0,u-1),r.color(s)}}else if(Qe.isLocation(o)){let{aUnit:a,aIndex:i}=o,s=Hy(a,a.elements[i]);if(s>0){let u=qy(a,a.elements[i]);if(u)return r.setDomain(0,u-1),r.color(s)}}return _C},props:t}}var jy={name:"sequence-id",factory:Ky,getParams:AC,defaultValues:k.getDefaultValues(zy),isApplicable:e=>!!e.structure};var io;(u=>{u.PaletteScale=16777215,u.EmptyFactory=()=>u.Empty;let r=13421772;u.Empty={factory:u.EmptyFactory,granularity:"uniform",color:()=>r,props:{}};function o(m,c){return m.contextHash===c.contextHash&&m.factory===c.factory&&Wn(m.props,c.props)}u.areEqual=o,u.EmptyProvider={name:"",factory:u.EmptyFactory,getParams:()=>({}),defaultValues:{},isApplicable:()=>!0};function i(){return new fi(u.BuiltIn,u.EmptyProvider)}u.createRegistry=i,u.BuiltIn={"carbohydrate-symbol":ly,"element-symbol":Ey,"polymer-id":Vy,"polymer-index":Oy,"sequence-id":jy,uniform:fy}})(io||(io={}));function vn(e,t){return{kind:e,layers:t}}(r=>{r.Empty={kind:"empty-loci",layers:[]};function t(n,o){if(n.kind==="element-loci"){let a=[];for(let i of n.layers){let s=le.Loci.remap(i.loci,o);le.Loci.isEmpty(s)||a.push({loci:s,value:i.value})}return{kind:"element-loci",layers:a}}else return n}r.remap=t})(vn||(vn={}));var Ji;(r=>{function e(n,o){return n===o}r.areEquivalent=e;function t(n){return n.cells.data.length===0}r.isEmpty=t})(Ji||(Ji={}));var Ts;(o=>{function e(a){var i,s,u,m;return((m=(u=(s=(i=a==null?void 0:a.grid)==null?void 0:i.cells)==null?void 0:s.space)==null?void 0:u.dimensions)==null?void 0:m.length)&&(a==null?void 0:a.sourceData)&&(a==null?void 0:a.customProperties)&&(a==null?void 0:a._propertyData)}o.is=e;let t;(m=>{function a(c,l,d){return Bt(u(c,d).absoluteValue,u(l,d).absoluteValue,d.sigma/100)}m.areSame=a;function i(c){return{kind:"absolute",absoluteValue:c}}m.absolute=i;function s(c,l){return l*c.sigma+c.mean}m.calcAbsolute=s;function u(c,l){return c.kind==="absolute"?c:{kind:"absolute",absoluteValue:m.calcAbsolute(l,c.relativeValue)}}m.toAbsolute=u})(t=o.IsoValue||(o.IsoValue={}));function r(a,i){return Ji.areEquivalent(a.grid,i.grid)}o.areEquivalent=r;function n(a){return Ji.isEmpty(a.grid)}o.isEmpty=n})(Ts||(Ts={}));var ao;(r=>{function e(){return{updateTransform:!1,updateMatrix:!1,updateColor:!1,updateSize:!1,createGeometry:!1,createNew:!1,info:{}}}r.create=e;function t(n){n.updateTransform=!1,n.updateMatrix=!1,n.updateColor=!1,n.updateSize=!1,n.createGeometry=!1,n.createNew=!1}r.reset=t})(ao||(ao={}));var IC={lowestElementCount:1e6,lowerElementCount:5e5,lowElementCount:1e5,mediumElementCount:2e4,highElementCount:2e3,coarseGrainedFactor:10,elementCountFactor:1};function Xc(e,t={}){let r={...IC,...t},n=e.elementCount*r.elementCountFactor;return e.isCoarseGrained&&(n*=r.coarseGrainedFactor),n>r.lowestElementCount?"lowest":n>r.lowerElementCount?"lower":n>r.lowElementCount?"low":n>r.mediumElementCount?"medium":n>r.highElementCount?"high":"higher"}function PC(e){if(e.root.models.length===1){let t=Lr.Provider.get(e.root.model);if(t&&t.spacegroup.name==="P 1"&&!Ro.isZero(t.spacegroup.cell))return t.spacegroup.cell.volume}return Xe.volume(e.root.boundary.box)}function Qy(e,t){let r=Jt(e.quality,"auto"),n=Jt(e.detail,1),o=Jt(e.radialSegments,12),a=Jt(e.linearSegments,8),i=Jt(e.resolution,2),s=Jt(e.probePositions,12),u=0;if(r==="auto"){if(t instanceof Ce)r=Xc(t.root),u=PC(t);else if(Ts.is(t)){let[m,c,l]=t.grid.cells.space.dimensions;u=m*c*l,r=u<1e7?"medium":"low"}}switch(r){case"highest":n=3,o=36,a=18,i=.1,s=72;break;case"higher":n=3,o=28,a=14,i=.3,s=48;break;case"high":n=2,o=20,a=10,i=.5,s=36;break;case"medium":n=1,o=12,a=8,i=.8,s=24;break;case"low":n=0,o=8,a=3,i=1.3,s=24;break;case"lower":n=0,o=4,a=2,i=3,s=12;break;case"lowest":n=0,o=2,a=1,i=8,s=12;break;case"custom":break}return i=Math.max(i,u/5e8),i=Math.min(i,20),{detail:n,radialSegments:o,linearSegments:a,resolution:i,probePositions:s}}function Dn(e){return{layers:e}}(n=>{n.Empty={layers:[]};let t;(a=>{let o;(y=>(y[y.None=0]="None",y[y.One=1]="One",y[y.Two=2]="Two",y[y.Three=4]="Three",y[y.Four=8]="Four",y[y.Five=16]="Five",y[y.Six=32]="Six"))(o=a.Flag||(a.Flag={}))})(t=n.Groups||(n.Groups={}));function r(o,a){let i=[];for(let s of o.layers){let{loci:u,groups:m}=s;u=le.Loci.remap(u,a),le.Loci.isEmpty(u)||i.push({loci:u,groups:m})}return{layers:i}}n.remap=r})(Dn||(Dn={}));var Yy;(t=>{function e(r,n,o){return k.getDefaultValues(r.getParams(n,o))}t.getDetaultParams=e})(Yy||(Yy={}));var Gt;(i=>{function e(){return{visible:!0,alphaFactor:1,transform:re.identity(),transparency:vn.Empty,clipping:Dn.Empty}}i.createState=e;function t(s,u){u.visible!==void 0&&(s.visible=u.visible),u.alphaFactor!==void 0&&(s.alphaFactor=u.alphaFactor),u.transparency!==void 0&&(s.transparency=u.transparency),u.clipping!==void 0&&(s.clipping=u.clipping),u.transform!==void 0&&re.copy(s.transform,u.transform)}i.updateState=t,i.StateBuilder={create:e,update:t},i.Empty={groupCount:0,renderObjects:[],geometryVersion:-1,props:{},params:{},state:e(),theme:lr.createEmpty(),createOrUpdate:()=>{},setState:()=>{},setTheme:()=>{}};class o{constructor(){this.curr=new Set;this.next=new Set;this._version=-1}get version(){return this._version}add(u,m){this.next.add(Wt(u,m))}snapshot(){xr.areEqual(this.curr,this.next)||(this._version+=1),[this.curr,this.next]=[this.next,this.curr],this.next.clear()}}i.GeometryState=o;function a(s,u,m,c,l){let d=new o,y=c.create(),S=lr.createEmpty(),x,g,h,f={},C=Object.keys(l).map((T,I)=>{f[I]=T;let P=l[T](u,m);return P.setState(y),P});return{get groupCount(){let T=0;if(g){let{visuals:I}=g;for(let P=0,A=C.length;P<A;++P)(!I||I.includes(f[P]))&&(T+=C[P].groupCount)}return T},get renderObjects(){let T=[];if(g){let{visuals:I}=g;for(let P=0,A=C.length;P<A;++P)(!I||I.includes(f[P]))&&T.push(...C[P].renderObjects)}return T},get geometryVersion(){return d.version},get props(){return g},get params(){return x},createOrUpdate:(T={},I)=>{I&&I!==h&&(x=m(u,I),h=I,g||(g=k.getDefaultValues(x)));let P=Qy(Object.assign({},g,T),h);Object.assign(g,T,P);let{visuals:A}=g;for(let b=0,_=C.length;b<_;++b)(!A||A.includes(f[b]))&&C[b].createOrUpdate(g,h),d.add(b,C[b].geometryVersion);d.snapshot()},get state(){return y},get theme(){return S},setState:T=>{c.update(y,T);for(let I=0,P=C.length;I<P;++I)C[I].setState(T)},setTheme:T=>{S=T;for(let I=0,P=C.length;I<P;++I)C[I].setTheme(T)}}}i.createMulti=a})(Gt||(Gt={}));function Xy(e,t){return{values:e,state:t}}function hi(e,t,r){return{type:"attribute",kind:e,itemSize:t,divisor:r}}function kr(e,t){return{type:"uniform",kind:e,variant:t}}function so(e,t,r,n,o){return{type:"texture",kind:e,format:t,dataType:r,filter:n,variant:o}}function Zy(e){return{type:"elements",kind:e}}function uo(e,t){return{type:"define",kind:e,options:t}}function on(e){return{type:"value",kind:e}}var SU={tDepth:so("texture","depth","ushort","nearest")},CU={uObjectId:kr("i")},TC={uColor:kr("v3","material"),tColor:so("image-uint8","rgb","ubyte","nearest"),tPalette:so("image-uint8","rgb","ubyte","nearest"),tColorGrid:so("texture","rgb","ubyte","linear"),dColorType:uo("string",["uniform","attribute","instance","group","groupInstance","vertex","vertexInstance","volume","volumeInstance","direct"]),dUsePalette:uo("boolean")},_U={uSize:kr("f","material"),uSizeTexDim:kr("v2"),tSize:so("image-uint8","rgb","ubyte","nearest"),dSizeType:uo("string",["uniform","attribute","instance","group","groupInstance"]),uSizeFactor:kr("f","material")},vC={tTransparency:so("image-uint8","alpha","ubyte","nearest"),dTransparency:uo("boolean"),transparencyAverage:on("number"),tTransparencyGrid:so("texture","alpha","ubyte","linear"),dTransparencyType:uo("string",["instance","groupInstance","volumeInstance"])},DC={uClippingTexDim:kr("v2"),tClipping:so("image-uint8","alpha","ubyte","nearest"),dClipping:uo("boolean"),dClippingType:uo("string",["instance","groupInstance"])},Wy={dGeometryType:uo("string",["cylinders","directVolume","image","lines","mesh","points","spheres","text","textureMesh"]),...TC,...vC,...DC,aInstance:hi("float32",1,1),aTransform:hi("float32",16,1),uAlpha:kr("f","material"),uVertexCount:kr("i"),uInstanceCount:kr("i"),uGroupCount:kr("i"),uInvariantBoundingSphere:kr("v4"),drawCount:on("number"),instanceCount:on("number"),alpha:on("number"),matrix:on("m4"),transform:on("float32"),extraTransform:on("float32"),instanceGranularity:on("boolean"),boundingSphere:on("sphere"),invariantBoundingSphere:on("sphere")};var MU={...Wy,aGroup:hi("float32",1,0),aPosition:hi("float32",3,0),aNormal:hi("float32",3,0),elements:Zy("uint32")};function Jy(e,t){return Xy(e,t)}var MC=gn(0,2147483647),vs=gn(0,2147483647);function Ds(e,t,r){return{id:MC(),type:e,values:t,state:r}}function $y(e){return Jy(e.values,e.state)}function Ko(e,t,r,n){let{webgl:o}=t,a=new Gt.GeometryState,i=vs(),s=[],u=tr.create(),m,c,l,d,y=lr.createEmpty();function S(h={},f){f&&f!==c&&(l=r(t,f),c=f,d||(d=k.getDefaultValues(l))),d=Object.assign({},d,h);let C=!1;m||(m=n(i,c,d,o),C=!0),m.createOrUpdate({webgl:o},y,d,f),C&&x(u),s.length=0,m&&m.renderObject&&(s.push(m.renderObject),a.add(m.renderObject.id,m.geometryVersion)),a.snapshot()}function x(h){if(tr.update(u,h),h.visible!==void 0&&m&&m.setVisibility(h.visible&&(u.unitTransforms===null||u.unitTransforms.isIdentity)),h.alphaFactor!==void 0&&m&&m.setAlphaFactor(h.alphaFactor),h.transparency!==void 0&&m){let f=vn.remap(h.transparency,c);m.setTransparency(f,o)}if(h.clipping!==void 0&&m){let f=Dn.remap(h.clipping,c);m.setClipping(f)}h.transform!==void 0&&m&&m.setTransform(h.transform),h.unitTransforms!==void 0&&m&&m.setVisibility(u.visible&&(h.unitTransforms===null||h.unitTransforms.isIdentity))}function g(h){y=h}return{get groupCount(){return m?m.groupCount:0},get props(){return d},get params(){return l},get state(){return u},get theme(){return y},get geometryVersion(){return a.version},renderObjects:s,createOrUpdate:S,setState:x,setTheme:g}}function Zc(e,t,r){if(r){Q.update(r.matrix,r.matrix.ref.value);let n=r.transform.ref.value.length>=t*16?r.transform.ref.value:new Float32Array(t*16);n.set(e),Q.update(r.transform,n),Q.updateIfChanged(r.uInstanceCount,t),Q.updateIfChanged(r.instanceCount,t);let o=r.aTransform.ref.value.length>=t*16?r.aTransform.ref.value:new Float32Array(t*16);Q.update(r.aTransform,o);let a=r.extraTransform.ref.value.length>=t*16?r.extraTransform.ref.value:new Float32Array(t*16);Q.update(r.extraTransform,Ms(a,t));let i=r.aInstance.ref.value.length>=t?r.aInstance.ref.value:new Float32Array(t);Q.update(r.aInstance,ro(i,t))}else r={aTransform:Q.create(new Float32Array(t*16)),matrix:Q.create(re.identity()),transform:Q.create(new Float32Array(e)),extraTransform:Q.create(Ms(new Float32Array(t*16),t)),uInstanceCount:Q.create(t),instanceCount:Q.create(t),aInstance:Q.create(ro(new Float32Array(t)))};return Jc(r),r}var Wc=new Float32Array(16);re.toArray(re.identity(),Wc,0);function Es(e){return Zc(new Float32Array(Wc),1,e)}function Ms(e,t){for(let r=0;r<t;r++)e.set(Wc,r*16);return e}function Jc(e){let t=e.aTransform.ref.value,r=e.instanceCount.ref.value,n=e.matrix.ref.value,o=e.transform.ref.value,a=e.extraTransform.ref.value;for(let i=0;i<r;i++){let s=i*16;re.mulOffset(t,a,o,s,s,s),re.mulOffset(t,n,t,s,0,s)}Q.update(e.aTransform,t)}function EC(e,t){e=Math.max(e,2);let r=Math.sqrt(e),n=Math.ceil(r);n=n+(t-n%t)%t;let o=n>0?Math.ceil(e/n):0;return{width:n,height:o,length:n*o*t}}function _r(e,t,r,n){let{length:o,width:a,height:i}=EC(e,t);return n=n&&n.length>=o?n:new r(o),{array:n,width:a,height:i}}var Cr=p(),BC=new Vr("14"),RC=new Vr("98");function eh(e){return e>1e5?BC:RC}function jo(e,t,r){let n=r*3,o=eh(t);o.reset();for(let i=0,s=t*3;i<s;i+=n)p.fromArray(Cr,e,i),o.includePosition(Cr);o.finishedIncludeStep();for(let i=0,s=t*3;i<s;i+=n)p.fromArray(Cr,e,i),o.radiusPosition(Cr);let a=o.getSphere();if(t<=98){let i=[];for(let s=0,u=t*3;s<u;s+=n)i.push(p.fromArray(p(),e,s));Se.setExtrema(a,i)}return a}var $c=re();function Bs(e,t,r){if(r===1){re.fromArray($c,t,0);let s=Se.clone(e);return re.isIdentity($c)?s:Se.transform(s,s,$c)}let n=eh(r);n.reset();let{center:o,radius:a,extrema:i}=e;if(i&&r<50){for(let s=0,u=r;s<u;++s)for(let m of i)p.transformMat4Offset(Cr,m,t,0,0,s*16),n.includePosition(Cr);n.finishedIncludeStep();for(let s=0,u=r;s<u;++s)for(let m of i)p.transformMat4Offset(Cr,m,t,0,0,s*16),n.radiusPosition(Cr)}else{for(let s=0,u=r;s<u;++s)p.transformMat4Offset(Cr,o,t,0,0,s*16),n.includePositionRadius(Cr,a);n.finishedIncludeStep();for(let s=0,u=r;s<u;++s)p.transformMat4Offset(Cr,o,t,0,0,s*16),n.radiusPositionRadius(Cr,a)}return n.getSphere()}var FC=gn();function Gr(){return{id:FC(),target:3553,format:0,internalFormat:0,type:0,filter:0,getWidth:()=>0,getHeight:()=>0,reset:()=>{},destroy:()=>{}}}function rh(e,t,r,n){for(let o=t;o<r;++o)e[o]=n*255;return!0}function em(e,t){if(t===0||e.length<t)return 0;let r=0;for(let n=0;n<t;++n)r+=e[n];return r/(255*t)}function nh(e,t,r){e.fill(0,t,r)}function oh(e,t,r){let n=_r(Math.max(1,e),1,Uint8Array,r&&r.tTransparency.ref.value.array);return r?(Q.update(r.tTransparency,n),Q.updateIfChanged(r.dTransparency,e>0),Q.updateIfChanged(r.transparencyAverage,em(n.array,e)),Q.updateIfChanged(r.dTransparencyType,t),r):{tTransparency:Q.create(n),dTransparency:Q.create(e>0),transparencyAverage:Q.create(0),tTransparencyGrid:Q.create(Gr()),dTransparencyType:Q.create(t)}}var th={array:new Uint8Array(1),width:1,height:1};function ih(e){return e?(Q.update(e.tTransparency,th),e):{tTransparency:Q.create(th),dTransparency:Q.create(!1),transparencyAverage:Q.create(0),tTransparencyGrid:Q.create(Gr()),dTransparencyType:Q.create("groupInstance")}}function sh(e,t,r,n){return e.fill(n,t,r),!0}function uh(e,t,r){e.fill(0,t,r)}function ch(e,t,r){let n=_r(Math.max(1,e),1,Uint8Array,r&&r.tClipping.ref.value.array);return r?(Q.update(r.tClipping,n),Q.update(r.uClippingTexDim,wt.create(n.width,n.height)),Q.updateIfChanged(r.dClipping,e>0),Q.updateIfChanged(r.dClippingType,t),r):{tClipping:Q.create(n),uClippingTexDim:Q.create(wt.create(n.width,n.height)),dClipping:Q.create(e>0),dClippingType:Q.create(t)}}var ah={array:new Uint8Array(1),width:1,height:1};function mh(e){return e?(Q.update(e.tClipping,ah),Q.update(e.uClippingTexDim,wt.create(1,1)),Q.updateIfChanged(e.dClipping,!1),e):{tClipping:Q.create(ah),uClippingTexDim:Q.create(wt.create(1,1)),dClipping:Q.create(!1),dClippingType:Q.create("groupInstance")}}var Qo={kind:"null-location"};function At(e,t,r,n,o=!1,a=()=>!1){if(e%r!==0)throw new Error("incompatible groupCount and stride");let i={location:Qo,index:0,groupIndex:0,instanceIndex:0,isSecondary:!1},s=i.groupIndex<e,u=!1,m=0,c=0,l=!1;return{get hasNext(){return s},get isNextNewInstance(){return u},groupCount:e,instanceCount:t,count:e*t,stride:r,nonInstanceable:o,move(){return s&&(i.groupIndex=m,i.instanceIndex=c,i.index=c*e+m,i.location=n(m,l?-1:c),i.isSecondary=a(m,l?-1:c),m+=r,m===e?(++c,u=!0,c<t&&(m=0)):u=!1,s=m<e),i},reset(){i.location=Qo,i.index=0,i.groupIndex=0,i.instanceIndex=0,i.isSecondary=!1,s=i.groupIndex<e,u=!1,m=0,c=0,l=!1},skipInstance(){s&&i.instanceIndex===c&&(++c,m=0,s=c<t)},voidInstances(){l=!0}}}function lh(e){return{kind:"position-location",position:e?p.clone(e):p()}}var dh={gray:8421504};var UC={custom:{},auto:{},highest:{},higher:{},high:{},medium:{},low:{},lower:{},lowest:{}},LC=Object.keys(UC),VC=k.arrayToOptions(LC),ph={smoothColors:k.MappedStatic("auto",{auto:k.Group({}),on:k.Group({resolutionFactor:k.Numeric(2,{min:.5,max:6,step:.1}),sampleStride:k.Numeric(3,{min:1,max:12,step:1})}),off:k.Group({})})};function fh(e){return!!e.smoothColors}function Rs(e,t,r){if((e.name==="on"||e.name==="auto"&&t)&&r&&r<3){let n=3;return e.name==="on"?(r*=e.params.resolutionFactor,n=e.params.sampleStride):(r*=2-fa(0,1.1,r),r=Math.max(.5,r),r>1.2&&(n=2)),{resolution:r,stride:n}}}var at;(i=>{i.CustomQualityParamInfo={category:"Custom Quality"},i.Params={alpha:k.Numeric(1,{min:0,max:1,step:.01},{label:"Opacity"}),quality:k.Select("auto",VC,{}),instanceGranularity:k.Boolean(!1,{})};function r(s=dh.gray,u=1,m){m||(m=Es());let c=At(1,m.instanceCount.ref.value,1,()=>Qo,!1,()=>!1),l={color:Is({},{value:s}),size:Ps({},{value:u})};return{transform:m,locationIterator:c,theme:l}}i.createSimple=r;function n(s,u){return{alpha:Q.create(s.alpha),uAlpha:Q.create(s.alpha),uVertexCount:Q.create(u.vertexCount),uGroupCount:Q.create(u.groupCount),drawCount:Q.create(u.drawCount),instanceGranularity:Q.create(s.instanceGranularity)}}i.createValues=n;function o(s={}){return{disposed:!1,visible:!0,alphaFactor:1,opaque:s.alpha===void 0?!0:s.alpha===1}}i.createRenderableState=o;function a(s,u){s.opaque=u.alpha*s.alphaFactor>=1}i.updateRenderableState=a})(at||(at={}));function yh(e,t=0){let r=e[0]*e[1]*e[2],n=Math.sqrt(r),o=Math.pow(2,Math.ceil(Math.log(n)/Math.log(2))),a=e[0]+t,i=e[1]+t,s=1,u=a;return o<a*e[2]?(u=Math.floor(o/a),s=Math.ceil(e[2]/u),a*=u,i*=s):a*=e[2],{width:a,height:i,columns:u,rows:s,powerOfTwoSize:i<o?o:o*2}}function hh(e,t,r,n,o){let{colorType:a,vertexCount:i,groupCount:s,positionBuffer:u,transformBuffer:m,groupBuffer:c,itemSize:l}=e,d=a.endsWith("Instance"),y=Xe.fromSphere3D(Xe(),d?e.boundingSphere:e.invariantBoundingSphere),S=1+t,x=Xe.expand(Xe(),y,p.create(S,S,S)),g=1/t,h=Xe.scale(Xe(),x,g),f=Xe.size(p(),h);p.ceil(f,f),p.add(f,f,p.create(2,2,2));let{min:C}=x,[T,I]=f,{width:P,height:A}=yh(f),b=new Float32Array(P*A*l),_=new Float32Array(P*A),v=new Uint8Array(P*A*l),R=d?e.instanceCount:1,E=e.colorData.array;function B(W,Y,ie){let D=Math.floor(ie*T%P/T),F=Math.floor(ie*T/P),N=D*T+W;return l*(F*I*P+Y*P+N)}let L=2,[G,K,X]=f,j=p();for(let W=0;W<R;++W)for(let Y=0;Y<i;Y+=r){p.fromArray(j,u,Y*3),d&&p.transformMat4Offset(j,j,m,0,0,W*16),p.sub(j,j,C),p.scale(j,j,g);let[ie,D,F]=j,N=Math.floor(ie),oe=Math.floor(D),se=Math.floor(F),ce=(W*s+c[Y])*l,he=Math.max(0,N-L),ve=Math.max(0,oe-L),Ie=Math.max(0,se-L),Pe=Math.min(G,N+L+2),me=Math.min(K,oe+L+2),fe=Math.min(X,se+L+2);for(let pe=he;pe<Pe;++pe){let Te=pe-ie;for(let be=ve;be<me;++be){let Re=be-D;for(let Ne=Ie;Ne<fe;++Ne){let Je=Ne-F,tt=Math.sqrt(Te*Te+Re*Re+Je*Je);if(tt>L)continue;let Le=L-tt,Ge=B(pe,be,Ne);for(let Fe=0;Fe<l;++Fe)b[Ge+Fe]+=E[ce+Fe]*Le;_[Ge/l]+=Le}}}}for(let W=0,Y=_.length;W<Y;++W){let ie=W*l,D=_[W];for(let F=0;F<l;++F)v[ie+F]=Math.round(b[ie+F]/D)}let $=wt.create(P,A),Z=fn.create(C[0],C[1],C[2],g),te=d?"volumeInstance":"volume";{let W=kC({vertexCount:i,instanceCount:R,transformBuffer:m,positionBuffer:u,colorType:te,grid:v,gridDim:f,gridTexDim:$,gridTransform:Z,vertexStride:3,colorStride:l,outputStride:l});return{kind:"vertex",texture:W,texDim:wt.create(W.width,W.height),type:d?"vertexInstance":"vertex"}}}function kC(e){let{vertexCount:t,positionBuffer:r,transformBuffer:n,grid:o,gridDim:a,gridTexDim:i,gridTransform:s,vertexStride:u,colorStride:m}=e,c=e.itemOffset||0,l=e.outputStride,d=e.colorType.endsWith("Instance"),y=d?e.instanceCount:1,S=_r(Math.max(1,y*t),l,Uint8Array),{array:x}=S,[g,h]=a,f=i[0],C=p.fromArray(p(),s,0),T=s[3];function I(v,R,E){let B=Math.floor(E*g%f/g),L=Math.floor(E*g/f),G=B*g+v;return m*(L*h*f+R*f+G)}let P=p(),A=p(),b=p(),_=p();for(let v=0;v<y;++v)for(let R=0;R<t;++R){p.fromArray(P,r,R*u),d&&p.transformMat4Offset(P,P,n,0,0,v*16),p.sub(P,P,C),p.scale(P,P,T),p.floor(A,P),p.ceil(b,P),p.sub(_,P,A),p.sub(P,b,A),p.div(_,_,P);let[E,B,L]=A,[G,K,X]=b,[j,$,Z]=_,te=I(E,B,L)+c,W=I(G,B,L)+c,Y=I(E,B,X)+c,ie=I(G,B,X)+c,D=I(E,K,L)+c,F=I(G,K,L)+c,N=I(E,K,X)+c,oe=I(G,K,X)+c,se=(v*t+R)*l;for(let ce=0;ce<l;++ce){let he=o[te+ce],ve=o[W+ce],Ie=o[Y+ce],Pe=o[ie+ce],me=o[D+ce],fe=o[F+ce],pe=o[N+ce],Te=o[oe+ce],be=Qt(he,ve,j),Re=Qt(Ie,Pe,j),Ne=Qt(me,fe,j),Je=Qt(pe,Te,j),tt=Qt(be,Ne,$),Le=Qt(Re,Je,$);x[se+ce]=Qt(tt,Le,Z)}}return S}function GC(e){return e==="group"||e==="groupInstance"}function xh(e,t,r,n,o){if(!GC(e.dColorType.ref.value))return;let a=hh({vertexCount:e.uVertexCount.ref.value,instanceCount:e.uInstanceCount.ref.value,groupCount:e.uGroupCount.ref.value,transformBuffer:e.aTransform.ref.value,instanceBuffer:e.aInstance.ref.value,positionBuffer:e.aPosition.ref.value,groupBuffer:e.aGroup.ref.value,colorData:e.tColor.ref.value,colorType:e.dColorType.ref.value,boundingSphere:e.boundingSphere.ref.value,invariantBoundingSphere:e.invariantBoundingSphere.ref.value,itemSize:3},t,r,n,o);a.kind==="vertex"&&(Q.updateIfChanged(e.dColorType,a.type),Q.update(e.tColor,a.texture))}function wC(e){return e==="groupInstance"}function gh(e,t,r,n,o){if(!wC(e.dTransparencyType.ref.value))return;let a=hh({vertexCount:e.uVertexCount.ref.value,instanceCount:e.uInstanceCount.ref.value,groupCount:e.uGroupCount.ref.value,transformBuffer:e.aTransform.ref.value,instanceBuffer:e.aInstance.ref.value,positionBuffer:e.aPosition.ref.value,groupBuffer:e.aGroup.ref.value,colorData:e.tTransparency.ref.value,colorType:e.dTransparencyType.ref.value,boundingSphere:e.boundingSphere.ref.value,invariantBoundingSphere:e.invariantBoundingSphere.ref.value,itemSize:1},t,r,n,o);a.kind==="vertex"&&(Q.updateIfChanged(e.dTransparencyType,a.type),Q.update(e.tTransparency,a.texture))}var rr;(a=>{function e(i,s){i&&(i.state.visible=s)}a.setVisibility=e;function t(i,s){i&&(i.state.alphaFactor=s)}a.setAlphaFactor=t;function r(i,s,u,m,c){if(!i)return;let{tTransparency:l,dTransparencyType:d,transparencyAverage:y,dTransparency:S,uGroupCount:x,instanceCount:g,instanceGranularity:h}=i.values,f=h.ref.value?g.ref.value:x.ref.value*g.ref.value,C=h.ref.value?"instance":"groupInstance";oh(s.layers.length?f:0,C,i.values);let{array:T}=l.ref.value;m&&nh(T,0,f);for(let I=0,P=s.layers.length;I<P;++I){let{loci:A,value:b}=s.layers[I];u(A,v=>{let R=z.start(v),E=z.end(v);return rh(T,R,E,b)},!1)}if(Q.update(l,l.ref.value),Q.updateIfChanged(y,em(T,f)),Q.updateIfChanged(d,C),Q.updateIfChanged(S,s.layers.length>0),s.layers.length!==0&&C!=="instance"&&c&&fh(c.props)){let{geometry:I,props:P,webgl:A}=c;if(I.kind==="mesh"){let{resolution:b,transparencyTexture:_}=I.meta,v=Rs(P.smoothColors,!0,b);v&&(gh(i.values,v.resolution,v.stride,A,_),I.meta.transparencyTexture=i.values.tTransparencyGrid.ref.value)}}}a.setTransparency=r;function n(i,s,u,m){if(!i)return;let{tClipping:c,dClippingType:l,dClipping:d,uGroupCount:y,instanceCount:S,instanceGranularity:x}=i.values,g=x.ref.value?S.ref.value:y.ref.value*S.ref.value,{layers:h}=s,f=x.ref.value?"instance":"groupInstance";ch(h.length?g:0,f,i.values);let{array:C}=c.ref.value;m&&uh(C,0,g);for(let T=0,I=s.layers.length;T<I;++T){let{loci:P,groups:A}=s.layers[T];u(P,_=>{let v=z.start(_),R=z.end(_);return sh(C,v,R,A)},!1)}Q.update(c,c.ref.value),Q.updateIfChanged(l,f),Q.updateIfChanged(d,s.layers.length>0)}a.setClipping=n;function o(i,s,u){if(!i||!s&&!u)return;let{values:m}=i;s&&(re.copy(m.matrix.ref.value,s),Q.update(m.matrix,m.matrix.ref.value)),u?(m.extraTransform.ref.value.set(u),Q.update(m.extraTransform,m.extraTransform.ref.value)):u===null&&(Ms(m.extraTransform.ref.value,m.instanceCount.ref.value),Q.update(m.extraTransform,m.extraTransform.ref.value)),Jc(m);let c=Bs(m.invariantBoundingSphere.ref.value,m.aTransform.ref.value,m.instanceCount.ref.value);Q.update(m.boundingSphere,c)}a.setTransform=o})(rr||(rr={}));function NC(e,t){for(let r=0,n=t*3;r<n;r+=3){let o=e[r],a=e[r+1],i=e[r+2],s=1/Math.sqrt(o*o+a*a+i*i);e[r]=o*s,e[r+1]=a*s,e[r+2]=i*s}return e}var nr=p();function $i(e,t,r,n){for(let o=0,a=n*3;o<a;o+=3)p.fromArray(nr,t,r+o),p.transformMat4(nr,nr,e),p.toArray(nr,t,r+o)}function _h(e,t,r,n){for(let o=0,a=n*3;o<a;o+=3)p.fromArray(nr,t,r+o),p.transformMat3(nr,nr,e),p.toArray(nr,t,r+o)}function Ah(e,t){for(let r=0,n=e.length;r<n;r+=3)p.fromArray(nr,e,r),p.normalize(nr,nr),p.scale(nr,nr,t),p.toArray(nr,e,r)}var bh=p(),tm=p(),Sh=p(),Ar=p(),Ch=p();function Ih(e,t,r,n,o){for(let a=0,i=o*3;a<i;a+=3){let s=t[a]*3,u=t[a+1]*3,m=t[a+2]*3;p.fromArray(bh,e,s),p.fromArray(tm,e,u),p.fromArray(Sh,e,m),p.sub(Ar,Sh,tm),p.sub(Ch,bh,tm),p.cross(Ar,Ar,Ch),r[s]+=Ar[0],r[s+1]+=Ar[1],r[s+2]+=Ar[2],r[u]+=Ar[0],r[u+1]+=Ar[1],r[u+2]+=Ar[2],r[m]+=Ar[0],r[m+1]+=Ar[1],r[m+2]+=Ar[2]}return NC(r,n)}function xi(e,t,r=1){let n=qp(e),o=new Int32Array(n+2),a=new Int32Array(t),i=new Int32Array(t);for(let m=0,c=t*r;m<c;m+=r)++i[e[m]];let s=0;for(let m=0;m<t;m++)o[m]=s,s+=i[m];o[t]=s;let u=new Int32Array(s);for(let m=0,c=t*r;m<c;m+=r){let l=e[m],d=o[l]+a[l];u[d]=m,++a[l]}return{indices:u,offsets:o}}function vh(e,t,r,n){let o=OC(e,t,r,n);return r.palette?(Q.updateIfChanged(o.dUsePalette,!0),HC(r.palette,o.tPalette)):Q.updateIfChanged(o.dUsePalette,!1),o}function OC(e,t,r,n){switch(r.granularity){case"uniform":return zC(e,r.color,n);case"instance":return e.nonInstanceable?Ph(e,r.color,n):KC(e,r.color,n);case"group":return Ph(e,r.color,n);case"groupInstance":return jC(e,r.color,n);case"vertex":return QC(t,r.color,n);case"vertexInstance":return YC(t,r.color,n);case"volume":return Th(r.grid,"volume",n);case"volumeInstance":return Th(r.grid,"volumeInstance",n);case"direct":return XC(n)}}function HC(e,t){let r=!0,n=t.ref.value;if(e.colors.length!==n.width||n.filter!==e.filter)r=!1;else{let i=n.array,s=0;for(let u of e.colors){let[m,c,l]=rt.toRgb(u);if(i[s++]!==m||i[s++]!==c||i[s++]!==l){r=!1;break}}}if(r)return;let o=new Uint8Array(e.colors.length*3),a=0;for(let i of e.colors){let[s,u,m]=rt.toRgb(i);o[a++]=s,o[a++]=u,o[a++]=m}Q.update(t,{array:o,height:1,width:e.colors.length,filter:e.filter})}function qC(e,t){return t?(Q.update(t.uColor,rt.toVec3Normalized(t.uColor.ref.value,e)),Q.updateIfChanged(t.dColorType,"uniform"),t):{uColor:Q.create(rt.toVec3Normalized(p(),e)),tColor:Q.create({array:new Uint8Array(3),width:1,height:1}),tColorGrid:Q.create(Gr()),tPalette:Q.create({array:new Uint8Array(3),width:1,height:1}),dColorType:Q.create("uniform"),dUsePalette:Q.create(!1)}}function zC(e,t,r){return qC(t(Qo,!1),r)}function ea(e,t,r){return r?(Q.update(r.tColor,e),Q.updateIfChanged(r.dColorType,t),r):{uColor:Q.create(p()),tColor:Q.create(e),tColorGrid:Q.create(Gr()),tPalette:Q.create({array:new Uint8Array(3),width:1,height:1}),dColorType:Q.create(t),dUsePalette:Q.create(!1)}}function KC(e,t,r){let{instanceCount:n}=e,o=_r(Math.max(1,n),3,Uint8Array,r&&r.tColor.ref.value.array);for(e.reset();e.hasNext;){let{location:a,isSecondary:i,instanceIndex:s}=e.move();rt.toArray(t(a,i),o.array,s*3),e.skipInstance()}return ea(o,"instance",r)}function Ph(e,t,r){let{groupCount:n}=e,o=_r(Math.max(1,n),3,Uint8Array,r&&r.tColor.ref.value.array);for(e.reset();e.hasNext&&!e.isNextNewInstance;){let{location:a,isSecondary:i,groupIndex:s}=e.move();rt.toArray(t(a,i),o.array,s*3)}return ea(o,"group",r)}function jC(e,t,r){let{groupCount:n,instanceCount:o}=e,a=o*n,i=_r(Math.max(1,a),3,Uint8Array,r&&r.tColor.ref.value.array);for(e.reset();e.hasNext;){let{location:s,isSecondary:u,index:m}=e.move();rt.toArray(t(s,u),i.array,m*3)}return ea(i,"groupInstance",r)}function QC(e,t,r){let{groupCount:n,stride:o}=e,a=_r(Math.max(1,n),3,Uint8Array,r&&r.tColor.ref.value.array);for(e.reset(),e.voidInstances();e.hasNext&&!e.isNextNewInstance;){let{location:i,isSecondary:s,groupIndex:u}=e.move(),m=t(i,s);for(let c=0;c<o;++c)rt.toArray(m,a.array,(u+c)*3)}return ea(a,"vertex",r)}function YC(e,t,r){let{groupCount:n,instanceCount:o,stride:a}=e,i=o*n,s=_r(Math.max(1,i),3,Uint8Array,r&&r.tColor.ref.value.array);for(e.reset();e.hasNext;){let{location:u,isSecondary:m,index:c}=e.move(),l=t(u,m);for(let d=0;d<a;++d)rt.toArray(l,s.array,(c+d)*3)}return ea(s,"vertexInstance",r)}function Th(e,t,r){let{colors:n}=e;return r?(Q.update(r.tColorGrid,n),Q.updateIfChanged(r.dColorType,t),r):{uColor:Q.create(p()),tColor:Q.create({array:new Uint8Array(3),width:1,height:1}),tColorGrid:Q.create(n),tPalette:Q.create({array:new Uint8Array(3),width:1,height:1}),dColorType:Q.create(t),dUsePalette:Q.create(!1)}}function XC(e){return e?(Q.updateIfChanged(e.dColorType,"direct"),e):{uColor:Q.create(p()),tColor:Q.create({array:new Uint8Array(3),width:1,height:1}),tColorGrid:Q.create(Gr()),tPalette:Q.create({array:new Uint8Array(3),width:1,height:1}),dColorType:Q.create("direct"),dUsePalette:Q.create(!1)}}var Ze;(S=>{function e(x,g,h,f,C,T,I){return I?o(x,g,h,f,C,T,I):n(x,g,h,f,C,T)}S.create=e;function t(x){let g=x?x.vertexBuffer.ref.value:new Float32Array(0),h=x?x.indexBuffer.ref.value:new Uint32Array(0),f=x?x.normalBuffer.ref.value:new Float32Array(0),C=x?x.groupBuffer.ref.value:new Float32Array(0);return e(g,h,f,C,0,0,x)}S.createEmpty=t;function r(x){return hr([x.vertexCount,x.triangleCount,x.vertexBuffer.ref.version,x.indexBuffer.ref.version,x.normalBuffer.ref.version,x.groupBuffer.ref.version])}function n(x,g,h,f,C,T){let I=Se(),P,A=-1,b=-1,_={kind:"mesh",vertexCount:C,triangleCount:T,vertexBuffer:Q.create(x),indexBuffer:Q.create(g),normalBuffer:Q.create(h),groupBuffer:Q.create(f),varyingGroup:Q.create(!1),get boundingSphere(){let v=r(_);if(v!==A){let R=jo(_.vertexBuffer.ref.value,_.vertexCount,1);Se.copy(I,R),A=v}return I},get groupMapping(){return _.groupBuffer.ref.version!==b&&(P=xi(_.groupBuffer.ref.value,_.vertexCount),b=_.groupBuffer.ref.version),P},setBoundingSphere(v){Se.copy(I,v),A=r(_)},meta:{}};return _}function o(x,g,h,f,C,T,I){return I.vertexCount=C,I.triangleCount=T,Q.update(I.vertexBuffer,x),Q.update(I.indexBuffer,g),Q.update(I.normalBuffer,h),Q.update(I.groupBuffer,f),I}let a=gt();function i(x,g){let h=x.vertexBuffer.ref.value;if($i(g,h,0,x.vertexCount),!re.isTranslationAndUniformScaling(g)){let f=gt.directionTransform(a,g);_h(f,x.normalBuffer.ref.value,0,x.vertexCount)}Q.update(x.vertexBuffer,h)}S.transform=i;function s(x,g=!0){let{indexBuffer:h,vertexBuffer:f,groupBuffer:C,normalBuffer:T,triangleCount:I,vertexCount:P}=x,A=h.ref.value,b=f.ref.value,_=C.ref.value,v=T.ref.value,R=xe.create(Uint32Array,3,1024,I),E=xe.create(Float32Array,3,1024,b);E.currentIndex=P*3,E.elementCount=P;let B=xe.create(Float32Array,3,1024,v);B.currentIndex=P*3,B.elementCount=P;let L=xe.create(Float32Array,1,1024,_);L.currentIndex=P,L.elementCount=P;let G=p(),K=p(),X=p(),j=p(),$=p(),Z=p();function te(he){p.fromArray(G,b,he*3),p.fromArray(j,v,he*3),xe.add3(E,G[0],G[1],G[2]),xe.add3(B,j[0],j[1],j[2])}function W(he,ve){p.fromArray(G,b,he*3),p.fromArray(K,b,ve*3),p.scale(G,p.add(G,G,K),.5),p.fromArray(j,v,he*3),p.fromArray($,v,ve*3),p.scale(j,p.add(j,j,$),.5),xe.add3(E,G[0],G[1],G[2]),xe.add3(B,j[0],j[1],j[2])}function Y(he,ve,Ie){p.fromArray(G,b,he*3),p.fromArray(K,b,ve*3),p.fromArray(X,b,Ie*3),p.scale(G,p.add(G,p.add(G,G,K),X),1/3),p.fromArray(j,v,he*3),p.fromArray($,v,ve*3),p.fromArray(Z,v,Ie*3),p.scale(j,p.add(j,p.add(j,j,$),Z),1/3),xe.add3(E,G[0],G[1],G[2]),xe.add3(B,j[0],j[1],j[2])}function ie(he,ve,Ie,Pe,me){++F,te(he),W(he,ve),W(he,Ie),xe.add3(R,D,D+1,D+2);for(let fe=0;fe<3;++fe)xe.add(L,Pe);D+=3,F+=2,te(ve),te(Ie),W(he,ve),W(he,Ie),xe.add3(R,D,D+1,D+3),xe.add3(R,D,D+3,D+2);for(let fe=0;fe<4;++fe)xe.add(L,me);D+=4}let D=P,F=0;if(g)for(let he=0,ve=I;he<ve;++he){let Ie=A[he*3],Pe=A[he*3+1],me=A[he*3+2],fe=_[Ie],pe=_[Pe],Te=_[me];if(fe===pe&&fe===Te)++F,xe.add3(R,Ie,Pe,me);else if(fe===pe)ie(me,Ie,Pe,Te,fe);else if(fe===Te)ie(Pe,me,Ie,pe,Te);else if(pe===Te)ie(Ie,Pe,me,fe,pe);else{F+=2,te(Ie),W(Ie,Pe),W(Ie,me),Y(Ie,Pe,me),xe.add3(R,D,D+1,D+3),xe.add3(R,D,D+3,D+2);for(let be=0;be<4;++be)xe.add(L,fe);D+=4,F+=2,te(Pe),W(Pe,me),W(Pe,Ie),Y(Ie,Pe,me),xe.add3(R,D,D+1,D+3),xe.add3(R,D,D+3,D+2);for(let be=0;be<4;++be)xe.add(L,pe);D+=4,F+=2,te(me),W(me,Pe),W(me,Ie),Y(Ie,Pe,me),xe.add3(R,D+3,D+1,D),xe.add3(R,D+2,D+3,D);for(let be=0;be<4;++be)xe.add(L,Te);D+=4}}else for(let he=0,ve=I;he<ve;++he){let Ie=A[he*3],Pe=A[he*3+1],me=A[he*3+2],fe=_[Ie],pe=_[Pe],Te=_[me];if(fe!==pe||fe!==Te){++F,te(Ie),te(Pe),te(me),xe.add3(R,D,D+1,D+2);let be=pe===Te?pe:fe;for(let Re=0;Re<3;++Re)xe.add(L,be);D+=3}else++F,xe.add3(R,Ie,Pe,me)}let N=xe.compact(R),oe=xe.compact(E),se=xe.compact(B),ce=xe.compact(L);return x.vertexCount=D,x.triangleCount=F,Q.update(f,oe),Q.update(C,ce),Q.update(h,N),Q.update(T,se),x.meta.originalData={indexBuffer:A,vertexCount:P,triangleCount:I},x}S.uniformTriangleGroup=s,S.Params={...at.Params},S.Utils={Params:S.Params,createEmpty:t,createValues:l,createRenderableState:d,updateRenderableState:y,createPositionIterator:c};function c(x,g){let h=x.vertexCount,f=g.instanceCount.ref.value,C=lh(),T=C.position,I=x.vertexBuffer.ref.value,P=g.aTransform.ref.value;return At(h,f,1,(b,_)=>(_<0?p.fromArray(T,I,b*3):p.transformMat4Offset(T,I,P,0,b*3,_*16),C))}function l(x,g,h,f,C){let{instanceCount:T,groupCount:I}=h,P=c(x,g),A=vh(h,P,f.color),b=ih(),_=mh(),v={drawCount:x.triangleCount*3,vertexCount:x.vertexCount,groupCount:I,instanceCount:T},R=Se.clone(x.boundingSphere),E=Bs(R,g.aTransform.ref.value,T);return{dGeometryType:Q.create("mesh"),aPosition:x.vertexBuffer,aNormal:x.normalBuffer,aGroup:x.groupBuffer,elements:x.indexBuffer,boundingSphere:Q.create(E),invariantBoundingSphere:Q.create(R),uInvariantBoundingSphere:Q.create(fn.ofSphere(R)),...A,...b,..._,...g,...at.createValues(C,v)}}function d(x){let g=at.createRenderableState(x);return y(g,x),g}function y(x,g){at.updateRenderableState(x,g)}})(Ze||(Ze={}));var gi;(r=>{function e(n){return Ze.Utils}r.getUtils=e;function t(n,o){return o==="instance"&&n.nonInstanceable?"group":o}r.getGranularity=t})(gi||(gi={}));function Fs(e){return!!e&&e.kind==="every-loci"}var Us;(i=>{function e(s,u,m,c,l,d){return d?o(s,u,m,c,l,d):n(s,u,m,c,l)}i.create=e;function t(s){let u=s?s.centerBuffer.ref.value:new Float32Array(0),m=s?s.mappingBuffer.ref.value:new Float32Array(0),c=s?s.indexBuffer.ref.value:new Uint32Array(0),l=s?s.groupBuffer.ref.value:new Float32Array(0);return e(u,m,c,l,0,s)}i.createEmpty=t;function r(s){return hr([s.sphereCount,s.centerBuffer.ref.version,s.mappingBuffer.ref.version,s.indexBuffer.ref.version,s.groupBuffer.ref.version])}function n(s,u,m,c,l){let d=Se(),y,S=-1,x=-1,g={kind:"spheres",sphereCount:l,centerBuffer:Q.create(s),mappingBuffer:Q.create(u),indexBuffer:Q.create(m),groupBuffer:Q.create(c),get boundingSphere(){let h=r(g);if(h!==S){let f=jo(g.centerBuffer.ref.value,g.sphereCount*4,4);Se.copy(d,f),S=h}return d},get groupMapping(){return g.groupBuffer.ref.version!==x&&(y=xi(g.groupBuffer.ref.value,g.sphereCount,4),x=g.groupBuffer.ref.version),y},setBoundingSphere(h){Se.copy(d,h),S=r(g)}};return g}function o(s,u,m,c,l,d){return l>d.sphereCount&&(Q.update(d.mappingBuffer,u),Q.update(d.indexBuffer,m)),d.sphereCount=l,Q.update(d.centerBuffer,s),Q.update(d.groupBuffer,c),d}i.Params={...at.Params,sizeFactor:k.Numeric(1,{min:0,max:10,step:.1})}})(Us||(Us={}));var Ls;(s=>{function e(u,m,c,l,d,y,S,x,g){return g?o(u,m,c,l,d,y,S,x,g):n(u,m,c,l,d,y,S,x)}s.create=e;function t(u){let m=u?u.mappingBuffer.ref.value:new Float32Array(0),c=u?u.indexBuffer.ref.value:new Uint32Array(0),l=u?u.groupBuffer.ref.value:new Float32Array(0),d=u?u.startBuffer.ref.value:new Float32Array(0),y=u?u.endBuffer.ref.value:new Float32Array(0),S=u?u.scaleBuffer.ref.value:new Float32Array(0),x=u?u.capBuffer.ref.value:new Float32Array(0);return e(m,c,l,d,y,S,x,0,u)}s.createEmpty=t;function r(u){return hr([u.cylinderCount,u.mappingBuffer.ref.version,u.indexBuffer.ref.version,u.groupBuffer.ref.version,u.startBuffer.ref.version,u.endBuffer.ref.version,u.scaleBuffer.ref.version,u.capBuffer.ref.version])}function n(u,m,c,l,d,y,S,x){let g=Se(),h,f=-1,C=-1,T={kind:"cylinders",cylinderCount:x,mappingBuffer:Q.create(u),indexBuffer:Q.create(m),groupBuffer:Q.create(c),startBuffer:Q.create(l),endBuffer:Q.create(d),scaleBuffer:Q.create(y),capBuffer:Q.create(S),get boundingSphere(){let I=r(T);if(I!==f){let P=jo(T.startBuffer.ref.value,T.cylinderCount*6,6),A=jo(T.endBuffer.ref.value,T.cylinderCount*6,6);Se.expandBySphere(g,P,A),f=I}return g},get groupMapping(){return T.groupBuffer.ref.version!==C&&(h=xi(T.groupBuffer.ref.value,T.cylinderCount,6),C=T.groupBuffer.ref.version),h},setBoundingSphere(I){Se.copy(g,I),f=r(T)}};return T}function o(u,m,c,l,d,y,S,x,g){return x>g.cylinderCount&&(Q.update(g.mappingBuffer,u),Q.update(g.indexBuffer,m)),g.cylinderCount=x,Q.update(g.groupBuffer,c),Q.update(g.startBuffer,l),Q.update(g.endBuffer,d),Q.update(g.scaleBuffer,y),Q.update(g.capBuffer,S),g}function a(u,m){let c=u.startBuffer.ref.value;$i(m,c,0,u.cylinderCount*6),Q.update(u.startBuffer,c);let l=u.endBuffer.ref.value;$i(m,l,0,u.cylinderCount*6),Q.update(u.endBuffer,l)}s.transform=a,s.Params={...at.Params,sizeFactor:k.Numeric(1,{min:0,max:10,step:.1}),sizeAspectRatio:k.Numeric(1,{min:0,max:3,step:.01})}})(Ls||(Ls={}));var Vs;(o=>{class e{constructor(){this.index=0;this.textures=[]}get(){return this.textures[this.index]}set(i,s,u){this.textures[this.index]=Object.assign(this.textures[this.index]||{},{vertex:i,group:s,normal:u}),this.index=(this.index+1)%2}destroy(){for(let i of this.textures)i.vertex.destroy(),i.group.destroy(),i.normal.destroy()}}o.DoubleBuffer=e;function t(a,i,s,u,m,c,l){let d=s.getWidth(),y=s.getHeight();return l?(l.vertexCount=a,l.groupCount=i,Q.update(l.geoTextureDim,wt.set(l.geoTextureDim.ref.value,d,y)),Q.update(l.vertexTexture,s),Q.update(l.groupTexture,u),Q.update(l.normalTexture,m),l.doubleBuffer.set(s,u,m),Se.copy(l.boundingSphere,c),l):{kind:"texture-mesh",vertexCount:a,groupCount:i,geoTextureDim:Q.create(wt.create(d,y)),vertexTexture:Q.create(s),groupTexture:Q.create(u),normalTexture:Q.create(m),varyingGroup:Q.create(!1),doubleBuffer:new e,boundingSphere:Se.clone(c),meta:{}}}o.create=t;function r(a){let i=a?a.vertexTexture.ref.value:Gr(),s=a?a.groupTexture.ref.value:Gr(),u=a?a.normalTexture.ref.value:Gr(),m=a?a.boundingSphere:Se();return t(0,0,i,s,u,m,a)}o.createEmpty=r,o.Params={...at.Params}})(Vs||(Vs={}));function Dh(e,t,r){let{child:n}=e.structure,o=t&&n?e.group.units.filter(u=>n.unitMap.has(u.id)):e.group.units,a=o.length,i=a*16,s=r&&r.aTransform.ref.value.length>=i?r.aTransform.ref.value:new Float32Array(i);for(let u=0;u<a;u++)re.toArray(o[u].conformation.operator.matrix,s,u*16);return Zc(s,a,r)}var ZC={atomic:{},spheres:{},gaussians:{}},Mh=k.objectToOptions(ZC);function Eh(e,t){for(let r=0,n=e.length;r<n;++r)if(O.isAtomic(t)&&e[r]==="atomic"||O.isSpheres(t)&&e[r]==="spheres"||O.isGaussians(t)&&e[r]==="gaussians")return!0;return!1}var Bh=5e8;function WC(e,t,r=Bh){let n=Xe.size(p(),e);p.ceil(n,n),n.sort((s,u)=>u-s);let o=Math.floor(Math.cbrt(r)*Math.cbrt(r)),a=n[0]*n[1],i=Math.ceil(a/(t*t));return{area:a,areaCells:i,maxAreaCells:o}}function Rh(e,t,r=Bh){let{area:n,areaCells:o,maxAreaCells:a}=WC(e,t.resolution,r),i=o>a?Math.sqrt(n/a):t.resolution;return{...t,resolution:i}}function JC(e){switch(e.kind){case O.Kind.Atomic:return e.model.atomicConformation;case O.Kind.Spheres:return e.model.coarseConformation.spheres;case O.Kind.Gaussians:return e.model.coarseConformation.gaussians}}var rm={ignoreHydrogens:k.Boolean(!1),traceOnly:k.Boolean(!1),includeParent:k.Boolean(!1)},pk=k.getDefaultValues(rm),$C=p();function e3(e,t,r,n){return p.squaredDistance(p.set($C,e,t,r),n)}function t3(e,t,r){let n=0,o=t.length;for(let a=0,i=r.length;a<i;++a){let s=ee.indexOfInRange(t,r[a],n,o);s===-1?e[a]=-2:(e[a]=s,n=s)}}function Fh(e,t,r,n){let{ignoreHydrogens:o,traceOnly:a,includeParent:i}=n,s=i?e.root.unitMap.get(t.id):t,{x:u,y:m,z:c}=JC(s),{elements:l}=s,{center:d,radius:y}=t.boundary.sphere,S=(2+1.5)*2,x=(y+S)*(y+S),g,h;if(o||a||i&&s!==t){let P=[],A=[];for(let b=0,_=l.length;b<_;++b){let v=l[b];o&&ks(s,v)||a&&!nm(s,v)||i&&e3(u[v],m[v],c[v],d)>x||(P.push(v),A.push(b))}g=ee.ofSortedArray(P),h=A}else g=l,h=ro(new Int32Array(g.length));i&&s!==t&&t3(h,t.elements,g);let f={indices:g,x:u,y:m,z:c,id:h},C=t===s?t.boundary:Ho(f),T=le.Location.create(e,s);return{position:f,boundary:C,radius:P=>(T.element=P,r.size(T))}}var Uh=Na.H;function ks(e,t){return O.isCoarse(e)?!1:e.model.atomicHierarchy.derived.atom.atomicNumber[t]===Uh}function ta(e,t){return e[t]===Uh}function nm(e,t){if(O.isCoarse(e))return!0;let r=e.model.atomicHierarchy.atoms.label_atom_id.value(t);return r==="CA"||r==="BB"||r==="P"}function om(e){return k.MultiSelect(e,Mh)}var Mn={unitKinds:om(["atomic","spheres"]),includeParent:k.Boolean(!1,{isHidden:!0})},Gs={...Ze.Params},Lh={...Us.Params},ws={...Ls.Params},Ns={...Vs.Params};function r3(e,t,r,n){let{createValues:o,createRenderableState:a}=gi.getUtils(e),i=Es(),s=o(e,i,t,r,n),u=a(n);return Ds(e.kind,s,u)}function Vh(e,t){let{defaultProps:r,createGeometry:n,createLocationIterator:o,eachLocation:a,processValues:i,dispose:s}=e,{createPositionIterator:u}=e.geometryUtils,m=ao.create(),c,l,d,y,S=Object.assign({},r),x=lr.createEmpty(),g,h,f=-1,C;function T(v,R,E){if(!E&&!g)throw new Error("missing structure");if(l=Object.assign({},S,R),d=v,y=E,ao.reset(m),!c||!g)m.createNew=!0,m.createGeometry=!0;else throw new Error("")}function I(v){if(m.createNew)if(C=o(y),v)c=r3(v,C,d,l),u(v,c.values);else throw new Error("expected geometry to be given");else throw new Error("");S=l,x=d,g=y,v&&(h=v,f+=1)}function P(v){return!!(Fs(v)||Ce.isLoci(v)&&Ce.areRootsEquivalent(v.structure,g)||le.Loci.is(v)&&Ce.areRootsEquivalent(v.structure,g)&&le.Loci.isWholeStructure(v))}function A(v,R,E){let B=!1;return!le.Loci.is(v)&&!Qe.isLoci(v)||!Ce.areEquivalent(v.structure,R)?!1:(E(z.ofSingleton(0))&&(B=!0),B)}function b(v,R,E){return P(v)?S.instanceGranularity?R(z.ofBounds(0,C.instanceCount)):R(z.ofBounds(0,C.groupCount*C.instanceCount)):S.instanceGranularity?A(v,g,R):a(v,g,R,E)}function _(v){c&&(i==null||i(c.values,h,S,x,v.webgl))}return{get groupCount(){return C?C.count:0},get renderObject(){return C&&C.count?c:void 0},get geometryVersion(){return f},createOrUpdate(v,R,E={},B){if(T(R,E,B||g),m.createGeometry){let L=n(v,y,d,l,h);I(L),_(v)}else I();_(v)},setVisibility(v){rr.setVisibility(c,v)},setAlphaFactor(v){rr.setAlphaFactor(c,v)},setTransform(v,R){rr.setTransform(c,v,R)},setTransparency(v,R){let E={geometry:h,props:S,webgl:R};rr.setTransparency(c,v,b,!0,E)},setClipping(v){rr.setClipping(c,v,b,!0)},destroy(){s==null||s(h),c&&(c.state.disposed=!0,c=void 0)}}}var bi={...Gs,...Mn};function En(e,t){return Vh({...e,setUpdateState:(r,n,o,a,i,s,u)=>{e.setUpdateState(r,n,o,a,i,s,u),nn.areEqual(a.size,i.size)||(r.createGeometry=!0)},geometryUtils:Ze.Utils},t)}var kh={...ws,...Mn},Gh={...Ns,...Mn};function an(e,t,r,n){let{webgl:o}=t,a=vs(),i=[],s=new Gt.GeometryState,u=tr.create(),m=new Map,c,l,d,y,S=lr.createEmpty();function x(C={},T){if(T&&T!==c&&(d=r(t,T),y||(y=k.getDefaultValues(d))),y=Object.assign({},y,C),!T||c)throw new Error("");l=T.unitSymmetryGroups;for(let I=0;I<l.length;I++){let P=l[I],A=n(a,T,y,o);A.createOrUpdate({webgl:o},S,y,{group:P,structure:T}),g(A,P,u),m.set(P.hashCode,{visual:A,group:P})}i.length=0,m.forEach(({visual:I})=>{I.renderObject&&(i.push(I.renderObject),s.add(I.renderObject.id,I.geometryVersion))}),s.snapshot(),c=T}function g(C,T,I){let{visible:P,alphaFactor:A,transparency:b,clipping:_,transform:v,unitTransforms:R}=I;P!==void 0&&C.setVisibility(P),A!==void 0&&C.setAlphaFactor(A),b!==void 0&&C.setTransparency(b,o),_!==void 0&&C.setClipping(_),v!==void 0&&C.setTransform(v),R!==void 0&&(R?C.setTransform(void 0,R.getSymmetryGroupTransforms(T)):C.setTransform(void 0,null))}function h(C){let{visible:T,alphaFactor:I,transparency:P,clipping:A,transform:b,unitTransforms:_}=C,v={};T!==u.visible&&(v.visible=T),I!==u.alphaFactor&&(v.alphaFactor=I),P!==void 0&&c&&(v.transparency=vn.remap(P,c)),A!==void 0&&c&&(v.clipping=Dn.remap(A,c)),b!==void 0&&!re.areEqual(b,u.transform,1e-6)&&(v.transform=b),(_!==u.unitTransforms||(_==null?void 0:_.version)!==C.unitTransformsVersion)&&(v.unitTransforms=_,u.unitTransformsVersion=_?_==null?void 0:_.version:-1),m.forEach(({visual:R,group:E})=>g(R,E,v)),tr.update(u,v)}function f(C){S=C}return{get groupCount(){let C=0;return m.forEach(({visual:T})=>{T.renderObject&&(C+=T.groupCount)}),C},get geometryVersion(){return s.version},get props(){return y},get params(){return d},get state(){return u},get theme(){return S},renderObjects:i,createOrUpdate:x,setState:h,setTheme:f}}function n3(e,t,r,n,o){let{createValues:a,createRenderableState:i}=gi.getUtils(t),s=Dh(e,o.includeParent),u=a(t,s,r,n,o),m=i(o);return Ds(t.kind,u,m)}function wh(e,t){let{defaultProps:r,createGeometry:n,createLocationIterator:o,eachLocation:a,setUpdateState:i,processValues:s,dispose:u}=e,{createEmpty:m,createPositionIterator:c}=e.geometryUtils,l=ao.create(),d,y=Object.assign({},r),S=lr.createEmpty(),x,g,h,f,C,T=-1,I;function P(B,L,G){if(!G&&!f)throw new Error("missing structureGroup");if(y=L,S=B,x=G,ao.reset(l),!d||!f){l.createNew=!0,l.createGeometry=!0;return}i(l,y,g,S,h,x,f),Ce.areHierarchiesEqual(f.structure,x.structure)||(l.updateTransform=!0,l.updateColor=!0,l.updateSize=!0),io.areEqual(S.color,h.color)||(l.updateColor=!0),f.structure.child!==x.structure.child&&(l.createGeometry=!0),y.instanceGranularity!==g.instanceGranularity&&(l.updateTransform=!0),Wn(y.unitKinds,g.unitKinds)||(l.createGeometry=!0),x.group.transformHash!==f.group.transformHash&&(x.group.units.length!==f.group.units.length||l.updateColor?l.updateTransform=!0:l.updateMatrix=!0);let K=x.group.units[0],X=f.group.units[0];O.areOperatorsEqual(K,X)||(l.updateTransform=!0),O.areConformationsEqual(K,X)||(l.createGeometry=!0),l.updateTransform&&(l.updateMatrix=!0),l.updateSize&&!("uSize"in d.values)&&(l.createGeometry=!0),(l.createGeometry||l.updateTransform)&&(f.structure.hashCode!==x.structure.hashCode&&(l.updateColor=!0,l.updateSize=!0),(S.color.granularity.startsWith("vertex")||d.values.dColorType.ref.value.startsWith("vertex")||S.color.granularity.startsWith("volume")||d.values.dColorType.ref.value.startsWith("volume"))&&(l.updateColor=!0))}function A(B){if(l.createNew)if(I=o(x),B)d=n3(x,B,I,S,y),c(B,d.values);else throw new Error("expected geometry to be given");else throw new Error("");g=y,h=S,f=x,B&&(C=B,T+=1)}function b(B,L,G,K,X,j){return Eh(X.unitKinds,L)?n(B,L,G,K,X,j):m(j)}function _(B){return!!(Fs(B)||Ce.isLoci(B)&&Ce.areRootsEquivalent(B.structure,f.structure)||le.Loci.is(B)&&Ce.areRootsEquivalent(B.structure,f.structure)&&le.Loci.isWholeStructure(B))}function v(B,L,G){let K=!1;if(Qe.isLoci(B)){let{structure:X,group:j}=L;if(!Ce.areEquivalent(B.structure,X))return!1;for(let $ of B.bonds){if($.aUnit!==$.bUnit)continue;let Z=j.unitIndexMap.get($.aUnit.id);Z!==void 0&&G(z.ofSingleton(Z))&&(K=!0)}}else if(le.Loci.is(B)){let{structure:X,group:j}=L;if(!Ce.areEquivalent(B.structure,X))return!1;for(let $ of B.elements){let Z=j.unitIndexMap.get($.unit.id);Z!==void 0&&G(z.ofSingleton(Z))&&(K=!0)}}return K}function R(B,L,G){return _(B)?g.instanceGranularity?L(z.ofBounds(0,I.instanceCount)):L(z.ofBounds(0,I.groupCount*I.instanceCount)):g.instanceGranularity?v(B,f,L):a(B,f,L,G)}function E(B){d&&(s==null||s(d.values,C,g,h,B.webgl))}return{get groupCount(){return I?I.count:0},get renderObject(){return I&&I.count?d:void 0},get geometryVersion(){return T},createOrUpdate(B,L,G,K){if(P(L,G,K||f),l.createGeometry){let X=b(B,x.group.units[0],x.structure,S,y,C);A(X),E(B)}else A();E(B)},setVisibility(B){rr.setVisibility(d,B)},setAlphaFactor(B){rr.setAlphaFactor(d,B)},setTransform(B,L){rr.setTransform(d,B,L)},setTransparency(B,L){let G={geometry:C,props:g,webgl:L};rr.setTransparency(d,B,R,!0,G)},setClipping(B){rr.setClipping(d,B,R,!0)},destroy(){u==null||u(C),d&&(d.state.disposed=!0,d=void 0)}}}var zt={...Gs,...Mn};function Ir(e,t){return wh({...e,setUpdateState:(r,n,o,a,i,s,u)=>{e.setUpdateState(r,n,o,a,i,s,u),nn.areEqual(a.size,i.size)||(r.createGeometry=!0)},geometryUtils:Ze.Utils},t)}var Nh={...Lh,...Mn},Oh={...ws,...Mn},Hh={...Ns,...Mn};var tr={create:()=>({...Gt.createState(),unitTransforms:null,unitTransformsVersion:-1}),update:(e,t)=>{Gt.updateState(e,t),t.unitTransforms!==void 0&&(e.unitTransforms=t.unitTransforms)}};var ft=p(),qh=gt(),Os=p(),ra=p(),Yo=p(),Hs=p(),wr=p.fromArray,o3=p.triangleNormal,zh=p.copy,Kh=p.transformMat4,jh=p.transformMat3,Qh=gt.directionTransform,Nr=xe.add3,im=xe.add,Ve;(u=>{function e(m=2048,c=1024,l){return{currentGroup:-1,vertices:xe.create(Float32Array,3,c,l?l.vertexBuffer.ref.value:m),normals:xe.create(Float32Array,3,c,l?l.normalBuffer.ref.value:m),indices:xe.create(Uint32Array,3,c*3,l?l.indexBuffer.ref.value:m*3),groups:xe.create(Float32Array,1,c,l?l.groupBuffer.ref.value:m),mesh:l}}u.createState=e;function t(m,c,l,d){let{vertices:y,normals:S,indices:x,groups:g,currentGroup:h}=m,f=y.elementCount;Nr(y,c[0],c[1],c[2]),Nr(y,l[0],l[1],l[2]),Nr(y,d[0],d[1],d[2]),o3(ft,c,l,d);for(let C=0;C<3;++C)Nr(S,ft[0],ft[1],ft[2]),im(g,h);Nr(x,f,f+1,f+2)}u.addTriangle=t;function r(m,c,l){wr(Yo,c,l[0]*3),wr(Hs,c,l[1]*3);for(let d=2,y=l.length;d<y;d+=2)zh(Os,Yo),zh(ra,Hs),wr(Yo,c,l[d]*3),wr(Hs,c,l[d+1]*3),t(m,Os,ra,Yo),t(m,ra,Hs,Yo)}u.addTriangleStrip=r;function n(m,c,l){wr(Os,c,l[0]*3);for(let d=2,y=l.length;d<y;++d)wr(ra,c,l[d-1]*3),wr(Yo,c,l[d]*3),t(m,Os,Yo,ra)}u.addTriangleFan=n;function o(m,c,l){let{vertices:d,normals:y,indices:S}=l,{vertices:x,normals:g,indices:h,groups:f,currentGroup:C}=m,T=x.elementCount,I=Qh(qh,c);for(let P=0,A=d.length;P<A;P+=3)Kh(ft,wr(ft,d,P),c),Nr(x,ft[0],ft[1],ft[2]),jh(ft,wr(ft,y,P),I),Nr(g,ft[0],ft[1],ft[2]),im(f,C);for(let P=0,A=S.length;P<A;P+=3)Nr(h,S[P]+T,S[P+1]+T,S[P+2]+T)}u.addPrimitive=o;function a(m,c,l){let{vertices:d,normals:y,indices:S}=l,{vertices:x,normals:g,indices:h,groups:f,currentGroup:C}=m,T=x.elementCount,I=Qh(qh,c);for(let P=0,A=d.length;P<A;P+=3)Kh(ft,wr(ft,d,P),c),Nr(x,ft[0],ft[1],ft[2]),jh(ft,wr(ft,y,P),I),Nr(g,-ft[0],-ft[1],-ft[2]),im(f,C);for(let P=0,A=S.length;P<A;P+=3)Nr(h,S[P+2]+T,S[P+1]+T,S[P]+T)}u.addPrimitiveFlipped=a;function i(m,c,l){o(m,c,{vertices:l.vertexBuffer.ref.value.subarray(0,l.vertexCount*3),normals:l.normalBuffer.ref.value.subarray(0,l.vertexCount*3),indices:l.indexBuffer.ref.value.subarray(0,l.triangleCount*3)})}u.addMesh=i;function s(m){let{vertices:c,normals:l,indices:d,groups:y,mesh:S}=m,x=xe.compact(c,!0),g=xe.compact(d,!0),h=xe.compact(l,!0),f=xe.compact(y,!0);return Ze.create(x,g,h,f,m.vertices.elementCount,m.indices.elementCount,S)}u.getMesh=s})(Ve||(Ve={}));var Yh=p(),Xh=p(),Zh=p();function Xo(e,t){let r=t.length,n=Bn(r/3);for(let o=0;o<r;o+=3)p.fromArray(Yh,e,t[o]*3),p.fromArray(Xh,e,t[o+1]*3),p.fromArray(Zh,e,t[o+2]*3),n.add(Yh,Xh,Zh);return n.getPrimitive()}var qs=p();function Bn(e,t){t===void 0&&(t=e*3);let r=new Float32Array(t*3),n=new Float32Array(t*3),o=new Uint32Array(e*3),a=0,i=0;return{add:(s,u,m)=>{p.toArray(s,r,a),p.toArray(u,r,a+3),p.toArray(m,r,a+6),p.triangleNormal(qs,s,u,m);for(let c=0;c<3;++c)p.toArray(qs,n,a+3*c),o[i+c]=a/3+c;a+=9,i+=3},addQuad:(s,u,m,c)=>{p.toArray(s,r,a),p.toArray(u,r,a+3),p.toArray(m,r,a+6),p.toArray(c,r,a+9),p.triangleNormal(qs,s,u,m);for(let d=0;d<4;++d)p.toArray(qs,n,a+3*d);let l=a/3;o[i]=l,o[i+1]=l+1,o[i+2]=l+2,o[i+3]=l+2,o[i+4]=l+3,o[i+5]=l,a+=12,i+=6},getPrimitive:()=>({vertices:r,normals:n,indices:o})}}var Si=p(),i3=gt();function Wh(e,t){let{vertices:r,normals:n}=e,o=gt.directionTransform(i3,t);for(let a=0,i=r.length;a<i;a+=3)p.transformMat4(Si,p.fromArray(Si,r,a),t),p.toArray(Si,r,a),p.transformMat3(Si,p.fromArray(Si,n,a),o),p.toArray(Si,n,a);return e}var Or={radiusTop:1,radiusBottom:1,height:1,radialSegments:8,heightSegments:1,topCap:!1,bottomCap:!1,thetaStart:0,thetaLength:Math.PI*2};function Jh(e){let{radiusTop:t,radiusBottom:r,height:n,radialSegments:o,heightSegments:a,topCap:i,bottomCap:s,thetaStart:u,thetaLength:m}={...Or,...e},c=[],l=[],d=[],y=0,S=[],x=n/2;return g(),i&&t>0&&h(!0),s&&r>0&&h(!1),{vertices:new Float32Array(l),normals:new Float32Array(d),indices:new Uint32Array(c)};function g(){let f=p.zero(),C=(r-t)/n;for(let T=0;T<=a;++T){let I=[],P=T/a,A=P*(r-t)+t;for(let b=0;b<=o;++b){let v=b/o*m+u,R=Math.sin(v),E=Math.cos(v);l.push(A*R,-P*n+x,A*E),p.normalize(f,p.set(f,R,C,E)),d.push(...f),I.push(y++)}S.push(I)}for(let T=0;T<o;++T)for(let I=0;I<a;++I){let P=S[I][T],A=S[I+1][T],b=S[I+1][T+1],_=S[I][T+1];c.push(P,A,_),c.push(A,b,_)}}function h(f){let C=f===!0?t:r,T=f===!0?1:-1,I=y;for(let A=1;A<=o;++A)l.push(0,x*T,0),d.push(0,T,0),++y;let P=y;for(let A=0;A<=o;++A){let _=A/o*m+u,v=Math.cos(_),R=Math.sin(_);l.push(C*R,x*T,C*v),d.push(0,T,0),++y}for(let A=0;A<o;++A){let b=I+A,_=P+A;f===!0?c.push(_,_+1,b):c.push(_+1,_,b)}}}function dr(e,t,r=-1){let n=new Float32Array(e*3),o=r===-1?e<=4?Math.sqrt(2)/2:.6:r,a=t?1:0;for(let i=0,s=e;i<s;++i){let u=(i*2+a)/e*Math.PI;n[i*3]=Math.cos(u)*o,n[i*3+1]=Math.sin(u)*o,n[i*3+2]=0}return n}var $h=p(),e1=p(),or=p(),ir=p(),sn=p(),Ci=p(),a3={height:1,topCap:!0,bottomCap:!0};function Zo(e,t){let r=e.length/3,{height:n,topCap:o,bottomCap:a}={...a3,...t},i=r*2,s=r*4,u=(o?1:0)+(a?1:0);r===3?(i+=u,s+=u*3):r===4?(i+=u*2,s+=u*4):(i+=u*r,s+=u*r*3);let m=Bn(i,s),c=n*.5;p.set($h,0,0,-c),p.set(e1,0,0,c);for(let l=0;l<r;++l){let d=(l+1)%r;p.set(or,e[l*3],e[l*3+1],-c),p.set(ir,e[d*3],e[d*3+1],-c),p.set(sn,e[d*3],e[d*3+1],c),p.set(Ci,e[l*3],e[l*3+1],c),m.addQuad(or,ir,sn,Ci)}if(r===3)o&&(p.set(or,e[0],e[1],-c),p.set(ir,e[3],e[4],-c),p.set(sn,e[6],e[7],-c),m.add(sn,ir,or)),a&&(p.set(or,e[0],e[1],c),p.set(ir,e[3],e[4],c),p.set(sn,e[6],e[7],c),m.add(or,ir,sn));else if(r===4)o&&(p.set(or,e[0],e[1],-c),p.set(ir,e[3],e[4],-c),p.set(sn,e[6],e[7],-c),p.set(Ci,e[9],e[10],-c),m.addQuad(Ci,sn,ir,or)),a&&(p.set(or,e[0],e[1],c),p.set(ir,e[3],e[4],c),p.set(sn,e[6],e[7],c),p.set(Ci,e[9],e[10],c),m.addQuad(or,ir,sn,Ci));else for(let l=0;l<r;++l){let d=(l+1)%r;o&&(p.set(or,e[l*3],e[l*3+1],-c),p.set(ir,e[d*3],e[d*3+1],-c),m.add($h,ir,or)),a&&(p.set(or,e[l*3],e[l*3+1],c),p.set(ir,e[d*3],e[d*3+1],c),m.add(or,ir,e1))}return m.getPrimitive()}var am;function t1(){return am||(am=Zo(dr(4,!1))),am}var sm;function r1(){return sm||(sm=Zo(dr(5,!1))),sm}var um;function n1(){return um||(um=Zo(dr(6,!1))),um}var cm;function o1(){return cm||(cm=Zo(dr(6,!0))),cm}var mm;function i1(){return mm||(mm=Zo(dr(7,!1))),mm}var a1=new Map,s1=p.create(0,1,0),cn=p(),zs=p(),u1=p(),co=re(),c1=re(),m1=p(),_i=p(),lm=p();function Ks(e,t,r,n,o){return p.setMagnitude(zs,r,n/2),p.add(u1,t,zs),o?p.matchDirection(lm,s1,zs):p.copy(lm,s1),p.set(m1,1,n,1),p.makeRotation(c1,lm,zs),re.scale(e,c1,m1),re.setTranslation(e,u1)}var un=new Int32Array(9);function s3(e){var t,r,n,o,a,i,s,u,m;return un[0]=Math.round(1e3*((t=e.radiusTop)!=null?t:Or.radiusTop)),un[1]=Math.round(1e3*((r=e.radiusBottom)!=null?r:Or.radiusBottom)),un[2]=Math.round(1e3*((n=e.height)!=null?n:Or.height)),un[3]=(o=e.radialSegments)!=null?o:Or.radialSegments,un[4]=(a=e.heightSegments)!=null?a:Or.heightSegments,un[5]=((i=e.topCap)!=null?i:Or.topCap)?1:0,un[6]=((s=e.bottomCap)!=null?s:Or.bottomCap)?1:0,un[7]=Math.round(1e3*((u=e.thetaStart)!=null?u:Or.thetaStart)),un[8]=Math.round(1e3*((m=e.thetaLength)!=null?m:Or.thetaLength)),hr(un)}function dm(e){let t=s3(e),r=a1.get(t);if(r===void 0){if(e.radialSegments&&e.radialSegments<=4){let n=Math.max(3,e.radialSegments),o=Zo(dr(n,!0,e.radiusTop),e);r=Wh(o,re.rotX90)}else r=Jh(e);a1.set(t,r)}return r}function Hr(e,t,r,n,o){let a=p.distance(t,r)*n;p.sub(cn,r,t),Ks(co,t,cn,a,!0),Ve.addPrimitive(e,co,dm(o))}function l1(e,t,r,n,o,a){let i=p.distance(t,r)*n,s=dm(a);p.sub(cn,r,t),p.add(_i,t,o),Ks(co,_i,cn,i,!0),Ve.addPrimitive(e,co,s),p.sub(_i,t,o),Ks(co,_i,cn,i,!0),Ve.addPrimitive(e,co,s)}function Wo(e,t,r,n,o,a){let i=Math.floor(o/2),s=1/o;if(n<1){let c=n/2/o;n+=o%2===1?c:-c}let u=p.distance(t,r)*n,m=dm(a);p.sub(cn,r,t);for(let c=0;c<i;++c){let l=s*(c*2+1);p.setMagnitude(cn,cn,u*l),p.add(_i,t,cn),Ks(co,_i,cn,u*s,!1),Ve.addPrimitive(e,co,m)}}var u3={radius:1,detail:0};function d1(e,t,r){let{radius:n,detail:o}={...u3,...r},a=c3(),{vertices:i,indices:s}=a;m(o),Ah(i,n);let u=new Float32Array(i.length);return Ih(i,s,u,i.length/3,s.length/3),{vertices:new Float32Array(i),normals:new Float32Array(u),indices:new Uint32Array(s)};function m(l){let d=p(),y=p(),S=p();for(let x=0;x<t.length;x+=3)p.fromArray(d,e,t[x+0]*3),p.fromArray(y,e,t[x+1]*3),p.fromArray(S,e,t[x+2]*3),c(d,y,S,l)}function c(l,d,y,S){let x=Math.pow(2,S),g=[];for(let h=0;h<=x;++h){g[h]=[];let f=p();p.lerp(f,l,y,h/x);let C=p();p.lerp(C,d,y,h/x);let T=x-h;for(let I=0;I<=T;++I)if(I===0&&h===x)g[h][I]=f;else{let P=p();p.lerp(P,f,C,I/T),g[h][I]=P}}for(let h=0;h<x;++h)for(let f=0;f<2*(x-h)-1;++f){let C=Math.floor(f/2);f%2===0?a.add(g[h][C+1],g[h+1][C],g[h][C]):a.add(g[h][C+1],g[h+1][C+1],g[h+1][C])}}}function c3(){let e=[],t=[],r=new Map;function n(o){let a=`${o[0].toFixed(5)}|${o[1].toFixed(5)}|${o[2].toFixed(5)}`,i=r.get(a);return i===void 0&&(i=e.length/3,r.set(a,i),e.push(...o)),i}return{vertices:e,indices:t,add:(o,a,i)=>{t.push(n(o),n(a),n(i))}}}var Pr=(1+Math.sqrt(5))/2,m3=[-1,Pr,0,1,Pr,0,-1,-Pr,0,1,-Pr,0,0,-1,Pr,0,1,Pr,0,-1,-Pr,0,1,-Pr,Pr,0,-1,Pr,0,1,-Pr,0,-1,-Pr,0,1],l3=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],pm;function p1(){return pm||(pm=Xo(m3,l3)),pm}var{vertices:d3,indices:p3}=p1();function f1(e){return 10*Math.pow(Math.pow(2,e),2)+2}function y1(e){return d1(d3,p3,{detail:e,radius:1})}var h1=new Map,f3=re.identity();function y3(e,t,r){return re.scaleUniformly(e,re.fromTranslation(e,t),r)}function h3(e){let t=h1.get(e);return t===void 0&&(t=y1(e),h1.set(e,t)),t}function Rn(e,t,r,n){Ve.addPrimitive(e,y3(f3,t,r),h3(n))}function x1(e,t){switch(t.kind){case O.Kind.Atomic:return new ym(e,t);case O.Kind.Spheres:case O.Kind.Gaussians:return new hm(e,t)}}function g1(e,t){return{centerA:le.Location.create(e,t),centerB:le.Location.create(e,t)}}var ym=class{constructor(t,r){this.unit=r;this.hasNext=!1;this.traceElementIndex=r.model.atomicHierarchy.derived.residue.traceElementIndex,this.gapIt=ct.transientSegments(xm(r),r.elements),this.value=g1(t,r),this.hasNext=this.gapIt.hasNext}move(){let{elements:t,residueIndex:r}=this.unit,n=this.gapIt.move();return this.value.centerA.element=this.traceElementIndex[r[t[n.start]]],this.value.centerB.element=this.traceElementIndex[r[t[n.end-1]]],this.hasNext=this.gapIt.hasNext,this.value}},hm=class{constructor(t,r){this.unit=r;this.hasNext=!1;this.gapIt=ct.transientSegments(xm(r),r.elements),this.value=g1(t,r),this.hasNext=this.gapIt.hasNext}move(){let t=this.gapIt.move();return this.value.centerA.element=this.unit.elements[t.start],this.value.centerB.element=this.unit.elements[t.end-1],this.hasNext=this.gapIt.hasNext,this.value}};function b1(e){let{x:t,y:r,z:n}=e.atomicConformation,{polymerType:o,traceElementIndex:a}=e.atomicHierarchy.derived.residue,i=o.length,s=Ae.ofBounds(0,e.atomicConformation.atomId.rowCount),u=ct.transientSegments(e.atomicRanges.polymerRanges,s),m=Ue.transientSegments(e.atomicHierarchy.residueAtomSegments,s),c=new Float32Array(i*3),l=new Float32Array(i*3),d=0,y=-1,S=-1,x=p(),g=p(),h=p(),f=p(),C=p(),T=p(),I=p(),P=p(),A=p(),b=p(),_=p(),v=p(),R=p(),E=p();for(;u.hasNext;){let B=u.move();for(m.setSegment(B),d=-1,S=-1;m.hasNext;){d+=1;let{index:$}=m.move();d===0&&(S=$),y=$-2;let Z=y*3;p.copy(x,g),p.copy(g,h),p.copy(h,f);let te=a[$];if(p.set(f,t[te],r[te],n[te]),d<3)continue;p.sub(C,g,x),p.sub(T,h,g),p.sub(I,f,h),p.sub(_,C,T),p.sub(v,T,I),p.cross(R,_,v),p.normalize(R,R),p.toArray(R,l,Z);let W=Math.cos(p.angle(_,v)),Y=p.magnitude(_),ie=p.magnitude(v),D=Math.sqrt(ie*Y)/Math.max(2,2*(1-W));p.scale(P,_,D/Y),p.sub(P,g,P),p.toArray(P,c,Z),p.scale(A,v,D/ie),p.sub(A,h,A),p.toArray(A,c,Z+3),p.copy(E,R)}let L=S*3;p.fromArray(P,c,L+3),p.fromArray(A,c,L+6),p.normalize(R,p.sub(R,P,A));let G=a[S];p.set(x,t[G],r[G],n[G]),p.copy(b,x),p.projectPointOnVector(b,b,R,P),p.toArray(b,c,L);let K=y+2,X=K*3;p.fromArray(P,c,X-3),p.fromArray(A,c,X-6),p.normalize(R,p.sub(R,P,A));let j=a[K];p.set(x,t[j],r[j],n[j]),p.copy(b,x),p.projectPointOnVector(b,b,R,P),p.toArray(b,c,X)}return{centers:c}}var na=wo.createProvider({descriptor:{name:"molstar_helix_orientation"},type:"dynamic",defaultParams:{},getParams:()=>({}),isApplicable:e=>!0,obtain:e=>({value:b1(e)})});function qr(e){return ke.is(e,ke.Flag.Helix)}function x3(e){return ke.is(e,ke.Flag.Beta)}function S1(e,t,r={}){switch(e.kind){case O.Kind.Atomic:return new gm(e,t,r);case O.Kind.Spheres:case O.Kind.Gaussians:return new bm(e,t)}}var Ys=ke.create(ke.Flag.NA);function C1(e,t){return{center:le.Location.create(e,t),centerPrev:le.Location.create(e,t),centerNext:le.Location.create(e,t),first:!1,last:!1,initial:!1,final:!1,secStrucFirst:!1,secStrucLast:!1,secStrucType:Ys,moleculeType:0,coarseBackboneFirst:!1,coarseBackboneLast:!1,isCoarseBackbone:!1,p0:p(),p1:p(),p2:p(),p3:p(),p4:p(),d12:p(),d23:p()}}var De=p(),js=p(),Qs=p(),gm=class{constructor(t,r,n={}){this.unit=t;this.state=0;this.p0=p();this.p1=p();this.p2=p();this.p3=p();this.p4=p();this.p5=p();this.p6=p();this.d01=p();this.d12=p();this.d23=p();this.d34=p();this.hasNext=!1;var o;if(this.atomicConformation=t.model.atomicConformation,this.residueAtomSegments=t.model.atomicHierarchy.residueAtomSegments,this.polymerRanges=t.model.atomicRanges.polymerRanges,this.traceElementIndex=t.model.atomicHierarchy.derived.residue.traceElementIndex,this.directionFromElementIndex=t.model.atomicHierarchy.derived.residue.directionFromElementIndex,this.directionToElementIndex=t.model.atomicHierarchy.derived.residue.directionToElementIndex,this.moleculeType=t.model.atomicHierarchy.derived.residue.moleculeType,this.cyclicPolymerMap=t.model.atomicRanges.cyclicPolymerMap,this.polymerIt=ct.transientSegments(this.polymerRanges,t.elements),this.residueIt=Ue.transientSegments(this.residueAtomSegments,t.elements),this.value=C1(r,t),this.hasNext=this.residueIt.hasNext&&this.polymerIt.hasNext,n.ignoreSecondaryStructure||(this.secondaryStructure=(o=rn.get(r).value)==null?void 0:o.get(t.invariantId)),n.useHelixOrientation){let a=na.get(t.model).value;if(!a)throw new Error("missing helix-orientation");this.helixOrientationCenters=a.centers}}atomicPos(t,r){r!==-1&&(t[0]=this.atomicConformation.x[r],t[1]=this.atomicConformation.y[r],t[2]=this.atomicConformation.z[r])}pos(t,r,n){let o=this.traceElementIndex[r];this.helixOrientationCenters&&qr(n)?p.fromArray(t,this.helixOrientationCenters,r*3):this.atomicPos(t,o)}updateResidueSegmentRange(t){let{index:r}=this.residueAtomSegments;this.residueSegmentMin=r[this.polymerRanges[t.index*2]],this.residueSegmentMax=r[this.polymerRanges[t.index*2+1]]}getResidueIndex(t){if(t<this.residueSegmentMin){let r=this.cyclicPolymerMap.get(this.residueSegmentMin);r!==void 0?t=r-(this.residueSegmentMin-t-1):t=this.residueSegmentMin}else if(t>this.residueSegmentMax){let r=this.cyclicPolymerMap.get(this.residueSegmentMax);r!==void 0?t=r+(t-this.residueSegmentMax-1):t=this.residueSegmentMax}return t}getSecStruc(t){if(this.secondaryStructure){let{type:r,getIndex:n}=this.secondaryStructure,o=r[n(t)];return qr(o)?ke.Flag.Helix:o}else return Ys}setControlPoint(t,r,n,o,a){x3(a)||this.helixOrientationCenters&&qr(a)?p.scale(t,p.add(t,r,p.add(t,o,p.add(t,n,n))),1/4):p.copy(t,n)}setFromToVector(t,r,n){this.value.isCoarseBackbone||this.helixOrientationCenters&&qr(n)?p.set(t,1,0,0):(this.atomicPos(js,this.directionFromElementIndex[r]),this.atomicPos(Qs,this.directionToElementIndex[r]),p.sub(t,Qs,js))}setDirection(t,r,n,o){p.matchDirection(js,r,n),p.matchDirection(Qs,o,n),p.scale(t,p.add(t,js,p.add(t,Qs,p.add(t,n,n))),1/4)}move(){let{residueIt:t,polymerIt:r,value:n}=this;if(this.state===0){for(;r.hasNext;)if(this.polymerSegment=r.move(),t.setSegment(this.polymerSegment),this.updateResidueSegmentRange(this.polymerSegment),t.hasNext){this.state=1;let o=this.residueAtomSegments.index[this.unit.elements[this.polymerSegment.start]],a=this.getResidueIndex(o-1);this.currSecStrucType=o===a?Ys:this.getSecStruc(a),this.nextSecStrucType=this.getSecStruc(o),this.currCoarseBackbone=this.directionFromElementIndex[a]===-1||this.directionToElementIndex[a]===-1,this.nextCoarseBackbone=this.directionFromElementIndex[o]===-1||this.directionToElementIndex[o]===-1;break}}if(this.state===1){let{index:o}=t.move(),a=this.getResidueIndex(o-3),i=this.getResidueIndex(o-2),s=this.getResidueIndex(o-1),u=this.getResidueIndex(o+1),m=this.getResidueIndex(o+2),c=this.getResidueIndex(o+3);this.prevSecStrucType=this.currSecStrucType,this.currSecStrucType=this.nextSecStrucType,this.nextSecStrucType=o===u?Ys:this.getSecStruc(u),this.prevCoarseBackbone=this.currCoarseBackbone,this.currCoarseBackbone=this.nextCoarseBackbone,this.nextCoarseBackbone=this.directionFromElementIndex[u]===-1||this.directionToElementIndex[u]===-1,n.secStrucType=this.currSecStrucType,n.secStrucFirst=this.prevSecStrucType!==this.currSecStrucType,n.secStrucLast=this.currSecStrucType!==this.nextSecStrucType,n.isCoarseBackbone=this.currCoarseBackbone,n.coarseBackboneFirst=this.prevCoarseBackbone!==this.currCoarseBackbone,n.coarseBackboneLast=this.currCoarseBackbone!==this.nextCoarseBackbone,n.first=o===this.residueSegmentMin,n.last=o===this.residueSegmentMax,n.moleculeType=this.moleculeType[o],n.initial=o===s,n.final=o===u,n.centerPrev.element=this.traceElementIndex[s],n.center.element=this.traceElementIndex[o],n.centerNext.element=this.traceElementIndex[u];let l=this.getSecStruc(a),d=this.getSecStruc(i),y=this.getSecStruc(s),S=this.getSecStruc(o),x=this.getSecStruc(u),g=this.getSecStruc(m),h=this.getSecStruc(c);this.pos(this.p0,a,l),this.pos(this.p1,i,d),this.pos(this.p2,s,y),this.pos(this.p3,o,S),this.pos(this.p4,u,x),this.pos(this.p5,m,g),this.pos(this.p6,c,h);let f=qr(l),C=qr(d),T=qr(y),I=qr(S),P=qr(x),A=qr(g),b=qr(h);this.helixOrientationCenters&&(I!==T?I?(p.copy(this.p0,this.p3),p.copy(this.p1,this.p3),p.copy(this.p2,this.p3)):T&&(p.scale(De,p.sub(De,this.p2,this.p3),2),p.add(this.p2,this.p3,De),p.add(this.p1,this.p2,De),p.add(this.p0,this.p1,De)):I!==C?I?(p.copy(this.p0,this.p2),p.copy(this.p1,this.p2)):C&&(p.scale(De,p.sub(De,this.p1,this.p2),2),p.add(this.p1,this.p2,De),p.add(this.p0,this.p1,De)):I!==f&&(I?p.copy(this.p0,this.p1):f&&(p.scale(De,p.sub(De,this.p0,this.p1),2),p.add(this.p0,this.p1,De))),I!==P?I?(p.copy(this.p4,this.p3),p.copy(this.p5,this.p3),p.copy(this.p6,this.p3)):P&&(p.scale(De,p.sub(De,this.p4,this.p3),2),p.add(this.p4,this.p3,De),p.add(this.p5,this.p4,De),p.add(this.p6,this.p5,De)):I!==A?I?(p.copy(this.p5,this.p4),p.copy(this.p6,this.p4)):A&&(p.scale(De,p.sub(De,this.p5,this.p4),2),p.add(this.p5,this.p4,De),p.add(this.p6,this.p5,De)):I!==b&&(I?p.copy(this.p6,this.p5):b&&(p.scale(De,p.sub(De,this.p6,this.p5),2),p.add(this.p6,this.p5,De)))),this.setFromToVector(this.d01,s,y),this.setFromToVector(this.d12,o,S),this.setFromToVector(this.d23,u,x),this.setFromToVector(this.d34,m,g);let _=I&&this.helixOrientationCenters,v=1.5;o===s||S!==y&&_?(p.setMagnitude(De,p.sub(De,this.p3,this.p4),v),p.add(this.p2,this.p3,De),p.add(this.p1,this.p2,De),p.add(this.p0,this.p1,De)):s===i||S!==d&&_?(p.setMagnitude(De,p.sub(De,this.p2,this.p3),v),p.add(this.p1,this.p2,De),p.add(this.p0,this.p1,De)):(i===a||S!==l&&_)&&(p.setMagnitude(De,p.sub(De,this.p1,this.p2),v),p.add(this.p0,this.p1,De)),o===u||S!==x&&_?(p.setMagnitude(De,p.sub(De,this.p3,this.p2),v),p.add(this.p4,this.p3,De),p.add(this.p5,this.p4,De),p.add(this.p6,this.p5,De)):u===m||S!==g&&_?(p.setMagnitude(De,p.sub(De,this.p4,this.p3),v),p.add(this.p5,this.p4,De),p.add(this.p6,this.p5,De)):(m===c||S!==h&&_)&&(p.setMagnitude(De,p.sub(De,this.p5,this.p4),v),p.add(this.p6,this.p5,De)),this.setControlPoint(n.p0,this.p0,this.p1,this.p2,d),this.setControlPoint(n.p1,this.p1,this.p2,this.p3,y),this.setControlPoint(n.p2,this.p2,this.p3,this.p4,S),this.setControlPoint(n.p3,this.p3,this.p4,this.p5,x),this.setControlPoint(n.p4,this.p4,this.p5,this.p6,g),this.setDirection(n.d12,this.d01,this.d12,this.d23),this.setDirection(n.d23,this.d12,this.d23,this.d34),t.hasNext||(this.state=0)}return this.hasNext=t.hasNext||r.hasNext,this.value}};var bm=class{constructor(t,r){this.unit=t;this.state=0;this.hasNext=!1;switch(this.polymerIt=ct.transientSegments(fm(t),t.elements),this.value=C1(r,t),p.set(this.value.d12,1,0,0),p.set(this.value.d23,1,0,0),t.kind){case O.Kind.Spheres:this.conformation=t.model.coarseConformation.spheres;break;case O.Kind.Gaussians:this.conformation=t.model.coarseConformation.gaussians;break}this.hasNext=this.polymerIt.hasNext}getElementIndex(t){return Math.min(Math.max(this.polymerSegment.start,t),this.polymerSegment.end-1)}pos(t,r){let n=this.unit.elements[r];t[0]=this.conformation.x[n],t[1]=this.conformation.y[n],t[2]=this.conformation.z[n]}move(){if(this.state===0){for(;this.polymerIt.hasNext;)if(this.polymerSegment=this.polymerIt.move(),this.elementIndex=this.polymerSegment.start,this.elementIndex<this.polymerSegment.end){this.state=1;break}}if(this.state===1){let t=this.getElementIndex(this.elementIndex-2),r=this.getElementIndex(this.elementIndex-1),n=this.getElementIndex(this.elementIndex+1),o=this.getElementIndex(this.elementIndex+2);this.value.centerPrev.element=this.value.center.unit.elements[r],this.value.center.element=this.value.center.unit.elements[this.elementIndex],this.value.centerNext.element=this.value.center.unit.elements[n],this.pos(this.value.p0,t),this.pos(this.value.p1,r),this.pos(this.value.p2,this.elementIndex),this.pos(this.value.p3,n),this.pos(this.value.p4,o);let a=.5;this.elementIndex===r?(p.scale(De,p.sub(De,this.value.p2,this.value.p3),a),p.add(this.value.p1,this.value.p2,De),p.add(this.value.p0,this.value.p1,De)):r===t&&(p.scale(De,p.sub(De,this.value.p1,this.value.p2),a),p.add(this.value.p0,this.value.p1,De)),this.elementIndex===n?(p.scale(De,p.sub(De,this.value.p2,this.value.p1),a),p.add(this.value.p3,this.value.p2,De),p.add(this.value.p4,this.value.p3,De)):n===o&&(p.scale(De,p.sub(De,this.value.p3,this.value.p2),a),p.add(this.value.p4,this.value.p3,De)),this.value.first=this.elementIndex===this.polymerSegment.start,this.value.last=this.elementIndex===this.polymerSegment.end-1,this.elementIndex+1>=this.polymerSegment.end&&(this.state=0)}return this.hasNext=this.elementIndex+1<this.polymerSegment.end||this.polymerIt.hasNext,this.elementIndex+=1,this.value}};var Jo=p.fromArray,Pi=p.toArray,Pm=p.normalize,g3=p.sub,Ai=p.spline,b3=p.slerp,_1=p.copy,A1=p.cross,Sm=p.orthogonalize,S3=p.matchDirection,C3=p.scale,I1=p.add;function D1(e){let t=e+1,r=t*3;return{curvePoints:new Float32Array(r),tangentVectors:new Float32Array(r),normalVectors:new Float32Array(r),binormalVectors:new Float32Array(r),widthValues:new Float32Array(t),heightValues:new Float32Array(t),linearSegments:e}}function M1(e,t,r,n){_3(e,t,r,n),I3(e,t)}var Cm=p(),_m=p(),Am=p();function _3(e,t,r,n){let{curvePoints:o,tangentVectors:a,linearSegments:i}=e,{p0:s,p1:u,p2:m,p3:c,p4:l,secStrucFirst:d,secStrucLast:y}=t,S=1-n,x=d?.5:r,g=y?.5:r;for(let h=0;h<=i;++h){let f=h*1/i;if(f<S){let C=Qt(x,r,f);Ai(Am,s,u,m,c,f+n,C),Ai(Cm,s,u,m,c,f+n+.01,x),Ai(_m,s,u,m,c,f+n-.01,x)}else{let C=Qt(r,g,f);Ai(Am,u,m,c,l,f-S,C),Ai(Cm,u,m,c,l,f-S+.01,C),Ai(_m,u,m,c,l,f-S-.01,C)}Pi(Am,o,h*3),Pm(mo,g3(mo,Cm,_m)),Pi(mo,a,h*3)}}var A3=p(),mo=p(),zr=p(),Ii=p(),oa=p(),P1=p(),T1=p(),v1=p(),Im=p(),Xs=p();function I3(e,t){let{curvePoints:r,tangentVectors:n,normalVectors:o,binormalVectors:a}=e,{d12:i,d23:s}=t,u=r.length/3;Jo(T1,n,0),Jo(v1,n,(u-1)*3),Sm(Im,T1,i),Sm(Xs,v1,s),S3(Xs,Xs,Im),_1(oa,Im);let m=u-1;for(let c=0;c<u;++c){let l=fa(0,m,c)*m,d=c===0?0:1/(u-l);Jo(mo,n,c*3),Sm(zr,mo,b3(A3,oa,Xs,d)),Pi(zr,o,c*3),_1(oa,zr),Pm(Ii,A1(Ii,mo,zr)),Pi(Ii,a,c*3)}for(let c=1;c<m;++c)Jo(oa,o,(c-1)*3),Jo(zr,o,c*3),Jo(P1,o,(c+1)*3),C3(zr,I1(zr,oa,I1(zr,P1,zr)),1/3),Pi(zr,o,c*3),Jo(mo,n,c*3),Pm(Ii,A1(Ii,mo,zr)),Pi(Ii,a,c*3)}function Tm(e,t,r,n,o,a,i,s){let{widthValues:u,heightValues:m,linearSegments:c}=e,l=1-s;for(let d=0;d<=c;++d){let y=d*1/c;y<l?(u[d]=Qt(t,r,y+s),m[d]=Qt(o,a,y+s)):(u[d]=Qt(r,n,y-l),m[d]=Qt(a,i,y-l))}}var B1=.5,R1=.9,F1=.5,U1=.3,vm=2;function fm(e){switch(e.kind){case O.Kind.Atomic:return e.model.atomicRanges.polymerRanges;case O.Kind.Spheres:return e.model.coarseHierarchy.spheres.polymerRanges;case O.Kind.Gaussians:return e.model.coarseHierarchy.gaussians.polymerRanges}}function xm(e){switch(e.kind){case O.Kind.Atomic:return e.model.atomicRanges.gapRanges;case O.Kind.Spheres:return e.model.coarseHierarchy.spheres.gapRanges;case O.Kind.Gaussians:return e.model.coarseHierarchy.gaussians.gapRanges}}var Zs;(t=>{function e(r){let{group:n,structure:o}=r,a=n.units[0].polymerElements,i=a.length,s=n.units.length,u=le.Location.create(o);return At(i,s,1,(c,l)=>{let d=n.units[l];return u.unit=d,u.element=a[c],u})}t.fromGroup=e})(Zs||(Zs={}));var Ws;(t=>{function e(r){let{group:n,structure:o}=r,a=n.units[0].gapElements,i=a.length,s=n.units.length,u=le.Location.create(o);return At(i,s,1,(c,l)=>{let d=n.units[l];return u.unit=d,u.element=a[c],u})}t.fromGroup=e})(Ws||(Ws={}));function E1(e,t,r,n,o,a){let i=-1,s=-1;for(let m=o;m<=a;m++){let c=r[m];if(!(c<0)&&(i=Ae.indexOf(t,c),i>=0)){s=m;break}}if(i<0)return!1;let u=i;for(let m=a;m>s;m--){let c=r[m];if(c<0)continue;let l=Ae.indexOf(t,c);if(l>=0){u=l;break}}return n(z.ofRange(e+i,e+u))}function Dm(e,t,r,n,o){let a=!1,{elements:i}=o.unit,{traceElementIndex:s}=o.unit.model.atomicHierarchy.derived.residue,{index:u}=o.unit.model.atomicHierarchy.residueAtomSegments,m=r(o.unit);if(z.is(o.indices))if(z.start(o.indices)===0&&z.end(o.indices)===o.unit.elements.length)a=n(z.ofBounds(e,e+t))||a;else{let c=u[i[z.min(o.indices)]],l=u[i[z.max(o.indices)]];a=E1(e,m,s,n,c,l)||a}else{let{indices:c}=o;for(let l=0,d=c.length;l<d;l++){let y=u[i[c[l]]],S=y,x=l+1;for(;x<d;){let g=u[i[c[x]]];if(g-S>1)break;S=g,x++}l=x-1,a=E1(e,m,s,n,y,S)||a}}return a}function P3(e){return e.polymerElements}function L1(e,t,r){let n=!1;if(!le.Loci.is(e))return!1;let{structure:o,group:a}=t;if(!Ce.areEquivalent(e.structure,o))return!1;let i=a.units[0].polymerElements.length;for(let s of e.elements){if(!a.unitIndexMap.has(s.unit.id))continue;let u=a.unitIndexMap.get(s.unit.id)*i;if(O.isAtomic(s.unit))n=Dm(u,i,P3,r,s)||n;else if(z.is(s.indices)){let m=u+z.start(s.indices),c=u+z.end(s.indices);n=r(z.ofBounds(m,c))||n}else for(let m=0,c=s.indices.length;m<c;m++){let l=s.indices[m],d=m+1;for(;d<c&&s.indices[d]===l;)d++;m=d-1;let y=s.indices[m];n=r(z.ofRange(u+l,u+y))||n}}return n}function V1(e,t,r){let n=!1;if(Qe.isLoci(e)){let{structure:o,group:a}=t;if(!Ce.areRootsEquivalent(e.structure,o))return!1;e=Qe.remapLoci(e,o);let i=a.units[0].gapElements.length;for(let s of e.bonds){let u=a.unitIndexMap.get(s.aUnit.id);if(u!==void 0){let m=Ae.indexOf(s.aUnit.gapElements,s.aUnit.elements[s.aIndex]),c=Ae.indexOf(s.bUnit.gapElements,s.bUnit.elements[s.bIndex]);m!==-1&&c!==-1&&r(z.ofSingleton(u*i+m))&&(n=!0)}}}else if(le.Loci.is(e)){let{structure:o,group:a}=t;if(!Ce.areRootsEquivalent(e.structure,o))return!1;e=le.Loci.remap(e,o);let i=a.units[0].gapElements.length;for(let s of e.elements){let u=a.unitIndexMap.get(s.unit.id);u!==void 0&&Ae.forEach(s.indices,m=>{let c=Ae.indexOf(s.unit.gapElements,s.unit.elements[m]);c!==-1&&r(z.ofSingleton(u*i+c))&&(n=!0)})}}return n}var Js;(t=>{function e(r){let{group:n,structure:o}=r,a=n.units[0],i=O.isAtomic(a)?a.nucleotideElements:[],s=i.length,u=n.units.length,m=le.Location.create(o);return At(s,u,1,(l,d)=>{let y=n.units[d];return m.unit=y,m.element=i[l],m})}t.fromGroup=e})(Js||(Js={}));function T3(e){return e.nucleotideElements}function k1(e,t,r){let n=!1;if(!le.Loci.is(e))return!1;let{structure:o,group:a}=t;if(!Ce.areEquivalent(e.structure,o))return!1;let i=a.units[0];if(!O.isAtomic(i))return!1;let{nucleotideElements:s}=i,u=s.length;for(let m of e.elements){if(!O.isAtomic(m.unit)||!a.unitIndexMap.has(m.unit.id))continue;let c=a.unitIndexMap.get(m.unit.id)*u;O.isAtomic(m.unit)&&(n=Dm(c,u,T3,r,m)||n)}return n}var $s=p.zero(),lo=p.zero(),eu=p.zero(),tu=p.zero(),$o=p.zero(),Ti=p.zero(),ru=p.zero(),G1=p.zero(),w1=p.zero(),ia=p.zero(),po=p.zero(),H1={sizeFactor:k.Numeric(.2,{min:0,max:10,step:.01}),radialSegments:k.Numeric(16,{min:2,max:56,step:2},at.CustomQualityParamInfo),detail:k.Numeric(0,{min:0,max:3,step:1},at.CustomQualityParamInfo)},FN=k.getDefaultValues(H1),nu=new Float32Array(2*9*3),v3=new Uint32Array([0,1,2,3,4,5,6,7,16,17,14,15,12,13,8,9,10,11,0,1]),D3=new Uint32Array([8,12,14,16,6,4,2,0,10]),M3=new Uint32Array([9,11,1,3,5,7,17,15,13]),ou=new Float32Array(2*6*3),E3=new Uint32Array([0,1,2,3,4,5,6,7,8,9,10,11,0,1]),B3=new Uint32Array([0,10,8,6,4,2]),R3=new Uint32Array([1,3,5,7,9,11]),N1=p.zero();function O1(e,t,...r){for(let n=0,o=r.length;n<o;++n){let a=r[n];p.toArray(p.add(N1,a,t),e,n*2*3),p.toArray(p.sub(N1,a,t),e,(n*2+1)*3)}}function F3(e,t,r,n,o,a){if(!O.isAtomic(t))return Ze.createEmpty(a);let i=t.nucleotideElements.length;if(!i)return Ze.createEmpty(a);let{sizeFactor:s,radialSegments:u,detail:m}=o,c=i*(26+u*2),l=Ve.createState(c,c/4,a),{elements:d,model:y}=t,{chainAtomSegments:S,residueAtomSegments:x,atoms:g,index:h}=y.atomicHierarchy,{moleculeType:f,traceElementIndex:C}=y.atomicHierarchy.derived.residue,{label_comp_id:T}=g,I=t.conformation.invariantPosition,P=Ue.transientSegments(S,d),A=Ue.transientSegments(x,d),b=1*s,_=1.25*s,v={radiusTop:1*s,radiusBottom:1*s,radialSegments:u},R=0;for(;P.hasNext;)for(A.setSegment(P.move());A.hasNext;){let{index:L}=A.move();if(Lo(f[L])){let G=T.value(x.offsets[L]),K=-1,X=-1,j=-1,$=-1,Z=-1,te=-1,W=-1,Y=-1,ie=-1,D=-1;l.currentGroup=R;let F=Tp(G),N=vp(G);if(!F&&!N){let oe=h.findAtomOnResidue(L,"C4"),se=h.findAtomOnResidue(L,"N9");oe!==-1&&se!==-1&&p.distance(I(oe,$o),I(se,ia))<1.6?F=!0:N=!0}F?(K=C[L],X=h.findAtomOnResidue(L,"N1"),j=h.findAtomOnResidue(L,"C2"),$=h.findAtomOnResidue(L,"N3"),Z=h.findAtomOnResidue(L,"C4"),te=h.findAtomOnResidue(L,"C5"),te===-1&&(te=h.findAtomOnResidue(L,"N5")),W=h.findAtomOnResidue(L,"C6"),Y=h.findAtomOnResidue(L,"N7"),Y===-1&&(Y=h.findAtomOnResidue(L,"C7")),ie=h.findAtomOnResidue(L,"C8"),D=h.findAtomOnResidue(L,"N9"),D!==-1&&K!==-1&&(I(D,ia),I(K,$s),l.currentGroup=R,Hr(l,ia,$s,1,v),Rn(l,ia,b,m)),X!==-1&&j!==-1&&$!==-1&&Z!==-1&&te!==-1&&W!==-1&&Y!==-1&&ie!==-1&&D!==-1&&(I(X,lo),I(j,eu),I($,tu),I(Z,$o),I(te,Ti),I(W,ru),I(Y,G1),I(ie,w1),p.triangleNormal(po,lo,$o,Ti),p.scale(po,po,_),O1(nu,po,lo,eu,tu,$o,Ti,ru,G1,w1,ia),Ve.addTriangleStrip(l,nu,v3),Ve.addTriangleFan(l,nu,D3),Ve.addTriangleFan(l,nu,M3))):N&&(K=C[L],X=h.findAtomOnResidue(L,"N1"),X===-1&&(X=h.findAtomOnResidue(L,"C1")),j=h.findAtomOnResidue(L,"C2"),$=h.findAtomOnResidue(L,"N3"),Z=h.findAtomOnResidue(L,"C4"),te=h.findAtomOnResidue(L,"C5"),W=h.findAtomOnResidue(L,"C6"),X!==-1&&K!==-1&&(I(X,lo),I(K,$s),l.currentGroup=R,Hr(l,lo,$s,1,v),Rn(l,lo,b,m)),X!==-1&&j!==-1&&$!==-1&&Z!==-1&&te!==-1&&W!==-1&&(I(j,eu),I($,tu),I(Z,$o),I(te,Ti),I(W,ru),p.triangleNormal(po,lo,$o,Ti),p.scale(po,po,_),O1(ou,po,lo,eu,tu,$o,Ti,ru),Ve.addTriangleStrip(l,ou,E3),Ve.addTriangleFan(l,ou,B3),Ve.addTriangleFan(l,ou,R3))),++R}}let E=Ve.getMesh(l),B=Se.expand(Se(),t.boundary.sphere,1*o.sizeFactor);return E.setBoundingSphere(B),E}var Mm={...zt,...H1};function q1(e){return Ir({defaultProps:k.getDefaultValues(Mm),createGeometry:F3,createLocationIterator:Js.fromGroup,eachLocation:k1,setUpdateState:(t,r,n)=>{t.createGeometry=r.sizeFactor!==n.sizeFactor||r.radialSegments!==n.radialSegments}},e)}var Em=10,z1={sizeFactor:k.Numeric(.2,{min:0,max:10,step:.01}),radialSegments:k.Numeric(16,{min:2,max:56,step:2},at.CustomQualityParamInfo)},KN=k.getDefaultValues(z1);function U3(e,t,r,n,o,a){let i=t.gapElements.length;if(!i)return Ze.createEmpty(a);let{sizeFactor:s,radialSegments:u}=o,m=Em*u*2*i*2,c=Ve.createState(m,m/10,a),l=t.conformation.invariantPosition,d=p.zero(),y=p.zero(),S={radiusTop:1,radiusBottom:1,topCap:!0,bottomCap:!0,radialSegments:u},x=0,g=x1(r,t);for(;g.hasNext;){let{centerA:C,centerB:T}=g.move();C.element===T.element||(l(C.element,d),l(T.element,y),S.radiusTop=S.radiusBottom=n.size.size(C)*s,c.currentGroup=x,Wo(c,d,y,.5,Em,S),S.radiusTop=S.radiusBottom=n.size.size(T)*s,c.currentGroup=x+1,Wo(c,y,d,.5,Em,S)),x+=2}let h=Ve.getMesh(c),f=Se.expand(Se(),t.boundary.sphere,1*o.sizeFactor);return h.setBoundingSphere(f),h}var Bm={...zt,...z1};function K1(e){return Ir({defaultProps:k.getDefaultValues(Bm),createGeometry:U3,createLocationIterator:Ws.fromGroup,eachLocation:V1,setUpdateState:(t,r,n)=>{t.createGeometry=r.sizeFactor!==n.sizeFactor||r.radialSegments!==n.radialSegments}},e)}var He=p(),Ye=p(),L3=p(),pr=p(),mn=p(),iu=p(),au=p(),aa=p(),Kr=p(),ln=p(),Rm=p(),fo=p(),yo=p(),ho=p(),xo=p(),Tr=p.fromArray,vi=p.scale,vr=p.add,Fn=p.sub,V3=p.magnitude,j1=p.negate,Fm=p.copy,Q1=p.cross,k3=p.set,We=xe.add3,G3=xe.add;function su(e,t,r,n,o,a,i,s,u){let{vertices:m,normals:c,indices:l}=t,d=m.elementCount;if(Tr(He,n,e),vi(au,He,i),vi(iu,He,s),Tr(Ye,o,e),vi(pr,Ye,a),Q1(ln,Ye,He),Tr(Kr,r,e),vr(fo,vr(fo,Kr,pr),iu),Fn(yo,vr(yo,Kr,pr),au),Fn(ho,Fn(ho,Kr,pr),au),vr(xo,Fn(xo,Kr,pr),iu),i<s?(We(m,xo[0],xo[1],xo[2]),We(m,ho[0],ho[1],ho[2]),We(m,yo[0],yo[1],yo[2]),We(m,fo[0],fo[1],fo[2]),Fm(mn,iu)):(We(m,fo[0],fo[1],fo[2]),We(m,yo[0],yo[1],yo[2]),We(m,ho[0],ho[1],ho[2]),We(m,xo[0],xo[1],xo[2]),Fm(mn,au)),u){for(let y=0;y<4;++y)We(c,-ln[0],-ln[1],-ln[2]);We(l,d,d+1,d+2),We(l,d+2,d+3,d)}else{for(let y=0;y<4;++y)We(c,ln[0],ln[1],ln[2]);We(l,d+2,d+1,d),We(l,d,d+3,d+2)}}function uu(e,t,r,n,o,a,i,s,u,m){let{currentGroup:c,vertices:l,normals:d,indices:y,groups:S}=e,x=l.elementCount,g=0;s>0?(Tr(He,t,0),Tr(Ye,t,o*3),g=s/V3(Fn(L3,Ye,He))):k3(aa,0,0,0);for(let f=0;f<=o;++f){let C=a[f],T=i[f],I=s===0?T:s*(1-f/o),P=f*3;Tr(mn,r,P),vi(mn,mn,I),Tr(pr,n,P),vi(pr,pr,C),s>0&&(Tr(He,r,P),Tr(Ye,n,P),vi(aa,Q1(aa,He,Ye),g)),Tr(Kr,t,P),Tr(ln,r,P),Tr(Rm,n,P),vr(He,vr(He,Kr,pr),mn),vr(Ye,ln,aa),We(l,He[0],He[1],He[2]),We(d,Ye[0],Ye[1],Ye[2]),vr(He,Fn(He,Kr,pr),mn),We(l,He[0],He[1],He[2]),We(d,Ye[0],Ye[1],Ye[2]),j1(Ye,Rm),We(l,He[0],He[1],He[2]),We(d,Ye[0],Ye[1],Ye[2]),Fn(He,Fn(He,Kr,pr),mn),We(l,He[0],He[1],He[2]),We(d,Ye[0],Ye[1],Ye[2]),vr(Ye,j1(Ye,ln),aa),We(l,He[0],He[1],He[2]),We(d,Ye[0],Ye[1],Ye[2]),Fn(He,vr(He,Kr,pr),mn),We(l,He[0],He[1],He[2]),We(d,Ye[0],Ye[1],Ye[2]),Fm(Ye,Rm),We(l,He[0],He[1],He[2]),We(d,Ye[0],Ye[1],Ye[2]),vr(He,vr(He,Kr,pr),mn),We(l,He[0],He[1],He[2]),We(d,Ye[0],Ye[1],Ye[2])}for(let f=0;f<o;++f){for(let C=0;C<2;C++)We(y,x+f*8+2*C,x+(f+1)*8+2*C+1,x+f*8+2*C+1),We(y,x+f*8+2*C,x+(f+1)*8+2*C,x+(f+1)*8+2*C+1);for(let C=2;C<4;C++)We(y,x+f*8+2*C,x+(f+1)*8+2*C,x+f*8+2*C+1),We(y,x+(f+1)*8+2*C,x+(f+1)*8+2*C+1,x+f*8+2*C+1)}if(u){let f=a[0],C=i[0],T=s===0?C:s;su(0,e,t,r,n,f,T,T,!1)}else if(s>0){let f=a[0],C=i[0];su(0,e,t,r,n,f,s,-C,!1),su(0,e,t,r,n,f,-s,C,!1)}if(m&&s===0){let f=a[o],C=i[o];su(o*3,e,t,r,n,f,C,C,!0)}let h=(o+1)*8+(u?4:s>0?8:0)+(m&&s===0?4:0);for(let f=0,C=h;f<C;++f)G3(S,c)}var St=p(),It=p(),Zt=p(),Ft=p(),Kt=p();function cu(e,t,r,n,o){e[0]=t[0]*n+r[0]*o,e[1]=t[1]*n+r[1]*o,e[2]=t[2]*n+r[2]*o}function Di(e,t,r,n,o,a){e[0]=t[0]*o+r[0]*a+n[0],e[1]=t[1]*o+r[1]*a+n[1],e[2]=t[2]*o+r[2]*a+n[2]}var Un=p.fromArray,w3=p.normalize,Um=p.scaleAndAdd,Y1=p.cross,N3=p.dot,O3=p.unitX,jt=xe.add3,Lm=new Map;function H3(e,t){let r=t?1:0,n=Wt(e,r);if(!Lm.has(n)){let o=[],a=[];for(let i=0;i<e;++i){let s=(i*2+r)/e*Math.PI;o[i]=Math.cos(s),a[i]=Math.sin(s)}Lm.set(n,{cos:o,sin:a})}return Lm.get(n)}function Vm(e,t,r,n,o,a,i,s,u,m,c){let{currentGroup:l,vertices:d,normals:y,indices:S,groups:x}=e,g=d.elementCount,{cos:h,sin:f}=H3(a,c==="rounded"),C=Math.round(a/4),T=C*3;for(let A=0;A<=o;++A){let b=A*3;Un(Ft,r,b),Un(Kt,n,b),Un(Zt,t,b);let _=i[A],v=s[A],R=c==="rounded"&&v>_;for(let E=0;E<a;++E){if(R){Di(It,Ft,Kt,Zt,_*h[E],_*f[E]);let B=N3(Kt,O3)<0?E<C||E>=T?v-_:-v+_:E>=C&&E<T?-v+_:v-_;Um(It,It,Ft,B),E===C||E===C-1?cu(St,Ft,Kt,0,1):E===T||E===T-1?cu(St,Ft,Kt,0,-1):cu(St,Ft,Kt,h[E],f[E])}else Di(It,Ft,Kt,Zt,v*h[E],_*f[E]),cu(St,Ft,Kt,_*h[E],v*f[E]);w3(St,St),jt(d,It[0],It[1],It[2]),jt(y,St[0],St[1],St[2])}}let I=Math.round(a/2);for(let A=0;A<o;++A){for(let b=0;b<I;++b)jt(S,g+A*a+(b+1)%a,g+(A+1)*a+(b+1)%a,g+A*a+b),jt(S,g+(A+1)*a+(b+1)%a,g+(A+1)*a+b,g+A*a+b);for(let b=I;b<a;++b)jt(S,g+A*a+(b+1)%a,g+(A+1)*a+b,g+A*a+b),jt(S,g+(A+1)*a+(b+1)%a,g+(A+1)*a+b,g+A*a+(b+1)%a)}if(u){let b=d.elementCount;Un(Ft,r,0),Un(Kt,n,0),Un(Zt,t,0),Y1(St,Kt,Ft),jt(d,Zt[0],Zt[1],Zt[2]),jt(y,St[0],St[1],St[2]);let _=i[0],v=s[0],R=c==="rounded"&&v>_;R&&(v-=_),g=d.elementCount;for(let E=0;E<a;++E)R?(Di(It,Ft,Kt,Zt,_*h[E],_*f[E]),Um(It,It,Ft,E<C||E>=T?v:-v)):Di(It,Ft,Kt,Zt,v*h[E],_*f[E]),jt(d,It[0],It[1],It[2]),jt(y,St[0],St[1],St[2]),jt(S,g+(E+1)%a,g+E,b)}if(m){let A=o*3,b=d.elementCount;Un(Ft,r,A),Un(Kt,n,A),Un(Zt,t,A),Y1(St,Ft,Kt),jt(d,Zt[0],Zt[1],Zt[2]),jt(y,St[0],St[1],St[2]);let _=i[o],v=s[o],R=c==="rounded"&&v>_;R&&(v-=_),g=d.elementCount;for(let E=0;E<a;++E)R?(Di(It,Ft,Kt,Zt,_*h[E],_*f[E]),Um(It,It,Ft,E<C||E>=T?v:-v)):Di(It,Ft,Kt,Zt,v*h[E],_*f[E]),jt(d,It[0],It[1],It[2]),jt(y,St[0],St[1],St[2]),jt(S,g+E,g+(E+1)%a,b)}let P=(o+1)*a+(u?a+1:0)+(m?a+1:0);xe.addRepeat(x,P,l)}var Ln=p.fromArray,q3=p.magnitude,km=p.sub,X1=p.add,Gm=p.scale,z3=p.negate,K3=p.copy,j3=p.cross,Dr=xe.add3,Q3=xe.add,Dt=p(),Ut=p(),Y3=p(),wm=p(),ei=p(),Z1=p(),sa=p(),X3=p(),Nm=p();function mu(e,t,r,n,o,a,i,s){let{currentGroup:u,vertices:m,normals:c,indices:l,groups:d}=e,y=m.elementCount,S=0;s>0&&(Ln(Dt,t,0),Ln(Ut,t,o*3),S=s/q3(km(Y3,Ut,Dt)));for(let g=0;g<=o;++g){let h=a[g],f=i[g],C=s===0?f:s*(1-g/o),T=g*3;Ln(ei,r,T),Gm(ei,ei,C),Ln(wm,n,T),Gm(wm,wm,h),s>0&&(Ln(Dt,r,T),Ln(Ut,n,T),Gm(Z1,j3(Z1,Dt,Ut),S)),Ln(sa,t,T),Ln(X3,r,T),Ln(Nm,n,T),X1(Dt,sa,ei),z3(Ut,Nm),Dr(m,Dt[0],Dt[1],Dt[2]),Dr(c,Ut[0],Ut[1],Ut[2]),km(Dt,sa,ei),Dr(m,Dt[0],Dt[1],Dt[2]),Dr(c,Ut[0],Ut[1],Ut[2]),X1(Dt,sa,ei),K3(Ut,Nm),Dr(m,Dt[0],Dt[1],Dt[2]),Dr(c,Ut[0],Ut[1],Ut[2]),km(Dt,sa,ei),Dr(m,Dt[0],Dt[1],Dt[2]),Dr(c,Ut[0],Ut[1],Ut[2])}for(let g=0;g<o;++g)Dr(l,y+g*4,y+(g+1)*4+1,y+g*4+1),Dr(l,y+g*4,y+(g+1)*4,y+(g+1)*4+1),Dr(l,y+g*4+2+1,y+(g+1)*4+2+1,y+g*4+2),Dr(l,y+g*4+2,y+(g+1)*4+2+1,y+(g+1)*4+2);let x=(o+1)*4;for(let g=0,h=x;g<h;++g)Q3(d,u)}var W1={sizeFactor:k.Numeric(.2,{min:0,max:10,step:.01}),aspectRatio:k.Numeric(5,{min:.1,max:10,step:.1}),arrowFactor:k.Numeric(1.5,{min:0,max:3,step:.1}),tubularHelices:k.Boolean(!1),helixProfile:k.Select("elliptical",k.arrayToOptions(["elliptical","rounded","square"])),detail:k.Numeric(0,{min:0,max:3,step:1},at.CustomQualityParamInfo),linearSegments:k.Numeric(8,{min:1,max:48,step:1},at.CustomQualityParamInfo),radialSegments:k.Numeric(16,{min:2,max:56,step:2},at.CustomQualityParamInfo)},bO=k.getDefaultValues(W1),ar=p();function Z3(e,t,r,n,o,a){let i=t.polymerElements.length;if(!i)return Ze.createEmpty(a);let{sizeFactor:s,detail:u,linearSegments:m,radialSegments:c,aspectRatio:l,arrowFactor:d,tubularHelices:y,helixProfile:S}=o,x=m*c*i+(c+1)*i*2,g=Ve.createState(x,x/10,a),h=O.isCoarse(t),f=D1(m),{curvePoints:C,normalVectors:T,binormalVectors:I,widthValues:P,heightValues:A}=f,b=0,_=S1(t,r,{ignoreSecondaryStructure:!1,useHelixOrientation:y});for(;_.hasNext;){let E=_.move();g.currentGroup=b;let B=Lo(E.moleculeType),L=ke.is(E.secStrucType,ke.Flag.Beta),G=ke.is(E.secStrucType,ke.Flag.Helix),K=G&&!y?R1:B1,X=B?U1:F1;M1(f,E,K,X);let j=n.size.size(E.centerPrev)*s,$=n.size.size(E.center)*s,Z=n.size.size(E.centerNext)*s;h&&(j*=l/2,$*=l/2,Z*=l/2);let te=E.secStrucFirst||E.coarseBackboneFirst||E.first,W=E.secStrucLast||E.coarseBackboneLast||E.last,Y=m;if(E.initial){Y=Math.max(Math.round(m*X),1);let ie=m-Y;C.copyWithin(0,ie*3),I.copyWithin(0,ie*3),T.copyWithin(0,ie*3),p.fromArray(ar,C,3),p.normalize(ar,p.sub(ar,E.p2,ar)),p.scaleAndAdd(ar,E.p2,ar,$*vm),p.toArray(ar,C,0)}else E.final&&(Y=Math.max(Math.round(m*(1-X)),1),p.fromArray(ar,C,Y*3-3),p.normalize(ar,p.sub(ar,E.p2,ar)),p.scaleAndAdd(ar,E.p2,ar,$*vm),p.toArray(ar,C,Y*3));if(E.initial===!0&&E.final===!0)Rn(g,E.p2,$*2,u);else if(L){let ie=j*l,D=$*l,F=Z*l,N=E.secStrucLast?D*d:0;Tm(f,j,$,Z,ie,D,F,X),c===2?mu(g,C,T,I,Y,P,A,N):uu(g,C,T,I,Y,P,A,N,te,W)}else{let ie,D,F;G&&!E.isCoarseBackbone?y?(j*=l*1.5,$*=l*1.5,Z*=l*1.5,ie=j,D=$,F=Z):(ie=j*l,D=$*l,F=Z*l):B&&!E.isCoarseBackbone?(ie=j*l,D=$*l,F=Z*l):(ie=j,D=$,F=Z),Tm(f,j,$,Z,ie,D,F,X);let[N,oe]=B&&!E.isCoarseBackbone?[I,T]:[T,I];if(B&&!E.isCoarseBackbone)for(let se=0,ce=N.length;se<ce;se++)N[se]*=-1;c===2?B&&!E.isCoarseBackbone?mu(g,C,N,oe,Y,A,P,0):mu(g,C,N,oe,Y,P,A,0):c===4?uu(g,C,N,oe,Y,P,A,0,te,W):D===$?Vm(g,C,N,oe,Y,c,P,A,te,W,"elliptical"):S==="square"?uu(g,C,N,oe,Y,P,A,0,te,W):Vm(g,C,N,oe,Y,c,P,A,te,W,S)}++b}let v=Ve.getMesh(g),R=Se.expand(Se(),t.boundary.sphere,1*o.sizeFactor);return v.setBoundingSphere(R),v}var Om={...zt,...W1};function J1(e){return Ir({defaultProps:k.getDefaultValues(Om),createGeometry:Z3,createLocationIterator:Zs.fromGroup,eachLocation:L1,setUpdateState:(t,r,n,o,a,i,s)=>{t.createGeometry=r.sizeFactor!==n.sizeFactor||r.tubularHelices!==n.tubularHelices||r.detail!==n.detail||r.linearSegments!==n.linearSegments||r.radialSegments!==n.radialSegments||r.aspectRatio!==n.aspectRatio||r.arrowFactor!==n.arrowFactor||r.helixProfile!==n.helixProfile;let u=rn.get(i.structure).version;t.info.secondaryStructureHash!==u&&(t.createGeometry=t.info.secondaryStructureHash!==void 0,t.info.secondaryStructureHash=u)}},e)}var $1={"polymer-trace":(e,t)=>an("Polymer trace mesh",e,t,J1),"polymer-gap":(e,t)=>an("Polymer gap cylinder",e,t,K1),"nucleotide-ring":(e,t)=>an("Nucleotide ring mesh",e,t,q1)},ex={...Om,...Bm,...Mm,sizeFactor:k.Numeric(.2,{min:0,max:10,step:.01}),visuals:k.MultiSelect(["polymer-trace","polymer-gap","nucleotide-ring"],k.objectToOptions($1))};function W3(e,t){let r=k.clone(ex),n=!1,o=!1;return t.units.forEach(a=>{!n&&O.isAtomic(a)&&a.nucleotideElements.length&&(n=!0),!o&&a.gapElements.length&&(o=!0)}),r.visuals.defaultValue=["polymer-trace"],n&&r.visuals.defaultValue.push("nucleotide-ring"),o&&r.visuals.defaultValue.push("polymer-gap"),r}function J3(e,t){return Gt.createMulti("Cartoon",e,t,tr,$1)}var tx={name:"cartoon",factory:J3,getParams:W3,defaultValues:k.getDefaultValues(ex),defaultColorTheme:{name:"chain-id"},defaultSizeTheme:{name:"uniform"},isApplicable:e=>e.polymerResidueCount>0,ensureCustomProperties:{attach:e=>{rn.attach(e,void 0,!0);for(let t of e.models)na.attach(t,void 0,!0)},detach:e=>{rn.ref(e,!1);for(let t of e.models)na.ref(t,!1)}}};var rx=new ArrayBuffer(4),$3=new Int32Array(rx),e_=new Float32Array(rx);function t_(e){let t=e<-126?-126:e;return $3[0]=(1<<23)*(t+126.94269504),e_[0]}function nx(e){return t_(1.44269504*e)}function ox(e,t,r,n){let{resolution:o,radiusOffset:a,smoothness:i}=n,s=1/o,{indices:u,x:m,y:c,z:l,id:d}=e,y=Ae.size(u),S=new Float32Array(y),x=0;for(let D=0;D<y;++D){let F=r(Ae.getAt(u,D))+a;x<F&&(x=F),S[D]=F}let g=x*2+o,h=Xe.expand(Xe(),t,p.create(g,g,g)),f=h.min,C=Xe.scale(Xe(),h,s),T=Xe.size(p(),C);p.ceil(T,T);let I=Nt.Space(T,[0,1,2],Float32Array),P=I.create(),A=Nt.create(I,P),b=I.create();b.fill(-1);let _=Nt.create(I,b),[v,R,E]=T,B=E,L=R,G=B*L,K=Va(T[0],f[0],o),X=Va(T[1],f[1],o),j=Va(T[2],f[2],o),$=I.create(),Z=i,te=Math.ceil(1e5/(Math.pow(Math.pow(x,3),3)*s));function W(D,F){for(let N=D;N<F;++N){let oe=Ae.getAt(u,N),se=m[oe],ce=c[oe],he=l[oe],ve=S[N],Pe=1/(ve*ve),me=ve*2,fe=me*me,pe=Math.ceil(me*s),Te=Math.floor(s*(se-f[0])),be=Math.floor(s*(ce-f[1])),Re=Math.floor(s*(he-f[2])),Ne=Math.max(0,Te-pe),Je=Math.max(0,be-pe),tt=Math.max(0,Re-pe),Le=Math.min(v,Te+pe+2),Ge=Math.min(R,be+pe+2),Fe=Math.min(E,Re+pe+2);for(let U=Ne;U<Le;++U){let w=K[U]-se,q=U*G;for(let ae=Je;ae<Ge;++ae){let Me=X[ae]-ce,Ee=w*w+Me*Me,ut=ae*B+q;for(let Ct=tt;Ct<Fe;++Ct){let it=j[Ct]-he,ii=Ee+it*it;if(ii<=fe){let _u=nx(-Z*(ii*Pe)),da=Ct+ut;P[da]+=_u,_u>$[da]&&($[da]=_u,b[da]=d?d[N]:N)}}}}}}function Y(){for(let D=0;D<y;D+=te)W(D,Math.min(D+te,y))}Y();let ie=re.identity();return re.fromScaling(ie,p.create(o,o,o)),re.setTranslation(ie,h.min),{field:A,idField:_,transform:ie,radiusFactor:1,resolution:o,maxRadius:x}}var qm={resolution:k.Numeric(1,{min:.1,max:20,step:.1},{...at.CustomQualityParamInfo}),radiusOffset:k.Numeric(0,{min:0,max:10,step:.1}),smoothness:k.Numeric(1.5,{min:.5,max:2.5,step:.1}),...rm},QO=k.getDefaultValues(qm);function ix(e,t,r,n){let{box:o}=t.lookup3d.boundary,a=Rh(o,n),{position:i,radius:s}=Fh(e,t,r,a);return ox(i,o,s,a)}function go(e,t,r){return{i:e,j:t,k:r}}function Mr(e,t){return{a:e,b:t}}var yt=[go(0,0,0),go(1,0,0),go(1,1,0),go(0,1,0),go(0,0,1),go(1,0,1),go(1,1,1),go(0,1,1)],ax=[Mr(yt[0],yt[1]),Mr(yt[1],yt[2]),Mr(yt[2],yt[3]),Mr(yt[3],yt[0]),Mr(yt[4],yt[5]),Mr(yt[5],yt[6]),Mr(yt[6],yt[7]),Mr(yt[7],yt[4]),Mr(yt[0],yt[4]),Mr(yt[1],yt[5]),Mr(yt[2],yt[6]),Mr(yt[3],yt[7])],sx=[{i:0,j:0,k:0,e:0},{i:1,j:0,k:0,e:1},{i:0,j:1,k:0,e:0},{i:0,j:0,k:0,e:1},{i:0,j:0,k:1,e:0},{i:1,j:0,k:1,e:1},{i:0,j:1,k:1,e:0},{i:0,j:0,k:1,e:1},{i:0,j:0,k:0,e:2},{i:1,j:0,k:0,e:2},{i:1,j:1,k:0,e:2},{i:0,j:1,k:0,e:2}],ux=[0,265,515,778,1030,1295,1541,1804,2060,2309,2575,2822,3082,3331,3593,3840,400,153,915,666,1430,1183,1941,1692,2460,2197,2975,2710,3482,3219,3993,3728,560,825,51,314,1590,1855,1077,1340,2620,2869,2111,2358,3642,3891,3129,3376,928,681,419,170,1958,1711,1445,1196,2988,2725,2479,2214,4010,3747,3497,3232,1120,1385,1635,1898,102,367,613,876,3180,3429,3695,3942,2154,2403,2665,2912,1520,1273,2035,1786,502,255,1013,764,3580,3317,4095,3830,2554,2291,3065,2800,1616,1881,1107,1370,598,863,85,348,3676,3925,3167,3414,2650,2899,2137,2384,1984,1737,1475,1226,966,719,453,204,4044,3781,3535,3270,3018,2755,2505,2240,2240,2505,2755,3018,3270,3535,3781,4044,204,453,719,966,1226,1475,1737,1984,2384,2137,2899,2650,3414,3167,3925,3676,348,85,863,598,1370,1107,1881,1616,2800,3065,2291,2554,3830,4095,3317,3580,764,1013,255,502,1786,2035,1273,1520,2912,2665,2403,2154,3942,3695,3429,3180,876,613,367,102,1898,1635,1385,1120,3232,3497,3747,4010,2214,2479,2725,2988,1196,1445,1711,1958,170,419,681,928,3376,3129,3891,3642,2358,2111,2869,2620,1340,1077,1855,1590,314,51,825,560,3728,3993,3219,3482,2710,2975,2197,2460,1692,1941,1183,1430,666,915,153,400,3840,3593,3331,3082,2822,2575,2309,2060,1804,1541,1295,1030,778,515,265,0],cx=[[],[0,8,3],[0,1,9],[1,8,3,9,8,1],[1,2,10],[0,8,3,1,2,10],[9,2,10,0,2,9],[2,8,3,2,10,8,10,9,8],[3,11,2],[0,11,2,8,11,0],[1,9,0,2,3,11],[1,11,2,1,9,11,9,8,11],[3,10,1,11,10,3],[0,10,1,0,8,10,8,11,10],[3,9,0,3,11,9,11,10,9],[9,8,10,10,8,11],[4,7,8],[4,3,0,7,3,4],[0,1,9,8,4,7],[4,1,9,4,7,1,7,3,1],[1,2,10,8,4,7],[3,4,7,3,0,4,1,2,10],[9,2,10,9,0,2,8,4,7],[2,10,9,2,9,7,2,7,3,7,9,4],[8,4,7,3,11,2],[11,4,7,11,2,4,2,0,4],[9,0,1,8,4,7,2,3,11],[4,7,11,9,4,11,9,11,2,9,2,1],[3,10,1,3,11,10,7,8,4],[1,11,10,1,4,11,1,0,4,7,11,4],[4,7,8,9,0,11,9,11,10,11,0,3],[4,7,11,4,11,9,9,11,10],[9,5,4],[9,5,4,0,8,3],[0,5,4,1,5,0],[8,5,4,8,3,5,3,1,5],[1,2,10,9,5,4],[3,0,8,1,2,10,4,9,5],[5,2,10,5,4,2,4,0,2],[2,10,5,3,2,5,3,5,4,3,4,8],[9,5,4,2,3,11],[0,11,2,0,8,11,4,9,5],[0,5,4,0,1,5,2,3,11],[2,1,5,2,5,8,2,8,11,4,8,5],[10,3,11,10,1,3,9,5,4],[4,9,5,0,8,1,8,10,1,8,11,10],[5,4,0,5,0,11,5,11,10,11,0,3],[5,4,8,5,8,10,10,8,11],[9,7,8,5,7,9],[9,3,0,9,5,3,5,7,3],[0,7,8,0,1,7,1,5,7],[1,5,3,3,5,7],[9,7,8,9,5,7,10,1,2],[10,1,2,9,5,0,5,3,0,5,7,3],[8,0,2,8,2,5,8,5,7,10,5,2],[2,10,5,2,5,3,3,5,7],[7,9,5,7,8,9,3,11,2],[9,5,7,9,7,2,9,2,0,2,7,11],[2,3,11,0,1,8,1,7,8,1,5,7],[11,2,1,11,1,7,7,1,5],[9,5,8,8,5,7,10,1,3,10,3,11],[5,7,0,5,0,9,7,11,0,1,0,10,11,10,0],[11,10,0,11,0,3,10,5,0,8,0,7,5,7,0],[11,10,5,7,11,5],[10,6,5],[0,8,3,5,10,6],[9,0,1,5,10,6],[1,8,3,1,9,8,5,10,6],[1,6,5,2,6,1],[1,6,5,1,2,6,3,0,8],[9,6,5,9,0,6,0,2,6],[5,9,8,5,8,2,5,2,6,3,2,8],[2,3,11,10,6,5],[11,0,8,11,2,0,10,6,5],[0,1,9,2,3,11,5,10,6],[5,10,6,1,9,2,9,11,2,9,8,11],[6,3,11,6,5,3,5,1,3],[0,8,11,0,11,5,0,5,1,5,11,6],[3,11,6,0,3,6,0,6,5,0,5,9],[6,5,9,6,9,11,11,9,8],[5,10,6,4,7,8],[4,3,0,4,7,3,6,5,10],[1,9,0,5,10,6,8,4,7],[10,6,5,1,9,7,1,7,3,7,9,4],[6,1,2,6,5,1,4,7,8],[1,2,5,5,2,6,3,0,4,3,4,7],[8,4,7,9,0,5,0,6,5,0,2,6],[7,3,9,7,9,4,3,2,9,5,9,6,2,6,9],[3,11,2,7,8,4,10,6,5],[5,10,6,4,7,2,4,2,0,2,7,11],[0,1,9,4,7,8,2,3,11,5,10,6],[9,2,1,9,11,2,9,4,11,7,11,4,5,10,6],[8,4,7,3,11,5,3,5,1,5,11,6],[5,1,11,5,11,6,1,0,11,7,11,4,0,4,11],[0,5,9,0,6,5,0,3,6,11,6,3,8,4,7],[6,5,9,6,9,11,4,7,9,7,11,9],[10,4,9,6,4,10],[4,10,6,4,9,10,0,8,3],[10,0,1,10,6,0,6,4,0],[8,3,1,8,1,6,8,6,4,6,1,10],[1,4,9,1,2,4,2,6,4],[3,0,8,1,2,9,2,4,9,2,6,4],[0,2,4,4,2,6],[8,3,2,8,2,4,4,2,6],[10,4,9,10,6,4,11,2,3],[0,8,2,2,8,11,4,9,10,4,10,6],[3,11,2,0,1,6,0,6,4,6,1,10],[6,4,1,6,1,10,4,8,1,2,1,11,8,11,1],[9,6,4,9,3,6,9,1,3,11,6,3],[8,11,1,8,1,0,11,6,1,9,1,4,6,4,1],[3,11,6,3,6,0,0,6,4],[6,4,8,11,6,8],[7,10,6,7,8,10,8,9,10],[0,7,3,0,10,7,0,9,10,6,7,10],[10,6,7,1,10,7,1,7,8,1,8,0],[10,6,7,10,7,1,1,7,3],[1,2,6,1,6,8,1,8,9,8,6,7],[2,6,9,2,9,1,6,7,9,0,9,3,7,3,9],[7,8,0,7,0,6,6,0,2],[7,3,2,6,7,2],[2,3,11,10,6,8,10,8,9,8,6,7],[2,0,7,2,7,11,0,9,7,6,7,10,9,10,7],[1,8,0,1,7,8,1,10,7,6,7,10,2,3,11],[11,2,1,11,1,7,10,6,1,6,7,1],[8,9,6,8,6,7,9,1,6,11,6,3,1,3,6],[0,9,1,11,6,7],[7,8,0,7,0,6,3,11,0,11,6,0],[7,11,6],[7,6,11],[3,0,8,11,7,6],[0,1,9,11,7,6],[8,1,9,8,3,1,11,7,6],[10,1,2,6,11,7],[1,2,10,3,0,8,6,11,7],[2,9,0,2,10,9,6,11,7],[6,11,7,2,10,3,10,8,3,10,9,8],[7,2,3,6,2,7],[7,0,8,7,6,0,6,2,0],[2,7,6,2,3,7,0,1,9],[1,6,2,1,8,6,1,9,8,8,7,6],[10,7,6,10,1,7,1,3,7],[10,7,6,1,7,10,1,8,7,1,0,8],[0,3,7,0,7,10,0,10,9,6,10,7],[7,6,10,7,10,8,8,10,9],[6,8,4,11,8,6],[3,6,11,3,0,6,0,4,6],[8,6,11,8,4,6,9,0,1],[9,4,6,9,6,3,9,3,1,11,3,6],[6,8,4,6,11,8,2,10,1],[1,2,10,3,0,11,0,6,11,0,4,6],[4,11,8,4,6,11,0,2,9,2,10,9],[10,9,3,10,3,2,9,4,3,11,3,6,4,6,3],[8,2,3,8,4,2,4,6,2],[0,4,2,4,6,2],[1,9,0,2,3,4,2,4,6,4,3,8],[1,9,4,1,4,2,2,4,6],[8,1,3,8,6,1,8,4,6,6,10,1],[10,1,0,10,0,6,6,0,4],[4,6,3,4,3,8,6,10,3,0,3,9,10,9,3],[10,9,4,6,10,4],[4,9,5,7,6,11],[0,8,3,4,9,5,11,7,6],[5,0,1,5,4,0,7,6,11],[11,7,6,8,3,4,3,5,4,3,1,5],[9,5,4,10,1,2,7,6,11],[6,11,7,1,2,10,0,8,3,4,9,5],[7,6,11,5,4,10,4,2,10,4,0,2],[3,4,8,3,5,4,3,2,5,10,5,2,11,7,6],[7,2,3,7,6,2,5,4,9],[9,5,4,0,8,6,0,6,2,6,8,7],[3,6,2,3,7,6,1,5,0,5,4,0],[6,2,8,6,8,7,2,1,8,4,8,5,1,5,8],[9,5,4,10,1,6,1,7,6,1,3,7],[1,6,10,1,7,6,1,0,7,8,7,0,9,5,4],[4,0,10,4,10,5,0,3,10,6,10,7,3,7,10],[7,6,10,7,10,8,5,4,10,4,8,10],[6,9,5,6,11,9,11,8,9],[3,6,11,0,6,3,0,5,6,0,9,5],[0,11,8,0,5,11,0,1,5,5,6,11],[6,11,3,6,3,5,5,3,1],[1,2,10,9,5,11,9,11,8,11,5,6],[0,11,3,0,6,11,0,9,6,5,6,9,1,2,10],[11,8,5,11,5,6,8,0,5,10,5,2,0,2,5],[6,11,3,6,3,5,2,10,3,10,5,3],[5,8,9,5,2,8,5,6,2,3,8,2],[9,5,6,9,6,0,0,6,2],[1,5,8,1,8,0,5,6,8,3,8,2,6,2,8],[1,5,6,2,1,6],[1,3,6,1,6,10,3,8,6,5,6,9,8,9,6],[10,1,0,10,0,6,9,5,0,5,6,0],[0,3,8,5,6,10],[10,5,6],[11,5,10,7,5,11],[11,5,10,11,7,5,8,3,0],[5,11,7,5,10,11,1,9,0],[10,7,5,10,11,7,9,8,1,8,3,1],[11,1,2,11,7,1,7,5,1],[0,8,3,1,2,7,1,7,5,7,2,11],[9,7,5,9,2,7,9,0,2,2,11,7],[7,5,2,7,2,11,5,9,2,3,2,8,9,8,2],[2,5,10,2,3,5,3,7,5],[8,2,0,8,5,2,8,7,5,10,2,5],[9,0,1,5,10,3,5,3,7,3,10,2],[9,8,2,9,2,1,8,7,2,10,2,5,7,5,2],[1,3,5,3,7,5],[0,8,7,0,7,1,1,7,5],[9,0,3,9,3,5,5,3,7],[9,8,7,5,9,7],[5,8,4,5,10,8,10,11,8],[5,0,4,5,11,0,5,10,11,11,3,0],[0,1,9,8,4,10,8,10,11,10,4,5],[10,11,4,10,4,5,11,3,4,9,4,1,3,1,4],[2,5,1,2,8,5,2,11,8,4,5,8],[0,4,11,0,11,3,4,5,11,2,11,1,5,1,11],[0,2,5,0,5,9,2,11,5,4,5,8,11,8,5],[9,4,5,2,11,3],[2,5,10,3,5,2,3,4,5,3,8,4],[5,10,2,5,2,4,4,2,0],[3,10,2,3,5,10,3,8,5,4,5,8,0,1,9],[5,10,2,5,2,4,1,9,2,9,4,2],[8,4,5,8,5,3,3,5,1],[0,4,5,1,0,5],[8,4,5,8,5,3,9,0,5,0,3,5],[9,4,5],[4,11,7,4,9,11,9,10,11],[0,8,3,4,9,7,9,11,7,9,10,11],[1,10,11,1,11,4,1,4,0,7,4,11],[3,1,4,3,4,8,1,10,4,7,4,11,10,11,4],[4,11,7,9,11,4,9,2,11,9,1,2],[9,7,4,9,11,7,9,1,11,2,11,1,0,8,3],[11,7,4,11,4,2,2,4,0],[11,7,4,11,4,2,8,3,4,3,2,4],[2,9,10,2,7,9,2,3,7,7,4,9],[9,10,7,9,7,4,10,2,7,8,7,0,2,0,7],[3,7,10,3,10,2,7,4,10,1,10,0,4,0,10],[1,10,2,8,7,4],[4,9,1,4,1,7,7,1,3],[4,9,1,4,1,7,0,8,1,8,7,1],[4,0,3,7,4,3],[4,8,7],[9,10,8,10,11,8],[3,0,9,3,9,11,11,9,10],[0,1,10,0,10,8,8,10,11],[3,1,10,11,3,10],[1,2,11,1,11,9,9,11,8],[3,0,9,3,9,11,1,2,9,2,11,9],[0,2,11,8,0,11],[3,2,11],[2,3,8,2,8,10,10,8,9],[9,10,2,0,9,2],[2,3,8,2,8,10,0,1,8,1,10,8],[1,10,2],[1,3,8,9,1,8],[0,9,1],[0,3,8],[]];function mx(e,t){let r=Math.min(65536,e*4),n=xe.create(Float32Array,3,e,t&&t.vertexBuffer.ref.value),o=xe.create(Float32Array,3,e,t&&t.normalBuffer.ref.value),a=xe.create(Float32Array,1,e,t&&t.groupBuffer.ref.value),i=xe.create(Uint32Array,3,r,t&&t.indexBuffer.ref.value),s=0,u=0;return{addVertex:(m,c,l)=>(++s,xe.add3(n,m,c,l)),addNormal:(m,c,l)=>{xe.add3(o,m,c,l)},addGroup:m=>{xe.add(a,m)},addTriangle:(m,c,l,d)=>{let y=m[c],S=m[l],x=m[d];y>=0&&S>=0&&x>=0&&(++u,xe.add3(i,y,S,x))},get:()=>{let m=xe.compact(n,!0),c=xe.compact(o,!0),l=xe.compact(i,!0),d=xe.compact(a,!0);return Ze.create(m,l,c,d,s,u,t)}}}function r_(e){return{...e,bottomLeft:Jt(e.bottomLeft,[0,0,0]),topRight:Jt(e.topRight,e.scalarField.space.dimensions)}}function n_(e){return{dX:e.topRight[0]-e.bottomLeft[0],dY:e.topRight[1]-e.bottomLeft[1],dZ:e.topRight[2]-e.bottomLeft[2]}}function lx(e,t){let r=r_(e),{dX:n,dY:o,dZ:a}=n_(r),i=Math.min(262144,Math.max(n*o*a/32,1024)),s=mx(i,t);return new zm(s,r).run(),s.get()}var zm=class{constructor(t,r){this.minX=0;this.minY=0;this.minZ=0;this.maxX=0;this.maxY=0;this.maxZ=0;this.state=new Km(t,r),this.minX=r.bottomLeft[0],this.minY=r.bottomLeft[1],this.minZ=r.bottomLeft[2],this.maxX=r.topRight[0]-1,this.maxY=r.topRight[1]-1,this.maxZ=r.topRight[2]-1}doSlices(){this.edgeFilter=15;for(let t=this.minZ;t<this.maxZ;t++,this.edgeFilter&=-5)this.slice(t)}slice(t){this.edgeFilter|=2;for(let r=this.minY;r<this.maxY;r++,this.edgeFilter&=-3){this.edgeFilter|=1;for(let n=this.minX;n<this.maxX;n++,this.edgeFilter&=-2)this.state.processCell(n,r,t,this.edgeFilter)}this.state.clearEdgeVertexIndexSlice(t)}run(){this.doSlices()}},Km=class{constructor(t,r){this.builder=t;this.vertList=[0,0,0,0,0,0,0,0,0,0,0,0];this.i=0;this.j=0;this.k=0;let n=r.scalarField.space.dimensions;this.nX=n[0],this.nY=n[1],this.nZ=n[2],this.isoLevel=r.isoLevel,this.scalarFieldGet=r.scalarField.space.get,this.scalarField=r.scalarField.data,r.idField&&(this.idField=r.idField.data,this.idFieldGet=r.idField.space.get),this.verticesOnEdges=new Int32Array(3*this.nX*this.nY*2)}get3dOffsetFromEdgeInfo(t){return this.nX*((this.k+t.k)%2*this.nY+this.j+t.j)+this.i+t.i}clearEdgeVertexIndexSlice(t){let r=t%2===0?0:3*this.nX*this.nY,n=t%2===0?3*this.nX*this.nY:this.verticesOnEdges.length;this.verticesOnEdges.fill(0,r,n)}interpolate(t){let r=sx[t],n=3*this.get3dOffsetFromEdgeInfo(r)+r.e,o=this.verticesOnEdges[n];if(o>0)return o-1;let a=this.scalarField,i=this.scalarFieldGet,s=ax[t],u=s.a,m=s.b,c=u.i+this.i,l=u.j+this.j,d=u.k+this.k,y=m.i+this.i,S=m.j+this.j,x=m.k+this.k,g=i(a,c,l,d),h=i(a,y,S,x),f=(this.isoLevel-g)/(g-h);if(this.idField){let B=this.idFieldGet(this.idField,c,l,d),L=this.idFieldGet(this.idField,y,S,x),G=f<.5?B:L;if(G===-1&&(G=f<.5?L:B),G===-2)return-1;this.builder.addGroup(G)}else this.builder.addGroup(0);let C=this.builder.addVertex(c+f*(c-y),l+f*(l-S),d+f*(d-x));this.verticesOnEdges[n]=C+1;let T=i(a,Math.max(0,c-1),l,d)-i(a,Math.min(this.nX-1,c+1),l,d),I=i(a,c,Math.max(0,l-1),d)-i(a,c,Math.min(this.nY-1,l+1),d),P=i(a,c,l,Math.max(0,d-1))-i(a,c,l,Math.min(this.nZ,d+1)),A=i(a,Math.max(0,y-1),S,x)-i(a,Math.min(this.nX-1,y+1),S,x),b=i(a,y,Math.max(0,S-1),x)-i(a,y,Math.min(this.nY-1,S+1),x),_=i(a,y,S,Math.max(0,x-1))-i(a,y,S,Math.min(this.nZ-1,x+1)),v=T+f*(T-A),R=I+f*(I-b),E=P+f*(P-_);return this.isoLevel>=0?this.builder.addNormal(v,R,E):this.builder.addNormal(-v,-R,-E),C}get(t,r,n){return this.scalarFieldGet(this.scalarField,t,r,n)}processCell(t,r,n,o){let a=0;if(this.get(t,r,n)<this.isoLevel&&(a|=1),this.get(t+1,r,n)<this.isoLevel&&(a|=2),this.get(t+1,r+1,n)<this.isoLevel&&(a|=4),this.get(t,r+1,n)<this.isoLevel&&(a|=8),this.get(t,r,n+1)<this.isoLevel&&(a|=16),this.get(t+1,r,n+1)<this.isoLevel&&(a|=32),this.get(t+1,r+1,n+1)<this.isoLevel&&(a|=64),this.get(t,r+1,n+1)<this.isoLevel&&(a|=128),a===0||a===255)return;this.i=t,this.j=r,this.k=n;let i=ux[a];(i&1)>0&&(this.vertList[0]=this.interpolate(0)),(i&2)>0&&(this.vertList[1]=this.interpolate(1)),(i&4)>0&&(this.vertList[2]=this.interpolate(2)),(i&8)>0&&(this.vertList[3]=this.interpolate(3)),(i&16)>0&&(this.vertList[4]=this.interpolate(4)),(i&32)>0&&(this.vertList[5]=this.interpolate(5)),(i&64)>0&&(this.vertList[6]=this.interpolate(6)),(i&128)>0&&(this.vertList[7]=this.interpolate(7)),(i&256)>0&&(this.vertList[8]=this.interpolate(8)),(i&512)>0&&(this.vertList[9]=this.interpolate(9)),(i&1024)>0&&(this.vertList[10]=this.interpolate(10)),(i&2048)>0&&(this.vertList[11]=this.interpolate(11));let s=cx[a];for(let u=0;u<s.length;u+=3){let m=s[u],c=s[u+1],l=s[u+2];this.isoLevel>=0?this.builder.addTriangle(this.vertList,m,c,l,o):this.builder.addTriangle(this.vertList,l,c,m,o)}}};var o_=p.add;function i_(e,t,r){let{ignoreHydrogens:n,traceOnly:o}=r,{atomicNumber:a}=t.model.atomicHierarchy.derived.atom,i=O.isCoarse(t),{child:s}=e,u=s==null?void 0:s.unitMap.get(t.id);if(s&&!u)throw new Error("expected childUnit to exist if child exists");if(!(!s&&!n&&!o))return m=>!!u&&!ee.has(u.elements,m)||!i&&n&&ta(a,m)||o&&!nm(t,m)}function dx(e,t,r,n,o,a){let{child:i}=r,s=i==null?void 0:i.unitMap.get(t.id);if(i&&!s)return Ze.createEmpty(a);let{detail:u,sizeFactor:m}=o,{elements:c}=t,l=c.length,d=l*f1(u),y=Ve.createState(d,d/2,a),S=p(),x=t.conformation.invariantPosition,g=i_(r,t,o),h=le.Location.create(r,t),f=n.size.size,C=p(),T=0,I=0;for(let _=0;_<l;_++){if(g&&g(c[_]))continue;h.element=c[_],x(c[_],S),o_(C,C,S),I+=1,y.currentGroup=_;let v=f(h);v>T&&(T=v),Rn(y,S,v*m,u)}let P=a?Se.clone(a.boundingSphere):void 0,A=Ve.getMesh(y);if(I===0)return A;let b;return p.scale(C,C,1/I),P&&p.distance(C,P.center)/P.radius<1?b=P:b=Se.expand(Se(),(s!=null?s:t).boundary.sphere,T*m+.05),A.setBoundingSphere(b),A}function lu(e,t,r){let n=!1;if(!le.Loci.is(e))return!1;let{structure:o,group:a}=t;if(!Ce.areEquivalent(e.structure,o))return!1;let i=a.elements.length,{unitIndexMap:s}=a;for(let u of e.elements){let m=s.get(u.unit.id);if(m!==void 0){let c=m*i;if(z.is(u.indices)){let l=c+z.start(u.indices),d=c+z.end(u.indices);r(z.ofBounds(l,d))&&(n=!0)}else for(let l=0,d=u.indices.length;l<d;l++){let y=u.indices[l],S=l+1;for(;S<d&&u.indices[S]===y;)S++;l=S-1;let x=u.indices[l];n=r(z.ofRange(c+y,c+x))||n}}}return n}var Mi;(r=>{function e(n){let{group:o,structure:a}=n,i=o.elements.length,s=o.units.length,u=le.Location.create(a);return At(i,s,1,(c,l)=>{let d=o.units[l];return u.unit=d,u.element=d.elements[c],u})}r.fromGroup=e;function t(n){let{units:o,elementCount:a}=n,i=a,s=1,{unitIndices:u,elementIndices:m}=n.serialMapping,c=le.Location.create(n);return At(i,s,1,d=>(c.unit=o[u[d]],c.element=m[d],c),!0)}r.fromStructure=t})(Mi||(Mi={}));var px={...qm,...ph,ignoreHydrogens:k.Boolean(!1),tryUseGpu:k.Boolean(!0),includeParent:k.Boolean(!1,{isHidden:!0})},jm={...zt,...Hh,...px},UH={...bi,...Gh,...px};function fx(e,t,r,n){return s_(e)}function a_(e,t,r,n,o,a){let{smoothness:i}=o,{transform:s,field:u,idField:m,radiusFactor:c,resolution:l,maxRadius:d}=ix(r,t,n.size,o),y={isoLevel:Math.exp(-i)/c,scalarField:u,idField:m},S=lx(y,a);S.meta.resolution=l,Ze.transform(S,s),e.webgl&&!e.webgl.isWebGL2?(Ze.uniformTriangleGroup(S),Q.updateIfChanged(S.varyingGroup,!1)):Q.updateIfChanged(S.varyingGroup,!0);let x=Se.expand(Se(),t.boundary.sphere,d);return S.setBoundingSphere(x),S}function s_(e){return Ir({defaultProps:k.getDefaultValues(jm),createGeometry:a_,createLocationIterator:Mi.fromGroup,eachLocation:lu,setUpdateState:(t,r,n)=>{r.resolution!==n.resolution&&(t.createGeometry=!0),r.radiusOffset!==n.radiusOffset&&(t.createGeometry=!0),r.smoothness!==n.smoothness&&(t.createGeometry=!0),r.ignoreHydrogens!==n.ignoreHydrogens&&(t.createGeometry=!0),r.traceOnly!==n.traceOnly&&(t.createGeometry=!0),r.includeParent!==n.includeParent&&(t.createGeometry=!0),r.smoothColors.name!==n.smoothColors.name?t.updateColor=!0:r.smoothColors.name==="on"&&n.smoothColors.name==="on"&&(r.smoothColors.params.resolutionFactor!==n.smoothColors.params.resolutionFactor&&(t.updateColor=!0),r.smoothColors.params.sampleStride!==n.smoothColors.params.sampleStride&&(t.updateColor=!0))},processValues:(t,r,n,o,a)=>{let{resolution:i,colorTexture:s}=r.meta,u=Rs(n.smoothColors,o.color.preferSmoothing,i);u&&(xh(t,u.resolution,u.stride,a,s),r.meta.colorTexture=t.tColorGrid.ref.value)},dispose:t=>{var r;(r=t.meta.colorTexture)==null||r.destroy()}},e)}var yx={"gaussian-surface-mesh":(e,t)=>an("Gaussian surface mesh",e,t,fx)},hx={...jm,visuals:k.MultiSelect(["gaussian-surface-mesh"],k.objectToOptions(yx))};function u_(e,t){return k.clone(hx)}function c_(e,t){return Gt.createMulti("Gaussian Surface",e,t,tr,yx)}var xx={name:"gaussian-surface",factory:c_,getParams:u_,defaultValues:k.getDefaultValues(hx),defaultColorTheme:{name:"chain-id"},defaultSizeTheme:{name:"physical"},isApplicable:e=>e.elementCount>0};var ri={linkScale:k.Numeric(.45,{min:0,max:1,step:.01}),linkSpacing:k.Numeric(1,{min:0,max:2,step:.01}),linkCap:k.Boolean(!1),aromaticScale:k.Numeric(.3,{min:0,max:1,step:.01}),aromaticSpacing:k.Numeric(1.5,{min:0,max:3,step:.01}),aromaticDashCount:k.Numeric(2,{min:2,max:6,step:2}),dashCount:k.Numeric(4,{min:2,max:10,step:2}),dashScale:k.Numeric(.8,{min:0,max:2,step:.1}),dashCap:k.Boolean(!0),stubCap:k.Boolean(!0),radialSegments:k.Numeric(16,{min:2,max:56,step:2},at.CustomQualityParamInfo)},JH=k.getDefaultValues(ri),Qm={linkScale:k.Numeric(.5,{min:0,max:1,step:.1}),linkSpacing:k.Numeric(.1,{min:0,max:2,step:.01}),aromaticDashCount:k.Numeric(2,{min:2,max:6,step:2}),dashCount:k.Numeric(4,{min:2,max:10,step:2})},$H=k.getDefaultValues(Qm),sr=p(),bo=p(),Er=p(),m_=p.create(0,1,0);function l_(e,t,r,n){p.normalize(bo,p.sub(bo,t,r)),n!==null?p.sub(Er,t,n):p.copy(Er,t),p.normalize(Er,Er);let o=p.dot(bo,Er);return 1-Math.abs(o)<1e-5&&(p.set(Er,1,0,0),o=p.dot(bo,Er),1-Math.abs(o)<1e-5&&(p.set(Er,0,1,0),o=p.dot(bo,Er))),p.setMagnitude(bo,bo,o),p.sub(Er,Er,bo),p.normalize(e,Er)}var gx=p.scale,Vn=p.add,kn=p.sub,ti=p.setMagnitude,d_=p.dot;function So(e,t,r,n){let{linkCount:o,referencePosition:a,position:i,style:s,radius:u,ignore:m,stub:c}=t;if(!o)return{mesh:Ze.createEmpty(n)};let{linkScale:l,linkSpacing:d,radialSegments:y,linkCap:S,aromaticScale:x,aromaticSpacing:g,aromaticDashCount:h,dashCount:f,dashScale:C,dashCap:T,stubCap:I}=r,P=y*2*o*2,A=Ve.createState(P,P/4,n),b=p(),_=p(),v=p(),R=p(),E=0,B={radiusTop:1,radiusBottom:1,radialSegments:y,topCap:S,bottomCap:S},L=f+1;for(let X=0,j=o;X<j;++X){if(m&&m(X))continue;i(b,_,X),Vn(R,R,b),Vn(R,R,_),E+=2,kn(sr,_,b);let $=d_(sr,m_)>0,Z=u(X),te=s?s(X):0,W=I&&(c?c(X):!1),[Y,ie]=$?[W,S]:[S,W];A.currentGroup=X;let D=h+1;if(te===0)B.radiusTop=B.radiusBottom=Z,B.topCap=Y,B.bottomCap=ie,Hr(A,b,_,.5,B);else if(te===1)B.radiusTop=B.radiusBottom=Z*C,B.topCap=B.bottomCap=T,Wo(A,b,_,.5,L,B);else if(te===2||te===3||te===4||te===5||te===7||te===8){let F=te===2||te===3?2:te===4||te===5?3:1.5,N=Z*(l/(.5*F)),oe=(Z-N)*d;if(l_(v,b,_,a?a(X):null),B.topCap=Y,B.bottomCap=ie,te===7||te===8){B.radiusTop=B.radiusBottom=Z,Hr(A,b,_,.5,B);let se=Z+x*Z+x*Z*g;ti(sr,kn(sr,_,b),Z*.5),Vn(b,b,sr),kn(_,_,sr),B.radiusTop=B.radiusBottom=Z*x,B.topCap=B.bottomCap=T,ti(v,v,se),kn(b,b,v),kn(_,_,v),Wo(A,b,_,.5,D,B),te===8&&(ti(v,v,se*2),Vn(b,b,v),Vn(_,_,v),Wo(A,b,_,.5,D,B))}else if(te===3||te===5){let se=Z+N+l*Z*d;ti(v,v,se),B.radiusTop=B.radiusBottom=Z,Hr(A,b,_,.5,B),gx(sr,sr,d*l*.2),Vn(b,b,sr),kn(_,_,sr),B.radiusTop=B.radiusBottom=N,B.topCap=$?W:T,B.bottomCap=$?T:W,ti(v,v,se),kn(b,b,v),kn(_,_,v),Hr(A,b,_,.5,B),F===3&&(ti(v,v,se*2),Vn(b,b,v),Vn(_,_,v),Hr(A,b,_,.5,B))}else ti(v,v,oe),B.radiusTop=B.radiusBottom=N,F===3&&Hr(A,b,_,.5,B),l1(A,b,_,.5,v,B)}else te===6&&(gx(sr,sr,.475),Vn(b,b,sr),kn(_,_,sr),B.radiusTop=B.radiusBottom=Z,B.topCap=Y,B.bottomCap=ie,Hr(A,b,_,.5,B))}let G=n?Se.clone(n.boundingSphere):void 0,K=Ve.getMesh(A);return E===0?{mesh:K}:(p.scale(R,R,1/E),G&&p.distance(R,G.center)/G.radius<1?{mesh:K,boundingSphere:G}:{mesh:K})}var Xm={includeTypes:k.MultiSelect(Kd(_e.Names),k.objectToOptions(_e.Names)),excludeTypes:k.MultiSelect([],k.objectToOptions(_e.Names)),ignoreHydrogens:k.Boolean(!1),aromaticBonds:k.Boolean(!0),multipleBonds:k.Select("symmetric",k.arrayToOptions(["off","symmetric","offset"]))},mq=k.getDefaultValues(Xm),ua={...ri,...Xm,adjustCylinderLength:k.Boolean(!1)},lq=k.getDefaultValues(ua),p_={...Qm,...Xm},dq=k.getDefaultValues(p_);function du(e,t,r){return!_e.is(e,r)||_e.is(t,r)}function bx(e,t,r){let n=t.elements,{atomicNumber:o}=t.model.atomicHierarchy.derived.atom,a=t.bonds,{a:i,b:s,edgeProps:u}=a,{flags:m}=u,{ignoreHydrogens:c,includeTypes:l,excludeTypes:d}=r,y=_e.fromNames(l),S=_e.fromNames(d),x=_e.isAll(y)&&_e.Flag.None===S,{child:g}=e,h=g==null?void 0:g.unitMap.get(t.id);if(g&&!h)throw new Error("expected childUnit to exist if child exists");if(!(x&&!c&&!g))return f=>!!h&&!ee.has(h.elements,n[i[f]])||c&&(ta(o,n[i[f]])||ta(o,n[s[f]]))||!x&&du(y,S,m[f])}function Sx(e,t){let r=e.interUnitBonds,{edges:n}=r,{ignoreHydrogens:o,includeTypes:a,excludeTypes:i}=t,s=_e.fromNames(a),u=_e.fromNames(i),m=_e.isAll(s)&&_e.Flag.None===u,{child:c}=e;if(!(m&&!o&&!c))return l=>{if(c){let d=n[l],y=c.unitMap.get(d.unitA);if(!y)return!0;let x=e.unitMap.get(d.unitA).elements[d.indexA];if(!ee.has(y.elements,x))return!0}if(o){let d=n[l],y=e.unitMap.get(d.unitA),S=e.unitMap.get(d.unitB);if(ks(y,y.elements[d.indexA])||ks(S,S.elements[d.indexB]))return!0}return!!(!m&&du(s,u,n[l].props.flag))}}var Ei;(r=>{function e(n){let{group:o,structure:a}=n,i=o.units[0],s=O.isAtomic(i)?i.bonds.edgeCount*2:0,u=o.units.length,m=Qe.Location(a,void 0,void 0,a,void 0,void 0);return At(s,u,1,(l,d)=>{let y=o.units[d];return m.aUnit=y,m.bUnit=y,m.aIndex=y.bonds.a[l],m.bIndex=y.bonds.b[l],m})}r.fromGroup=e;function t(n){let o=n.interUnitBonds.edgeCount,a=1,i=Qe.Location(n,void 0,void 0,n,void 0,void 0);return At(o,a,1,u=>{let m=n.interUnitBonds.edges[u];return i.aUnit=n.unitMap.get(m.unitA),i.aIndex=m.indexA,i.bUnit=n.unitMap.get(m.unitB),i.bIndex=m.indexB,i},!0)}r.fromStructure=t})(Ei||(Ei={}));function Cx(e,t,r,n){let o=!1;if(Qe.isLoci(e)){let{structure:a,group:i}=t;if(!Ce.areEquivalent(e.structure,a))return!1;let s=i.units[0];if(!O.isAtomic(s))return!1;let u=s.bonds.edgeCount*2;for(let m of e.bonds){if(m.aUnit!==m.bUnit)continue;let c=i.unitIndexMap.get(m.aUnit.id);if(c!==void 0){let l=s.bonds.getDirectedEdgeIndex(m.aIndex,m.bIndex);l!==-1&&r(z.ofSingleton(c*u+l))&&(o=!0)}}}else if(le.Loci.is(e)){let{structure:a,group:i}=t;if(!Ce.areEquivalent(e.structure,a))return!1;let s=i.units[0];if(!O.isAtomic(s))return!1;let u=s.bonds.edgeCount*2;for(let m of e.elements){let c=i.unitIndexMap.get(m.unit.id);if(c!==void 0){let{offset:l,b:d}=s.bonds;Ae.forEach(m.indices,y=>{for(let S=l[y],x=l[y+1];S<x;S++)(!n||Ae.has(m.indices,d[S]))&&r(z.ofSingleton(c*u+S))&&(o=!0)})}}}return o}var Ym=new Map;function _x(e,t,r,n){let o=!1;if(Qe.isLoci(e)){if(!Ce.areEquivalent(e.structure,t))return!1;for(let a of e.bonds){let i=t.interUnitBonds.getBondIndexFromLocation(a);i!==-1&&r(z.ofSingleton(i))&&(o=!0)}}else if(le.Loci.is(e)){if(!Ce.areEquivalent(e.structure,t)||n&&e.elements.length===1)return!1;for(let a of e.elements)Ym.set(a.unit.id,a.indices);for(let a of e.elements){let{unit:i}=a;O.isAtomic(i)&&t.interUnitBonds.getConnectedUnits(i.id).forEach(s=>{let u=Ym.get(s.unitB);(!n||u)&&Ae.forEach(a.indices,m=>{s.connectedIndices.includes(m)&&s.getEdges(m).forEach(c=>{if(!n||u&&Ae.has(u,c.indexB)){let l=t.interUnitBonds.getEdgeIndex(m,i.id,c.indexB,s.unitB);r(z.ofSingleton(l))&&(o=!0)}})})})}Ym.clear()}return o}var Zm=_e.is;function f_(e,t,r,n){let o=e.elements,a=e.bonds,{edgeCount:i,a:s,b:u,edgeProps:m,offset:c}=a,{order:l,flags:d}=m,{sizeFactor:y,sizeAspectRatio:S,adjustCylinderLength:x,aromaticBonds:g,includeTypes:h,excludeTypes:f,multipleBonds:C}=n,T=C==="off",I=C==="symmetric",P=_e.fromNames(h),A=_e.fromNames(f),b=du(P,A,_e.Flag.Computed),_=p(),v=p(),R=e.conformation.invariantPosition,E,B=le.Location.create(t,e),L=Qe.Location(t,e,void 0,t,e,void 0),{child:G}=t;if(n.includeParent&&G){let W=G.unitMap.get(e.id);if(!W)throw new Error("expected childUnit to exist");E=Y=>{let ie=o[s[Y]],D=o[u[Y]];return ee.has(W.elements,ie)&&!ee.has(W.elements,D)}}let K=W=>(L.aIndex=s[W],L.bIndex=u[W],r.size.size(L)*y),X=W=>(B.element=o[s[W]],r.size.size(B)*y),j=W=>(B.element=o[u[W]],r.size.size(B)*y),{elementRingIndices:$,elementAromaticRingIndices:Z}=e.rings,te=g?e.resonance.delocalizedTriplets:void 0;return{linkCount:i*2,referencePosition:W=>{let Y=s[W],ie=u[W],D=te==null?void 0:te.getThirdElement(Y,ie);if(D!==void 0)return R(o[D],_);Y>ie&&([Y,ie]=[ie,Y]),c[Y+1]-c[Y]===1&&([Y,ie]=[ie,Y]);let F=Z.get(Y)||$.get(Y),N=0;for(let oe=c[Y],se=c[Y+1];oe<se;++oe){let ce=u[oe];if(ce!==ie&&ce!==Y)if(F){let he=Z.get(ce)||$.get(ce);if(!he)continue;let ve=bc(F,he);ve>N&&(N=ve,R(o[ce],_))}else return R(o[ce],_)}return N>0?_:null},position:(W,Y,ie)=>{if(R(o[s[ie]],W),R(o[u[ie]],Y),x){let D=X(ie),F=j(ie),N=Math.min(D,F)*S,oe=Math.sqrt(Math.max(0,D*D-N*N))-.05,se=Math.sqrt(Math.max(0,F*F-N*N))-.05;if(oe<=.01&&se<=.01)return;p.normalize(v,p.sub(v,Y,W)),p.scaleAndAdd(W,W,v,oe),p.scaleAndAdd(Y,Y,v,-se)}},style:W=>{let Y=l[W],ie=d[W];if(Zm(ie,_e.Flag.MetallicCoordination)||Zm(ie,_e.Flag.HydrogenBond))return 1;if(Y===3)return T?0:I?4:5;if(g){let D=s[W],F=u[W],N=Z.get(D),oe=Z.get(F),se=N&&oe?bc(N,oe):0;if(Zm(ie,_e.Flag.Aromatic)||se&&!b)return se===2?8:7}return Y!==2||T?0:I?2:3},radius:W=>K(W)*S,ignore:bx(t,e,n),stub:E}}function y_(e,t,r,n,o,a){if(!O.isAtomic(t))return Ze.createEmpty(a);if(!t.bonds.edgeCount)return Ze.createEmpty(a);let{child:i}=r,s=i==null?void 0:i.unitMap.get(t.id);if(i&&!s)return Ze.createEmpty(a);let u=f_(t,r,n,o),{mesh:m,boundingSphere:c}=So(e,u,o,a);if(c)m.setBoundingSphere(c);else if(m.triangleCount>0){let l=Se.expand(Se(),(s!=null?s:t).boundary.sphere,1*o.sizeFactor);m.setBoundingSphere(l)}return m}var Wm={...zt,...Oh,...ua,sizeFactor:k.Numeric(.3,{min:0,max:10,step:.01}),sizeAspectRatio:k.Numeric(2/3,{min:0,max:3,step:.01}),tryUseImpostor:k.Boolean(!0),includeParent:k.Boolean(!1)};function Ix(e,t,r,n){return h_(e)}function h_(e){return Ir({defaultProps:k.getDefaultValues(Wm),createGeometry:y_,createLocationIterator:Ei.fromGroup,eachLocation:Cx,setUpdateState:(t,r,n,o,a,i,s)=>{t.createGeometry=r.sizeFactor!==n.sizeFactor||r.sizeAspectRatio!==n.sizeAspectRatio||r.radialSegments!==n.radialSegments||r.linkScale!==n.linkScale||r.linkSpacing!==n.linkSpacing||r.ignoreHydrogens!==n.ignoreHydrogens||r.linkCap!==n.linkCap||r.aromaticScale!==n.aromaticScale||r.aromaticSpacing!==n.aromaticSpacing||r.aromaticDashCount!==n.aromaticDashCount||r.dashCount!==n.dashCount||r.dashScale!==n.dashScale||r.dashCap!==n.dashCap||r.stubCap!==n.stubCap||!Jn(r.includeTypes,n.includeTypes)||!Jn(r.excludeTypes,n.excludeTypes)||r.adjustCylinderLength!==n.adjustCylinderLength||r.aromaticBonds!==n.aromaticBonds||r.multipleBonds!==n.multipleBonds;let u=i.group.units[0],m=s.group.units[0];O.isAtomic(u)&&O.isAtomic(m)&&(qt.areEqual(u.bonds,m.bonds)||(t.createGeometry=!0,t.updateTransform=!0,t.updateColor=!0,t.updateSize=!0))}},e)}var Jm=new Qe.ElementBondIterator;function Px(e,t,r,n){for(Jm.setElement(t,r,n);Jm.hasNext;){let o=Jm.move();return o.otherUnit.conformation.position(o.otherUnit.elements[o.otherIndex],e),e}return null}var Tx=p();function x_(e,t,r){let n=le.Location.create(e),o=Qe.Location(e,void 0,void 0,e,void 0,void 0),a=e.interUnitBonds,{edgeCount:i,edges:s}=a,{sizeFactor:u,sizeAspectRatio:m,adjustCylinderLength:c,aromaticBonds:l,multipleBonds:d}=r,y=d==="off",S=d==="symmetric",x=p(),g,{child:h}=e;r.includeParent&&h&&(g=I=>{let P=s[I],A=h.unitMap.get(P.unitA),b=h.unitMap.get(P.unitB),v=e.unitMap.get(P.unitA).elements[P.indexA],E=e.unitMap.get(P.unitB).elements[P.indexB];return A&&ee.has(A.elements,v)&&(!b||!ee.has(b.elements,E))});let f=I=>{let P=s[I];return o.aUnit=e.unitMap.get(P.unitA),o.aIndex=P.indexA,o.bUnit=e.unitMap.get(P.unitB),o.bIndex=P.indexB,t.size.size(o)*u},C=I=>{let P=s[I];return n.unit=e.unitMap.get(P.unitA),n.element=n.unit.elements[P.indexA],t.size.size(n)*u},T=I=>{let P=s[I];return n.unit=e.unitMap.get(P.unitB),n.element=n.unit.elements[P.indexB],t.size.size(n)*u};return{linkCount:i,referencePosition:I=>{let P=s[I],A,b,_,v;if(P.unitA<P.unitB)A=e.unitMap.get(P.unitA),b=e.unitMap.get(P.unitB),_=P.indexA,v=P.indexB;else if(P.unitA>P.unitB)A=e.unitMap.get(P.unitB),b=e.unitMap.get(P.unitA),_=P.indexB,v=P.indexA;else throw new Error("same units in createInterUnitBondCylinderMesh");return Px(Tx,e,A,_)||Px(Tx,e,b,v)},position:(I,P,A)=>{let b=s[A],_=e.unitMap.get(b.unitA),v=e.unitMap.get(b.unitB);if(_.conformation.position(_.elements[b.indexA],I),v.conformation.position(v.elements[b.indexB],P),c){let R=C(A),E=T(A),B=Math.min(R,E)*m,L=Math.sqrt(Math.max(0,R*R-B*B))-.05,G=Math.sqrt(Math.max(0,E*E-B*B))-.05;if(L<=.01&&G<=.01)return;p.normalize(x,p.sub(x,P,I)),p.scaleAndAdd(I,I,x,L),p.scaleAndAdd(P,P,x,-G)}},style:I=>{let P=s[I].props.order,A=Ot.create(s[I].props.flag);return _e.is(A,_e.Flag.MetallicCoordination)||_e.is(A,_e.Flag.HydrogenBond)?1:P===3?y?0:S?4:5:l&&_e.is(A,_e.Flag.Aromatic)?7:P!==2||y?0:S?2:3},radius:I=>f(I)*m,ignore:Sx(e,r),stub:g}}function g_(e,t,r,n,o){if(!t.interUnitBonds.edgeCount)return Ze.createEmpty(o);let a=x_(t,r,n),{mesh:i,boundingSphere:s}=So(e,a,n,o);if(s)i.setBoundingSphere(s);else if(i.triangleCount>0){let{child:u}=t,m=Se.expand(Se(),(u!=null?u:t).boundary.sphere,1*n.sizeFactor);i.setBoundingSphere(m)}return i}var $m={...bi,...kh,...ua,sizeFactor:k.Numeric(.3,{min:0,max:10,step:.01}),sizeAspectRatio:k.Numeric(2/3,{min:0,max:3,step:.01}),tryUseImpostor:k.Boolean(!0),includeParent:k.Boolean(!1)};function vx(e,t,r,n){return b_(e)}function b_(e){return En({defaultProps:k.getDefaultValues($m),createGeometry:g_,createLocationIterator:Ei.fromStructure,eachLocation:_x,setUpdateState:(t,r,n,o,a,i,s)=>{t.createGeometry=r.sizeFactor!==n.sizeFactor||r.sizeAspectRatio!==n.sizeAspectRatio||r.radialSegments!==n.radialSegments||r.linkScale!==n.linkScale||r.linkSpacing!==n.linkSpacing||r.ignoreHydrogens!==n.ignoreHydrogens||r.linkCap!==n.linkCap||r.aromaticScale!==n.aromaticScale||r.aromaticSpacing!==n.aromaticSpacing||r.aromaticDashCount!==n.aromaticDashCount||r.dashCount!==n.dashCount||r.dashScale!==n.dashScale||r.dashCap!==n.dashCap||r.stubCap!==n.stubCap||!Jn(r.includeTypes,n.includeTypes)||!Jn(r.excludeTypes,n.excludeTypes)||r.adjustCylinderLength!==n.adjustCylinderLength||r.multipleBonds!==n.multipleBonds,i.interUnitBonds!==s.interUnitBonds&&(t.createGeometry=!0,t.updateTransform=!0,t.updateColor=!0,t.updateSize=!0)}},e)}var el={...zt,...Nh,sizeFactor:k.Numeric(1,{min:0,max:10,step:.1}),detail:k.Numeric(0,{min:0,max:3,step:1},at.CustomQualityParamInfo),ignoreHydrogens:k.Boolean(!1),traceOnly:k.Boolean(!1),tryUseImpostor:k.Boolean(!0)};function Dx(e,t,r,n){return S_(e)}function S_(e){return Ir({defaultProps:k.getDefaultValues(el),createGeometry:dx,createLocationIterator:Mi.fromGroup,eachLocation:lu,setUpdateState:(t,r,n)=>{t.createGeometry=r.sizeFactor!==n.sizeFactor||r.detail!==n.detail||r.ignoreHydrogens!==n.ignoreHydrogens||r.traceOnly!==n.traceOnly}},e)}var Mx={"element-sphere":(e,t)=>an("Element sphere",e,t,Dx),"intra-bond":(e,t)=>an("Intra-unit bond cylinder",e,t,Ix),"inter-bond":(e,t)=>Ko("Inter-unit bond cylinder",e,t,vx)},Ex={...el,traceOnly:k.Boolean(!1,{isHidden:!0}),...Wm,...$m,includeParent:k.Boolean(!1),unitKinds:om(["atomic"]),sizeFactor:k.Numeric(.15,{min:.01,max:10,step:.01}),sizeAspectRatio:k.Numeric(2/3,{min:.01,max:3,step:.01}),visuals:k.MultiSelect(["element-sphere","intra-bond","inter-bond"],k.objectToOptions(Mx))};function C_(e,t){return k.clone(Ex)}function __(e,t){return Gt.createMulti("Ball & Stick",e,t,tr,Mx)}var Bx={name:"ball-and-stick",factory:__,getParams:C_,defaultValues:k.getDefaultValues(Ex),defaultColorTheme:{name:"element-symbol"},defaultSizeTheme:{name:"physical"},isApplicable:e=>e.elementCount>0};function A_(e,t,r,n,o){let{links:a,elements:i}=t.carbohydrates,{linkSizeFactor:s}=n,u=le.Location.create(t),m={linkCount:a.length,position:(d,y,S)=>{let x=a[S];p.copy(d,i[x.carbohydrateIndexA].geometry.center),p.copy(y,i[x.carbohydrateIndexB].geometry.center)},radius:d=>{let y=a[d],S=i[y.carbohydrateIndexA],x=S.unit.rings.all[S.ringIndex];return u.unit=S.unit,u.element=S.unit.elements[x[0]],r.size.size(u)*s}},{mesh:c,boundingSphere:l}=So(e,m,n,o);if(l)c.setBoundingSphere(l);else if(c.triangleCount>0){let d=Se.expand(Se(),t.boundary.sphere,1*s);c.setBoundingSphere(d)}return c}var rl={...zt,...ri,linkSizeFactor:k.Numeric(.3,{min:0,max:3,step:.01})};function Rx(e){return En({defaultProps:k.getDefaultValues(rl),createGeometry:A_,createLocationIterator:I_,eachLocation:P_,setUpdateState:(t,r,n)=>{t.createGeometry=r.linkSizeFactor!==n.linkSizeFactor||r.radialSegments!==n.radialSegments||r.linkCap!==n.linkCap}},e)}function I_(e){let{elements:t,links:r}=e.carbohydrates,n=r.length,o=1,a=le.Location.create(e);return At(n,o,1,s=>{let u=r[s],m=t[u.carbohydrateIndexA],c=m.unit.rings.all[m.ringIndex];return a.unit=m.unit,a.element=m.unit.elements[c[0]],a},!0)}var tl=new Set;function P_(e,t,r){let n=!1;if(!le.Loci.is(e)||!Ce.areEquivalent(e.structure,t))return!1;let{getLinkIndices:o}=t.carbohydrates;for(let{unit:a,indices:i}of e.elements)O.isAtomic(a)&&(tl.clear(),Ae.forEach(i,s=>{let u=o(a,a.elements[s]);for(let m=0,c=u.length;m<c;++m)tl.has(u[m])||(tl.add(u[m]),r(z.ofSingleton(u[m]))&&(n=!0))}));return n}var Gn=p(),wn=p(),Nn=p(),Bi=p(),ht=dr(4,!0);function Fx(e){let n=Bn(12,e?36:24);for(let o=0;o<4;++o){let a=(o+1)%4;p.set(Gn,ht[o*3],ht[o*3+1],-.5),p.set(wn,ht[a*3],ht[a*3+1],-.5),p.set(Nn,ht[a*3],ht[a*3+1],.5),p.set(Bi,ht[o*3],ht[o*3+1],.5),e?n.add(Gn,wn,Nn):n.addQuad(Gn,wn,Nn,Bi)}return p.set(Gn,ht[0],ht[1],-.5),p.set(wn,ht[3],ht[4],-.5),p.set(Nn,ht[6],ht[7],-.5),p.set(Bi,ht[9],ht[10],-.5),e?n.add(Nn,wn,Gn):n.addQuad(Bi,Nn,wn,Gn),p.set(Gn,ht[0],ht[1],.5),p.set(wn,ht[3],ht[4],.5),p.set(Nn,ht[6],ht[7],.5),p.set(Bi,ht[9],ht[10],.5),e?n.add(Gn,wn,Nn):n.addQuad(Gn,wn,Nn,Bi),n.getPrimitive()}var nl;function Ux(){return nl||(nl=Fx(!1)),nl}var ol;function Lx(){return ol||(ol=Fx(!0)),ol}var T_=p.create(0,0,-.5),v_=p.create(0,0,.5),Co=p(),_o=p(),pu=p(),Vx=p();function D_(e){let t=e.length/3,n=(t===3?1:t===4?2:t)+t,o=t===4?t*3+4:n*3,a=Bn(n,o);for(let i=0;i<t;++i){let s=(i+1)%t;p.set(Co,e[i*3],e[i*3+1],-.5),p.set(_o,e[s*3],e[s*3+1],-.5),a.add(Co,_o,v_)}if(t===3)p.set(Co,e[0],e[1],-.5),p.set(_o,e[3],e[4],-.5),p.set(pu,e[6],e[7],-.5),a.add(pu,_o,Co);else if(t===4)p.set(Co,e[0],e[1],-.5),p.set(_o,e[3],e[4],-.5),p.set(pu,e[6],e[7],-.5),p.set(Vx,e[9],e[10],-.5),a.addQuad(Vx,pu,_o,Co);else for(let i=0;i<t;++i){let s=(i+1)%t;p.set(Co,e[i*3],e[i*3+1],-.5),p.set(_o,e[s*3],e[s*3+1],-.5),a.add(T_,_o,Co)}return a.getPrimitive()}var il;function kx(){return il||(il=D_(dr(8,!0))),il}var al;function Gx(){if(!al){let e=dr(8,!0),t=new Float32Array(8*3+6);for(let n=0;n<8;++n)t[n*3]=e[n*3],t[n*3+1]=e[n*3+1],t[n*3+2]=-.5;t[8*3]=0,t[8*3+1]=0,t[8*3+2]=-.5,t[8*3+3]=0,t[8*3+4]=0,t[8*3+5]=.5,al=Xo(t,[0,1,8,1,2,8,4,5,8,5,6,8,2,3,9,3,4,9,6,7,9,7,0,9])}return al}var M_={pointCount:5,outerRadius:1,innerRadius:.5,thickness:.3},sl=p.zero(),ul=p.zero(),cl=p.zero(),ca=p.zero(),ml=p.zero();function wx(e){let{outerRadius:t,innerRadius:r,thickness:n,pointCount:o}={...M_,...e},a=o*2*2,i=Bn(a),s=new Float32Array(o*2),u=new Float32Array(o*2);for(let m=0;m<o;++m){let c=m*2,l=m*2+1,d=(c+1)/o*Math.PI,y=(l+1)/o*Math.PI;u[c]=Math.cos(d)*t,u[l]=Math.sin(d)*t,s[c]=Math.cos(y)*r,s[l]=Math.sin(y)*r}p.set(sl,0,0,n/2),p.set(ul,0,0,-n/2);for(let m=0;m<o;++m){let c=(m+1)%o;p.set(cl,u[m*2],u[m*2+1],0),p.set(ca,s[m*2],s[m*2+1],0),p.set(ml,u[c*2],u[c*2+1],0),i.add(sl,cl,ca),i.add(ca,cl,ul),i.add(sl,ca,ml),i.add(ml,ca,ul)}return i.getPrimitive()}var Nx=[.5,0,0,-.5,0,0,0,.5,0,0,-.5,0,0,0,.5,0,0,-.5],E_=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],B_=[0,2,4,0,4,3,1,2,5,1,5,3],ll;function Ox(){return ll||(ll=Xo(Nx,E_)),ll}var dl;function Hx(){return dl||(dl=Xo(Nx,B_)),dl}var ge=re.identity(),On=p(),qx=p(),R_=2*.806,zx=Ux(),Kx=Lx(),F_=kx(),jx=Gx(),U_=wx({outerRadius:1,innerRadius:.5,thickness:.5,pointCount:5}),L_=Ox(),Qx=Hx(),Yx=t1(),V_=r1(),k_=n1(),G_=o1(),w_=i1();function N_(e,t,r,n,o){let a=Ve.createState(256,128,o),{detail:i,sizeFactor:s}=n,u=t.carbohydrates,m=u.elements.length,c=le.Location.create(t);for(let l=0;l<m;++l){let d=u.elements[l],y=d.unit.rings.all[d.ringIndex],S=fp(d.component.type,y.length);c.unit=d.unit,c.element=d.unit.elements[y[0]];let x=r.size.size(c),g=x*s,h=x*s*R_,{center:f,normal:C,direction:T}=d.geometry;switch(p.add(qx,f,T),re.targetTo(ge,f,qx,C),re.setTranslation(ge,f),a.currentGroup=l*2,S){case 0:Rn(a,f,g,i);break;case 1:re.scaleUniformly(ge,ge,h),Ve.addPrimitive(a,ge,zx);break;case 2:re.scaleUniformly(ge,ge,h),Ve.addPrimitive(a,ge,Kx),re.mul(ge,ge,re.rotZ90X180),a.currentGroup+=1,Ve.addPrimitive(a,ge,Kx);break;case 4:re.scaleUniformly(ge,ge,h*1.2),Ve.addPrimitive(a,ge,F_);break;case 5:re.scaleUniformly(ge,ge,h*1.2),Ve.addPrimitive(a,ge,jx),re.mul(ge,ge,re.rotZ90),a.currentGroup+=1,Ve.addPrimitive(a,ge,jx);break;case 6:re.mul(ge,ge,re.rotZY90),re.scale(ge,ge,p.set(On,h,h,h/2)),Ve.addPrimitive(a,ge,zx);break;case 7:re.scaleUniformly(ge,ge,h),re.mul(ge,ge,re.rotZY90),Ve.addPrimitive(a,ge,U_);break;case 8:re.mul(ge,ge,re.rotZY90),re.scale(ge,ge,p.set(On,h*1.4,h*1.4,h*1.4)),Ve.addPrimitive(a,ge,L_);break;case 3:re.mul(ge,ge,re.rotZY90),re.scale(ge,ge,p.set(On,h*1.4,h*1.4,h*1.4)),Ve.addPrimitive(a,ge,Qx),re.mul(ge,ge,re.rotY90),a.currentGroup+=1,Ve.addPrimitive(a,ge,Qx);break;case 9:re.mul(ge,ge,re.rotZY90),re.scale(ge,ge,p.set(On,h,h/2,h/2)),Ve.addPrimitive(a,ge,Yx);break;case 12:re.mul(ge,ge,re.rotZY90),re.scale(ge,ge,p.set(On,h,h,h/2)),Ve.addPrimitive(a,ge,Yx);break;case 13:case 11:re.mul(ge,ge,re.rotZY90),re.scale(ge,ge,p.set(On,h,h,h/2)),Ve.addPrimitive(a,ge,V_);break;case 14:re.mul(ge,ge,re.rotZY90),re.scale(ge,ge,p.set(On,h,h,h/2)),Ve.addPrimitive(a,ge,k_);break;case 15:re.mul(ge,ge,re.rotZY90),re.scale(ge,ge,p.set(On,h,h,h/2)),Ve.addPrimitive(a,ge,w_);break;case 10:default:re.mul(ge,ge,re.rotZYZ90),re.scale(ge,ge,p.set(On,h/1.5,h,h/2)),Ve.addPrimitive(a,ge,G_);break}}return Ve.getMesh(a)}var fl={...bi,detail:k.Numeric(0,{min:0,max:3,step:1},at.CustomQualityParamInfo),sizeFactor:k.Numeric(1.75,{min:0,max:10,step:.01})};function Xx(e){return En({defaultProps:k.getDefaultValues(fl),createGeometry:N_,createLocationIterator:O_,eachLocation:H_,setUpdateState:(t,r,n)=>{t.createGeometry=r.sizeFactor!==n.sizeFactor||r.detail!==n.detail}},e)}function O_(e){let t=e.carbohydrates.elements,r=t.length*2,n=1,o=le.Location.create(e);function a(s,u){let m=t[Math.floor(s/2)],c=m.unit.rings.all[m.ringIndex];return o.unit=m.unit,o.element=m.unit.elements[c[0]],o}function i(s,u){return s%2===1}return At(r,n,1,a,!0,i)}var pl=new Set;function H_(e,t,r){let{getElementIndices:n}=t.carbohydrates,o=!1;if(!le.Loci.is(e)||!Ce.areEquivalent(e.structure,t))return!1;for(let{unit:a,indices:i}of e.elements)O.isAtomic(a)&&(pl.clear(),Ae.forEach(i,s=>{let u=n(a,a.elements[s]);for(let m=0,c=u.length;m<c;++m)pl.has(u[m])||(pl.add(u[m]),r(z.ofSingleton(u[m]*2))&&(o=!0))}));return o}function q_(e,t,r,n,o){let{terminalLinks:a,elements:i}=t.carbohydrates,{terminalLinkSizeFactor:s}=n,u=le.Location.create(t),m={linkCount:a.length,position:(d,y,S)=>{let x=a[S];x.fromCarbohydrate?(p.copy(d,i[x.carbohydrateIndex].geometry.center),x.elementUnit.conformation.position(x.elementUnit.elements[x.elementIndex],y)):(x.elementUnit.conformation.position(x.elementUnit.elements[x.elementIndex],d),p.copy(y,i[x.carbohydrateIndex].geometry.center))},radius:d=>{let y=a[d];if(y.fromCarbohydrate){let S=i[y.carbohydrateIndex],x=S.unit.rings.all[S.ringIndex];u.unit=S.unit,u.element=S.unit.elements[x[0]]}else u.unit=y.elementUnit,u.element=y.elementUnit.elements[y.elementIndex];return r.size.size(u)*s},style:d=>{let y=a[d],S=y.elementUnit.elements[y.elementIndex],x=gr(y.elementUnit.model.atomicHierarchy.atoms.type_symbol.value(S));return no.has(x)?1:0}},{mesh:c,boundingSphere:l}=So(e,m,n,o);if(l)c.setBoundingSphere(l);else if(c.triangleCount>0){let d=Se.expand(Se(),t.boundary.sphere,1*s);c.setBoundingSphere(d)}return c}var hl={...zt,...ri,terminalLinkSizeFactor:k.Numeric(.2,{min:0,max:3,step:.01})};function Zx(e){return En({defaultProps:k.getDefaultValues(hl),createGeometry:q_,createLocationIterator:z_,eachLocation:K_,setUpdateState:(t,r,n)=>{t.createGeometry=r.terminalLinkSizeFactor!==n.terminalLinkSizeFactor||r.radialSegments!==n.radialSegments||r.linkCap!==n.linkCap}},e)}function z_(e){let{elements:t,terminalLinks:r}=e.carbohydrates,n=r.length,o=1,a=le.Location.create(e);return At(n,o,1,s=>{let u=r[s];if(u.fromCarbohydrate){let m=t[u.carbohydrateIndex],c=m.unit.rings.all[m.ringIndex];a.unit=m.unit,a.element=m.unit.elements[c[0]]}else a.unit=u.elementUnit,a.element=u.elementUnit.elements[u.elementIndex];return a},!0)}var yl=new Set;function K_(e,t,r){let n=!1;if(!le.Loci.is(e)||!Ce.areEquivalent(e.structure,t))return!1;let{getTerminalLinkIndices:o}=t.carbohydrates;for(let{unit:a,indices:i}of e.elements)O.isAtomic(a)&&(yl.clear(),Ae.forEach(i,s=>{let u=o(a,a.elements[s]);for(let m=0,c=u.length;m<c;++m)yl.has(u[m])||(yl.add(u[m]),r(z.ofSingleton(u[m]))&&(n=!0))}));return n}var Wx={"carbohydrate-symbol":(e,t)=>Ko("Carbohydrate symbol mesh",e,t,Xx),"carbohydrate-link":(e,t)=>Ko("Carbohydrate link cylinder",e,t,Rx),"carbohydrate-terminal-link":(e,t)=>Ko("Carbohydrate terminal link cylinder",e,t,Zx)},Jx={...fl,...rl,...hl,visuals:k.MultiSelect(["carbohydrate-symbol","carbohydrate-link","carbohydrate-terminal-link"],k.objectToOptions(Wx))};function j_(e,t){return k.clone(Jx)}function Q_(e,t){return Gt.createMulti("Carbohydrate",e,t,tr,Wx)}var $x={name:"carbohydrate",factory:Q_,getParams:j_,defaultValues:k.getDefaultValues(Jx),defaultColorTheme:{name:"carbohydrate-symbol"},defaultSizeTheme:{name:"uniform"},isApplicable:e=>e.models.some(t=>lt.hasCarbohydrate(t))};var dn;(i=>{function e(s){return{name:s}}i.Symbol=e;function t(s,u){return u?{head:s,args:u}:{head:s}}i.Apply=t;function r(s){return!!s&&Array.isArray(s)}i.isArgumentsArray=r;function n(s){return!o(s)&&!a(s)}i.isLiteral=n;function o(s){return!!s&&!!s.head&&typeof s=="object"}function a(s){return!!s&&typeof s.name=="string"}i.isSymbol=a})(dn||(dn={}));var xl=class{constructor(){this.map=new Map}addSymbol(t){this.map.set(t.symbol.id,t)}getRuntime(t){return this.map.get(t)}},Sl=new xl,gl=class{constructor(t){this.table=t;this.constQueryContext=new tn(Ce.Empty)}},ni;(r=>{function e(n){return{isConst:!0,fn:function(a){return n}}}r.Const=e;function t(n){return{isConst:!1,fn:n}}r.Dynamic=t})(ni||(ni={}));var fu;(t=>{function e(r,n,o,a){if(typeof r.length=="number")for(let i=0,s=r.length;i<s;i++)o(r[i](n),i,a);else{let i=0;for(let s of Object.keys(r))o(r[s](n),i++,a)}return a}t.forEachEval=e})(fu||(fu={}));var ma;(r=>{function e(n,o){return new yu(n,o,!0)}r.Const=e;function t(n,o){return new yu(n,o,!1)}r.Dynamic=t})(ma||(ma={}));var yu=class{constructor(t,r,n){this.symbol=t;this.fn=r;this.isConst=n}compile(t,r){let n,o=!1;if(!r)n=void 0,o=!0;else if(dn.isArgumentsArray(r)){n=[],o=!0;for(let a of r){let i=bl(t,a);o=o&&i.isConst,n.push(i.fn)}}else{n=Object.create(null),o=!0;for(let a of Object.keys(r)){let i=bl(t,r[a]);o=o&&i.isConst,n[a]=i.fn}}return this.isConst?this.isConst&&o?ni.Const(this.fn(t.constQueryContext,n)):ni.Dynamic(e0(this.fn,n)):ni.Dynamic(e0(this.fn,n))}};function e0(e,t){return function(n){return e(n,t)}}function bl(e,t){if(dn.isLiteral(t))return ni.Const(t);if(dn.isSymbol(t)){let n=e.table.getRuntime(t.name);return n?n.compile(e):ni.Const(t.name)}if(!dn.isSymbol(t.head))throw new Error("Can only apply symbols.");let r=e.table.getRuntime(t.head.name);if(!r)throw new Error(`Symbol '${t.head.name}' is not implemented.`);return r.compile(e,t.args)}function t0(e){let t=new gl(Sl);return bl(t,e).fn}var de;(l=>{function e(d,y,S){return{kind:"variable",name:d,type:y,isConstraint:S}}l.Variable=e;function t(d,y,S){return{kind:"value",namespace:d,name:y,parent:S}}l.Value=t;function r(d,y,S,x){return{kind:"container",namespace:d,name:y,child:S,alias:x}}l.Container=r;function n(d){return{kind:"union",types:d}}l.Union=n;function o(d,y,S,x){let g=Object.create(null);for(let h of x)g[h]=!0;return{kind:"oneof",namespace:d,name:y,type:S,values:g}}l.OneOf=o,l.Any={kind:"any"},l.AnyValue={kind:"any-value"},l.Num=t("","Number"),l.Str=t("","String"),l.Bool=o("","Bool",l.Str,["true","false"]);function c({values:d}){return Object.keys(d).sort()}l.oneOfValues=c})(de||(de={}));function qe(e,t){let{isOptional:r=!1,defaultValue:n=void 0}=t||{};return{type:e,isOptional:r,defaultValue:n}}var et;(n=>{n.None=t({});function t(o){return{kind:"dictionary",map:o,"@type":0}}n.Dictionary=t;function r(o,a){let{nonEmpty:i=!1}=a||{};return{kind:"list",type:o,nonEmpty:i,"@type":0}}n.List=r})(et||(et={}));function r0(e,t,r){let n=function(o){return dn.Apply(dn.Symbol(n.id),o)};return n.info={namespace:"",name:e},n.id="",n.args=t,n.type=r,n}function n0(e){let t=e;return typeof t=="function"&&!!t.info&&!!t.args&&typeof t.info.namespace=="string"&&!!t.type}function nt(e,t){return r0("",e,t)}function hu(e){i0("","",e)}function o0(e){let t=/([a-z])([A-Z])([a-z]|$)/g;return e.replace(t,(r,n,o,a)=>`${n}-${o.toLocaleLowerCase()}${a}`).replace(t,(r,n,o,a)=>`${n}-${o.toLocaleLowerCase()}${a}`)}function i0(e,t,r){if(n0(r)){r.info.namespace=e,r.info.name=r.info.name||o0(t),r.id=`${r.info.namespace}.${r.info.name}`;return}let n=`${r["@namespace"]||o0(t)}`,o=e?`${e}.${n}`:n;for(let a of Object.keys(r))i0(o,a,r[a])}var Mt;(m=>(m.AnyVar=de.Variable("a",de.Any),m.AnyValueVar=de.Variable("a",de.Any),m.ConstrainedVar=de.Variable("a",de.Any,!0),m.Regex=de.Value("Core","Regex"),m.Set=c=>de.Container("Core","Set",c||m.AnyValueVar),m.List=c=>de.Container("Core","List",c||m.AnyVar),m.Fn=(c,l)=>de.Container("Core","Fn",c||m.AnyVar,l),m.Flags=(c,l)=>de.Container("Core","Flags",c,l),m.BitFlags=(0,m.Flags)(de.Num,"BitFlags")))(Mt||(Mt={}));function Y_(e,t){return nt(et.Dictionary({0:qe(e)}),e)}function a0(e,t){return nt(et.List(e,{nonEmpty:!0}),e)}function s0(e,t,r){return nt(et.Dictionary({0:qe(e),1:qe(e)}),t)}var X_={regex:nt(et.Dictionary({0:qe(de.Str,{}),1:qe(de.Str,{isOptional:!0})}),Mt.Regex),list:nt(et.List(Mt.AnyVar),Mt.List()),set:nt(et.List(Mt.AnyValueVar),Mt.Set()),bitflags:nt(et.Dictionary({0:qe(de.Num)}),Mt.BitFlags)},Z_={not:Y_(de.Bool),and:a0(de.Bool),or:a0(de.Bool)},W_={eq:s0(de.Variable("a",de.AnyValue,!0),de.Bool),neq:s0(de.Variable("a",de.AnyValue,!0),de.Bool)},J_={match:nt(et.Dictionary({0:qe(Mt.Regex),1:qe(de.Str)}),de.Bool)},$_={has:nt(et.Dictionary({0:qe(Mt.Set(Mt.ConstrainedVar)),1:qe(Mt.ConstrainedVar)}),de.Bool)},eA={hasAny:nt(et.Dictionary({0:qe(Mt.Flags(Mt.ConstrainedVar)),1:qe(Mt.Flags(Mt.ConstrainedVar))}),de.Bool)},Cl={type:X_,logic:Z_,rel:W_,str:J_,set:$_,flags:eA};hu(Cl);var Oe;(x=>(x.ElementSymbol=de.Value("Structure","ElementSymbol"),x.AtomName=de.Value("Structure","AtomName"),x.BondFlag=de.OneOf("Structure","BondFlag",de.Str,["covalent","metallic","ion","hydrogen","sulfide","computed","aromatic"]),x.BondFlags=Mt.Flags(x.BondFlag,"BondFlags"),x.SecondaryStructureFlag=de.OneOf("Structure","SecondaryStructureFlag",de.Str,["alpha","beta","3-10","pi","sheet","strand","helix","turn","none"]),x.SecondaryStructureFlags=Mt.Flags(x.SecondaryStructureFlag,"SecondaryStructureFlag"),x.RingFingerprint=de.Value("Structure","RingFingerprint"),x.EntityType=de.OneOf("Structure","EntityType",de.Str,["polymer","non-polymer","water","branched"]),x.EntitySubtype=de.OneOf("Structure","EntitySubtype",de.Str,["other","polypeptide(D)","polypeptide(L)","polydeoxyribonucleotide","polyribonucleotide","polydeoxyribonucleotide/polyribonucleotide hybrid","cyclic-pseudo-peptide","peptide nucleic acid","oligosaccharide"]),x.ObjectPrimitive=de.OneOf("Structure","ObjectPrimitive",de.Str,["atomistic","sphere","gaussian","other"]),x.ResidueId=de.Value("Structure","ResidueId"),x.ElementSet=de.Value("Structure","ElementSet"),x.ElementSelection=de.Value("Structure","ElementSelection"),x.ElementReference=de.Value("Structure","ElementReference"),x.ElementSelectionQuery=Mt.Fn(x.ElementSelection,"ElementSelectionQuery")))(Oe||(Oe={}));var rA={all:nt(et.None,Oe.ElementSelectionQuery),atomGroups:nt(et.Dictionary({"entity-test":qe(de.Bool,{isOptional:!0,defaultValue:!0}),"chain-test":qe(de.Bool,{isOptional:!0,defaultValue:!0}),"residue-test":qe(de.Bool,{isOptional:!0,defaultValue:!0}),"atom-test":qe(de.Bool,{isOptional:!0,defaultValue:!0}),"group-by":qe(de.Any,{isOptional:!0,defaultValue:"atom-key"})}),Oe.ElementSelectionQuery),bondedAtomicPairs:nt(et.Dictionary({0:qe(de.Bool,{isOptional:!0,defaultValue:"true for covalent bonds"})}),Oe.ElementSelectionQuery),empty:nt(et.None,Oe.ElementSelectionQuery)},nA={queryEach:nt(et.Dictionary({0:qe(Oe.ElementSelectionQuery),query:qe(Oe.ElementSelectionQuery)}),Oe.ElementSelectionQuery),exceptBy:nt(et.Dictionary({0:qe(Oe.ElementSelectionQuery),by:qe(Oe.ElementSelectionQuery)}),Oe.ElementSelectionQuery),unionBy:nt(et.Dictionary({0:qe(Oe.ElementSelectionQuery),by:qe(Oe.ElementSelectionQuery)}),Oe.ElementSelectionQuery),union:nt(et.Dictionary({0:qe(Oe.ElementSelectionQuery)}),Oe.ElementSelectionQuery),includeConnected:nt(et.Dictionary({0:qe(Oe.ElementSelectionQuery),"bond-test":qe(de.Bool,{isOptional:!0,defaultValue:"true for covalent bonds"}),"layer-count":qe(de.Num,{isOptional:!0,defaultValue:1}),"fixed-point":qe(de.Bool,{isOptional:!0,defaultValue:!1}),"as-whole-residues":qe(de.Bool,{isOptional:!0})}),Oe.ElementSelectionQuery),wholeResidues:nt(et.Dictionary({0:qe(Oe.ElementSelectionQuery)}),Oe.ElementSelectionQuery)},oA={pick:nt(et.Dictionary({0:qe(Oe.ElementSelectionQuery),test:qe(de.Bool)}),Oe.ElementSelectionQuery),first:nt(et.Dictionary({0:qe(Oe.ElementSelectionQuery)}),Oe.ElementSelectionQuery),isConnectedTo:nt(et.Dictionary({0:qe(Oe.ElementSelectionQuery),target:qe(Oe.ElementSelectionQuery),"bond-test":qe(de.Bool,{isOptional:!0,defaultValue:"true for covalent bonds"}),disjunct:qe(de.Bool,{isOptional:!0,defaultValue:!0}),invert:qe(de.Bool,{isOptional:!0,defaultValue:!1})}),Oe.ElementSelectionQuery)},iA={intersect:nt(et.List(Oe.ElementSelectionQuery),Oe.ElementSelectionQuery),merge:nt(et.List(Oe.ElementSelectionQuery),Oe.ElementSelectionQuery)},aA={macromolecular:{isHet:xt(de.Bool),id:xt(de.Num),label_atom_id:xt(Oe.AtomName),label_alt_id:xt(de.Str),label_comp_id:xt(de.Str),label_asym_id:xt(de.Str),label_entity_id:xt(de.Str),label_seq_id:xt(de.Num),auth_atom_id:xt(Oe.AtomName),auth_comp_id:xt(de.Str),auth_asym_id:xt(de.Str),auth_seq_id:xt(de.Num),pdbx_PDB_ins_code:xt(de.Str),pdbx_formal_charge:xt(de.Num),occupancy:xt(de.Num),B_iso_or_equiv:xt(de.Num),entityType:xt(Oe.EntityType),entitySubtype:xt(Oe.EntitySubtype),entityPrdId:xt(de.Str),objectPrimitive:xt(Oe.ObjectPrimitive),secondaryStructureKey:xt(de.AnyValue),secondaryStructureFlags:xt(Oe.SecondaryStructureFlags),isNonStandard:xt(de.Bool),chemCompType:xt(de.Str)}},sA={flags:Ri(Oe.BondFlags),order:Ri(de.Num),key:Ri(de.Num),length:Ri(de.Num),atomA:Ri(Oe.ElementReference),atomB:Ri(Oe.ElementReference)};function xt(e){return nt(et.Dictionary({0:qe(Oe.ElementReference,{isOptional:!0,defaultValue:"slot.current-atom"})}),e)}function Ri(e){return nt(et.None,e)}var u0={generator:rA,modifier:nA,filter:oA,combinator:iA,atomProperty:aA,bondProperty:sA};var cA={current:nt(et.None,Oe.ElementSelectionQuery)},c0={generator:cA};var je={core:Cl,structureQuery:u0,internal:c0};hu(je);var jr=ma.Const,Et=ma.Dynamic,mA=[jr(je.core.type.set,function(t,r){return fu.forEachEval(r,t,function(o,a,i){return i.add(o)},new Set)}),jr(je.core.type.regex,function(t,r){return new RegExp(r[0](t),r[1]&&r[1](t)||"")}),jr(je.core.type.bitflags,function(t,r){return+r[0](t)}),jr(je.core.logic.not,(e,t)=>!t[0](e)),jr(je.core.logic.and,(e,t)=>{if(typeof t.length=="number"){for(let r=0,n=t.length;r<n;r++)if(!t[r](e))return!1}else for(let r of Object.keys(t))if(!t[r](e))return!1;return!0}),jr(je.core.logic.or,(e,t)=>{if(typeof t.length=="number"){for(let r=0,n=t.length;r<n;r++)if(t[r](e))return!0}else for(let r of Object.keys(t))if(t[r](e))return!0;return!1}),jr(je.core.rel.eq,(e,t)=>t[0](e)===t[1](e)),jr(je.core.rel.neq,(e,t)=>t[0](e)!==t[1](e)),jr(je.core.str.match,(e,t)=>t[0](e).test(t[1](e))),jr(je.core.set.has,function(t,r){return r[0](t).has(r[1](t))}),jr(je.core.flags.hasAny,(e,t)=>{let r=t[1](e),n=t[0](e);return r?(n&r)!==0:!!n}),Et(je.structureQuery.filter.isConnectedTo,(e,t)=>{var r,n;return Yt.filters.isConnectedTo({query:t[0],target:t.target,disjunct:(r=t.disjunct)==null?void 0:r.call(t,e),invert:(n=t.invert)==null?void 0:n.call(t,e),bondTest:t["bond-test"]})(e)}),Et(je.structureQuery.generator.atomGroups,function(t,r){return Yt.generators.atoms({entityTest:r["entity-test"],chainTest:r["chain-test"],residueTest:r["residue-test"],atomTest:r["atom-test"],groupBy:r["group-by"]})(t)}),Et(je.structureQuery.generator.all,function(t){return Yt.generators.all(t)}),Et(je.structureQuery.generator.bondedAtomicPairs,function(t,r){return Yt.generators.bondedAtomicPairs(r&&r[0])(t)}),Et(je.structureQuery.modifier.wholeResidues,function(t,r){return Yt.modifiers.wholeResidues(r[0])(t)}),Et(je.structureQuery.modifier.union,function(t,r){return Yt.modifiers.union(r[0])(t)}),Et(je.structureQuery.modifier.exceptBy,function(t,r){return Yt.modifiers.exceptBy(r[0],r.by)(t)}),Et(je.structureQuery.modifier.includeConnected,function(t,r){var n,o;return Yt.modifiers.includeConnected({query:r[0],bondTest:r["bond-test"],wholeResidues:!!(r["as-whole-residues"]&&r["as-whole-residues"](t)),layerCount:r["layer-count"]&&r["layer-count"](t)||1,fixedPoint:(o=(n=r["fixed-point"])==null?void 0:n.call(r,t))!=null?o:!1})(t)}),Et(je.structureQuery.combinator.merge,(e,t)=>Yt.combinators.merge(t)(e)),Et(je.structureQuery.atomProperty.macromolecular.label_atom_id,Hn(mt.atom.label_atom_id)),Et(je.structureQuery.atomProperty.macromolecular.label_comp_id,Hn(mt.atom.label_comp_id)),Et(je.structureQuery.atomProperty.macromolecular.auth_comp_id,Hn(mt.atom.auth_comp_id)),Et(je.structureQuery.atomProperty.macromolecular.entityType,Hn(mt.entity.type)),Et(je.structureQuery.atomProperty.macromolecular.entitySubtype,Hn(mt.entity.subtype)),Et(je.structureQuery.atomProperty.macromolecular.entityPrdId,Hn(mt.entity.prd_id)),Et(je.structureQuery.atomProperty.macromolecular.objectPrimitive,Hn(mt.unit.object_primitive)),Et(je.structureQuery.atomProperty.macromolecular.isNonStandard,Hn(mt.residue.isNonStandard)),Et(je.structureQuery.atomProperty.macromolecular.chemCompType,Hn(mt.residue.chem_comp_type)),Et(je.structureQuery.bondProperty.order,(e,t)=>e.atomicBond.order),Et(je.structureQuery.bondProperty.flags,(e,t)=>e.atomicBond.type)];function Hn(e){return(t,r)=>e(r&&r[0]&&r[0](t)||t.element)}(function(){for(let e of mA)Sl.addSymbol(e)})();var H;(u=>{u.core=je.core,u.struct=je.structureQuery,u.internal=je.internal;function n(...m){return u.core.type.list(m)}u.list=n;function o(...m){return u.core.type.set(m)}u.set=o;function a(m,c){return u.core.type.regex([m,c])}u.re=a;let i=u.struct.atomProperty.macromolecular;function s(m){return i[m]()}u.ammp=s})(H||(H={}));function Lt(e,t,r={}){var n;return{label:e,expression:t,category:(n=r.category)!=null?n:"Miscellaneous",isHidden:!!r.isHidden,priority:r.priority||0,referencesCurrent:!!r.referencesCurrent,ensureCustomProperties:r.ensureCustomProperties}}var lA=Lt("All",H.struct.generator.all(),{category:"",priority:1e3}),dA=Lt("Current Selection",H.internal.generator.current(),{category:"",referencesCurrent:!0}),pA=Lt("Polymer",H.struct.modifier.union([H.struct.generator.atomGroups({"entity-test":H.core.logic.and([H.core.rel.eq([H.ammp("entityType"),"polymer"]),H.core.str.match([H.re("(polypeptide|cyclic-pseudo-peptide|peptide-like|nucleotide|peptide nucleic acid)","i"),H.ammp("entitySubtype")])])})]),{category:"Type"}),fA=Lt("Trace",H.struct.modifier.union([H.struct.combinator.merge([H.struct.modifier.union([H.struct.generator.atomGroups({"entity-test":H.core.rel.eq([H.ammp("entityType"),"polymer"]),"chain-test":H.core.set.has([H.set("sphere","gaussian"),H.ammp("objectPrimitive")])})]),H.struct.modifier.union([H.struct.generator.atomGroups({"entity-test":H.core.rel.eq([H.ammp("entityType"),"polymer"]),"chain-test":H.core.rel.eq([H.ammp("objectPrimitive"),"atomistic"]),"atom-test":H.core.set.has([H.set("CA","P"),H.ammp("label_atom_id")])})])])]),{category:"Structure Property"}),yA=H.core.logic.and([H.core.rel.eq([H.ammp("entityType"),"polymer"]),H.core.str.match([H.re("(polypeptide|cyclic-pseudo-peptide|peptide-like)","i"),H.ammp("entitySubtype")])]),hA=H.core.logic.and([H.core.rel.eq([H.ammp("entityType"),"polymer"]),H.core.str.match([H.re("(nucleotide|peptide nucleic acid)","i"),H.ammp("entitySubtype")])]),xA=H.core.str.match([H.re("non-polymer|(amino|carboxy) terminus|peptide-like","i"),H.ammp("chemCompType")]),gA=Lt("Protein",H.struct.modifier.union([H.struct.generator.atomGroups({"entity-test":yA})]),{category:"Type"}),bA=Lt("Nucleic",H.struct.modifier.union([H.struct.generator.atomGroups({"entity-test":hA})]),{category:"Type"}),SA=Lt("Water",H.struct.modifier.union([H.struct.generator.atomGroups({"entity-test":H.core.rel.eq([H.ammp("entityType"),"water"])})]),{category:"Type"}),CA=Lt("Ion",H.struct.modifier.union([H.struct.generator.atomGroups({"entity-test":H.core.rel.eq([H.ammp("entitySubtype"),"ion"])})]),{category:"Type"}),xu=Lt("Carbohydrate",H.struct.modifier.union([H.struct.generator.atomGroups({"entity-test":H.core.logic.or([H.core.rel.eq([H.ammp("entityType"),"branched"]),H.core.logic.and([H.core.rel.eq([H.ammp("entityType"),"non-polymer"]),H.core.str.match([H.re("oligosaccharide","i"),H.ammp("entitySubtype")])])])})]),{category:"Type"}),m0=Lt("Carbohydrate with Connected",H.struct.modifier.union([H.struct.modifier.includeConnected({0:xu.expression,"layer-count":1,"as-whole-residues":!0})]),{category:"Internal",isHidden:!0}),l0=Lt("Connected to Carbohydrate",H.struct.modifier.union([H.struct.modifier.exceptBy({0:m0.expression,by:xu.expression})]),{category:"Internal",isHidden:!0}),_l=Lt("Ligand",H.struct.modifier.union([H.struct.modifier.exceptBy({0:H.struct.modifier.union([H.struct.combinator.merge([H.struct.modifier.union([H.struct.generator.atomGroups({"entity-test":H.core.logic.and([H.core.logic.or([H.core.rel.eq([H.ammp("entityType"),"non-polymer"]),H.core.rel.neq([H.ammp("entityPrdId"),""])]),H.core.logic.not([H.core.str.match([H.re("(oligosaccharide|lipid|ion)","i"),H.ammp("entitySubtype")])])]),"chain-test":H.core.rel.eq([H.ammp("objectPrimitive"),"atomistic"]),"residue-test":H.core.logic.not([H.core.str.match([H.re("saccharide","i"),H.ammp("chemCompType")])])})]),H.struct.modifier.union([H.struct.generator.atomGroups({"entity-test":H.core.rel.eq([H.ammp("entityType"),"polymer"]),"chain-test":H.core.rel.eq([H.ammp("objectPrimitive"),"atomistic"]),"residue-test":xA})])])]),by:H.struct.modifier.union([H.struct.generator.atomGroups({"entity-test":H.core.rel.eq([H.ammp("entityType"),"polymer"]),"chain-test":H.core.rel.eq([H.ammp("objectPrimitive"),"atomistic"]),"residue-test":H.core.set.has([H.set(...xr.toArray(Ka)),H.ammp("label_comp_id")])})])})]),{category:"Type"}),d0=Lt("Ligand with Connected",H.struct.modifier.union([H.struct.modifier.exceptBy({0:H.struct.modifier.union([H.struct.modifier.includeConnected({0:_l.expression,"layer-count":1,"as-whole-residues":!0,"bond-test":H.core.flags.hasAny([H.struct.bondProperty.flags(),H.core.type.bitflags([_e.Flag.Covalent|_e.Flag.MetallicCoordination])])})]),by:xu.expression})]),{category:"Internal",isHidden:!0}),p0=Lt("Connected to Ligand",H.struct.modifier.union([H.struct.modifier.exceptBy({0:d0.expression,by:_l.expression})]),{category:"Internal",isHidden:!0}),_A=Lt("Connected to Ligand or Carbohydrate",H.struct.modifier.union([H.struct.combinator.merge([l0.expression,p0.expression])]),{category:"Internal",isHidden:!0}),AA=Lt("Disulfide Bridges",H.struct.modifier.union([H.struct.combinator.merge([H.struct.modifier.union([H.struct.modifier.wholeResidues([H.struct.filter.isConnectedTo({0:H.struct.generator.atomGroups({"residue-test":H.core.set.has([H.set("CYS"),H.ammp("auth_comp_id")]),"atom-test":H.core.set.has([H.set("SG"),H.ammp("label_atom_id")])}),target:H.struct.generator.atomGroups({"residue-test":H.core.set.has([H.set("CYS"),H.ammp("auth_comp_id")]),"atom-test":H.core.set.has([H.set("SG"),H.ammp("label_atom_id")])}),"bond-test":!0})])]),H.struct.modifier.union([H.struct.modifier.wholeResidues([H.struct.modifier.union([H.struct.generator.bondedAtomicPairs({0:H.core.flags.hasAny([H.struct.bondProperty.flags(),H.core.type.bitflags([_e.Flag.Disulfide])])})])])])])]),{category:"Bond Property"}),IA=Lt("NOS Bridges",H.struct.modifier.union([H.struct.modifier.wholeResidues([H.struct.filter.isConnectedTo({0:H.struct.generator.atomGroups({"residue-test":H.core.set.has([H.set("CSO","LYS"),H.ammp("auth_comp_id")]),"atom-test":H.core.set.has([H.set("OD","NZ"),H.ammp("label_atom_id")])}),target:H.struct.generator.atomGroups({"residue-test":H.core.set.has([H.set("CSO","LYS"),H.ammp("auth_comp_id")]),"atom-test":H.core.set.has([H.set("OD","NZ"),H.ammp("label_atom_id")])}),"bond-test":!0})])]),{category:"Bond Property"}),PA=Lt("Non-standard Residues in Polymers",H.struct.modifier.union([H.struct.generator.atomGroups({"entity-test":H.core.rel.eq([H.ammp("entityType"),"polymer"]),"chain-test":H.core.rel.eq([H.ammp("objectPrimitive"),"atomistic"]),"residue-test":H.ammp("isNonStandard")})]),{category:"Residue Property"}),st={all:lA,current:dA,polymer:pA,trace:fA,protein:gA,nucleic:bA,water:SA,ion:CA,branched:xu,branchedPlusConnected:m0,branchedConnectedOnly:l0,ligand:_l,ligandPlusConnected:d0,ligandConnectedOnly:p0,connectedOnly:_A,disulfideBridges:AA,nosBridges:IA,nonStandardPolymer:PA};var qn=class e{constructor(t){this.state=e.createDefaultSnapshot();this.deltaDirection=p();this.newPosition=p();e.copySnapshot(this.state,t)}get position(){return this.state.position}get up(){return this.state.up}get target(){return this.state.target}setState(t){e.copySnapshot(this.state,t)}getTargetDistance(t){return e.targetDistance(t,this.state.fov)}getFocus(t,r,n,o){let a=Math.max(r,.01),i=this.getTargetDistance(a);p.sub(this.deltaDirection,this.target,this.position),o&&p.matchDirection(this.deltaDirection,o,this.deltaDirection),p.setMagnitude(this.deltaDirection,this.deltaDirection,i),p.sub(this.newPosition,t,this.deltaDirection);let s=e.copySnapshot(e.createDefaultSnapshot(),this.state);return s.target=p.clone(t),s.radius=a,s.position=p.clone(this.newPosition),n&&p.matchDirection(s.up,n,s.up),s}focus(t,r,n,o){r>0&&this.setState(this.getFocus(t,r,n,o))}};(n=>{function e(o,a){let i=Math.max(o,.01);return Math.abs(i/1/Math.sin(a/2))}n.targetDistance=e;function t(){return{fov:Math.PI/4,position:p.create(0,0,100),up:p.create(0,1,0),target:p.create(0,0,0),radius:0}}n.createDefaultSnapshot=t;function r(o,a){return a&&(typeof a.fov<"u"&&(o.fov=a.fov),typeof a.position<"u"&&p.copy(o.position,a.position),typeof a.up<"u"&&p.copy(o.up,a.up),typeof a.target<"u"&&p.copy(o.target,a.target),typeof a.radius<"u"&&(o.radius=a.radius)),o}n.copySnapshot=r})(qn||(qn={}));var f0=H.struct.modifier.union([H.struct.modifier.exceptBy({0:H.struct.generator.all(),by:st.water.expression})]),y0=H.struct.modifier.union([H.struct.combinator.merge([st.ion.expression,st.ligandPlusConnected.expression,st.branchedConnectedOnly.expression,st.disulfideBridges.expression,st.nonStandardPolymer.expression])]),xj=H.struct.modifier.union([H.struct.combinator.merge([st.ion.expression,st.ligandPlusConnected.expression,st.disulfideBridges.expression,st.nonStandardPolymer.expression])]),h0=H.struct.modifier.union([H.struct.combinator.merge([st.trace.expression,st.nucleic.expression,st.branchedPlusConnected.expression,st.ion.expression,st.ligandPlusConnected.expression,st.branchedConnectedOnly.expression,st.disulfideBridges.expression,st.nonStandardPolymer.expression])]),gj=H.struct.modifier.union([H.struct.combinator.merge([st.trace.expression,st.nucleic.expression,st.ion.expression,st.ligandPlusConnected.expression,st.disulfideBridges.expression,st.nonStandardPolymer.expression])]);var ur=class e{constructor(t,r,n,o,a=!1){this.frames=[];this.qualifiers=[];this.metadata={};this.parent=null;this.pathIndex=-1;this.pathJump=0;this.name=t,this.value=r,this.valueType=n,this.valueTypeStr=o,this.isArray=a}addQualifier(t){this.qualifiers.push(t)}isConnection(){return this.value instanceof e}isRelationship(){return this.value instanceof gu}getPathJump(){return this.pathJump=0,this.parent!==null&&this.parent.attributes[this.parent.attributes.length-1]===this&&(this.pathJump=-2),this.pathJump}},gu=class e{constructor(t,r){this.parent=null;this.metadata={};this.children=[];this.attributes=[];this.pathIndex=0;this.pathJump=-1;this.specifierType=0,this.name=t,this.classType=r}addAttribute(t){t.parent=this,this.attributes.push(t)}addChild(t){return t.parent=this,this.children.push(t),t}createChild(t,r){return this.addChild(new e(t,r))}updatePathIndices(t){this.pathIndex=t,t+=1;for(let r of this.children)t=r.updatePathIndices(t);for(let r of this.attributes)r.pathIndex=this.pathIndex,t+=1;return t}countItems(){let t=this.attributes.length+this.children.length;for(let r of this.children)t+=r.countItems();return t}getPathJump(){return this.parent===null||this.parent.children[this.parent.children.length-1]===this&&this.parent.attributes.length===0?this.pathJump=-1:this.pathJump=this.countItems()+1,this.pathJump}},bu=class extends gu{updatePathIndices(){let t=1;for(let r of this.children)t=r.updatePathIndices(t);return 0}getPathJump(){return this.pathJump=this.children.length>0?-1:-2,this.pathJump}},x0=2113929216,TA=65535,S0=4,vA=12,DA=new ArrayBuffer(8),la=new DataView(DA);function MA(e,t){let r=new Float64Array(e);return new Uint8Array(r.buffer)}var Al=class e{constructor(){this.table=new Int32Array(4096);this.table.fill(-1)}static _hash(t){return t=t&4294967295,Math.imul(t,2654435761)&4095}getPosition(t){let r=e._hash(t);return this.table[r]}setPosition(t,r){let n=e._hash(t);this.table[n]=r}};function EA(e){return e+Math.floor(e/255)+16}function g0(e,t){return e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24}function BA(e,t,r){e[t]=r&255,e[t+1]=r>>8&255}function RA(e,t,r,n){let o=0;for(;r<=n&&e[t]===e[r];){o++;t++,r++}return o}function b0(e,t,r,n,o){let a=r.length,i=t,s=i;if(i++,a>=15){e[s]=240;let u=a-15;for(;u>=255;)e[i]=255,i++,u-=255;e[i]=u,i++}else e[s]=a<<4;if(e.set(r,i),i+=a,o>0)if(BA(e,i,n),i+=2,o-=S0,o>=15){for(e[s]|=15,o-=15;o>=255;)e[i]=255,i++,o-=255;e[i]=o,i++}else e[s]|=o;return i-t}function FA(e){let t=e.length,r=new Uint8Array(EA(t)),n=new Al,o=0,a=0,i=0,s=t-vA;for(;o<s;){let u=g0(e,o),m=n.getPosition(u);if(m!==-1&&u===g0(e,m)&&o-m<=TA){let c=RA(e,m,o,s);if(c<S0)break;i+=b0(r,i,new Uint8Array(e.buffer,a,o-a),o-m,c),o+=c,a=o}else n.setPosition(u,o),o++}return i+=b0(r,i,new Uint8Array(e.buffer,a,t-a),0,0),new Uint8Array(r.buffer,0,i)}function Il(e){let t=e.length;if(t===0)return new Uint8Array;if(t>127*x0)throw new Error("Buffer Too Large for LZ4 Compression");if(t<=x0){let r=FA(e),n=new Uint8Array(r.length+1);return n.set(r,1),n}else throw new Error("Not implemented")}function UA(e){var c;let t=e.length;if(t===0)return new Uint8Array;let r=4+Math.floor((t*2+7)/8)+t*4,n=new Uint8Array(r),o=new DataView(n.buffer),a=0,i=new Map;for(let l=0;l<t;++l){let d=e[l],y=d-a;i.set(y,((c=i.get(y))!=null?c:0)+1),a=d}let s=0,u=0;i.forEach((l,d)=>{l>u?(s=d,u=l):l===u&&d>s&&(s=d)}),o.setInt32(0,s,!0);let m=4+Math.floor((t*2+7)/8);a=0;for(let l=0;l<t;++l){let d=e[l],y=d-a,S=l+16;y!==s&&(y<=127&&y>=-128?(n[Math.floor(S/4)]|=1<<S%4*2,o.setInt8(m,y),m++):y<=32767&&y>=-32768?(n[Math.floor(S/4)]|=2<<S%4*2,o.setInt16(m,y,!0),m+=2):(n[Math.floor(S/4)]|=3<<S%4*2,o.setInt32(m,y,!0),m+=4)),a=d}return new Uint8Array(n.buffer,0,m)}function ot(e,t,r,n=!1){let o=new Uint8Array(r),a=new DataView(o.buffer);r===4?n?a.setInt32(0,t,!0):a.setUint32(0,t,!0):n?(a.setInt32(0,t,!0),t<0&&a.setInt32(1,-1,!0)):a.setUint32(0,t,!0),e.write(o)}function zn(e,t){let r=Il(UA(t));ot(e,r.length,8),e.write(r)}var Pl=class{constructor(){this.pos=0;this.buffers=[]}tell(){return this.pos}write(t){this.pos+=t.length,this.buffers.push(t)}compact(){let t=0;for(let o of this.buffers)t+=o.length;let r=new Uint8Array(t),n=0;for(let o of this.buffers)r.set(o,n),n+=o.length;return r}getUSDZ(){let t=0;for(let l of this.buffers)t+=l.length;let r=[116,109,112,46,117,115,100,99],n=64-(34+r.length)%64,o=new Uint8Array(34+r.length+n),a=new Uint8Array(46+r.length+22);this.buffers.unshift(o),this.buffers.push(a);let i=0,s=new DataView(o.buffer);o.set([80,75,3,4],i),i+=4,s.setUint16(i,20,!0),i+=2,i+=2,i+=2,i+=4,i+=4,s.setUint32(i,t,!0),i+=4,s.setUint32(i,t,!0),i+=4,s.setUint16(i,r.length,!0),i+=2,s.setUint16(i,n+4,!0),i+=2,o.set(r,i),i+=r.length,s.setUint16(i,1,!0),i+=2,s.setUint16(i,n,!0),i=0;let u=new DataView(a.buffer),m=34+r.length+n+t;a.set([80,75,1,2],i),i+=4,u.setUint16(i,62,!0),i+=2,u.setUint16(i,20,!0),i+=2,i+=2,i+=2,i+=4,i+=4,u.setUint32(i,t,!0),i+=4,u.setUint32(i,t,!0),i+=4,u.setUint16(i,r.length,!0),i+=2,i+=2,i+=2,i+=2,i+=2,i+=4,i+=4,a.set(r,i),i+=r.length;let c=46+r.length;return a.set([80,75,5,6],i),i+=4,i+=2,i+=2,u.setUint16(i,1,!0),i+=2,u.setUint16(i,1,!0),i+=2,u.setUint32(i,c,!0),i+=4,u.setUint32(i,m,!0),this.compact()}},Su=class{constructor(){this.file=new Pl;this.toc=[];this.tokenMap=new Map;this.tokens=[];this.strings=[];this.fields=[];this.reps=[];this.repsMap=new Map;this.fsets=[];this.paths=[];this.specs=[];this.writtenDataKeys=[];this.writtenDataValues=[];this.tocStartBuffer=new Uint8Array(8)}addWrittenData(t,r,n){this.writtenDataKeys.push(t),this.writtenDataValues.push(n)}getDataReference(t,r){for(let n=0;n<this.writtenDataKeys.length;++n){let o=this.writtenDataKeys[n];if(t.length!==o.length)continue;let a=0;for(;a<t.length&&t[a]===o[a];++a);if(a===t.length)return this.writtenDataValues[n]}return-1}getTokenIndex(t){let r=this.tokenMap.get(t);if(r!==void 0)return r;let n=this.tokens.length;return this.tokenMap.set(t,n),this.tokens.push(t),n}getStringIndex(t){let r=this.getTokenIndex(t),n=this.strings.indexOf(r);return n!==-1?n:(this.strings.push(r),this.strings.length-1)}addFieldSet(t){let r=this.fsets.length;return this.fsets.push(...t),this.fsets.push(-1),r}addFieldItem(t,r,n,o,a,i){let s=this.reps.length;la.setUint32(0,i,!0);let u=0,m=i+t*4294967296;u|=r<<16,n&&(u|=1<<31,m+=4398046511104),a&&(u|=1<<29,m+=1099511627776),o&&(u|=1<<30,m+=2199023255552),la.setUint32(4,u,!0);let c=la.getFloat64(0,!0),l=this.repsMap.get(m);return l!==void 0?l:(this.repsMap.set(m,s),this.fields.push(t),this.reps.push(c),s)}addFieldTokens(t,r){let n=this.getTokenIndex(t),o=[];for(let i of r)o.push(this.getTokenIndex(i));let a=this.file.tell();ot(this.file,o.length,8);for(let i of o)ot(this.file,i,4);return this.addFieldItem(n,11,!0,!1,!1,a)}addFieldToken(t,r){let n=this.getTokenIndex(t),o=this.getTokenIndex(r);return this.addFieldItem(n,11,!1,!0,!1,o)}addFieldTokenVector(t,r){let n=this.getTokenIndex(t),o=[];for(let i of r)o.push(this.getTokenIndex(i));let a=this.getDataReference(o,41);if(a<0){a=this.file.tell(),this.addWrittenData(o,41,a),ot(this.file,o.length,8);for(let i of o)ot(this.file,i,4);this.file.write(new Uint8Array(4))}return this.addFieldItem(n,41,!1,!1,!1,a)}addFieldPathListOp(t,r){let n=this.getTokenIndex(t),o=this.file.tell(),a=259;return ot(this.file,a,8),this.file.write(new Uint8Array(1)),ot(this.file,r,4),this.addFieldItem(n,34,!1,!1,!1,o)}addFieldPathVector(t,r){let n=this.getTokenIndex(t),o=this.file.tell();return ot(this.file,1,8),ot(this.file,r,4),this.addFieldItem(n,40,!1,!1,!1,o)}addFieldSpecifier(t,r){let n=this.getTokenIndex(t);return this.addFieldItem(n,42,!1,!0,!1,r)}addFieldInt(t,r){let n=this.getTokenIndex(t),o=r.length>=16,a=this.getDataReference(r,3);if(a<0)if(a=this.file.tell(),this.addWrittenData(r,3,a),ot(this.file,r.length,8),o)zn(this.file,r);else for(let i of r)ot(this.file,i,4,!0);return this.addFieldItem(n,3,!0,!1,o,a)}addFieldFloat(t,r){let n=this.getTokenIndex(t);la.setFloat32(0,r,!0);let o=la.getInt32(0,!0);return this.addFieldItem(n,8,!1,!0,!1,o)}addFieldVectors(t,r){let n=this.getTokenIndex(t),o=this.file.tell();return ot(this.file,r.length/3,8),this.file.write(new Uint8Array(r.buffer)),this.addFieldItem(n,24,!0,!1,!1,o)}addFieldVector(t,r){let n=this.getTokenIndex(t),o=this.file.tell();return this.file.write(new Uint8Array(r.buffer)),this.addFieldItem(n,24,!1,!1,!1,o)}addFieldBoolean(t,r){let n=this.getTokenIndex(t),o=r?1:0;return this.addFieldItem(n,1,!1,!0,!1,o)}addFieldVariability(t,r){let n=this.getTokenIndex(t),o=r?1:0;return this.addFieldItem(n,44,!1,!0,!1,o)}addFieldDictionary(t,r){let n=this.getTokenIndex(t),o=this.file.tell();ot(this.file,Object.keys(r).length,8);for(let a in r){let i=r[a];ot(this.file,this.getStringIndex(a),4),ot(this.file,8,8),ot(this.file,this.getStringIndex(i),4),ot(this.file,1074397184,4)}return this.addFieldItem(n,31,!1,!1,!1,o)}addField(t,r){let n=r.value,o=r.valueType;if(o===11)return r.isArray?this.addFieldTokens(t,n):this.addFieldToken(t,n);if(o===42)return this.addFieldSpecifier(t,n);if(o===3)return this.addFieldInt(t,n);if(o===8)return this.addFieldFloat(t,n);if(o===24)return r.isArray?this.addFieldVectors(t,n):this.addFieldVector(t,n);if(o===1)return this.addFieldBoolean(t,n);if(o===44)return this.addFieldVariability(t,n);if(o===31)return this.addFieldDictionary(t,n);throw new Error("Unknown type")}addPath(t,r,n,o){o&&(r*=-1),this.paths.push([t,r,n])}addSpec(t,r){let n=this.specs.length;return this.specs.push([n,t,r]),n}writeBootStrap(t=0){this.file.write(new Uint8Array([80,88,82,45,85,83,68,67])),this.file.write(new Uint8Array([0,7,0,0,0,0,0,0])),this.file.write(this.tocStartBuffer),this.file.write(new Uint8Array(64))}writeTokensSection(){let t=this.file.tell();ot(this.file,this.tokens.length,8);let r=0;for(let s of this.tokens)r+=s.length+1;let n=new Uint8Array(r),o=0;for(let s of this.tokens){for(let u=0;u<s.length;++u)n[o++]=s.charCodeAt(u);o++}ot(this.file,n.length,8);let a=Il(n);ot(this.file,a.length,8),this.file.write(a);let i=this.file.tell()-t;this.toc.push(["TOKENS",t,i])}writestringsSection(){let t=this.file.tell();ot(this.file,this.strings.length,8);for(let n of this.strings)ot(this.file,n,4);let r=this.file.tell()-t;this.toc.push(["STRINGS",t,r])}writeFieldsSection(){let t=this.file.tell();ot(this.file,this.fields.length,8),zn(this.file,this.fields);let r=Il(MA(this.reps,8));ot(this.file,r.length,8),this.file.write(r);let n=this.file.tell()-t;this.toc.push(["FIELDS",t,n])}writeFieldSetsSection(){let t=this.file.tell();ot(this.file,this.fsets.length,8),zn(this.file,this.fsets);let r=this.file.tell()-t;this.toc.push(["FIELDSETS",t,r])}writePathsSection(){let t=this.file.tell(),r=[],n=[],o=[];for(let[i,s,u]of this.paths)r.push(i),n.push(s),o.push(u);ot(this.file,this.paths.length,8),ot(this.file,this.paths.length,8),zn(this.file,r),zn(this.file,n),zn(this.file,o);let a=this.file.tell()-t;this.toc.push(["PATHS",t,a])}writeSpecsSection(){let t=this.file.tell(),r=[],n=[],o=[];for(let[i,s,u]of this.specs)r.push(i),n.push(s),o.push(u);ot(this.file,this.specs.length,8),zn(this.file,r),zn(this.file,n),zn(this.file,o);let a=this.file.tell()-t;this.toc.push(["SPECS",t,a])}writeSections(){this.writeTokensSection(),this.writestringsSection(),this.writeFieldsSection(),this.writeFieldSetsSection(),this.writePathsSection(),this.writeSpecsSection()}writeTableOfContents(){let t=this.file.tell();ot(this.file,this.toc.length,8);for(let[r,n,o]of this.toc){let a=new Uint8Array(16);for(let i=0;i<r.length;++i)a[i]=r.charCodeAt(i);this.file.write(a),ot(this.file,n,8),ot(this.file,o,8)}new DataView(this.tocStartBuffer.buffer).setUint32(0,t,!0)}writeUsdConnection(t){let r=[],n=t.value.pathIndex;r.push(this.addFieldToken("typeName","token")),r.push(this.addFieldPathListOp("connectionPaths",n)),r.push(this.addFieldPathVector("connectionChildren",n));let o=this.addFieldSet(r);t.pathIndex=this.addSpec(o,1);let a=this.getTokenIndex(t.name),i=t.getPathJump();this.addPath(t.pathIndex,a,i,!0)}writeUsdRelationship(t){let r=[],n=t.value.pathIndex;r.push(this.addFieldVariability("variability",!0)),r.push(this.addFieldPathListOp("targetPaths",n)),r.push(this.addFieldPathVector("targetChildren",n));let o=this.addFieldSet(r);t.pathIndex=this.addSpec(o,8);let a=this.getTokenIndex(t.name),i=t.getPathJump();this.addPath(t.pathIndex,a,i,!0)}writeUsdAttribute(t){let r=[];r.push(this.addFieldToken("typeName",t.valueTypeStr));for(let i of t.qualifiers)r.push(this.addFieldVariability("variability",!0));for(let i in t.metadata){let s=t.metadata[i];r.push(this.addFieldToken(i,s))}t.value!==null&&r.push(this.addField("default",t));let n=this.addFieldSet(r);t.pathIndex=this.addSpec(n,1);let o=this.getTokenIndex(t.name),a=t.getPathJump();this.addPath(t.pathIndex,o,a,!0)}writeUsdPrim(t){let r=[];r.push(this.addFieldSpecifier("specifier",t.specifierType)),r.push(this.addFieldToken("typeName",t.classType));for(let i in t.metadata){let s=t.metadata[i];i==="assetInfo"?r.push(this.addFieldDictionary(i,s)):i==="kind"&&r.push(this.addFieldToken(i,s))}if(t.attributes.length>0){let i=t.attributes.map(s=>s.name);r.push(this.addFieldTokenVector("properties",i))}if(t.children.length>0){let i=t.children.map(s=>s.name);r.push(this.addFieldTokenVector("primChildren",i))}let n=this.addFieldSet(r);t.pathIndex=this.addSpec(n,6);let o=this.getTokenIndex(t.name),a=t.getPathJump();this.addPath(t.pathIndex,o,a,!1);for(let i of t.children)this.writeUsdPrim(i);for(let i of t.attributes)i.isConnection()?this.writeUsdConnection(i):i.isRelationship()?this.writeUsdRelationship(i):this.writeUsdAttribute(i)}writeUsd(t){t.updatePathIndices(),this.writeBootStrap();let r=[];if(t.children.length>0){let i=t.children.map(s=>s.name);r.push(this.addFieldTokenVector("primChildren",i))}let n=this.addFieldSet(r);t.pathIndex=this.addSpec(n,7);let o=this.getTokenIndex(""),a=t.getPathJump();this.addPath(t.pathIndex,o,a,!1);for(let i of t.children)this.writeUsdPrim(i);this.writeSections(),this.writeTableOfContents()}getUSDZ(){return this.file.getUSDZ()}};function C0(e){let t=new bu("",""),r=t.createChild("ar","Xform"),n=r.createChild("Materials","Scope"),o=0;for(let[s,u]of e){let{positions:m,normals:c,faces:l}=u,d=m,y=c,S=new Float32Array(rt.toRgbNormalized(s)),x=n.createChild("k"+String(o),"Material"),g=x.createChild("shader","Shader"),h=new ur("info:id","UsdPreviewSurface",11,"token");h.addQualifier("uniform"),g.addAttribute(h),g.addAttribute(new ur("inputs:diffuseColor",S,24,"color3f")),g.addAttribute(new ur("inputs:roughness",.2,8,"float"));let f=new ur("outputs:surface",null,11,"token");g.addAttribute(f),x.addAttribute(new ur("outputs:surface",f,0,"token"));let C=[];for(let A=0,b=l.length/3;A<b;++A)C.push(3);let T=r.createChild("m"+String(o),"Mesh");T.addAttribute(new ur("material:binding",x,0,"rel")),T.addAttribute(new ur("faceVertexCounts",C,3,"int[]",!0)),T.addAttribute(new ur("faceVertexIndices",l,3,"int[]",!0)),T.addAttribute(new ur("points",d,24,"point3f[]",!0));let I=new ur("primvars:normals",y,24,"normal3f[]",!0);I.metadata.interpolation="vertex",T.addAttribute(I);let P=new ur("subdivisionScheme","none",11,"token");P.addQualifier("uniform"),T.addAttribute(P),o++}let a=new Su;return a.writeUsd(t),a.getUSDZ()}var _0=p.zero();function LA(e){let t=new Float32Array(e.elementCount*3);for(let r=0,n=0,o=e.units.length;r<o;++r){let a=e.units[r],{elements:i}=a,s=a.conformation.position;for(let u=0,m=i.length;u<m;++u)s(i[u],_0),p.toArray(_0,t,n+u*3);n+=i.length*3}return t}function oi(e,t){let n=t0(t)(new tn(e));return we.unionStructure(n)}function A0(e){return e.polymerUnitCount===1?"sequence-id":e.polymerUnitCount<40?"polymer-index":"polymer-id"}function VA(e){return e.polymerUnitCount<40?"polymer-index":"polymer-id"}function kA(e){let t=e.unitSymmetryGroups.filter(r=>r.units[0].polymerElements.length>0);return t.length===1&&t[0].units.length>2&&t[0].units[0].polymerElements.length<15}function GA(e){return e.polymerResidueCount>4e3?0:kA(e)||e.polymerResidueCount<10?2:1}function wA(e){let t=Xc(e);switch(t){case"lowest":case"lower":case"low":return"low";default:return t}}var Cu=class{constructor(){this.renderables=[];this.camera=new qn({position:p.create(0,0,100),fov:3.14});let t=io.createRegistry();this.reprCtx={webgl:void 0,colorThemeRegistry:t,sizeThemeRegistry:nn.createRegistry()}}addRepresentation(t,r,n){r.ensureCustomProperties&&r.ensureCustomProperties.attach(t);let o=this.reprCtx.colorThemeRegistry.get(n.colorTheme);o.ensureCustomProperties&&o.ensureCustomProperties.attach({structure:t});let a=r.factory(this.reprCtx,r.getParams);a.setTheme({color:this.reprCtx.colorThemeRegistry.create(n.colorTheme,{structure:t},{carbonColor:{name:"element-symbol"}}),size:this.reprCtx.sizeThemeRegistry.create(n.sizeTheme,{structure:t})});let i={...r.defaultValues,quality:n.quality||"auto",ignoreHydrogens:!0};n.radiusOffset&&Object.assign(i,{radiusOffset:n.radiusOffset}),a.createOrUpdate(i,t);for(let s of a.renderObjects)this.renderables.push($y(s))}addCartoon(t,r={}){this.addRepresentation(t,tx,{colorTheme:A0(t),sizeTheme:"uniform",...r})}addGaussianSurface(t,r={}){this.addRepresentation(t,xx,{colorTheme:A0(t),sizeTheme:"uniform",radiusOffset:.75,...r})}addBallAndStick(t,r={}){this.addRepresentation(t,Bx,{colorTheme:"element-symbol",sizeTheme:"physical",...r})}addCarbohydrate(t,r={}){this.addRepresentation(t,$x,{colorTheme:"carbohydrate-symbol",sizeTheme:"uniform",...r})}create3DModel(t){let r=p.fromArray,n=p.toArray,o=p.transformMat4,a=p.transformMat3,i=gt.directionTransform,s=xe.add3,u=p(),m=p(),c=p(),l=p(),d=p(),y=this.camera.state;p.normalize(c,y.up),p.normalize(l,p.sub(l,y.position,y.target)),p.cross(d,c,l);let S=gt.create(d[0],c[0],l[0],d[1],c[1],l[1],d[2],c[2],l[2]),x=re();re.fromMat3(x,S);let g=new Map,h=re(),f=gt();for(let K of this.renderables){let X=K.values,j=X.aPosition.ref.value,$=X.aNormal.ref.value,Z=X.elements.ref.value,te=X.dColorType.ref.value,W=X.tColor.ref.value.array,Y=X.drawCount.ref.value,ie=X.instanceCount.ref.value,D=X.aTransform.ref.value,F=X.uVertexCount.ref.value;for(let N=0;N<ie;++N)if(re.fromArray(h,D,N*16),i(f,h),re.mul(h,x,h),gt.mul(f,S,f),te=="instance"){let oe=X.aInstance.ref.value[N],se=(W[oe*3]<<16)+(W[oe*3+1]<<8)+W[oe*3+2],ce=g.get(se);ce===void 0&&(ce={positions:xe.create(Float32Array,3,512),normals:xe.create(Float32Array,3,512),faces:[]},g.set(se,ce));let{positions:he,normals:ve,faces:Ie}=ce,Pe=he.elementCount;for(let me=0;me<Y;++me){let fe=Z[me];Ie.push(fe+Pe)}for(let me=0;me<F;++me)r(u,j,me*3),o(u,u,h),s(he,u[0],u[1],u[2]);for(let me=0;me<F;++me){r(m,$,me*3);let fe=p.squaredMagnitude(m);(fe<1-1e-6||fe>1+1e-6)&&p.scale(m,m,1/Math.sqrt(fe)),a(m,m,f),s(ve,m[0],m[1],m[2])}}else if(te=="group"){let oe=X.aGroup.ref.value,se=new Map;for(let ce=0;ce<Y;ce+=3){let he=oe[Z[ce]],ve=(W[he*3]<<16)+(W[he*3+1]<<8)+W[he*3+2],Ie=g.get(ve);Ie===void 0&&(Ie={positions:xe.create(Float32Array,3,512),normals:xe.create(Float32Array,3,512),faces:[]},g.set(ve,Ie));let{positions:Pe,normals:me,faces:fe}=Ie,pe=se.get(ve);pe===void 0&&(pe=new Map,se.set(ve,pe));for(let Te=0;Te<3;++Te){let be=Z[ce+Te],Re=pe.get(be);if(Re===void 0){Re=Pe.elementCount,pe.set(be,Re),r(u,j,be*3),r(m,$,be*3);let Ne=p.squaredMagnitude(m);(Ne<1-1e-6||Ne>1+1e-6)&&p.scale(m,m,1/Math.sqrt(Ne)),o(u,u,h),a(m,m,f),s(Pe,u[0],u[1],u[2]),s(me,m[0],m[1],m[2])}fe.push(Re)}}}}g.forEach(K=>{K.positions=xe.compact(K.positions,!1),K.normals=xe.compact(K.normals,!1)});let C=K=>{let X=1/0,j=1/0,$=1/0,Z=-1/0,te=-1/0,W=-1/0,Y=K.length;for(let ie=0;ie<Y;ie+=3){let D=K[ie],F=K[ie+1],N=K[ie+2];D<X&&(X=D),F<j&&(j=F),N<$&&($=N),D>Z&&(Z=D),F>te&&(te=F),N>W&&(W=N)}return[[X,j,$],[Z,te,W]]},T=[],I=[];g.forEach(K=>{let[X,j]=C(K.positions);T.push(X),I.push(j)});let P=Math.min(...T.map(K=>K[0])),A=Math.min(...T.map(K=>K[1])),b=Math.min(...T.map(K=>K[2])),_=Math.max(...I.map(K=>K[0])),v=Math.max(...I.map(K=>K[1])),R=Math.max(...I.map(K=>K[2])),E=Math.max(_-P,v-A,R-b),B=p.create(-(P+_)/2,-A,-(b+R)/2),L=Math.min(40/E,1);g.forEach(K=>{let X=K.positions,j=X.length;for(let $=0;$<j;$+=3)r(u,X,$),p.add(u,u,B),p.scale(u,u,L),n(u,X,$)});let G=C0(g);t(G),this.renderables.length=0}focusCamera(t){let r=mr.ofPositions(LA(t)),{origin:n,dirA:o,dirC:a}=r.boxAxes,i=p.magnitude(o),s=p();p.scaleAndAdd(s,s,n,100),this.camera.setState({position:s}),this.camera.focus(n,i,o,a);let u=qn.copySnapshot(qn.createDefaultSnapshot(),this.camera.state);u.radius=t.boundary.sphere.radius,this.camera.setState(u)}renderAssembly(t,r,n){let a=Lr.Provider.get(t).assemblies[0],i=Ce.ofModel(t),s;a!==void 0?s=br.buildAssembly(i,a.id):s=i,this.render(s,r,n)}render(t,r,n){let o=GA(t),a=wA(t),i;if(o===0)a="lower",i=oi(t,st.polymer.expression),this.addGaussianSurface(i,{quality:a});else{let s={quality:a};r=="cartoon"?this.addCartoon(oi(t,st.polymer.expression),s):this.addGaussianSurface(oi(t,st.polymer.expression),{quality:"low",colorTheme:VA(t)}),this.addCarbohydrate(oi(t,st.branchedPlusConnected.expression),{quality:a}),o===2?(i=oi(t,f0),this.addBallAndStick(i,{quality:a})):(i=oi(t,h0),this.addBallAndStick(oi(t,y0),{quality:a}))}this.focusCamera(i),this.create3DModel(n)}};function NA(e,t,r="cartoon"){let o=La.parseBinary(e).blocks[0],a=of(o);new Cu().renderAssembly(a.representative,r,t)}typeof window<"u"&&(window.main=NA);})();
